{"version":3,"file":"colorpicker.js","sources":["../../loadFileNodeJS/index.js","../../loadScriptNodeJS/index.js","../../loadScriptNodeJS/loadScript.js","../index.js"],"sourcesContent":["/**\r\n * node.js version of the synchronous download of the file.\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//The myRequest is cross-browser XMLHttpRequest wrapper.\r\nfunction myRequest( options ) {\r\n\r\n\tthis.loadXMLDoc = function () {\r\n\t\tvar req;\r\n\r\n\t\tif ( window.XMLHttpRequest ) {\r\n\t\t\treq = new XMLHttpRequest();\r\n\t\t\tif ( !req )\r\n\t\t\t\tthrow \"new XMLHttpRequest() failed!\"\r\n\t\t}\r\n\t\telse if ( window.ActiveXObject ) {\r\n\t\t\treq = this.NewActiveXObject();\r\n\t\t\tif ( !req )\r\n\t\t\t\tthrow \"NewActiveXObject() failed!\"\r\n\t\t}\r\n\t\telse throw \"myRequest.loadXMLDoc(...) failed!\";\r\n\t\treturn req;\r\n\t}\r\n\r\n\tthis.NewActiveXObject = function () {\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP.6.0\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP.3.0\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Microsoft.XMLHTTP\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\tErrorMessage( 'This browser does not support XMLHttpRequest. Probably, your security settings do not allow Web sites to use ActiveX controls installed on your computer. Refresh your Web page to find out the current status of your Web page or enable the \"Initialize and script ActiveX controls not marked as safe\" and \"Run Active X controls and plug-ins\" of the Security settings of the Internet zone of your browser.' );\r\n\t\treturn null;\r\n\t}\r\n\r\n\tthis.XMLHttpRequestStart = function ( onreadystatechange, async ) {\r\n\r\n\t\tthis.XMLHttpRequestStop();//For compatibility with IE Windows Phone\r\n\r\n\t\tthis.req.onreadystatechange = onreadystatechange;\r\n\r\n\t\t//ATTENTION!!! do not works in IE\r\n\t\tif ( \"onerror\" in this.req ) {\r\n\t\t\tthis.req.onerror = function ( event ) {\r\n\t\t\t\tErrorMessage( \"XMLHttpRequest error. url: \" + this.url, false, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.XMLHttpRequestReStart( async );\r\n\t}\r\n\r\n\tthis.getUrl = function () {\r\n\t\tif ( ( typeof this.url == 'undefined' ) || ( this.url == null ) ) {\r\n\t\t\tthis.url = \"XMLHttpRequest.xml\";\r\n\t\t}\r\n\t\treturn this.url + ( this.params ? this.params : \"\" );\r\n\t}\r\n\r\n\tthis.XMLHttpRequestReStart = function ( async ) {\r\n\t\ttry {\r\n\t\t\tif ( typeof async == 'undefined' )\r\n\t\t\t\tasync = true;\r\n\t\t\tthis.req.open( \"GET\", this.getUrl(), async );\r\n\t\t\tif ( async ) {\r\n\t\t\t\tvar timeout = ( 60 + 30 ) * 1000;//��������!!! �������� ������ ���� ������ CSocketWaitEvent::WaitResponse\r\n\t\t\t\tif ( \"timeout\" in this.req )//for IE6\r\n\t\t\t\t\tthis.req.timeout = timeout;\r\n\t\t\t\tif ( \"ontimeout\" in this.req )\r\n\t\t\t\t\tthis.req.ontimeout = function () {\r\n\t\t\t\t\t\tErrorMessage( 'XMLHttpRequest timeout', false, false );\r\n\t\t\t\t\t}\r\n\t\t\t\telse {//for Safari, IE6\r\n\t\t\t\t\tclearTimeout( this.timeout_id_SendReq );\r\n\t\t\t\t\tthis.timeout_id_SendReq = setTimeout( function () {\r\n\t\t\t\t\t\tErrorMessage( 'XMLHttpRequest timeout 2', false, false );\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t, timeout );\r\n\t\t\t\t\t//console.log(\"setTimeout this.req.timeout_id_SendReq = \" + this.req.timeout_id_SendReq);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.req.send( null );\r\n\t\t} catch ( e ) {\r\n\t\t\tErrorMessage( e.message + \" url: \" + this.url, false, false );\r\n\t\t}\r\n\t}\r\n\r\n\tthis.XMLHttpRequestStop = function () {\r\n\t\t//console.log(\"XMLHttpRequestStop(...)\");\r\n\t\tif ( this.req == null )\r\n\t\t\treturn;\r\n\t\tthis.req.abort();\r\n\t}\r\n\r\n\tthis.ProcessReqChange = function ( processStatus200 ) {\r\n\t\tvar req = this.req;\r\n\t\tif ( ( typeof isIE === 'undefined' ) || !isIE ) {\r\n\t\t\t//\tconsole.log(\"processReqChange(); req.statusText: \" + req.statusText + \". req.status = \" + req.status + \". req.readyState = \" + req.readyState + \". req.responseText: \" + req.responseText);\r\n\t\t}\r\n\t\t// only if req shows \"complete\"\r\n\t\t//http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp\r\n\t\t//http://xmlhttprequest.ru/w3c\r\n\t\tswitch ( req.readyState ) {\r\n\t\t\tcase 4://request finished and response is ready\r\n\t\t\t\t{\r\n\t\t\t\t\tif ( typeof req.status == \"unknown\" ) {//IE5 timeout\r\n\t\t\t\t\t\tconsoleError( 'typeof XMLHttpRequest status == \"unknown\"' );\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//� �� ���� ��������� switch ���� � ������\r\n\t\t\t\t\tif ( req.status == 200 )//OK)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclearTimeout( this.timeout_id_SendReq );\r\n\t\t\t\t\t\treturn processStatus200( this );\r\n\t\t\t\t\t}//200://OK\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tErrorMessage( \"Invalid XMLHttpRequest status : \" + req.status + \" url: \" + this.url );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1://server connection established\r\n\t\t\tcase 2://request received\r\n\t\t\tcase 3://processing request\r\n\t\t\t\tbreak;\r\n\t\t\t//\t\tcase 404:\r\n\t\t\tcase 0://request not initialized\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"processReqChange(); req.readyState = \" + req.readyState;\r\n\t\t\t\tbreak;\r\n\t\t}//switch(req.readyState)\r\n\t\treturn true;\r\n\t}\r\n\r\n\tthis.processStatus200Error = function () {\r\n\t\tvar error = this.GetElementText( 'error', true );\r\n\t\tif ( error ) {\r\n\t\t\tErrorMessage( error );\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tthis.GetElementText = function ( tagName, noDisplayErrorMessage ) {\r\n\t\tvar xmlhttp = this.req;\r\n\t\tif ( !xmlhttp.responseXML ) {\r\n\t\t\tif ( noDisplayErrorMessage != true )\r\n\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, ' + tagName + '); xmlhttp.responseXML is null.\\nxmlhttp.responseText:\\n' + xmlhttp.responseText );\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar element = xmlhttp.responseXML.getElementsByTagName( tagName );\r\n\r\n\t\t//ATTENTION!!! For IE set the content-type m_HttpResponse.SetContentType(\"text/xml\");\r\n\r\n\t\tif ( element.length == 0 ) {\r\n\t\t\tif ( noDisplayErrorMessage != true )\r\n\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, \"' + tagName + '\"); element.length == ' + element.length );\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tvar text = \"\";\r\n\t\tfor ( var i = 0; i < element.length; i++ ) {\r\n\t\t\tif ( typeof ( element[i].textContent ) == 'undefined' ) {\r\n\t\t\t\tif ( typeof ( element[i].text ) == 'undefined' ) {\r\n\t\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, ' + tagName + '); element[' + i + '].text) == undefined' );\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t\tif ( text != \"\" )\r\n\t\t\t\t\ttext += \" \";\r\n\t\t\t\ttext += element[i].text;//IE\r\n\t\t\t}\r\n\t\t\telse text += element[i].textContent;//Chrome\r\n\t\t}\r\n\t\treturn text;\r\n\t}\r\n\r\n\tif ( options.data ) {\r\n\t\tthis.req = options.data.req;\r\n\t\tthis.url = options.data.url;\r\n\t\tthis.params = options.data.params;\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tthis.req = this.loadXMLDoc();\r\n\t\t} catch ( e ) {\r\n\t\t\tvar message;\r\n\t\t\tif ( typeof e.message == 'undefined' )\r\n\t\t\t\tmessage = e;\r\n\t\t\telse message = e.message;\r\n\t\t\tErrorMessage( \"Your browser is too old and is not compatible with our site.\\n\\n\"\r\n\t\t\t\t+ window.navigator.appName + \" \" + window.navigator.appVersion + \"\\n\\n\" + message );\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif ( !this.req ) {\r\n\t\tconsoleError( \"Invalid myRequest.req: \" + this.req );\r\n\t\treturn;\r\n\t}\r\n\r\n\tfunction ErrorMessage( error ) {\r\n\r\n\t\tconsole.error( error );\r\n\t\toptions.onerror( error );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @callback onerror\r\n * @param {string} str - error details\r\n */\r\n\r\n/**\r\n * Synchronous load file\r\n * @param {string} url URL of an external file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured. Optional.\r\n * @returns {string} file content\r\n * @example\r\n * \r\n\t//Simplest example.\r\n\tdocument.getElementById( \"elID\" ).innerHTML = loadFile.sync('element.html');\r\n *\r\n * @example\r\n *\r\n\t//onload, onerror events.\r\n\tdocument.getElementById( \"elID\").innerHTML = loadFile.sync( 'element.html',\r\n\t{\r\n\t\tonload: function ( response ) {\r\n\r\n\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\tconsole.log( str );\r\n\r\n\t\t},\r\n\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\tconsole.error( str );\r\n\r\n\t\t},\r\n\t}, );\r\n */\r\nfunction sync( url, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.onload = options.onload || function () { };\r\n\toptions.onerror = options.onerror || function () { };\r\n\r\n\tvar response,\r\n\t\trequest = new myRequest( options );\r\n\trequest.url = url;\r\n\trequest.XMLHttpRequestStart(\r\n\r\n\t\tfunction () {//onreadystatechange\r\n\r\n\t\t\trequest.ProcessReqChange( function ( myRequest ) {//processStatus200\r\n\r\n\t\t\t\tif ( myRequest.processStatus200Error() )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tresponse = myRequest.req.responseText;\r\n\t\t\t\t//console.log( 'loadFile.sync.onload() ' + url );\r\n\t\t\t\toptions.onload( response, url );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\t, false//Synchronous mode\r\n\r\n\t);\r\n\t//console.log( 'sync(' + url + ')' );\r\n\treturn response;\r\n\r\n}\r\n\r\n/**\r\n * display a text to HTML\r\n * @param {string} str source text\r\n * @returns {string} escaped text\r\n */\r\nfunction escapeHtml( str ) {\r\n\r\n\treturn str.replace( /[&<>\"'\\/]/g, function ( s ) {\r\n\r\n\t\tvar entityMap = {\r\n\r\n\t\t\t\"&\": \"&amp;\",\r\n\t\t\t\"<\": \"&lt;\",\r\n\t\t\t\">\": \"&gt;\",\r\n\t\t\t'\"': '&quot;',\r\n\t\t\t\"'\": '&#39;',\r\n\t\t\t\"/\": '&#x2F;'\r\n\r\n\t\t};\r\n\r\n\t\treturn entityMap[s];\r\n\r\n\t} );\r\n}\r\n\r\nexport { sync, escapeHtml };\r\n","/**\r\n * node.js version of the load JavaScript file\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Thanks to:\r\n *http://javascript.ru/forum/events/21439-dinamicheskaya-zagruzka-skriptov.html\r\n *https://learn.javascript.ru/onload-onerror\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//Please download https://github.com/anhr/loadFileNodeJS into ../loadFileNodeJS folder\r\nimport { sync as loadFileSync, escapeHtml } from '../loadFileNodeJS/index.js';\r\n\r\n/**\r\n * @callback onerror\r\n * @param {string} str - error details\r\n */\r\n\r\n/**\r\n * Synchronous load JavaScript file\r\n * @param {string} src URL of an external script file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured. Optional.\r\n * @param {string}[options.appendTo] The node to which the new script will be append. Optional. Default is head node\r\n * @param {Object|string}[options.tag] The script's tag attributes (Object) or tag type (string). Optional.\r\n * Available tag types:\r\n *\t'style' - load a style file (.css extension)\r\n * @param {string} [options.tag.name] tag name. Default is 'script'\r\n * @param {Object} [options.tag.attribute] tag attribute. Optional.\r\n * @param {string} options.tag.attribute.name attribute name. Default is 'type'\r\n * @param {string} options.tag.attribute.value attribute value. Default is 'text/javascript'\r\n *\r\n * @example\r\n * \r\n\t//Simplest example. Append script into head node.\r\n\tloadScript.sync( 'sync.js' );\r\n\r\n * @example\r\n * \r\n\t//onload, onerror events. Append script into \"appendto\" element\r\n\tloadScript.sync( 'sync.js',\r\n\t\t{\r\n\t\t\tonload: function ( response ) {\r\n\r\n\t\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\t\tconsole.log( str );\r\n\r\n\t\t\t},\r\n\t\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\t\telSync2Res.style.color = 'red';\r\n\r\n\t\t\t},\r\n\t\t\tappendTo: document.getElementById( \"appendto\" ),\r\n\t\t},\r\n\t);\r\n *\r\n * @example\r\n *\r\n\t//Append style into head node.\r\n\tloadScript.sync( \"controls.css\",\r\n\t{\r\n\t\t//style rel=\"stylesheet\"\r\n\t\ttag: {\r\n\r\n\t\t\tname: 'style',\r\n\t\t\tattribute: {\r\n\r\n\t\t\t\tname: 'rel',\r\n\t\t\t\tvalue: 'stylesheet',\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n */\r\nfunction sync( src, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.onload = options.onload || function () { };\r\n\toptions.onerror = options.onerror || function () { };\r\n\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[0];\r\n\r\n\tif ( isScriptExists( options.appendTo, src ) ) {\r\n\r\n\t\t//options.onerror( 'duplicate downloading of the ' + src + ' file' );\r\n\t\toptions.onload();\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tif ( src instanceof Array ) {\r\n\r\n\t\tvar error,\r\n\t\t\toptionsItem = {\r\n\r\n\t\t\t\tappendTo: options.appendTo,\r\n\t\t\t\ttag: options.tag,\r\n\t\t\t\tonload: function ( response, url ) {\r\n\t\t\t\t\r\n\t\t\t\t\tconsole.log( 'loadScript.sync.onload: ' + url );\r\n\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tonerror: function ( str ) {\r\n\r\n\t\t\t\t\toptions.onerror( str );\r\n\t\t\t\t\terror = str;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t};\r\n\t\tfor ( var i = 0; i < src.length; i++ ) {\r\n\r\n\t\t\tvar item = src[ i ];\r\n\t\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\t\tscript.setAttribute( \"id\", item );\r\n\t\t\t\tscript.innerHTML = loadFileSync( item, optionsItem );\r\n\r\n\t\t\t}, optionsItem );\r\n\t\t\tif ( error !== undefined )\r\n\t\t\t\tbreak;\r\n\r\n\t\t};\r\n\t\tif ( error === undefined )\r\n\t\t\toptions.onload();\r\n\r\n\t} else loadScriptBase( function ( script ) {\r\n\r\n\t\tscript.setAttribute( \"id\", src );\r\n\t\tscript.innerHTML = loadFileSync( src, options );\r\n\r\n\t}, options );\r\n\r\n}\r\n\r\n/**\r\n * @callback onerrorasync\r\n * @param {string} str - error details\r\n * @param {Object} e - event\r\n */\r\n\r\n/**\r\n * Asynchronous load JavaScript file\r\n * @param {string|string[]} src URL of an external script file or array of the script file names.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerrorasync} [options.onerror] function ( str, e ) The onerror event occurs when an error has been occured. Optional.\r\n * @param {string}[options.appendTo] The node to which the new script will be append. Optional. Default is head node\r\n * @param {Object}[options.tag] The script's tag attributes. Optional.\r\n * @param {string} options.tag.name tag name. Default is 'script'\r\n * @param {Object} [options.tag.attribute] tag attribute. Optional.\r\n * @param {string} options.tag.attribute.name attribute name. Default is 'type'\r\n * @param {string} options.tag.attribute.value attribute value. Default is 'text/javascript'\r\n*\r\n * @example\r\n * \r\n\t//Simplest example. Append script into head node.\r\n\tloadScript.async( \"JavaScript.js);\r\n * \r\n * @example\r\n *\r\n\t//onload, onerror events. Append script into \"appendto\" element\r\n\tloadScript.async( \"JavaScript.js\",\r\n\t{\r\n \t\tonload: function () {\r\n \r\n \t\t\tvar str = 'file has been loaded successfully';\r\n \t\t\tconsole.log( str );\r\n \r\n \t\t},\r\n \t\tonerror: function ( str, e ) {\r\n \r\n \t\t\tconsole.error( str );\r\n \r\n \t\t},\r\n \t\tappendTo: document.getElementById( \"appendto\" ),\r\n \r\n \t}\r\n \r\n  );\r\n *\r\n * @example\r\n *\r\n\t//loading of array of JavaScript files. Append script into head node.\r\n\tloadScript.async( [\r\n \t\t\"JavaScript1.js\",\r\n \t\t\"JavaScript2.js\",\r\n \t],\r\n \t{\r\n \t\tonload: function () {\r\n \r\n \t\t\tvar str = 'file has been loaded successfully';\r\n \t\t\tconsole.log( str );\r\n \r\n \t\t},\r\n \t\tonerror: function ( str, e ) {\r\n \r\n \t\t\tconsole.error( str );\r\n \r\n \t\t},\r\n \r\n \t}\r\n \r\n  );\r\n */\r\nfunction async( src, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[ 0 ];\r\n\toptions.onload = options.onload || function () {};\r\n\r\n\tvar isrc;\r\n\r\n\tfunction async( srcAsync ) {\r\n\r\n\t\tfunction next() {\r\n\r\n\t\t\tif ( src instanceof Array && ( isrc < ( src.length - 1 ) ) ) {\r\n\r\n\t\t\t\tisrc++;\r\n\t\t\t\tasync( src[isrc] );\r\n\r\n\t\t\t} else options.onload();\r\n\r\n\t\t}\r\n\r\n\t\tif ( isScriptExists( options.appendTo, srcAsync, options.onload ) ) {\r\n\r\n\t\t\tnext();\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\tscript.setAttribute( \"id\", srcAsync );\r\n\r\n\t\t\tfunction _onload() {\r\n\r\n\t\t\t\tconsole.log( 'loadScript.async.onload() ' + srcAsync );\r\n\t\t\t\tif ( options.onload !== undefined ) {\r\n\r\n\t\t\t\t\tnext();\r\n/*\r\n\t\t\t\t\tif ( src instanceof Array && ( isrc < ( src.length - 1 ) ) ) {\r\n\r\n\t\t\t\t\t\tisrc++;\r\n\t\t\t\t\t\tasync( src[isrc] );\r\n\r\n\t\t\t\t\t} else options.onload();\r\n*/\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( script.readyState && ! script.onload ) {\r\n\r\n\t\t\t\t// IE, Opera\r\n\t\t\t\tscript.onreadystatechange = function () {\r\n\r\n\t\t\t\t\tif ( script.readyState == \"complete\" ) {\r\n\r\n\t\t\t\t\t\t// �� ������ �������� loaded\r\n\t\t\t\t\t\tif ( options.onload !== undefined ) options.onload(); // (2)\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( script.readyState == \"loaded\" ) {\r\n\r\n\t\t\t\t\t\tsetTimeout( options.onload, 0 ); // (1)\r\n\r\n\t\t\t\t\t\t// ������� ����������, ����� �� �������� �� complete\r\n\t\t\t\t\t\tthis.onreadystatechange = null;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Rest\r\n\t\t\t\tscript.onload = _onload;\r\n\r\n\t\t\t\tscript.onerror = function ( e ) {\r\n\r\n\t\t\t\t\tvar str = 'loadScript: \"' + this.src + '\" failed';\r\n\t\t\t\t\tif ( options.onerror !== undefined )\r\n\t\t\t\t\t\toptions.onerror( str, e );\r\n\t\t\t\t\tconsole.error( str );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscript.src = srcAsync;\r\n\r\n\t\t}, options );\r\n\r\n\t}\r\n\r\n\tif ( src instanceof Array ) {\r\n\r\n\t\tisrc = 0;\r\n\t\tasync( src[ isrc ] );\r\n\r\n\t} else async( src );\r\n\r\n}\r\n\r\nfunction loadScriptBase( callback, options ) {\r\n\r\n\toptions.tag = options.tag || {};\r\n\tif ( typeof options.tag === \"string\" ) {\r\n\r\n\t\tswitch ( options.tag ) {\r\n\r\n\t\t\tcase 'style':\r\n\t\t\t\toptions.tag = {\r\n\r\n\t\t\t\t\tname: 'style',\r\n\t\t\t\t\tattribute: {\r\n\r\n\t\t\t\t\t\tname: 'rel',\r\n\t\t\t\t\t\tvalue: 'stylesheet',\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: console.error( 'Invalid options.tag: ' + options.tag );\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toptions.tag.name = options.tag.name || 'script';\r\n\tvar script = document.createElement( options.tag.name );\r\n\r\n\toptions.tag.attribute = options.tag.attribute || {};\r\n\toptions.tag.attribute.name = options.tag.attribute.name || \"type\";\r\n\toptions.tag.attribute.value = options.tag.attribute.value || 'text/javascript';\r\n\tscript.setAttribute( options.tag.attribute.name, options.tag.attribute.value );\r\n\r\n\tcallback( script );\r\n\toptions.appendTo.appendChild( script );\r\n\r\n}\r\n\r\nfunction isScriptExists( elParent, srcAsync, onload ) {\r\n\r\n\tvar scripts = elParent.querySelectorAll( 'script' );\r\n\tfor ( var i = 0; i < scripts.length; i++ ) {\r\n\r\n\t\tvar child = scripts[i];\r\n\t\tif ( child.id === srcAsync ) {\r\n\r\n/*\r\n\t\t\tif ( onload !== undefined )\r\n\t\t\t\tonload();\r\n*/\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\treturn false;\r\n\r\n}\r\n\r\nexport { async, sync, escapeHtml };\r\n","﻿/**\r\n * node.js version of download of the scripts.\r\n * \r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport { sync, async } from './index.js';\r\n\r\nvar loadScript = {\r\n\r\n\tsync: sync,\r\n\tasync: async,\r\n\r\n}\r\nexport default loadScript;\r\n","/**\r\n * @module ColorPicker\r\n * @description Pure JavaScript color picker.\r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n * @See Thanks to [FlexiColorPicker]{@link https://github.com/DavidDurman/FlexiColorPicker}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//Please download https://github.com/anhr/loadScriptNodeJS into ../loadScriptNodeJS folder\r\n\r\nimport loadScript from '../loadScriptNodeJS/loadScript.js';\r\n//import loadScript from 'https://raw.githack.com/anhr/commonNodeJS/master/loadScriptNodeJS/loadScript.js';\r\n//import loadScript from 'http://localhost/anhr/commonNodeJS/master/loadScriptNodeJS/loadScript.js';\r\n\r\nconst optionsStyle = {\r\n\r\n\t//style rel=\"stylesheet\"\r\n\ttag: 'style'\r\n\r\n}\r\n\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\n//Такая же функция есть в frustumPoints.js но если ее использовать то она будет возвращать путь на frustumPoints.js\r\nconst getCurrentScript = function () {\r\n\r\n\tif ( document.currentScript && ( document.currentScript.src !== '' ) )\r\n\t\treturn document.currentScript.src;\r\n\tconst scripts = document.getElementsByTagName( 'script' ),\r\n\t\tstr = scripts[scripts.length - 1].src;\r\n\tif ( str !== '' )\r\n\t\treturn src;\r\n\t//Thanks to https://stackoverflow.com/a/42594856/5175935\r\n\treturn new Error().stack.match( /(https?:[^:]*)/ )[0];\r\n\r\n};\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\nconst getCurrentScriptPath = function () {\r\n\tconst script = getCurrentScript(),\r\n\t\tpath = script.substring( 0, script.lastIndexOf( '/' ) );\r\n\treturn path;\r\n};\r\n//console.warn( 'getCurrentScriptPath = ' + getCurrentScriptPath() );\r\nconst currentScriptPath = getCurrentScriptPath();\r\n\r\n//loadScript.sync( 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.css', optionsStyle );\r\nloadScript.sync( currentScriptPath + '/colorpicker.css', optionsStyle );\r\n\r\nconst type = ( window.SVGAngle || document.implementation.hasFeature( \"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\" ) ? \"SVG\" : \"VML\" ),\r\n\tsvgNS = 'http://www.w3.org/2000/svg';\r\nvar uniqID = 0;\r\n\r\n/**\r\n * enumeration of available palettes.\r\n * @readonly\r\n * @enum {number}\r\n */\r\nconst paletteIndexes = {\r\n\t\r\n\r\n\t/** [blue, green, red, white]{@link https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/Example/index.html#BGRW} palette. This is the default palette*/\r\n\tBGRW: 0,\r\n\t/** [monochrome]{@link https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/Example/index.html#Monochrome} palette */\r\n\tmonochrome: 1,\r\n\t/** [red, black, green]{@link https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/Example/index.html#Bidirectional} palette */\r\n\tbidirectional: 2,//\r\n\t/** [rainbow]{@link https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/Example/index.html#rainbow} palette */\r\n\trainbow: 3,\r\n\r\n}\r\n/**\r\n * @callback callback\r\n * @description Called whenever the color is changed provided chosen color in RGB HEX format. See options.sliderIndicator.callback param of the create method.\r\n * @param {object} c color\r\n * @param {string} c.hex A hexadecimal color is specified with: #RRGGBB, where the RR (red), GG (green) and BB (blue)\r\n * <pre>\r\n * hexadecimal integers specify the components of the color. All values must be between 00 and FF.\r\n * Example #00ff00\r\n * </pre>\r\n * @param {number} c.r red of RGB color value. Must be between 0 and 255.\r\n * @param {number} c.g green of RGB color value. Must be between 0 and 255.\r\n * @param {number} c.b blue of RGB color value. Must be between 0 and 255.\r\n * @param {number} percent position of the mouse pointer in the percents. See details in options.direction param\r\n */\r\n\r\n/**\r\n * @callback onError\r\n * @param {string} message error message\r\n */\r\n\r\n/**\r\n * creates an instance of ColorPicker\r\n * @param {string|HTMLElement} elSliderWrapper id of the ColorPicker element or ColorPicker element\r\n * @param {object} [options] followed options is availablee\r\n * @param {paletteIndexes|object[]|Palette} [options.palette] Palette index or palette array or Palette. The following indexes are available:\r\n * <pre>\r\n * paletteIndexes.BGRW: 0 - blue, green, red, white palette.\r\n * paletteIndexes.monochrome: 1,\r\n * paletteIndexes.bidirectional: 2,//red, black, green\r\n * paletteIndexes.rainbow: 3,\r\n * Default is paletteIndexes.BGRW index.\r\n * Example of palette array:\r\n[\r\n\t{ percent: 0, r: 0, g: 0, b: 0, },\r\n\t{ percent: 10, r: 0xff, g: 255, b: 0xff, },\r\n\t{ percent: 100, r: 0xff, g: 255, b: 0xff, },\r\n]\r\n * Palette see function Palette( options ) for details\r\n * </pre>\r\n * @param {object} [options.orientation] orientation of the element. Available \"horizontal\" or \"vertical\" orientation\r\n * @param {object} [options.direction] true - position of the mouse pointer relative left side for 'horizontal' slider\r\n * or bottom side for 'vertical' slider in the percents.\r\n * <p>\r\n * false - position of the mouse pointer relative right side for 'horizontal' slider\r\n * or relative top side for 'vertical' slider in the percents.\r\n * </p>\r\n * Default is true.\r\n * @param {object} [options.style] style statements\r\n * @param {object} [options.style.width] width of the element. Default is 200px for options.orientation = \"horizontal\"\r\n * and 30px for options.orientation = \"vertical\".\r\n * @param {object} [options.style.height] height of the element. Default is 30px for options.orientation = \"horizontal\"\r\n * and 200px for options.orientation = \"vertical\".\r\n * @param {string} [options.style.border] elSliderWrapper border. Example: '1px solid black'\r\n * @param {object} [options.sliderIndicator] adds a slider-indicator element for choose by mouse a color from palette.\r\n * Default is undefuned\r\n * @param {callback} [options.sliderIndicator.callback] Called whenever the color is changed provided chosen color in RGB HEX format.\r\n * @param {number} [options.sliderIndicator.value] Initial position of the slider indicator in percent. Default is 0.\r\n * @param {onError} [options.onError] Called whenever an error has occurred.\r\n * @param {boolean} [options.duplicate] true - allow to create two or more palettes on your web page.\r\n */\r\nfunction create( elSliderWrapper, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.orientation = options.orientation || 'horizontal';\r\n\r\n\tfunction isHorizontal() { return options.orientation === \"horizontal\"; }\r\n\r\n\tif ( options.direction === undefined  )\r\n\t\toptions.direction = true;\r\n\toptions.style = options.style || {};\r\n\t//\t\toptions.style.width = options.style.width || ( isHorizontal() ? '200px' : '30px' );\r\n\toptions.style.width = options.style.width || ( isHorizontal() ? 200 : 30 );\r\n\toptions.style.height = options.style.height || ( isHorizontal() ? 30 : 200 );\r\n\r\n\toptions.onError = options.onError || function () {}\r\n\r\n\tif ( elSliderWrapper instanceof HTMLElement !== true ) {\r\n\r\n\t\tif ( typeof elSliderWrapper !== \"string\" ) {\r\n\r\n\t\t\tconsole.error( 'ColorPicker.create: invalid elSliderWrapper = ' + elSliderWrapper );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\telSliderWrapper = document.getElementById( elSliderWrapper );\r\n\t\tif ( elSliderWrapper === null ) {\r\n\r\n\t\t\tconsole.error( 'ColorPicker.create: invalid elSliderWrapper = ' + elSliderWrapper );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\telSliderWrapper.classList.add( 'slider-wrapper' );\r\n\tfor ( var style in options.style ) {\r\n\r\n\t\telSliderWrapper.style[style] = options.style[style];\r\n\r\n\t}\r\n\r\n\tconst palette = options.palette instanceof Palette ? options.palette : new Palette( options );\r\n\tvar slide;\r\n\tfunction getSlideHeight() {\r\n\r\n\t\tif ( typeof options.style.height === \"string\" )\r\n\t\t\treturn parseInt( options.style.height );\r\n\t\treturn options.style.height;\r\n\r\n\t}\r\n\tfunction getSlideWidth() { return slide.clientWidth; }\r\n\t/**\r\n\t * sets color from palette\r\n\t * @param {number} value coordinate of color from palette in percent\r\n\t * @param {number} position coordinate of color from palette\r\n\t */\r\n\tfunction setValue( value, position ) {\r\n\r\n\t\tif ( slideIndicator === undefined ) {\r\n\r\n\t\t\tconsole.error( 'Set value of this instance of the ColorPicker is impossible because options.sliderIndicator is not defined.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst c = palette.hsv2rgb( value );\r\n\t\tif ( c === undefined ) {\r\n\r\n\t\t\tconsole.error( 'ColorPicker.setValue: invalud c = ' + c );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvalue = c.percent;\r\n\t\tif ( position === undefined )\r\n\t\t\tposition = isHorizontal() ?\r\n\t\t\t\t( getSlideWidth() * value ) / 100 :\r\n\t\t\t\tgetSlideHeight() - ( getSlideHeight() * ( options.direction ? value : 100 - value ) ) / 100;\r\n\t\tpositionIndicators( position );\r\n\t\tif ( options.sliderIndicator.callback !== undefined ) {\r\n\r\n\t\t\t//console.warn( 'callback: ' + c.percent + ' percent c.hex = ' + c.hex );\r\n\t\t\toptions.sliderIndicator.callback( c );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar slideIndicator;\r\n\tif ( options.sliderIndicator !== undefined ) {\r\n\r\n\t\tslideIndicator = document.createElement( 'div' );\r\n\t\tslideIndicator.className = 'slider-indicator';\r\n\t\tif ( isHorizontal() )\r\n\t\t\tslideIndicator.style.width = '10px';\r\n\t\telse slideIndicator.style.height = '10px';\r\n\t\telSliderWrapper.appendChild( slideIndicator );\r\n\t\tslideIndicator.style.pointerEvents = 'none';\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Helper to position indicators.\r\n\t * @param {number} position Coordinates of the mouse cursor in the slide area.\r\n\t */\r\n\tfunction positionIndicators( position ) {\r\n\r\n\t\tif ( slideIndicator === undefined )\r\n\t\t\treturn;\r\n\r\n\t\tif ( isHorizontal() ) {\r\n\r\n\t\t\tif ( ( position < 0 ) || ( position > getSlideWidth() ) ) {\r\n\r\n\t\t\t\tconsole.error( 'ColorPicker.positionIndicators: Invalid position = ' + position );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tslideIndicator.style.top = '0px';\r\n\t\t\tslideIndicator.style.left = ( ( options.direction ? position : getSlideWidth() - position ) - slideIndicator.offsetWidth / 2 ) + 'px';\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( ( position < 0 ) || ( position > getSlideHeight() ) ) {\r\n\r\n\t\t\t\tconsole.error( 'ColorPicker.positionIndicators: Invalid position = ' + position );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tslideIndicator.style.left = '0px';\r\n\t\t\tslideIndicator.style.top = ( position - slideIndicator.offsetHeight / 2 ) + 'px';\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tif ( type == 'SVG' ) {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tconst linearGradient = 'linearGradient';\r\n\t\t\tslide = CreateSVGElement( 'svg', {\r\n\t\t\t\txmlns: 'http://www.w3.org/2000/svg',\r\n\t\t\t\tversion: '1.1',\r\n\t\t\t\twidth: isHorizontal() ? '100%' : options.style.width,\r\n\t\t\t\theight: options.style.height,\r\n\t\t\t},\r\n\t\t\t\t[\r\n\t\t\t\t\tCreateSVGElement( 'defs', {},\r\n\t\t\t\t\t\tCreateSVGElement( linearGradient, {\r\n\r\n\t\t\t\t\t\t\tid: 'gradient-hsv-' + uniqID,\r\n\t\t\t\t\t\t\tx1: isHorizontal() && options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\ty1: !isHorizontal() && !options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\tx2: isHorizontal() && !options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\ty2: !isHorizontal() && options.direction ? '100%' : '0%',\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tpalette.getPalette()\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\tCreateSVGElement( 'rect', { x: '0', y: '0', width: '100%', height: '100%', fill: 'url(#gradient-hsv-' + uniqID + ')' } )\r\n\t\t\t\t]\r\n\t\t\t);\r\n\t\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\t\tslide.style.cursor = isHorizontal() ? 'e-resize' : 's-resize';\r\n\t\t\t\tslideIndicator.style.cursor = slide.style.cursor;\r\n\r\n\t\t\t}\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\t//I can not get \r\n\t\t\t// slide.querySelector( linearGradient );\r\n\t\t\t//in Safari 5.1.7 browser for Windows\r\n\t\t\t//Instead I see the error message:\r\n\t\t\t// 'null' is not an object( evaluating 'hsvGradient.id = 'gradient - hsv - ' + uniqID' )\r\n\t\t\tconsole.error( 'Create SVG element failed! ' + e.message );\r\n\r\n\t\t}\r\n\r\n\t\telSliderWrapper.appendChild( slide );\r\n\t\telSliderWrapper.style.height = getSlideHeight() + 'px'; \r\n\r\n\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\tif ( isHorizontal() )\r\n\t\t\t\tslideIndicator.style.height = ( parseInt( options.style.height ) - 2 ) + 'px';\r\n\t\t\telse slideIndicator.style.width = ( parseInt( options.style.width ) - 2 ) + 'px';\r\n\r\n\t\t\toptions.sliderIndicator.value = options.sliderIndicator.value || 0;\r\n\t\t\tsetValue( options.sliderIndicator.value );\r\n\r\n\t\t}\r\n\t\tuniqID++;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.error( 'Under constraction' );\r\n\r\n\t}\r\n\r\n\tfunction mouseMove( mouse ) {\r\n\r\n\t\t//for IE\r\n\t\tmouse.x = parseInt( mouse.x );\r\n\t\tmouse.y = parseInt( mouse.y );\r\n\r\n\t\tvar position, size, value;\r\n\t\tif ( isHorizontal() ) {\r\n\r\n\t\t\tposition = mouse.x;\r\n\t\t\tsize = getSlideWidth() - 1;\r\n\r\n\t\t\tif ( position >= getSlideWidth() )\r\n\t\t\t\tposition = size;\r\n\t\t\tvalue = ( position * 100 ) / size;\r\n\t\t\tif ( !options.direction ) {\r\n\r\n\t\t\t\tvalue = 100 - value;\r\n\t\t\t\tposition = size - position;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tposition = mouse.y;\r\n\t\t\tsize = getSlideHeight() - 1;\r\n\r\n\t\t\tif ( position >= getSlideHeight() )\r\n\t\t\t\tposition = size;\r\n\t\t\tvalue = ( 1 - position / size ) * 100;\r\n\t\t\tif ( !options.direction ) {\r\n\r\n\t\t\t\tvalue = 100 - value;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tsetValue( value, position );\r\n\r\n\t}\r\n\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\tvar mouseout = false;\r\n\r\n\t\t/**\r\n\t\t * Return click event handler for the slider.\r\n\t\t * Sets picker background color and calls options.sliderIndicator.callback if provided.\r\n\t\t */\r\n\t\tfunction slideListener() {\r\n\r\n\t\t\treturn function ( evt ) {\r\n\r\n\t\t\t\tif ( mouseout )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tevt = evt || window.event;\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Return mouse position relative to the element el.\r\n\t\t\t\t */\r\n\t\t\t\tfunction mousePosition( evt ) {\r\n\t\t\t\t\t// IE:\r\n\t\t\t\t\tif ( window.event && window.event.contentOverflow !== undefined ) {\r\n\t\t\t\t\t\treturn { x: window.event.offsetX, y: window.event.offsetY };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Webkit:\r\n\t\t\t\t\tif ( evt.offsetX !== undefined && evt.offsetY !== undefined ) {\r\n\t\t\t\t\t\treturn { x: evt.offsetX, y: evt.offsetY };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Firefox:\r\n\t\t\t\t\tvar wrapper = evt.target.parentNode.parentNode;\r\n\t\t\t\t\treturn { x: evt.layerX - wrapper.offsetLeft, y: evt.layerY - wrapper.offsetTop };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmouseMove( mousePosition( evt ) );\r\n\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tfunction addEventListener( element, event, listener ) {\r\n\r\n\t\t\tif ( element === null )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif ( element.attachEvent ) {\r\n\r\n\t\t\t\telement.attachEvent( 'on' + event, listener );\r\n\r\n\t\t\t} else if ( element.addEventListener ) {\r\n\r\n\t\t\t\telement.addEventListener( event, listener, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddEventListener( slide, 'click', slideListener() );\r\n\r\n\t\t/**\r\n\t\t * @callback listener\r\n\t\t*/\r\n\r\n\t\t/**\r\n\t\t * Enable drag&drop color selection.\r\n\t\t * @param {object} ctx ColorPicker instance.\r\n\t\t * @param {listener} listener Function that will be called whenever mouse is dragged over the element with event object as argument.\r\n\t\t */\r\n\t\tfunction enableDragging( ctx, listener ) {\r\n\r\n\t\t\tvar element = slide;\r\n\r\n\t\t\t//Touchscreen support\r\n\r\n\t\t\taddEventListener( element, 'touchstart', function ( evt ) { } );\r\n\t\t\taddEventListener( element, 'touchmove', function ( evt ) {\r\n\r\n\t\t\t\tevt.preventDefault();\r\n\r\n\t\t\t\tvar rect = evt.srcElement.getBoundingClientRect(),\r\n\t\t\t\t\tx = ( evt.touches[0].clientX - rect.left ),\r\n\t\t\t\t\ty = ( evt.touches[0].clientY - rect.top );\r\n\t\t\t\tif ( x < 0 ) x = 0;\r\n\t\t\t\tif ( y < 0 ) y = 0;\r\n\t\t\t\tmouseMove( { x: x, y: y } );\r\n\r\n\t\t\t} );\r\n\t\t\taddEventListener( element, 'touchend', function ( evt ) {\r\n\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//mouse support\r\n\t\t\taddEventListener( element, 'mousedown', function ( evt ) {\r\n\r\n\t\t\t\tconst mouseup = 'mouseup', mousemove = 'mousemove';\r\n\t\t\t\tfunction onMouseUp() {\r\n\r\n\t\t\t\t\t//console.warn( mouseup );\r\n\t\t\t\t\tfunction removeEventListener( element, event, listener ) {\r\n\r\n\t\t\t\t\t\tif ( element === null )\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\tif ( element.detachEvent ) {\r\n\r\n\t\t\t\t\t\t\telement.detachEvent( 'on' + event, listener );\r\n\r\n\t\t\t\t\t\t} else if ( element.removeEventListener ) {\r\n\r\n\t\t\t\t\t\t\telement.removeEventListener( event, listener, false );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tremoveEventListener( window, mouseup, onMouseUp );\r\n\t\t\t\t\tremoveEventListener( window, mousemove, listener );\r\n\r\n\t\t\t\t}\r\n\t\t\t\taddEventListener( window, mouseup, onMouseUp );\r\n\t\t\t\taddEventListener( window, mousemove, listener );\r\n\r\n\t\t\t} );\r\n\t\t\taddEventListener( element, 'mouseout', function ( evt ) { mouseout = true; } );\r\n\t\t\taddEventListener( element, 'mouseover', function ( evt ) { mouseout = false; } );\r\n\t\t}\r\n\t\tenableDragging( this, slideListener() );\r\n\r\n\t}\r\n\r\n\treturn {\r\n\r\n\t\tsetValue: setValue,\r\n\r\n\t};\r\n}\r\n\r\nfunction CreateSVGElement( el, attrs, children ) {\r\n\r\n\tel = document.createElementNS( svgNS, el );\r\n\tfor ( var key in attrs )\r\n\t\tel.setAttribute( key, attrs[key] );\r\n\tif ( Object.prototype.toString.call( children ) != '[object Array]' ) children = [children];\r\n\tvar i = 0, len = ( children[0] && children.length ) || 0;\r\n\tfor ( ; i < len; i++ )\r\n\t\tel.appendChild( children[i] );\r\n\treturn el;\r\n}\r\n\r\nvar boCreated = false;\r\n\r\n/**\r\n * create palette\r\n * @param {object} [options] the following options are available\r\n * @param {paletteIndexes|object[]} [options.palette] Palette index or palette array. The following indexes are available:\r\n * <pre>\r\n * paletteIndexes.BGRW: 0 - blue, green, red, white palette.\r\n * paletteIndexes.monochrome: 1,\r\n * paletteIndexes.bidirectional: 2,//red, black, green\r\n * paletteIndexes.rainbow: 3,\r\n * Default is paletteIndexes.BGRW index.\r\n * Example of palette array:\r\n[\r\n\t{ percent: 0, r: 0, g: 0, b: 0, },\r\n\t{ percent: 10, r: 0xff, g: 255, b: 0xff, },\r\n\t{ percent: 100, r: 0xff, g: 255, b: 0xff, },\r\n]\r\n* </pre>\r\n*/\r\nfunction Palette( options ) {\r\n\r\n\r\n\tfunction paletteitem( percent, r, g, b ) {\r\n\r\n\t\treturn {\r\n\r\n\t\t\tpercent: percent,\r\n\t\t\tr: r,\r\n\t\t\tg: g,\r\n\t\t\tb: b,\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toptions = options || {};\r\n\r\n\tif ( !options.duplicate && boCreated ) {\r\n\r\n\t\tconsole.warn( 'Palette: duplicate palette' );\r\n\t\treturn;\r\n\r\n\t}\r\n\tif ( options.palette === undefined )\r\n\t\toptions.palette = paletteIndexes.BGRW;\r\n\r\n\tvar arrayPalette = [\r\n\r\n\t\tnew paletteitem( 0, 0x00, 0x00, 0xFF ),//blue\r\n\t\tnew paletteitem( 33, 0x00, 0xFF, 0x00 ),//green\r\n\t\tnew paletteitem( 66, 0xFF, 0xFF, 0x00 ),//red\r\n\t\tnew paletteitem( 100, 0xFF, 0xFF, 0xFF ),//white\r\n\r\n\t];\r\n\tswitch ( typeof options.palette ) {\r\n\r\n\t\tcase 'number':\r\n\t\t\tswitch ( options.palette ) {\r\n\r\n\t\t\t\tcase paletteIndexes.BGRW:\r\n\t\t\t\t\tbreak;//default palette\r\n\t\t\t\tcase paletteIndexes.monochrome:\r\n\t\t\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\t\t\tnew paletteitem( 0, 0x00, 0x00, 0x00 ),//blach\r\n\t\t\t\t\t\tnew paletteitem( 100, 0xFF, 0xFF, 0xFF ),//white\r\n\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase paletteIndexes.bidirectional:\r\n\t\t\t\t\tvar arrayPalette = [\r\n\t\t\t\t\t\tnew paletteitem( 0, 0xff, 0x30, 0x30 ),//red\r\n\t\t\t\t\t\tnew paletteitem( 50, 0x30, 0x30, 0x30 ),//gray\r\n\t\t\t\t\t\tnew paletteitem( 100, 0x30, 0xFF, 0x30 ),//green\r\n\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase paletteIndexes.rainbow:\r\n\t\t\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\t\t\tnew paletteitem( 0, 0xff, 0x32, 0x32 ),\r\n\t\t\t\t\t\tnew paletteitem( 16, 0xfc, 0xf5, 0x28 ),\r\n\t\t\t\t\t\tnew paletteitem( 32, 0x28, 0xfc, 0x28 ),\r\n\t\t\t\t\t\tnew paletteitem( 50, 0x28, 0xfc, 0xf8 ),\r\n\t\t\t\t\t\tnew paletteitem( 66, 0x27, 0x2e, 0xf9 ),\r\n\t\t\t\t\t\tnew paletteitem( 82, 0xff, 0x28, 0xfb ),\r\n\t\t\t\t\t\tnew paletteitem( 100, 0xff, 0x32, 0x32 ),\r\n\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error( 'ColorPicker.create.Palette: invalid options.palette = ' + options.palette );\r\n\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase \"object\":\r\n\t\t\tif ( Array.isArray( options.palette ) ) {\r\n\r\n\t\t\t\t//Custom palette\r\n\t\t\t\tarrayPalette = options.palette;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\tvar message = 'invalid options.palette = ' + options.palette;\r\n\t\t\tconsole.error( 'ColorPicker.create.Palette: ' + message );\r\n\t\t\toptions.onError( message );\r\n\r\n\t}\r\n\t/**\r\n\t* returns palette array.\r\n\t* @function Palette.\r\n\t* getPalette\r\n\t* @returns {object[]} palette array\r\n\t*/\r\n\tthis.getPalette = function () {\r\n\r\n\t\tconst palette = [];\r\n\t\tarrayPalette.forEach( function ( item ) {\r\n\r\n\t\t\tpalette.unshift( CreateSVGElement( 'stop', {\r\n\r\n\t\t\t\toffset: ( 100 - item.percent ) + '%', 'stop-color': '#'\r\n\t\t\t\t\t//Thanks to https://stackoverflow.com/a/13240395/5175935\r\n\t\t\t\t\t+ ( \"0\" + ( Number( item.r ).toString( 16 ) ) ).slice( -2 ).toUpperCase()\r\n\t\t\t\t\t+ ( \"0\" + ( Number( item.g ).toString( 16 ) ) ).slice( -2 ).toUpperCase()\r\n\t\t\t\t\t+ ( \"0\" + ( Number( item.b ).toString( 16 ) ) ).slice( -2 ).toUpperCase(),\r\n\t\t\t\t'stop-opacity': '1'\r\n\r\n\t\t\t} ) );\r\n\r\n\t\t} );\r\n\t\treturn palette;\r\n\r\n\t}\r\n\t/**\r\n\t* converts a percent or value from min to max  to object with r, g, b, hex and percent.\r\n\t* @function Palette.\r\n\t* hsv2rgb\r\n\t* @param {number} stringPercent coordinate of color from palette in percent or value from min to max\r\n\t* @param {number} [min] min stringPercent. Default is undefined.\r\n\t* @param {number} [max] max stringPercent. Default is undefined.\r\n\t* @returns {object} object with r, g, b, hex and percent\r\n\t*/\r\n\tthis.hsv2rgb = function ( stringPercent, min, max ) {\r\n\r\n\t\tvar percent = parseFloat( stringPercent );\r\n\t\tif ( min !== undefined && max !== undefined )\r\n\t\t\tpercent = ( 100 / ( max - min ) ) * ( percent - min );\r\n\t\tvar lastPalette = arrayPalette[arrayPalette.length - 1];\r\n\t\tif ( lastPalette.percent !== 100 ) {\r\n\r\n\t\t\t//not compatible with Safari for Windows\r\n\t\t\t//var lastItem = Object.assign( {}, arrayPalette[arrayPalette.length - 1] );\r\n\r\n\t\t\tconst lastItem = {};\r\n\t\t\tObject.keys( lastPalette ).forEach( function ( key ) {\r\n\r\n\t\t\t\tlastItem[key] = lastPalette[key];\r\n\r\n\t\t\t} );\r\n\t\t\tlastItem.percent = 100;\r\n\t\t\tarrayPalette.push( lastItem );\r\n\r\n\t\t}\r\n\t\tvar itemPrev;\r\n\t\tfor ( var i = 0; i < arrayPalette.length; i++ ) {\r\n\r\n\t\t\tconst item = arrayPalette[i];\r\n\t\t\tif ( itemPrev === undefined )\r\n\t\t\t\titemPrev = item;\r\n\t\t\tif ( ( ( percent >= itemPrev.percent ) && ( percent <= item.percent ) ) ) {\r\n\r\n\t\t\t\tfunction color( percentPrev, prev, percentItem, item ) {\r\n\r\n\t\t\t\t\tvar percentD = percentItem - percentPrev;\r\n\t\t\t\t\tif ( percentD === 0 )\r\n\t\t\t\t\t\treturn prev;\r\n\t\t\t\t\treturn Math.round( prev + ( ( item - prev ) / percentD ) * ( percent - percentPrev ) );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst r = color( itemPrev.percent, itemPrev.r, item.percent, item.r ),\r\n\t\t\t\t\tg = color( itemPrev.percent, itemPrev.g, item.percent, item.g ),\r\n\t\t\t\t\tb = color( itemPrev.percent, itemPrev.b, item.percent, item.b );\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tr: r,\r\n\t\t\t\t\tg: g,\r\n\t\t\t\t\tb: b,\r\n\t\t\t\t\thex: \"#\" + ( 16777216 | b | ( g << 8 ) | ( r << 16 ) ).toString( 16 ).slice( 1 ),\r\n\t\t\t\t\tpercent: percent\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\t\t\titemPrev = item;\r\n\r\n\t\t}\r\n\t\tif ( options.onError !== undefined )\r\n\t\t\toptions.onError( 'Invalid color value of the ColorPicker: ' + stringPercent );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t* converts a value in percentages to color.\r\n\t* @function Palette.\r\n\t* toColor\r\n\t* @param {number} value coordinate of color from palette in percent. Default value range from 0 to 100.\r\n\t* @param {number} min minimal value\r\n\t* @param {number} max maximal value\r\n\t* @returns {THREE.Color} color\r\n\t*/\r\n\tthis.toColor = function ( value, min, max ) {\r\n\r\n\t\tif ( typeof THREE === 'undefined' ){\r\n\r\n\t\t\tconsole.error( 'Call ColorPicker.palette.setTHREE(THREE) first.' );\r\n\t\t\treturn;\r\n\t\t\t\r\n\t\t}\r\n\t\tif ( value instanceof THREE.Color )\r\n\t\t\treturn value;\r\n\t\tvar c = this.hsv2rgb( value, min, max );\r\n\t\tif ( c === undefined )\r\n\t\t\tc = { r: 255, g: 255, b: 255 }\r\n\t\treturn new THREE.Color( \"rgb(\" + c.r + \", \" + c.g + \", \" + c.b + \")\" );\r\n\r\n\t}\r\n\r\n\tboCreated = true;\r\n\r\n}\r\n\r\nvar THREE;\r\n/**\r\n * set THREE\r\n * @function Palette.\r\n * setTHREE\r\n * @param {THREE} _THREE {@link https://github.com/anhr/three.js|THREE}\r\n */\r\nPalette.setTHREE = function ( _THREE ) {\r\n\r\n\tif ( THREE ) {\r\n\r\n\t\tif ( !Object.is( THREE, _THREE ) )\r\n\t\t\tconsole.error( 'Palette.setTHREE: duplicate THREE. Please use one instance of the THREE library.' )\r\n\t\treturn;\r\n\r\n\t}\r\n\tTHREE = _THREE;\r\n\r\n}\r\nexport { paletteIndexes, create, Palette };\r\n"],"names":["myRequest","options","loadXMLDoc","req","window","XMLHttpRequest","ActiveXObject","NewActiveXObject","e","XMLHttpRequestStart","onreadystatechange","async","XMLHttpRequestStop","onerror","event","url","XMLHttpRequestReStart","getUrl","params","open","timeout","ontimeout","timeout_id_SendReq","setTimeout","send","message","abort","ProcessReqChange","processStatus200","readyState","status","processStatus200Error","error","GetElementText","tagName","noDisplayErrorMessage","xmlhttp","responseXML","ErrorMessage","responseText","element","getElementsByTagName","length","text","i","textContent","data","navigator","appName","appVersion","sync","onload","response","request","src","appendTo","document","isScriptExists","Array","optionsItem","tag","log","str","item","script","setAttribute","innerHTML","loadFileSync","undefined","loadScriptBase","isrc","srcAsync","next","_onload","callback","name","createElement","attribute","value","appendChild","elParent","scripts","querySelectorAll","child","id","loadScript","optionsStyle","getCurrentScript","currentScript","Error","stack","match","getCurrentScriptPath","path","substring","lastIndexOf","currentScriptPath","type","SVGAngle","implementation","hasFeature","svgNS","uniqID","paletteIndexes","create","elSliderWrapper","orientation","isHorizontal","direction","style","width","height","onError","HTMLElement","getElementById","classList","add","palette","Palette","slide","getSlideHeight","parseInt","getSlideWidth","clientWidth","setValue","position","slideIndicator","c","hsv2rgb","percent","sliderIndicator","className","pointerEvents","positionIndicators","top","left","offsetWidth","offsetHeight","linearGradient","CreateSVGElement","getPalette","x","y","fill","cursor","mouseMove","mouse","size","slideListener","evt","mouseout","mousePosition","contentOverflow","offsetX","offsetY","wrapper","target","parentNode","layerX","offsetLeft","layerY","offsetTop","addEventListener","listener","attachEvent","enableDragging","ctx","preventDefault","rect","srcElement","getBoundingClientRect","touches","clientX","clientY","mouseup","mousemove","onMouseUp","removeEventListener","detachEvent","el","attrs","children","createElementNS","key","Object","prototype","toString","call","len","boCreated","paletteitem","r","g","b","duplicate","warn","BGRW","arrayPalette","monochrome","bidirectional","rainbow","isArray","forEach","unshift","Number","slice","toUpperCase","stringPercent","min","max","parseFloat","lastPalette","lastItem","keys","push","itemPrev","color","percentPrev","prev","percentItem","percentD","Math","round","toColor","THREE","Color","setTHREE","_THREE","is","console"],"mappings":"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"}