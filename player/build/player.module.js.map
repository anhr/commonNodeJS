{"version":3,"file":"player.module.js","sources":["../../dat/dat.gui.module.js","../../UpDownController.js","../../three.js","../../ScaleController.js","../../PositionController.js","../../dat.gui/CustomController/build/dat.gui.module.js","../../getPosition.js","../../WebGL.js","../../loadFileNodeJS/index.js","../../loadScriptNodeJS/index.js","../../loadScriptNodeJS/loadScript.js","../../colorpicker/colorpicker.js","../../OrbitControls/OrbitControls.js","../../cookieNodeJS/index.js","../../cookieNodeJS/cookie.js","../../lang.js","../../createFullScreenSettings.js","../../SpriteText/SpriteText.js","../../StereoEffect/StereoEffect.js","../../Options.js","../player.js"],"sourcesContent":["/**\r\n * dat-gui JavaScript Controller Library\r\n * http://code.google.com/p/dat-gui\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nfunction ___$insertStyle(css) {\r\n  if (!css) {\r\n    return;\r\n  }\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  var style = document.createElement('style');\r\n\r\n  style.setAttribute('type', 'text/css');\r\n  style.innerHTML = css;\r\n  document.head.appendChild(style);\r\n\r\n  return css;\r\n}\r\n\r\nfunction colorToString (color, forceCSSHex) {\r\n  var colorFormat = color.__state.conversionName.toString();\r\n  var r = Math.round(color.r);\r\n  var g = Math.round(color.g);\r\n  var b = Math.round(color.b);\r\n  var a = color.a;\r\n  var h = Math.round(color.h);\r\n  var s = color.s.toFixed(1);\r\n  var v = color.v.toFixed(1);\r\n  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\r\n    var str = color.hex.toString(16);\r\n    while (str.length < 6) {\r\n      str = '0' + str;\r\n    }\r\n    return '#' + str;\r\n  } else if (colorFormat === 'CSS_RGB') {\r\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n  } else if (colorFormat === 'CSS_RGBA') {\r\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\r\n  } else if (colorFormat === 'HEX') {\r\n    return '0x' + color.hex.toString(16);\r\n  } else if (colorFormat === 'RGB_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ']';\r\n  } else if (colorFormat === 'RGBA_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\r\n  } else if (colorFormat === 'RGB_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\r\n  } else if (colorFormat === 'RGBA_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\r\n  } else if (colorFormat === 'HSV_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\r\n  } else if (colorFormat === 'HSVA_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\r\n  }\r\n  return 'unknown format';\r\n}\r\n\r\nvar ARR_EACH = Array.prototype.forEach;\r\nvar ARR_SLICE = Array.prototype.slice;\r\nvar Common = {\r\n  BREAK: {},\r\n  extend: function extend(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (!this.isUndefined(obj[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  defaults: function defaults(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (this.isUndefined(target[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  compose: function compose() {\r\n    var toCall = ARR_SLICE.call(arguments);\r\n    return function () {\r\n      var args = ARR_SLICE.call(arguments);\r\n      for (var i = toCall.length - 1; i >= 0; i--) {\r\n        args = [toCall[i].apply(this, args)];\r\n      }\r\n      return args[0];\r\n    };\r\n  },\r\n  each: function each(obj, itr, scope) {\r\n    if (!obj) {\r\n      return;\r\n    }\r\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\r\n      obj.forEach(itr, scope);\r\n    } else if (obj.length === obj.length + 0) {\r\n      var key = void 0;\r\n      var l = void 0;\r\n      for (key = 0, l = obj.length; key < l; key++) {\r\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    } else {\r\n      for (var _key in obj) {\r\n        if (itr.call(scope, obj[_key], _key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  defer: function defer(fnc) {\r\n    setTimeout(fnc, 0);\r\n  },\r\n  debounce: function debounce(func, threshold, callImmediately) {\r\n    var timeout = void 0;\r\n    return function () {\r\n      var obj = this;\r\n      var args = arguments;\r\n      function delayed() {\r\n        timeout = null;\r\n        if (!callImmediately) func.apply(obj, args);\r\n      }\r\n      var callNow = callImmediately || !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(delayed, threshold);\r\n      if (callNow) {\r\n        func.apply(obj, args);\r\n      }\r\n    };\r\n  },\r\n  toArray: function toArray(obj) {\r\n    if (obj.toArray) return obj.toArray();\r\n    return ARR_SLICE.call(obj);\r\n  },\r\n  isUndefined: function isUndefined(obj) {\r\n    return obj === undefined;\r\n  },\r\n  isNull: function isNull(obj) {\r\n    return obj === null;\r\n  },\r\n  isNaN: function (_isNaN) {\r\n    function isNaN(_x) {\r\n      return _isNaN.apply(this, arguments);\r\n    }\r\n    isNaN.toString = function () {\r\n      return _isNaN.toString();\r\n    };\r\n    return isNaN;\r\n  }(function (obj) {\r\n    return isNaN(obj);\r\n  }),\r\n  isArray: Array.isArray || function (obj) {\r\n    return obj.constructor === Array;\r\n  },\r\n  isObject: function isObject(obj) {\r\n    return obj === Object(obj);\r\n  },\r\n  isNumber: function isNumber(obj) {\r\n    return obj === obj + 0;\r\n  },\r\n  isString: function isString(obj) {\r\n    return obj === obj + '';\r\n  },\r\n  isBoolean: function isBoolean(obj) {\r\n    return obj === false || obj === true;\r\n  },\r\n  isFunction: function isFunction(obj) {\r\n    return Object.prototype.toString.call(obj) === '[object Function]';\r\n  }\r\n};\r\n\r\nvar INTERPRETATIONS = [\r\n{\r\n  litmus: Common.isString,\r\n  conversions: {\r\n    THREE_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    SIX_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9]{6})$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGB: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3])\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGBA: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3]),\r\n          a: parseFloat(test[4])\r\n        };\r\n      },\r\n      write: colorToString\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isNumber,\r\n  conversions: {\r\n    HEX: {\r\n      read: function read(original) {\r\n        return {\r\n          space: 'HEX',\r\n          hex: original,\r\n          conversionName: 'HEX'\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return color.hex;\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isArray,\r\n  conversions: {\r\n    RGB_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 3) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b];\r\n      }\r\n    },\r\n    RGBA_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 4) return false;\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2],\r\n          a: original[3]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b, color.a];\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isObject,\r\n  conversions: {\r\n    RGBA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    RGB_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b\r\n        };\r\n      }\r\n    },\r\n    HSVA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    HSV_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v\r\n        };\r\n      }\r\n    }\r\n  }\r\n}];\r\nvar result = void 0;\r\nvar toReturn = void 0;\r\nvar interpret = function interpret() {\r\n  toReturn = false;\r\n  var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\r\n  Common.each(INTERPRETATIONS, function (family) {\r\n    if (family.litmus(original)) {\r\n      Common.each(family.conversions, function (conversion, conversionName) {\r\n        result = conversion.read(original);\r\n        if (toReturn === false && result !== false) {\r\n          toReturn = result;\r\n          result.conversionName = conversionName;\r\n          result.conversion = conversion;\r\n          return Common.BREAK;\r\n        }\r\n      });\r\n      return Common.BREAK;\r\n    }\r\n  });\r\n  return toReturn;\r\n};\r\n\r\nvar tmpComponent = void 0;\r\nvar ColorMath = {\r\n  hsv_to_rgb: function hsv_to_rgb(h, s, v) {\r\n    var hi = Math.floor(h / 60) % 6;\r\n    var f = h / 60 - Math.floor(h / 60);\r\n    var p = v * (1.0 - s);\r\n    var q = v * (1.0 - f * s);\r\n    var t = v * (1.0 - (1.0 - f) * s);\r\n    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\r\n    return {\r\n      r: c[0] * 255,\r\n      g: c[1] * 255,\r\n      b: c[2] * 255\r\n    };\r\n  },\r\n  rgb_to_hsv: function rgb_to_hsv(r, g, b) {\r\n    var min = Math.min(r, g, b);\r\n    var max = Math.max(r, g, b);\r\n    var delta = max - min;\r\n    var h = void 0;\r\n    var s = void 0;\r\n    if (max !== 0) {\r\n      s = delta / max;\r\n    } else {\r\n      return {\r\n        h: NaN,\r\n        s: 0,\r\n        v: 0\r\n      };\r\n    }\r\n    if (r === max) {\r\n      h = (g - b) / delta;\r\n    } else if (g === max) {\r\n      h = 2 + (b - r) / delta;\r\n    } else {\r\n      h = 4 + (r - g) / delta;\r\n    }\r\n    h /= 6;\r\n    if (h < 0) {\r\n      h += 1;\r\n    }\r\n    return {\r\n      h: h * 360,\r\n      s: s,\r\n      v: max / 255\r\n    };\r\n  },\r\n  rgb_to_hex: function rgb_to_hex(r, g, b) {\r\n    var hex = this.hex_with_component(0, 2, r);\r\n    hex = this.hex_with_component(hex, 1, g);\r\n    hex = this.hex_with_component(hex, 0, b);\r\n    return hex;\r\n  },\r\n  component_from_hex: function component_from_hex(hex, componentIndex) {\r\n    return hex >> componentIndex * 8 & 0xFF;\r\n  },\r\n  hex_with_component: function hex_with_component(hex, componentIndex, value) {\r\n    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\r\n  }\r\n};\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\r\n  return typeof obj;\r\n} : function (obj) {\r\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar get = function get(object, property, receiver) {\r\n  if (object === null) object = Function.prototype;\r\n  var desc = Object.getOwnPropertyDescriptor(object, property);\r\n\r\n  if (desc === undefined) {\r\n    var parent = Object.getPrototypeOf(object);\r\n\r\n    if (parent === null) {\r\n      return undefined;\r\n    } else {\r\n      return get(parent, property, receiver);\r\n    }\r\n  } else if (\"value\" in desc) {\r\n    return desc.value;\r\n  } else {\r\n    var getter = desc.get;\r\n\r\n    if (getter === undefined) {\r\n      return undefined;\r\n    }\r\n\r\n    return getter.call(receiver);\r\n  }\r\n};\r\n\r\nvar inherits = function (subClass, superClass) {\r\n  if (typeof superClass !== \"function\" && superClass !== null) {\r\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\r\n  }\r\n\r\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n    constructor: {\r\n      value: subClass,\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true\r\n    }\r\n  });\r\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar possibleConstructorReturn = function (self, call) {\r\n  if (!self) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n\r\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\r\n};\r\n\r\nvar Color = function () {\r\n  function Color() {\r\n    classCallCheck(this, Color);\r\n    this.__state = interpret.apply(this, arguments);\r\n    if (this.__state === false) {\r\n      throw new Error('Failed to interpret color arguments');\r\n    }\r\n    this.__state.a = this.__state.a || 1;\r\n  }\r\n  createClass(Color, [{\r\n    key: 'toString',\r\n    value: function toString() {\r\n      return colorToString(this);\r\n    }\r\n  }, {\r\n    key: 'toHexString',\r\n    value: function toHexString() {\r\n      return colorToString(this, true);\r\n    }\r\n  }, {\r\n    key: 'toOriginal',\r\n    value: function toOriginal() {\r\n      return this.__state.conversion.write(this);\r\n    }\r\n  }]);\r\n  return Color;\r\n}();\r\nfunction defineRGBComponent(target, component, componentHexIndex) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'RGB') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateRGB(this, component, componentHexIndex);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'RGB') {\r\n        Color.recalculateRGB(this, component, componentHexIndex);\r\n        this.__state.space = 'RGB';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nfunction defineHSVComponent(target, component) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'HSV') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateHSV(this);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'HSV') {\r\n        Color.recalculateHSV(this);\r\n        this.__state.space = 'HSV';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nColor.recalculateRGB = function (color, component, componentHexIndex) {\r\n  if (color.__state.space === 'HEX') {\r\n    color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\r\n  } else if (color.__state.space === 'HSV') {\r\n    Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\r\n  } else {\r\n    throw new Error('Corrupted color state');\r\n  }\r\n};\r\nColor.recalculateHSV = function (color) {\r\n  var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\r\n  Common.extend(color.__state, {\r\n    s: result.s,\r\n    v: result.v\r\n  });\r\n  if (!Common.isNaN(result.h)) {\r\n    color.__state.h = result.h;\r\n  } else if (Common.isUndefined(color.__state.h)) {\r\n    color.__state.h = 0;\r\n  }\r\n};\r\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\r\ndefineRGBComponent(Color.prototype, 'r', 2);\r\ndefineRGBComponent(Color.prototype, 'g', 1);\r\ndefineRGBComponent(Color.prototype, 'b', 0);\r\ndefineHSVComponent(Color.prototype, 'h');\r\ndefineHSVComponent(Color.prototype, 's');\r\ndefineHSVComponent(Color.prototype, 'v');\r\nObject.defineProperty(Color.prototype, 'a', {\r\n  get: function get$$1() {\r\n    return this.__state.a;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.a = v;\r\n  }\r\n});\r\nObject.defineProperty(Color.prototype, 'hex', {\r\n  get: function get$$1() {\r\n    if (!this.__state.space !== 'HEX') {\r\n      this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\r\n    }\r\n    return this.__state.hex;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.space = 'HEX';\r\n    this.__state.hex = v;\r\n  }\r\n});\r\n\r\nvar Controller = function () {\r\n  function Controller(object, property) {\r\n    classCallCheck(this, Controller);\r\n    this.initialValue = object[property];\r\n    this.domElement = document.createElement('div');\r\n    this.object = object;\r\n    this.property = property;\r\n    this.__onChange = undefined;\r\n    this.__onFinishChange = undefined;\r\n  }\r\n  createClass(Controller, [{\r\n    key: 'onChange',\r\n    value: function onChange(fnc) {\r\n      this.__onChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'onFinishChange',\r\n    value: function onFinishChange(fnc) {\r\n      this.__onFinishChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'setValue',\r\n    value: function setValue(newValue) {\r\n      this.object[this.property] = newValue;\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this, newValue);\r\n      }\r\n      this.updateDisplay();\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'getValue',\r\n    value: function getValue() {\r\n      return this.object[this.property];\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'isModified',\r\n    value: function isModified() {\r\n      return this.initialValue !== this.getValue();\r\n    }\r\n  }]);\r\n  return Controller;\r\n}();\r\n\r\nvar EVENT_MAP = {\r\n  HTMLEvents: ['change'],\r\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\r\n  KeyboardEvents: ['keydown']\r\n};\r\nvar EVENT_MAP_INV = {};\r\nCommon.each(EVENT_MAP, function (v, k) {\r\n  Common.each(v, function (e) {\r\n    EVENT_MAP_INV[e] = k;\r\n  });\r\n});\r\nvar CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\r\nfunction cssValueToPixels(val) {\r\n  if (val === '0' || Common.isUndefined(val)) {\r\n    return 0;\r\n  }\r\n  var match = val.match(CSS_VALUE_PIXELS);\r\n  if (!Common.isNull(match)) {\r\n    return parseFloat(match[1]);\r\n  }\r\n  return 0;\r\n}\r\nvar dom = {\r\n  makeSelectable: function makeSelectable(elem, selectable) {\r\n    if (elem === undefined || elem.style === undefined) return;\r\n    elem.onselectstart = selectable ? function () {\r\n      return false;\r\n    } : function () {};\r\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\r\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\r\n    elem.unselectable = selectable ? 'on' : 'off';\r\n  },\r\n  makeFullscreen: function makeFullscreen(elem, hor, vert) {\r\n    var vertical = vert;\r\n    var horizontal = hor;\r\n    if (Common.isUndefined(horizontal)) {\r\n      horizontal = true;\r\n    }\r\n    if (Common.isUndefined(vertical)) {\r\n      vertical = true;\r\n    }\r\n    elem.style.position = 'absolute';\r\n    if (horizontal) {\r\n      elem.style.left = 0;\r\n      elem.style.right = 0;\r\n    }\r\n    if (vertical) {\r\n      elem.style.top = 0;\r\n      elem.style.bottom = 0;\r\n    }\r\n  },\r\n  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\r\n    var params = pars || {};\r\n    var className = EVENT_MAP_INV[eventType];\r\n    if (!className) {\r\n      throw new Error('Event type ' + eventType + ' not supported.');\r\n    }\r\n    var evt = document.createEvent(className);\r\n    switch (className) {\r\n      case 'MouseEvents':\r\n        {\r\n          var clientX = params.x || params.clientX || 0;\r\n          var clientY = params.y || params.clientY || 0;\r\n          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0,\r\n          0,\r\n          clientX,\r\n          clientY,\r\n          false, false, false, false, 0, null);\r\n          break;\r\n        }\r\n      case 'KeyboardEvents':\r\n        {\r\n          var init = evt.initKeyboardEvent || evt.initKeyEvent;\r\n          Common.defaults(params, {\r\n            cancelable: true,\r\n            ctrlKey: false,\r\n            altKey: false,\r\n            shiftKey: false,\r\n            metaKey: false,\r\n            keyCode: undefined,\r\n            charCode: undefined\r\n          });\r\n          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\r\n          break;\r\n        }\r\n      default:\r\n        {\r\n          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\r\n          break;\r\n        }\r\n    }\r\n    Common.defaults(evt, aux);\r\n    elem.dispatchEvent(evt);\r\n  },\r\n  bind: function bind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.addEventListener) {\r\n      elem.addEventListener(event, func, bool);\r\n    } else if (elem.attachEvent) {\r\n      elem.attachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  unbind: function unbind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.removeEventListener) {\r\n      elem.removeEventListener(event, func, bool);\r\n    } else if (elem.detachEvent) {\r\n      elem.detachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  addClass: function addClass(elem, className) {\r\n    if (elem.className === undefined) {\r\n      elem.className = className;\r\n    } else if (elem.className !== className) {\r\n      var classes = elem.className.split(/ +/);\r\n      if (classes.indexOf(className) === -1) {\r\n        classes.push(className);\r\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n      }\r\n    }\r\n    return dom;\r\n  },\r\n  removeClass: function removeClass(elem, className) {\r\n    if (className) {\r\n      if (elem.className === className) {\r\n        elem.removeAttribute('class');\r\n      } else {\r\n        var classes = elem.className.split(/ +/);\r\n        var index = classes.indexOf(className);\r\n        if (index !== -1) {\r\n          classes.splice(index, 1);\r\n          elem.className = classes.join(' ');\r\n        }\r\n      }\r\n    } else {\r\n      elem.className = undefined;\r\n    }\r\n    return dom;\r\n  },\r\n  hasClass: function hasClass(elem, className) {\r\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\r\n  },\r\n  getWidth: function getWidth(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\r\n  },\r\n  getHeight: function getHeight(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\r\n  },\r\n  getOffset: function getOffset(el) {\r\n    var elem = el;\r\n    var offset = { left: 0, top: 0 };\r\n    if (elem.offsetParent) {\r\n      do {\r\n        offset.left += elem.offsetLeft;\r\n        offset.top += elem.offsetTop;\r\n        elem = elem.offsetParent;\r\n      } while (elem);\r\n    }\r\n    return offset;\r\n  },\r\n  isActive: function isActive(elem) {\r\n    return elem === document.activeElement && (elem.type || elem.href);\r\n  }\r\n};\r\n\r\nvar BooleanController = function (_Controller) {\r\n  inherits(BooleanController, _Controller);\r\n  function BooleanController(object, property) {\r\n    classCallCheck(this, BooleanController);\r\n    var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__prev = _this2.getValue();\r\n    _this2.__checkbox = document.createElement('input');\r\n    _this2.__checkbox.setAttribute('type', 'checkbox');\r\n    function onChange() {\r\n      _this.setValue(!_this.__prev);\r\n    }\r\n    dom.bind(_this2.__checkbox, 'change', onChange, false);\r\n    _this2.domElement.appendChild(_this2.__checkbox);\r\n    _this2.updateDisplay();\r\n    return _this2;\r\n  }\r\n  createClass(BooleanController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      this.__prev = this.getValue();\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (this.getValue() === true) {\r\n        this.__checkbox.setAttribute('checked', 'checked');\r\n        this.__checkbox.checked = true;\r\n        this.__prev = true;\r\n      } else {\r\n        this.__checkbox.checked = false;\r\n        this.__prev = false;\r\n      }\r\n      return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return BooleanController;\r\n}(Controller);\r\n\r\nvar OptionController = function (_Controller) {\r\n  inherits(OptionController, _Controller);\r\n  function OptionController(object, property, opts) {\r\n    classCallCheck(this, OptionController);\r\n    var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\r\n    var options = opts;\r\n    var _this = _this2;\r\n    _this2.__select = document.createElement('select');\r\n    if (Common.isArray(options)) {\r\n      var map = {};\r\n      Common.each(options, function (element) {\r\n        map[element] = element;\r\n      });\r\n      options = map;\r\n    }\r\n    Common.each(options, function (value, key) {\r\n      var opt = document.createElement('option');\r\n      opt.innerHTML = key;\r\n      opt.setAttribute('value', value);\r\n      _this.__select.appendChild(opt);\r\n    });\r\n    _this2.updateDisplay();\r\n    dom.bind(_this2.__select, 'change', function () {\r\n      var desiredValue = this.options[this.selectedIndex].value;\r\n      _this.setValue(desiredValue);\r\n    });\r\n    _this2.domElement.appendChild(_this2.__select);\r\n    return _this2;\r\n  }\r\n  createClass(OptionController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (dom.isActive(this.__select)) return this;\r\n      this.__select.value = this.getValue();\r\n      return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return OptionController;\r\n}(Controller);\r\n\r\nvar StringController = function (_Controller) {\r\n  inherits(StringController, _Controller);\r\n  function StringController(object, property) {\r\n    classCallCheck(this, StringController);\r\n    var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\r\n    var _this = _this2;\r\n    function onChange() {\r\n      _this.setValue(_this.__input.value);\r\n    }\r\n    function onBlur() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'keyup', onChange);\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        this.blur();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(StringController, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (!dom.isActive(this.__input)) {\r\n        this.__input.value = this.getValue();\r\n      }\r\n      return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return StringController;\r\n}(Controller);\r\n\r\nfunction numDecimals(x) {\r\n  var _x = x.toString();\r\n  if (_x.indexOf('.') > -1) {\r\n    return _x.length - _x.indexOf('.') - 1;\r\n  }\r\n  return 0;\r\n}\r\nvar NumberController = function (_Controller) {\r\n  inherits(NumberController, _Controller);\r\n  function NumberController(object, property, params) {\r\n    classCallCheck(this, NumberController);\r\n    var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\r\n    var _params = params || {};\r\n    _this.__min = _params.min;\r\n    _this.__max = _params.max;\r\n    _this.__step = _params.step;\r\n    if (Common.isUndefined(_this.__step)) {\r\n      if (_this.initialValue === 0) {\r\n        _this.__impliedStep = 1;\r\n      } else {\r\n        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\r\n      }\r\n    } else {\r\n      _this.__impliedStep = _this.__step;\r\n    }\r\n    _this.__precision = numDecimals(_this.__impliedStep);\r\n    return _this;\r\n  }\r\n  createClass(NumberController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var _v = v;\r\n      if (this.__min !== undefined && _v < this.__min) {\r\n        _v = this.__min;\r\n      } else if (this.__max !== undefined && _v > this.__max) {\r\n        _v = this.__max;\r\n      }\r\n      if (this.__step !== undefined && _v % this.__step !== 0) {\r\n        _v = Math.round(_v / this.__step) * this.__step;\r\n      }\r\n      return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\r\n    }\r\n  }, {\r\n    key: 'min',\r\n    value: function min(minValue) {\r\n      this.__min = minValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'max',\r\n    value: function max(maxValue) {\r\n      this.__max = maxValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'step',\r\n    value: function step(stepValue) {\r\n      this.__step = stepValue;\r\n      this.__impliedStep = stepValue;\r\n      this.__precision = numDecimals(stepValue);\r\n      return this;\r\n    }\r\n  }]);\r\n  return NumberController;\r\n}(Controller);\r\n\r\nfunction roundToDecimal(value, decimals) {\r\n  var tenTo = Math.pow(10, decimals);\r\n  return Math.round(value * tenTo) / tenTo;\r\n}\r\nvar NumberControllerBox = function (_NumberController) {\r\n  inherits(NumberControllerBox, _NumberController);\r\n  function NumberControllerBox(object, property, params) {\r\n    classCallCheck(this, NumberControllerBox);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\r\n    _this2.__truncationSuspended = false;\r\n    var _this = _this2;\r\n    var prevY = void 0;\r\n    function onChange() {\r\n      var attempted = parseFloat(_this.__input.value);\r\n      if (!Common.isNaN(attempted)) {\r\n        _this.setValue(attempted);\r\n      }\r\n    }\r\n    function onFinish() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onBlur() {\r\n      onFinish();\r\n    }\r\n    function onMouseDrag(e) {\r\n      var diff = prevY - e.clientY;\r\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\r\n      prevY = e.clientY;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      onFinish();\r\n    }\r\n    function onMouseDown(e) {\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      prevY = e.clientY;\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        _this.__truncationSuspended = true;\r\n        this.blur();\r\n        _this.__truncationSuspended = false;\r\n        onFinish();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerBox, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\r\n      return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerBox;\r\n}(NumberController);\r\n\r\nfunction map(v, i1, i2, o1, o2) {\r\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\r\n}\r\nvar NumberControllerSlider = function (_NumberController) {\r\n  inherits(NumberControllerSlider, _NumberController);\r\n  function NumberControllerSlider(object, property, min, max, step) {\r\n    classCallCheck(this, NumberControllerSlider);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, { min: min, max: max, step: step }));\r\n    var _this = _this2;\r\n    _this2.__background = document.createElement('div');\r\n    _this2.__foreground = document.createElement('div');\r\n    dom.bind(_this2.__background, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__background, 'touchstart', onTouchStart);\r\n    dom.addClass(_this2.__background, 'slider');\r\n    dom.addClass(_this2.__foreground, 'slider-fg');\r\n    function onMouseDown(e) {\r\n      document.activeElement.blur();\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      onMouseDrag(e);\r\n    }\r\n    function onMouseDrag(e) {\r\n      e.preventDefault();\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n      return false;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onTouchStart(e) {\r\n      if (e.touches.length !== 1) {\r\n        return;\r\n      }\r\n      dom.bind(window, 'touchmove', onTouchMove);\r\n      dom.bind(window, 'touchend', onTouchEnd);\r\n      onTouchMove(e);\r\n    }\r\n    function onTouchMove(e) {\r\n      var clientX = e.touches[0].clientX;\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n    }\r\n    function onTouchEnd() {\r\n      dom.unbind(window, 'touchmove', onTouchMove);\r\n      dom.unbind(window, 'touchend', onTouchEnd);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.updateDisplay();\r\n    _this2.__background.appendChild(_this2.__foreground);\r\n    _this2.domElement.appendChild(_this2.__background);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerSlider, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\r\n      this.__foreground.style.width = pct * 100 + '%';\r\n      return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerSlider;\r\n}(NumberController);\r\n\r\nvar FunctionController = function (_Controller) {\r\n  inherits(FunctionController, _Controller);\r\n  function FunctionController(object, property, text) {\r\n    classCallCheck(this, FunctionController);\r\n    var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__button = document.createElement('div');\r\n    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\r\n    dom.bind(_this2.__button, 'click', function (e) {\r\n      e.preventDefault();\r\n      _this.fire();\r\n      return false;\r\n    });\r\n    dom.addClass(_this2.__button, 'button');\r\n    _this2.domElement.appendChild(_this2.__button);\r\n    return _this2;\r\n  }\r\n  createClass(FunctionController, [{\r\n    key: 'fire',\r\n    value: function fire() {\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this);\r\n      }\r\n      this.getValue().call(this.object);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n    }\r\n  }]);\r\n  return FunctionController;\r\n}(Controller);\r\n\r\nvar ColorController = function (_Controller) {\r\n    inherits(ColorController, _Controller);\r\n    function ColorController(object, property) {\r\n        classCallCheck(this, ColorController);\r\n        var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\r\n        _this2.__color = new Color(_this2.getValue());\r\n        _this2.__temp = new Color(0);\r\n        var _this = _this2;\r\n        _this2.domElement = document.createElement('div');\r\n        dom.makeSelectable(_this2.domElement, false);\r\n        _this2.__selector = document.createElement('div');\r\n        _this2.__selector.className = 'selector';\r\n        _this2.__saturation_field = document.createElement('div');\r\n        _this2.__saturation_field.className = 'saturation-field';\r\n        _this2.__field_knob = document.createElement('div');\r\n        _this2.__field_knob.className = 'field-knob';\r\n        _this2.__field_knob_border = '2px solid ';\r\n        _this2.__hue_knob = document.createElement('div');\r\n        _this2.__hue_knob.className = 'hue-knob';\r\n        _this2.__hue_field = document.createElement('div');\r\n        _this2.__hue_field.className = 'hue-field';\r\n        _this2.__input = document.createElement('input');\r\n        _this2.__input.type = 'text';\r\n        _this2.__input_textShadow = '0 1px 1px ';\r\n        dom.bind(_this2.__input, 'keydown', function (e) {\r\n            if (e.keyCode === 13) {\r\n                onBlur.call(this);\r\n            }\r\n        });\r\n        dom.bind(_this2.__input, 'blur', onBlur);\r\n        dom.bind(_this2.__selector, 'mousedown', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'mouseup', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        dom.bind(_this2.__selector, 'touchstart', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'touchend', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        var valueField = document.createElement('div');\r\n        Common.extend(_this2.__selector.style, {\r\n            width: '122px',\r\n            height: '102px',\r\n            padding: '3px',\r\n            backgroundColor: '#222',\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\r\n        });\r\n        Common.extend(_this2.__field_knob.style, {\r\n            position: 'absolute',\r\n            width: '12px',\r\n            height: '12px',\r\n            border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\r\n            borderRadius: '12px',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__hue_knob.style, {\r\n            position: 'absolute',\r\n            width: '15px',\r\n            height: '2px',\r\n            borderRight: '4px solid #fff',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__saturation_field.style, {\r\n            width: '100px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            marginRight: '3px',\r\n            display: 'inline-block',\r\n            cursor: 'pointer'\r\n        });\r\n        Common.extend(valueField.style, {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: 'none'\r\n        });\r\n        linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\r\n        Common.extend(_this2.__hue_field.style, {\r\n            width: '15px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            cursor: 'ns-resize',\r\n            position: 'absolute',\r\n            top: '3px',\r\n            right: '3px'\r\n        });\r\n        hueGradient(_this2.__hue_field);\r\n        Common.extend(_this2.__input.style, {\r\n            outline: 'none',\r\n            textAlign: 'center',\r\n            color: '#fff',\r\n            border: 0,\r\n            fontWeight: 'bold',\r\n            textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\r\n        });\r\n        dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\r\n        dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\r\n        function fieldDown(e) {\r\n            setSV(e);\r\n            dom.bind(window, 'mousemove', setSV);\r\n            dom.bind(window, 'touchmove', setSV);\r\n            dom.bind(window, 'mouseup', fieldUpSV);\r\n            dom.bind(window, 'touchend', fieldUpSV);\r\n        }\r\n        function fieldDownH(e) {\r\n            setH(e);\r\n            dom.bind(window, 'mousemove', setH);\r\n            dom.bind(window, 'touchmove', setH);\r\n            dom.bind(window, 'mouseup', fieldUpH);\r\n            dom.bind(window, 'touchend', fieldUpH);\r\n        }\r\n        function fieldUpSV() {\r\n            dom.unbind(window, 'mousemove', setSV);\r\n            dom.unbind(window, 'touchmove', setSV);\r\n            dom.unbind(window, 'mouseup', fieldUpSV);\r\n            dom.unbind(window, 'touchend', fieldUpSV);\r\n            onFinish();\r\n        }\r\n        function fieldUpH() {\r\n            dom.unbind(window, 'mousemove', setH);\r\n            dom.unbind(window, 'touchmove', setH);\r\n            dom.unbind(window, 'mouseup', fieldUpH);\r\n            dom.unbind(window, 'touchend', fieldUpH);\r\n            onFinish();\r\n        }\r\n        function onBlur() {\r\n            var i = interpret(this.value);\r\n            if (i !== false) {\r\n                _this.__color.__state = i;\r\n                _this.setValue(_this.__color.toOriginal());\r\n            } else {\r\n                this.value = _this.__color.toString();\r\n            }\r\n        }\r\n        function onFinish() {\r\n            if (_this.__onFinishChange) {\r\n                _this.__onFinishChange.call(_this, _this.__color.toOriginal());\r\n            }\r\n        }\r\n        _this2.__saturation_field.appendChild(valueField);\r\n        _this2.__selector.appendChild(_this2.__field_knob);\r\n        _this2.__selector.appendChild(_this2.__saturation_field);\r\n        _this2.__selector.appendChild(_this2.__hue_field);\r\n        _this2.__hue_field.appendChild(_this2.__hue_knob);\r\n        _this2.domElement.appendChild(_this2.__input);\r\n        _this2.domElement.appendChild(_this2.__selector);\r\n        _this2.updateDisplay();\r\n        function setSV(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__saturation_field.getBoundingClientRect();\r\n            var _ref = e.touches && e.touches[0] || e,\r\n                clientX = _ref.clientX,\r\n                clientY = _ref.clientY;\r\n            var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\r\n            var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (v > 1) {\r\n                v = 1;\r\n            } else if (v < 0) {\r\n                v = 0;\r\n            }\r\n            if (s > 1) {\r\n                s = 1;\r\n            } else if (s < 0) {\r\n                s = 0;\r\n            }\r\n            _this.__color.v = v;\r\n            _this.__color.s = s;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        function setH(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__hue_field.getBoundingClientRect();\r\n            var _ref2 = e.touches && e.touches[0] || e,\r\n                clientY = _ref2.clientY;\r\n            var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (h > 1) {\r\n                h = 1;\r\n            } else if (h < 0) {\r\n                h = 0;\r\n            }\r\n            _this.__color.h = h * 360;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        return _this2;\r\n    }\r\n    createClass(ColorController, [{\r\n        key: 'updateDisplay',\r\n        value: function updateDisplay() {\r\n            var i = interpret(this.getValue());\r\n            if (i !== false) {\r\n                var mismatch = false;\r\n                Common.each(Color.COMPONENTS, function (component) {\r\n                    if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\r\n                        mismatch = true;\r\n                        return {};\r\n                    }\r\n                }, this);\r\n                if (mismatch) {\r\n                    Common.extend(this.__color.__state, i);\r\n                }\r\n            }\r\n            Common.extend(this.__temp.__state, this.__color.__state);\r\n            this.__temp.a = 1;\r\n            var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\r\n            var _flip = 255 - flip;\r\n            Common.extend(this.__field_knob.style, {\r\n                marginLeft: 100 * this.__color.s - 7 + 'px',\r\n                marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\r\n                backgroundColor: this.__temp.toHexString(),\r\n                border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\r\n            });\r\n            this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\r\n            this.__temp.s = 1;\r\n            this.__temp.v = 1;\r\n            linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\r\n            this.__input.value = this.__color.toString();\r\n            Common.extend(this.__input.style, {\r\n                backgroundColor: this.__color.toHexString(),\r\n                color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\r\n                textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\r\n            });\r\n        }\r\n    }]);\r\n    return ColorController;\r\n}(Controller);\r\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\r\nfunction linearGradient(elem, x, a, b) {\r\n    elem.style.background = '';\r\n    Common.each(vendors, function (vendor) {\r\n        elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\r\n    });\r\n}\r\nfunction hueGradient(elem) {\r\n    elem.style.background = '';\r\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\r\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n}\r\n\r\nvar ControllerFactory = function ControllerFactory(object, property) {\r\n  var initialValue = object[property];\r\n  if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\r\n    return new OptionController(object, property, arguments[2]);\r\n  }\r\n  if (Common.isNumber(initialValue)) {\r\n    if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\r\n      if (Common.isNumber(arguments[4])) {\r\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4]);\r\n      }\r\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\r\n    }\r\n    if (Common.isNumber(arguments[4])) {\r\n      return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });\r\n    }\r\n    return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\r\n  }\r\n  if (Common.isString(initialValue)) {\r\n    return new StringController(object, property);\r\n  }\r\n  if (Common.isFunction(initialValue)) {\r\n    return new FunctionController(object, property, '');\r\n  }\r\n  if (Common.isBoolean(initialValue)) {\r\n    return new BooleanController(object, property);\r\n  }\r\n  return null;\r\n};\r\n\r\nvar CustomController = function (_Controller) {\r\n  inherits(CustomController, _Controller);\r\n  function CustomController(object, property) {\r\n    classCallCheck(this, CustomController);\r\n    var _this = possibleConstructorReturn(this, (CustomController.__proto__ || Object.getPrototypeOf(CustomController)).call(this, object, property));\r\n    _this.arguments = {\r\n      object: object, property: property, opts: Array.prototype.slice.call(arguments, 2)\r\n    };\r\n    if (object.property) _this.property = object.property(_this);\r\n    return _this;\r\n  }\r\n  createClass(CustomController, [{\r\n    key: 'controller',\r\n    set: function set$$1(newController) {\r\n      this._controller = newController;\r\n    },\r\n    get: function get$$1() {\r\n      return this._controller;\r\n    }\r\n  }]);\r\n  return CustomController;\r\n}(Controller);\r\n\r\nvar css = {\r\n  load: function load(url, indoc) {\r\n    var doc = indoc || document;\r\n    var link = doc.createElement('link');\r\n    link.type = 'text/css';\r\n    link.rel = 'stylesheet';\r\n    link.href = url;\r\n    doc.getElementsByTagName('head')[0].appendChild(link);\r\n  },\r\n  inject: function inject(cssContent, indoc) {\r\n    var doc = indoc || document;\r\n    var injected = document.createElement('style');\r\n    injected.type = 'text/css';\r\n    injected.innerHTML = cssContent;\r\n    var head = doc.getElementsByTagName('head')[0];\r\n    try {\r\n      head.appendChild(injected);\r\n    } catch (e) {\r\n    }\r\n  }\r\n};\r\n\r\nvar saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\r\n\r\nfunction requestAnimationFrame(callback) {\r\n  setTimeout(callback, 1000 / 60);\r\n}\r\nvar requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\r\n\r\nvar CenteredDiv = function () {\r\n  function CenteredDiv() {\r\n    classCallCheck(this, CenteredDiv);\r\n    this.backgroundElement = document.createElement('div');\r\n    Common.extend(this.backgroundElement.style, {\r\n      backgroundColor: 'rgba(0,0,0,0.8)',\r\n      top: 0,\r\n      left: 0,\r\n      display: 'none',\r\n      zIndex: '1000',\r\n      opacity: 0,\r\n      WebkitTransition: 'opacity 0.2s linear',\r\n      transition: 'opacity 0.2s linear'\r\n    });\r\n    dom.makeFullscreen(this.backgroundElement);\r\n    this.backgroundElement.style.position = 'fixed';\r\n    this.domElement = document.createElement('div');\r\n    Common.extend(this.domElement.style, {\r\n      position: 'fixed',\r\n      display: 'none',\r\n      zIndex: '1001',\r\n      opacity: 0,\r\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\r\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\r\n    });\r\n    document.body.appendChild(this.backgroundElement);\r\n    document.body.appendChild(this.domElement);\r\n    var _this = this;\r\n    dom.bind(this.backgroundElement, 'click', function () {\r\n      _this.hide();\r\n    });\r\n  }\r\n  createClass(CenteredDiv, [{\r\n    key: 'show',\r\n    value: function show() {\r\n      var _this = this;\r\n      this.backgroundElement.style.display = 'block';\r\n      this.domElement.style.display = 'block';\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n      this.layout();\r\n      Common.defer(function () {\r\n        _this.backgroundElement.style.opacity = 1;\r\n        _this.domElement.style.opacity = 1;\r\n        _this.domElement.style.webkitTransform = 'scale(1)';\r\n      });\r\n    }\r\n  }, {\r\n    key: 'hide',\r\n    value: function hide() {\r\n      var _this = this;\r\n      var hide = function hide() {\r\n        _this.domElement.style.display = 'none';\r\n        _this.backgroundElement.style.display = 'none';\r\n        dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\r\n        dom.unbind(_this.domElement, 'transitionend', hide);\r\n        dom.unbind(_this.domElement, 'oTransitionEnd', hide);\r\n      };\r\n      dom.bind(this.domElement, 'webkitTransitionEnd', hide);\r\n      dom.bind(this.domElement, 'transitionend', hide);\r\n      dom.bind(this.domElement, 'oTransitionEnd', hide);\r\n      this.backgroundElement.style.opacity = 0;\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n    }\r\n  }, {\r\n    key: 'layout',\r\n    value: function layout() {\r\n      this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\r\n      this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\r\n    }\r\n  }]);\r\n  return CenteredDiv;\r\n}();\r\n\r\nvar styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\r\n\r\ncss.inject(styleSheet);\r\nvar CSS_NAMESPACE = 'dg';\r\nvar HIDE_KEY_CODE = 72;\r\nvar CLOSE_BUTTON_HEIGHT = 20;\r\nvar DEFAULT_DEFAULT_PRESET_NAME = 'Default';\r\nvar SUPPORTS_LOCAL_STORAGE = function () {\r\n  try {\r\n    return !!window.localStorage;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}();\r\nvar SAVE_DIALOGUE = void 0;\r\nvar autoPlaceVirgin = true;\r\nvar autoPlaceContainer = void 0;\r\nvar hide = false;\r\nvar hideableGuis = [];\r\nvar GUI = function GUI(pars) {\r\n  var _this = this;\r\n  var params = pars || {};\r\n  this.domElement = document.createElement('div');\r\n  this.__ul = document.createElement('ul');\r\n  this.domElement.appendChild(this.__ul);\r\n  dom.addClass(this.domElement, CSS_NAMESPACE);\r\n  this.__folders = {};\r\n  this.__controllers = [];\r\n  this.__rememberedObjects = [];\r\n  this.__rememberedObjectIndecesToControllers = [];\r\n  this.__listening = [];\r\n  params = Common.defaults(params, {\r\n    closeOnTop: false,\r\n    autoPlace: true,\r\n    width: GUI.DEFAULT_WIDTH\r\n  });\r\n  params = Common.defaults(params, {\r\n    resizable: params.autoPlace,\r\n    hideable: params.autoPlace\r\n  });\r\n  if (!Common.isUndefined(params.load)) {\r\n    if (params.preset) {\r\n      params.load.preset = params.preset;\r\n    }\r\n  } else {\r\n    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\r\n  }\r\n  if (Common.isUndefined(params.parent) && params.hideable) {\r\n    hideableGuis.push(this);\r\n  }\r\n  params.resizable = Common.isUndefined(params.parent) && params.resizable;\r\n  if (params.autoPlace && Common.isUndefined(params.scrollable)) {\r\n    params.scrollable = true;\r\n  }\r\n  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\r\n  var saveToLocalStorage = void 0;\r\n  var titleRow = void 0;\r\n  Object.defineProperties(this,\r\n  {\r\n    parent: {\r\n      get: function get$$1() {\r\n        return params.parent;\r\n      }\r\n    },\r\n    scrollable: {\r\n      get: function get$$1() {\r\n        return params.scrollable;\r\n      }\r\n    },\r\n    autoPlace: {\r\n      get: function get$$1() {\r\n        return params.autoPlace;\r\n      }\r\n    },\r\n    closeOnTop: {\r\n      get: function get$$1() {\r\n        return params.closeOnTop;\r\n      }\r\n    },\r\n    preset: {\r\n      get: function get$$1() {\r\n        if (_this.parent) {\r\n          return _this.getRoot().preset;\r\n        }\r\n        return params.load.preset;\r\n      },\r\n      set: function set$$1(v) {\r\n        if (_this.parent) {\r\n          _this.getRoot().preset = v;\r\n        } else {\r\n          params.load.preset = v;\r\n        }\r\n        setPresetSelectIndex(this);\r\n        _this.revert();\r\n      }\r\n    },\r\n    width: {\r\n      get: function get$$1() {\r\n        return params.width;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.width = v;\r\n        setWidth(_this, v);\r\n      }\r\n    },\r\n    name: {\r\n      get: function get$$1() {\r\n        return params.name;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.name = v;\r\n        if (titleRow) {\r\n          titleRow.innerHTML = params.name;\r\n        }\r\n      }\r\n    },\r\n    closed: {\r\n      get: function get$$1() {\r\n        return params.closed;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.closed = v;\r\n        if (params.closed) {\r\n          dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        } else {\r\n          dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        }\r\n        this.onResize();\r\n        if (_this.__closeButton) {\r\n          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\r\n        }\r\n      }\r\n    },\r\n    load: {\r\n      get: function get$$1() {\r\n        return params.load;\r\n      }\r\n    },\r\n    useLocalStorage: {\r\n      get: function get$$1() {\r\n        return useLocalStorage;\r\n      },\r\n      set: function set$$1(bool) {\r\n        if (SUPPORTS_LOCAL_STORAGE) {\r\n          useLocalStorage = bool;\r\n          if (bool) {\r\n            dom.bind(window, 'unload', saveToLocalStorage);\r\n          } else {\r\n            dom.unbind(window, 'unload', saveToLocalStorage);\r\n          }\r\n          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\r\n        }\r\n      }\r\n    }\r\n  });\r\n  if (Common.isUndefined(params.parent)) {\r\n    this.closed = params.closed || false;\r\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\r\n    dom.makeSelectable(this.domElement, false);\r\n    if (SUPPORTS_LOCAL_STORAGE) {\r\n      if (useLocalStorage) {\r\n        _this.useLocalStorage = true;\r\n        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\r\n        if (savedGui) {\r\n          params.load = JSON.parse(savedGui);\r\n        }\r\n      }\r\n    }\r\n    this.__closeButton = document.createElement('div');\r\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\r\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\r\n    if (params.closeOnTop) {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\r\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\r\n    } else {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\r\n      this.domElement.appendChild(this.__closeButton);\r\n    }\r\n    dom.bind(this.__closeButton, 'click', function () {\r\n      _this.closed = !_this.closed;\r\n    });\r\n  } else {\r\n    if (params.closed === undefined) {\r\n      params.closed = true;\r\n    }\r\n    var titleRowName = document.createTextNode(params.name);\r\n    dom.addClass(titleRowName, 'controller-name');\r\n    titleRow = addRow(_this, titleRowName);\r\n    var onClickTitle = function onClickTitle(e) {\r\n      e.preventDefault();\r\n      _this.closed = !_this.closed;\r\n      return false;\r\n    };\r\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\r\n    dom.addClass(titleRow, 'title');\r\n    dom.bind(titleRow, 'click', onClickTitle);\r\n    if (!params.closed) {\r\n      this.closed = false;\r\n    }\r\n  }\r\n  if (params.autoPlace) {\r\n    if (Common.isUndefined(params.parent)) {\r\n      if (autoPlaceVirgin) {\r\n        autoPlaceContainer = document.createElement('div');\r\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\r\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\r\n        document.body.appendChild(autoPlaceContainer);\r\n        autoPlaceVirgin = false;\r\n      }\r\n      autoPlaceContainer.appendChild(this.domElement);\r\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\r\n    }\r\n    if (!this.parent) {\r\n      setWidth(_this, params.width);\r\n    }\r\n  }\r\n  this.__resizeHandler = function () {\r\n    _this.onResizeDebounced();\r\n  };\r\n  dom.bind(window, 'resize', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\r\n  this.onResize();\r\n  if (params.resizable) {\r\n    addResizeHandle(this);\r\n  }\r\n  saveToLocalStorage = function saveToLocalStorage() {\r\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\r\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\r\n    }\r\n  };\r\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\r\n  function resetWidth() {\r\n    var root = _this.getRoot();\r\n    root.width += 1;\r\n    Common.defer(function () {\r\n      root.width -= 1;\r\n    });\r\n  }\r\n  if (!params.parent) {\r\n    resetWidth();\r\n  }\r\n};\r\nGUI.toggleHide = function () {\r\n  hide = !hide;\r\n  Common.each(hideableGuis, function (gui) {\r\n    gui.domElement.style.display = hide ? 'none' : '';\r\n  });\r\n};\r\nGUI.CLASS_AUTO_PLACE = 'a';\r\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\r\nGUI.CLASS_MAIN = 'main';\r\nGUI.CLASS_CONTROLLER_ROW = 'cr';\r\nGUI.CLASS_TOO_TALL = 'taller-than-window';\r\nGUI.CLASS_CLOSED = 'closed';\r\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\r\nGUI.CLASS_CLOSE_TOP = 'close-top';\r\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\r\nGUI.CLASS_DRAG = 'drag';\r\nGUI.DEFAULT_WIDTH = 245;\r\nGUI.TEXT_CLOSED = 'Close Controls';\r\nGUI.TEXT_OPEN = 'Open Controls';\r\nGUI._keydownHandler = function (e) {\r\n  if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\r\n    GUI.toggleHide();\r\n  }\r\n};\r\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\r\nCommon.extend(GUI.prototype,\r\n{\r\n  add: function add(object, property) {\r\n    return _add(this, object, property, {\r\n      factoryArgs: Array.prototype.slice.call(arguments, 2)\r\n    });\r\n  },\r\n  addColor: function addColor(object, property) {\r\n    return _add(this, object, property, {\r\n      color: true\r\n    });\r\n  },\r\n  remove: function remove(controller) {\r\n    this.__ul.removeChild(controller.__li);\r\n    this.__controllers.splice(this.__controllers.indexOf(controller), 1);\r\n    var _this = this;\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  destroy: function destroy() {\r\n    if (this.parent) {\r\n      throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\r\n    }\r\n    if (this.autoPlace) {\r\n      autoPlaceContainer.removeChild(this.domElement);\r\n    }\r\n    var _this = this;\r\n    Common.each(this.__folders, function (subfolder) {\r\n      _this.removeFolder(subfolder);\r\n    });\r\n    dom.unbind(window, 'keydown', GUI._keydownHandler, false);\r\n    removeListeners(this);\r\n  },\r\n  addFolder: function addFolder(name) {\r\n    if (this.__folders[name] !== undefined) {\r\n      throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\r\n    }\r\n    var newGuiParams = { name: name, parent: this };\r\n    newGuiParams.autoPlace = this.autoPlace;\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[name]) {\r\n      newGuiParams.closed = this.load.folders[name].closed;\r\n      newGuiParams.load = this.load.folders[name];\r\n    }\r\n    var gui = new GUI(newGuiParams);\r\n    this.__folders[name] = gui;\r\n    var li = addRow(this, gui.domElement);\r\n    dom.addClass(li, 'folder');\r\n    return gui;\r\n  },\r\n  removeFolder: function removeFolder(folder) {\r\n    this.__ul.removeChild(folder.domElement.parentElement);\r\n    delete this.__folders[folder.name];\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[folder.name]) {\r\n      delete this.load.folders[folder.name];\r\n    }\r\n    removeListeners(folder);\r\n    var _this = this;\r\n    Common.each(folder.__folders, function (subfolder) {\r\n      folder.removeFolder(subfolder);\r\n    });\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  open: function open() {\r\n    this.closed = false;\r\n  },\r\n  close: function close() {\r\n    this.closed = true;\r\n  },\r\n  hide: function hide() {\r\n    this.domElement.style.display = 'none';\r\n  },\r\n  show: function show() {\r\n    this.domElement.style.display = '';\r\n  },\r\n  onResize: function onResize() {\r\n    var root = this.getRoot();\r\n    if (root.scrollable) {\r\n      var top = dom.getOffset(root.__ul).top;\r\n      var h = 0;\r\n      Common.each(root.__ul.childNodes, function (node) {\r\n        if (!(root.autoPlace && node === root.__save_row)) {\r\n          h += dom.getHeight(node);\r\n        }\r\n      });\r\n      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\r\n        dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\r\n      } else {\r\n        dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = 'auto';\r\n      }\r\n    }\r\n    if (root.__resize_handle) {\r\n      Common.defer(function () {\r\n        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\r\n      });\r\n    }\r\n    if (root.__closeButton) {\r\n      root.__closeButton.style.width = root.width + 'px';\r\n    }\r\n  },\r\n  onResizeDebounced: Common.debounce(function () {\r\n    this.onResize();\r\n  }, 50),\r\n  remember: function remember() {\r\n    if (Common.isUndefined(SAVE_DIALOGUE)) {\r\n      SAVE_DIALOGUE = new CenteredDiv();\r\n      SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\r\n    }\r\n    if (this.parent) {\r\n      throw new Error('You can only call remember on a top level GUI.');\r\n    }\r\n    var _this = this;\r\n    Common.each(Array.prototype.slice.call(arguments), function (object) {\r\n      if (_this.__rememberedObjects.length === 0) {\r\n        addSaveMenu(_this);\r\n      }\r\n      if (_this.__rememberedObjects.indexOf(object) === -1) {\r\n        _this.__rememberedObjects.push(object);\r\n      }\r\n    });\r\n    if (this.autoPlace) {\r\n      setWidth(this, this.width);\r\n    }\r\n  },\r\n  getRoot: function getRoot() {\r\n    var gui = this;\r\n    while (gui.parent) {\r\n      gui = gui.parent;\r\n    }\r\n    return gui;\r\n  },\r\n  getSaveObject: function getSaveObject() {\r\n    var toReturn = this.load;\r\n    toReturn.closed = this.closed;\r\n    if (this.__rememberedObjects.length > 0) {\r\n      toReturn.preset = this.preset;\r\n      if (!toReturn.remembered) {\r\n        toReturn.remembered = {};\r\n      }\r\n      toReturn.remembered[this.preset] = getCurrentPreset(this);\r\n    }\r\n    toReturn.folders = {};\r\n    Common.each(this.__folders, function (element, key) {\r\n      toReturn.folders[key] = element.getSaveObject();\r\n    });\r\n    return toReturn;\r\n  },\r\n  save: function save() {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n    }\r\n    this.load.remembered[this.preset] = getCurrentPreset(this);\r\n    markPresetModified(this, false);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  saveAs: function saveAs(presetName) {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\r\n    }\r\n    this.load.remembered[presetName] = getCurrentPreset(this);\r\n    this.preset = presetName;\r\n    addPresetOption(this, presetName, true);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  revert: function revert(gui) {\r\n    Common.each(this.__controllers, function (controller) {\r\n      if (!this.getRoot().load.remembered) {\r\n        controller.setValue(controller.initialValue);\r\n      } else {\r\n        recallSavedValue(gui || this.getRoot(), controller);\r\n      }\r\n      if (controller.__onFinishChange) {\r\n        controller.__onFinishChange.call(controller, controller.getValue());\r\n      }\r\n    }, this);\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.revert(folder);\r\n    });\r\n    if (!gui) {\r\n      markPresetModified(this.getRoot(), false);\r\n    }\r\n  },\r\n  listen: function listen(controller) {\r\n    var init = this.__listening.length === 0;\r\n    this.__listening.push(controller);\r\n    if (init) {\r\n      updateDisplays(this.__listening);\r\n    }\r\n  },\r\n  updateDisplay: function updateDisplay() {\r\n    Common.each(this.__controllers, function (controller) {\r\n      controller.updateDisplay();\r\n    });\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.updateDisplay();\r\n    });\r\n  }\r\n});\r\nfunction addRow(gui, newDom, liBefore) {\r\n  var li = document.createElement('li');\r\n  if (newDom) {\r\n    li.appendChild(newDom);\r\n  }\r\n  if (liBefore) {\r\n    gui.__ul.insertBefore(li, liBefore);\r\n  } else {\r\n    gui.__ul.appendChild(li);\r\n  }\r\n  gui.onResize();\r\n  return li;\r\n}\r\nfunction removeListeners(gui) {\r\n  dom.unbind(window, 'resize', gui.__resizeHandler);\r\n  if (gui.saveToLocalStorageIfPossible) {\r\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\r\n  }\r\n}\r\nfunction markPresetModified(gui, modified) {\r\n  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\r\n  if (modified) {\r\n    opt.innerHTML = opt.value + '*';\r\n  } else {\r\n    opt.innerHTML = opt.value;\r\n  }\r\n}\r\nfunction augmentController(gui, li, controller) {\r\n  controller.__li = li;\r\n  controller.__gui = gui;\r\n  Common.extend(controller,                                   {\r\n    options: function options(_options) {\r\n      if (arguments.length > 1) {\r\n        var nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: nextSibling,\r\n          factoryArgs: [Common.toArray(arguments)]\r\n        });\r\n      }\r\n      if (Common.isArray(_options) || Common.isObject(_options)) {\r\n        var _nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: _nextSibling,\r\n          factoryArgs: [_options]\r\n        });\r\n      }\r\n    },\r\n    name: function name(_name) {\r\n      controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\r\n      return controller;\r\n    },\r\n    listen: function listen() {\r\n      controller.__gui.listen(controller);\r\n      return controller;\r\n    },\r\n    remove: function remove() {\r\n      controller.__gui.remove(controller);\r\n      return controller;\r\n    }\r\n  });\r\n  if (controller instanceof NumberControllerSlider) {\r\n    var box = new NumberControllerBox(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });\r\n    Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function (method) {\r\n      var pc = controller[method];\r\n      var pb = box[method];\r\n      controller[method] = box[method] = function () {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        pb.apply(box, args);\r\n        return pc.apply(controller, args);\r\n      };\r\n    });\r\n    dom.addClass(li, 'has-slider');\r\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\r\n  } else if (controller instanceof NumberControllerBox) {\r\n    var r = function r(returned) {\r\n      if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\r\n        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\r\n        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\r\n        controller.remove();\r\n        var newController = _add(gui, controller.object, controller.property, {\r\n          before: controller.__li.nextElementSibling,\r\n          factoryArgs: [controller.__min, controller.__max, controller.__step]\r\n        });\r\n        newController.name(oldName);\r\n        if (wasListening) newController.listen();\r\n        return newController;\r\n      }\r\n      return returned;\r\n    };\r\n    controller.min = Common.compose(r, controller.min);\r\n    controller.max = Common.compose(r, controller.max);\r\n  } else if (controller instanceof BooleanController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__checkbox, 'click');\r\n    });\r\n    dom.bind(controller.__checkbox, 'click', function (e) {\r\n      e.stopPropagation();\r\n    });\r\n  } else if (controller instanceof FunctionController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__button, 'click');\r\n    });\r\n    dom.bind(li, 'mouseover', function () {\r\n      dom.addClass(controller.__button, 'hover');\r\n    });\r\n    dom.bind(li, 'mouseout', function () {\r\n      dom.removeClass(controller.__button, 'hover');\r\n    });\r\n  } else if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n    controller.updateDisplay = Common.compose(function (val) {\r\n      li.style.borderLeftColor = controller.__color.toString();\r\n      return val;\r\n    }, controller.updateDisplay);\r\n    controller.updateDisplay();\r\n  }\r\n  controller.setValue = Common.compose(function (val) {\r\n    if (gui.getRoot().__preset_select && controller.isModified()) {\r\n      markPresetModified(gui.getRoot(), true);\r\n    }\r\n    return val;\r\n  }, controller.setValue);\r\n}\r\nfunction recallSavedValue(gui, controller) {\r\n  var root = gui.getRoot();\r\n  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\r\n  if (matchedIndex !== -1) {\r\n    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\r\n    if (controllerMap === undefined) {\r\n      controllerMap = {};\r\n      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\r\n    }\r\n    controllerMap[controller.property] = controller;\r\n    if (root.load && root.load.remembered) {\r\n      var presetMap = root.load.remembered;\r\n      var preset = void 0;\r\n      if (presetMap[gui.preset]) {\r\n        preset = presetMap[gui.preset];\r\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\r\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\r\n      } else {\r\n        return;\r\n      }\r\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\r\n        var value = preset[matchedIndex][controller.property];\r\n        controller.initialValue = value;\r\n        controller.setValue(value);\r\n      }\r\n    }\r\n  }\r\n}\r\nfunction _add(gui, object, property, params) {\r\n  var customObject;\r\n  if (object.arguments) {\r\n    customObject = object;\r\n    object = customObject.arguments.object;\r\n    property = customObject.arguments.property;\r\n    params = {\r\n      factoryArgs: customObject.arguments.opts\r\n    };\r\n  }\r\n  if (customObject === undefined && object[property] === undefined) {\r\n    throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\r\n  }\r\n  var controller = void 0;\r\n  if (params.color) {\r\n    controller = new ColorController(object, property);\r\n  } else if (customObject !== undefined && typeof customObject.property === \"string\") {\r\n    controller = customObject;\r\n  } else {\r\n    var factoryArgs = [object, property].concat(params.factoryArgs);\r\n    controller = ControllerFactory.apply(gui, factoryArgs);\r\n  }\r\n  if (controller === null) controller = customObject;else if (customObject !== undefined) customObject.controller = controller;\r\n  if (params.before instanceof Controller) {\r\n    params.before = params.before.__li;\r\n  }\r\n  recallSavedValue(gui, controller);\r\n  dom.addClass(controller.domElement, 'c');\r\n  var name = document.createElement('span');\r\n  dom.addClass(name, 'property-name');\r\n  if (customObject !== undefined && _typeof(customObject.property) === \"object\") {\r\n    for (var propertyName in customObject.property) {\r\n      name.appendChild(customObject.property[propertyName]);\r\n    }\r\n  } else name.innerHTML = controller.property;\r\n  var container = document.createElement('div');\r\n  container.appendChild(name);\r\n  container.appendChild(controller.domElement);\r\n  var li = addRow(gui, container, params.before);\r\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\r\n  if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n  } else {\r\n    dom.addClass(li, _typeof(controller.getValue()));\r\n  }\r\n  augmentController(gui, li, controller);\r\n  gui.__controllers.push(controller);\r\n  return controller;\r\n}\r\nfunction getLocalStorageHash(gui, key) {\r\n  return document.location.href + '.' + key;\r\n}\r\nfunction addPresetOption(gui, name, setSelected) {\r\n  var opt = document.createElement('option');\r\n  opt.innerHTML = name;\r\n  opt.value = name;\r\n  gui.__preset_select.appendChild(opt);\r\n  if (setSelected) {\r\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\r\n  }\r\n}\r\nfunction showHideExplain(gui, explain) {\r\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\r\n}\r\nfunction addSaveMenu(gui) {\r\n  var div = gui.__save_row = document.createElement('li');\r\n  dom.addClass(gui.domElement, 'has-save');\r\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\r\n  dom.addClass(div, 'save-row');\r\n  var gears = document.createElement('span');\r\n  gears.innerHTML = '&nbsp;';\r\n  dom.addClass(gears, 'button gears');\r\n  var button = document.createElement('span');\r\n  button.innerHTML = 'Save';\r\n  dom.addClass(button, 'button');\r\n  dom.addClass(button, 'save');\r\n  var button2 = document.createElement('span');\r\n  button2.innerHTML = 'New';\r\n  dom.addClass(button2, 'button');\r\n  dom.addClass(button2, 'save-as');\r\n  var button3 = document.createElement('span');\r\n  button3.innerHTML = 'Revert';\r\n  dom.addClass(button3, 'button');\r\n  dom.addClass(button3, 'revert');\r\n  var select = gui.__preset_select = document.createElement('select');\r\n  if (gui.load && gui.load.remembered) {\r\n    Common.each(gui.load.remembered, function (value, key) {\r\n      addPresetOption(gui, key, key === gui.preset);\r\n    });\r\n  } else {\r\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\r\n  }\r\n  dom.bind(select, 'change', function () {\r\n    for (var index = 0; index < gui.__preset_select.length; index++) {\r\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\r\n    }\r\n    gui.preset = this.value;\r\n  });\r\n  div.appendChild(select);\r\n  div.appendChild(gears);\r\n  div.appendChild(button);\r\n  div.appendChild(button2);\r\n  div.appendChild(button3);\r\n  if (SUPPORTS_LOCAL_STORAGE) {\r\n    var explain = document.getElementById('dg-local-explain');\r\n    var localStorageCheckBox = document.getElementById('dg-local-storage');\r\n    var saveLocally = document.getElementById('dg-save-locally');\r\n    saveLocally.style.display = 'block';\r\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\r\n      localStorageCheckBox.setAttribute('checked', 'checked');\r\n    }\r\n    showHideExplain(gui, explain);\r\n    dom.bind(localStorageCheckBox, 'change', function () {\r\n      gui.useLocalStorage = !gui.useLocalStorage;\r\n      showHideExplain(gui, explain);\r\n    });\r\n  }\r\n  var newConstructorTextArea = document.getElementById('dg-new-constructor');\r\n  dom.bind(newConstructorTextArea, 'keydown', function (e) {\r\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\r\n      SAVE_DIALOGUE.hide();\r\n    }\r\n  });\r\n  dom.bind(gears, 'click', function () {\r\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\r\n    SAVE_DIALOGUE.show();\r\n    newConstructorTextArea.focus();\r\n    newConstructorTextArea.select();\r\n  });\r\n  dom.bind(button, 'click', function () {\r\n    gui.save();\r\n  });\r\n  dom.bind(button2, 'click', function () {\r\n    var presetName = prompt('Enter a new preset name.');\r\n    if (presetName) {\r\n      gui.saveAs(presetName);\r\n    }\r\n  });\r\n  dom.bind(button3, 'click', function () {\r\n    gui.revert();\r\n  });\r\n}\r\nfunction addResizeHandle(gui) {\r\n  var pmouseX = void 0;\r\n  gui.__resize_handle = document.createElement('div');\r\n  Common.extend(gui.__resize_handle.style, {\r\n    width: '6px',\r\n    marginLeft: '-3px',\r\n    height: '200px',\r\n    cursor: 'ew-resize',\r\n    position: 'absolute'\r\n  });\r\n  function drag(e) {\r\n    e.preventDefault();\r\n    gui.width += pmouseX - e.clientX;\r\n    gui.onResize();\r\n    pmouseX = e.clientX;\r\n    return false;\r\n  }\r\n  function dragStop() {\r\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.unbind(window, 'mousemove', drag);\r\n    dom.unbind(window, 'mouseup', dragStop);\r\n  }\r\n  function dragStart(e) {\r\n    e.preventDefault();\r\n    pmouseX = e.clientX;\r\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.bind(window, 'mousemove', drag);\r\n    dom.bind(window, 'mouseup', dragStop);\r\n    return false;\r\n  }\r\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\r\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\r\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\r\n}\r\nfunction setWidth(gui, w) {\r\n  gui.domElement.style.width = w + 'px';\r\n  if (gui.__save_row && gui.autoPlace) {\r\n    gui.__save_row.style.width = w + 'px';\r\n  }\r\n  if (gui.__closeButton) {\r\n    gui.__closeButton.style.width = w + 'px';\r\n  }\r\n}\r\nfunction getCurrentPreset(gui, useInitialValues) {\r\n  var toReturn = {};\r\n  Common.each(gui.__rememberedObjects, function (val, index) {\r\n    var savedValues = {};\r\n    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\r\n    Common.each(controllerMap, function (controller, property) {\r\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\r\n    });\r\n    toReturn[index] = savedValues;\r\n  });\r\n  return toReturn;\r\n}\r\nfunction setPresetSelectIndex(gui) {\r\n  for (var index = 0; index < gui.__preset_select.length; index++) {\r\n    if (gui.__preset_select[index].value === gui.preset) {\r\n      gui.__preset_select.selectedIndex = index;\r\n    }\r\n  }\r\n}\r\nfunction updateDisplays(controllerArray) {\r\n  if (controllerArray.length !== 0) {\r\n    requestAnimationFrame$1.call(window, function () {\r\n      updateDisplays(controllerArray);\r\n    });\r\n  }\r\n  Common.each(controllerArray, function (c) {\r\n    c.updateDisplay();\r\n  });\r\n}\r\n\r\nvar color = {\r\n  Color: Color,\r\n  math: ColorMath,\r\n  interpret: interpret\r\n};\r\nvar controllers = {\r\n  Controller: Controller,\r\n  BooleanController: BooleanController,\r\n  OptionController: OptionController,\r\n  StringController: StringController,\r\n  NumberController: NumberController,\r\n  NumberControllerBox: NumberControllerBox,\r\n  NumberControllerSlider: NumberControllerSlider,\r\n  FunctionController: FunctionController,\r\n  ColorController: ColorController,\r\n  CustomController: CustomController\r\n};\r\nvar dom$1 = { dom: dom };\r\nvar gui = { GUI: GUI };\r\nvar GUI$1 = GUI;\r\nvar index = {\r\n  color: color,\r\n  controllers: controllers,\r\n  dom: dom$1,\r\n  gui: gui,\r\n  GUI: GUI$1\r\n};\r\n\r\nexport { color, controllers, dom$1 as dom, gui, GUI$1 as GUI };\r\nexport default index;\r\n//# sourceMappingURL=dat.gui.module.js.map\r\n","﻿/**\r\n * custom controller, allow to user to change a value step by step.\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nvar UpDownController = {\r\n\r\n\t/**\r\n\t * adds new button into controller\r\n\t * @param {string} innerHTML button name\r\n\t * @param {object} [options] the following options are available\r\n\t * @param {String} [options.title] title of the button\r\n\t * @param {Event} [options.onclick] onclick event\r\n\t * @param {Event} [options.onWheel] onWheel event\r\n\t */\r\n\taddButton: function ( innerHTML, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\tvar button = document.createElement( 'span' );\r\n\t\tbutton.innerHTML = innerHTML;\r\n\t\tif ( options.title !== undefined )\r\n\t\t\tbutton.title = options.title;\r\n\t\tif ( options.onclick !== undefined ) {\r\n\r\n\t\t\tbutton.style.cursor = 'pointer';\r\n\t\t\tbutton.onclick = options.onclick;\r\n\r\n\t\t}\r\n\t\tif ( options.onwheel !== undefined ) {\r\n\r\n\t\t\tbutton.style.cursor = 'n-resize';\r\n\r\n\t\t\t//https://learn.javascript.ru/mousewheel\r\n\t\t\tif ( button.addEventListener ) {\r\n\t\t\t\tif ( 'onwheel' in document ) {\r\n\t\t\t\t\t// IE9+, FF17+, Ch31+\r\n\t\t\t\t\tbutton.addEventListener( \"wheel\", onWheel );\r\n\t\t\t\t} else if ( 'onmousewheel' in document ) {\r\n\t\t\t\t\t// устаревший вариант события\r\n\t\t\t\t\tbutton.addEventListener( \"mousewheel\", onWheel );\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Firefox < 17\r\n\t\t\t\t\tbutton.addEventListener( \"MozMousePixelScroll\", onWheel );\r\n\t\t\t\t}\r\n\t\t\t} else { // IE8-\r\n\t\t\t\tbutton.attachEvent( \"onmousewheel\", onWheel );\r\n\t\t\t}\r\n\r\n\t\t\tfunction onWheel( e ) {\r\n\t\t\t\te = e || window.event;\r\n\r\n\t\t\t\t// wheelDelta не дает возможность узнать количество пикселей\r\n\t\t\t\tvar delta = e.deltaY || e.detail || e.wheelDelta;\r\n\t\t\t\toptions.onwheel( delta );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tbutton.style.margin = '0px 2px';\r\n\t\treturn button;\r\n\r\n\t},\r\n\r\n}\r\n\r\nexport default UpDownController;\r\n","/**\r\n * three class for [THREE]{@link https://github.com/anhr/three.js} and [dat.GUI(...)]{@link https://github.com/anhr/dat.gui} variables.\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n/*если импортировать THREE, то при \"npm run build\" получу ошибку\r\n * (babel plugin) ReferenceError: Unknown plugin \"external-helpers\" specified in \"base\" at 1, attempted to resolve relative to \r\n//import * as THREE from 'https://threejs.org/build/three.module.js';\r\n//import * as THREE from '../../../../../three.js/dev/build/three.module.min.js';\r\n//import * as THREE from '../../three.js/dev/build/three.module.js';\r\n//import * as THREE from '../../three.js/dev/src/Three.js';\r\n//import { THREE } from 'https://raw.githack.com/anhr/commonNodeJS/master/three.js';\r\n//import * as THREE from 'https://raw.githack.com/anhr/three.js/dev/build/three.module.js';\r\n//import * as THREE from 'https://raw.githack.com/anhr/three.js/dev/build/three.module.min.js';\r\n*/\r\n\r\nvar _THREE, _dat;\r\n\r\nclass Three {\r\n\r\n\t/**\r\n\t * class for [THREE]{@link https://github.com/anhr/three.js} and [dat]{@link https://github.com/dataarts/dat.gui} instances.\r\n\t * */\r\n\tconstructor() {}\r\n\t/**\r\n\t * set [THREE]{@link https://github.com/anhr/three.js}\r\n\t */\r\n\tset THREE( THREE ) {\r\n\r\n\t\tif ( _THREE ) {\r\n\r\n\t\t\tif ( !Object.is( THREE, _THREE ) )\r\n\t\t\t\tconsole.error( 'three: duplicate THREE. Please use one instance of the THREE library.' )\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\t_THREE = THREE;\r\n\r\n\t}\r\n\t/**\r\n\t * get [THREE]{@link https://github.com/anhr/three.js}\r\n\t */\r\n\tget THREE() {\r\n\r\n\t\tif ( _THREE === undefined )\r\n\t\t\tconsole.error( 'three: invalid _THREE = ' + _THREE + '. Call three.THREE = THREE first.' );\r\n\t\treturn _THREE;\r\n\r\n\t}\r\n\t/**\r\n\t * set [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t */\r\n\tset dat( dat ) {\r\n\r\n\t\tif ( _dat ) {\r\n\r\n\t\t\tif ( !Object.is( dat, _dat ) )\r\n\t\t\t\tconsole.error( 'three: duplicate dat. Please use one instance of the dat library.' )\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\t_dat = dat;\r\n\r\n\t}\r\n\t/**\r\n\t * get [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t */\r\n\tget dat() {\r\n\r\n/*Неверно срабатывает когда dat не импортирован\r\n\t\tif ( _dat === undefined && !boSetDat )\r\n\t\t\tconsole.error( 'three: invalid _dat = ' + _dat + '. Call three.dat = dat first.' );\r\n*/\t\t\t\r\n\t\treturn _dat;\r\n\r\n\t}\r\n\r\n}\r\n\r\nvar three;\r\nwindow.__myThree__ = window.__myThree__ || {};\r\nif ( window.__myThree__.three ) {\r\n\r\n\t//сюда попадает если использовать './commonNodeJS/master/player/build/player.module.js'\r\n//\tconsole.error( 'three: duplicate three. Please use one instance of the three class.' );\r\n\tthree = window.__myThree__.three;\r\n\r\n} else {\r\n\r\n\tthree = new Three();\r\n\tthree.isThree = function(){ return _THREE; }\r\n\twindow.__myThree__.three = three;\r\n\r\n}\r\n\r\nexport default three;","/**\r\n * @module ScaleController\r\n * @description is dat.GUI graphical user interface controller for control of the scale of threejs 3D object\r\n * \r\n * @see {@link https://threejs.org/} about threejs\r\n * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import { controllers } from '../../dat.gui/CustomController/build/dat.gui.module.js';\r\nimport { controllers } from './dat/dat.gui.module.js';\r\nimport UpDownController from './UpDownController.js';\r\n\r\n//import { dat } from './dat/dat.module.js';\r\nimport three from './three.js'\r\n\r\nclass ScaleController extends controllers.CustomController {\r\n\r\n\t/**\r\n\t* @callback onclick\r\n\t* @param {ScaleController} customController this controller\r\n\t* @param {Function} action action( value, zoom ) function for multiply or divide value to zoom\r\n\t*/\r\n\r\n\t/**\r\n\t * @description dat.GUI graphical user interface controller for control of the scale of threejs 3D object\r\n\t * @param {onclick} onclick Called whenever user has clicked this controller.\r\n\t * @param {object} [options] the following options are available:\r\n\t * @param {object} [options.settings] settings.\r\n\t * @param {number} [options.settings.zoomMultiplier] control value. Default is 1.1\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n\t * @example \r\n//Add new ScaleController to the dat.GUI folder\r\nfolder.add( new ScaleController( function ( customController, action ) {\r\n\r\n\tvar zoom = customController.controller.getValue();\r\n\r\n\t//Scale a THREE.Mesh object\r\n\tmesh.scale.x = action( mesh.scale.x, zoom );\r\n\tmesh.scale.y = action( mesh.scale.y, zoom );\r\n\tmesh.scale.z = action( mesh.scale.z, zoom );\r\n\tmesh.needsUpdate = true;\r\n\r\n},\r\n\t{\r\n\r\n\t\tsettings: { zoomMultiplier: 1.1, },\r\n\t\tgetLanguageCode: getLanguageCode,\r\n\r\n\t} ) );\r\n\t */\r\n\tconstructor( onclick, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\toptions.settings = options.settings || {};\r\n\t\toptions.settings.zoomMultiplier = options.settings.zoomMultiplier || 1.1;\r\n\r\n\t\tsuper( {\r\n\r\n\t\t\tmultiplier: options.settings.zoomMultiplier,//1.1\r\n\t\t\tproperty: function ( customController ) {\r\n\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tvar lang = {\r\n\r\n\t\t\t\t\t//Zoom\r\n\t\t\t\t\tzoom: 'Zoom',\r\n\t\t\t\t\tin: 'in',\r\n\t\t\t\t\tout: 'out',\r\n\t\t\t\t\twheelZoom: 'Scroll the mouse wheel to zoom',\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t\t: options.getLanguageCode();\r\n\t\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t//Zoom\r\n\t\t\t\t\t\tlang.zoom = 'Изменить';\r\n\t\t\t\t\t\tlang.in = 'увеличить';\r\n\t\t\t\t\t\tlang.out = 'уменьшить';\r\n\t\t\t\t\t\tlang.wheelZoom = 'Прокрутите колесико мыши для изменения масштаба';\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault://Custom language\r\n\t\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar buttons = {},\r\n\t\t\t\t\taddButton = UpDownController.addButton;\r\n\t\t\t\tbuttons.zoomLabel = addButton( lang.zoom, {\r\n\r\n\t\t\t\t\ttitle: lang.wheelZoom,//Scroll the mouse wheel to zoom\r\n\t\t\t\t\tonwheel: function ( delta ) {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tif ( delta > 0 )\r\n\t\t\t\t\t\t\t\tvalue *= zoom;\r\n\t\t\t\t\t\t\telse value /= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.in = addButton( '↑', {\r\n\r\n\t\t\t\t\ttitle: lang.in,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tvalue *= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.out = addButton( '↓', {\r\n\r\n\t\t\t\t\ttitle: lang.out,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tvalue /= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn buttons;\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'multiplier', 1.1, 10, 0.1 );\r\n\t\tif ( this.property === undefined )\r\n\t\t\tconsole.error( 'init() returns ' + this.property );\r\n\r\n\t}\r\n\r\n}\r\nexport default ScaleController;\r\n\r\n/**\r\n * dat.GUI graphical user interface controllers for manipulate or multiplication of the object's property\r\n * @param {GUI} folder folder for new controllers\r\n * @param {Object} object The object to be manipulated\r\n * @param {String} property The name of the property to be manipulated\r\n * @param {function( value )} onChange Callback function that take the new  property of the object\r\n * @param {Object} [options] the following options are available\r\n * @param {object} [options.settings] settings.\r\n * @param {number} [options.settings.zoomMultiplier] control value. Default is 1.1\r\n * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n * @param {String} [options.text] object's property name. Default is property name.\r\n * @param {String} [options.textTitle] object's property title. Default is not title,\r\n */\r\nfunction ScaleControllers( folder, object, property, onChange, options ) {\r\n\r\n\toptions = options || {};\r\n\tconst dat = three.dat;\r\n\tvar scaleController = folder.add( new ScaleController( function ( customController, action ) {\r\n\r\n\t\tvar value = action( controller.getValue(), scaleController.getValue() );\r\n\t\tcontroller.setValue( value );\r\n\t\tonChange( value );\r\n\r\n\t},\r\n\t\t{\r\n\r\n\t\t\tgetLanguageCode: options.getLanguageCode,\r\n\t\t\tsettings: options.settings,\r\n\r\n\t\t} ) ).onChange( function ( value ) { scaleController.zoomMultiplier = value; } );\r\n\tvar controller = dat.controllerZeroStep( folder, object, property, function ( value ) { onChange( value ); } );\r\n\tif ( options.text )\r\n\t\tdat.controllerNameAndTitle( controller, options.text, options.textTitle );\r\n\r\n}\r\nexport { ScaleControllers };\r\n","/**\r\n * PositionController is dat.GUI graphical user interface controller for control of the position of threejs 3D object\r\n * \r\n * @see {@link https://threejs.org/} about threejs\r\n * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import { controllers } from '../../dat.gui/CustomController/build/dat.gui.module.js';\r\nimport { controllers } from './dat/dat.gui.module.js';\r\nimport UpDownController from './UpDownController.js';\r\n\r\nclass PositionController extends controllers.CustomController {\r\n\r\n\t/**\r\n\t * dat.GUI graphical user interface for control of the position of threejs 3D object.\r\n\t * Base class <a href=\"../../dat.gui/CustomController/src/dat/controllers/CustomController.js\" target=\"_blank\">CustomController</a>\r\n\t * @extends controllers.CustomController.\r\n\t * @param {Event} onclickController\r\n\t * @param {object} [options={}] the following options are available:\r\n\t * @param {number} [options.settings={}] time settings.\r\n\t * @param {number} [options.settings.offset=0.1] offset.\r\n\t * @param {number} [options.min=0.1] Minimal offset.\r\n\t * @param {number} [options.max=10] Maximal offset.\r\n\t * @param {number} [options.step=0.1] step of offset.\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n\t */\r\n\tconstructor( onclickController, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\toptions.settings = options.settings || {}; \r\n\t\tvar settings = options.settings; \r\n\r\n\t\toptions.min = options.min || 0.1;\r\n\t\toptions.max = options.max || 10;\r\n//\t\toptions.offset = options.offset || 0.1;\r\n\t\tsettings.offset = settings.offset || 0.1;\r\n\t\toptions.step = options.step || 0.1;\r\n\r\n\t\tsuper( {\r\n\r\n\t\t\toffset: settings.offset,\r\n\t\t\tproperty: function ( customController ) {\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tvar lang = {\r\n\r\n\t\t\t\t\t//Position\r\n\t\t\t\t\toffset: 'Offset',\r\n\t\t\t\t\tadd: 'add',\r\n\t\t\t\t\tsubtract: 'subtract',\r\n\t\t\t\t\twheelPosition: 'Scroll the mouse wheel to change the position',\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t\t: options.getLanguageCode();\r\n\t\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t//Position\r\n\t\t\t\t\t\tlang.offset = 'Сдвиг';\r\n\t\t\t\t\t\tlang.add = 'добавить';\r\n\t\t\t\t\t\tlang.subtract = 'вычесть';\r\n\t\t\t\t\t\tlang.wheelPosition = 'Прокрутите колесико мыши для изменения позиции';\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault://Custom language\r\n\t\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar buttons = {}, addButton = UpDownController.addButton;\r\n\t\t\t\tbuttons.Label = addButton( lang.offset, {\r\n\r\n\t\t\t\t\ttitle: lang.wheelPosition,\r\n\t\t\t\t\tonwheel: function ( delta ) {\r\n\r\n\t\t\t\t\t\tvar shift = customController.controller.getValue();\r\n\t\t\t\t\t\tonclickController( delta > 0 ? shift : - shift );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.in = addButton( '↑', {\r\n\r\n\t\t\t\t\ttitle: lang.add,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclickController( customController.controller.getValue() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.out = addButton( '↓', {\r\n\r\n\t\t\t\t\ttitle: lang.subtract,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclickController( - customController.controller.getValue() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn buttons;\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'offset', options.min, options.max, options.step );\r\n\t\tif ( this.property === undefined )\r\n\t\t\tconsole.error( 'init() returns ' + this.property );\r\n\r\n\t}\r\n\r\n}\r\nexport default PositionController;","/**\r\n * dat-gui JavaScript Controller Library\r\n * http://code.google.com/p/dat-gui\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nfunction ___$insertStyle(css) {\r\n  if (!css) {\r\n    return;\r\n  }\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  var style = document.createElement('style');\r\n\r\n  style.setAttribute('type', 'text/css');\r\n  style.innerHTML = css;\r\n  document.head.appendChild(style);\r\n\r\n  return css;\r\n}\r\n\r\nfunction colorToString (color, forceCSSHex) {\r\n  var colorFormat = color.__state.conversionName.toString();\r\n  var r = Math.round(color.r);\r\n  var g = Math.round(color.g);\r\n  var b = Math.round(color.b);\r\n  var a = color.a;\r\n  var h = Math.round(color.h);\r\n  var s = color.s.toFixed(1);\r\n  var v = color.v.toFixed(1);\r\n  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\r\n    var str = color.hex.toString(16);\r\n    while (str.length < 6) {\r\n      str = '0' + str;\r\n    }\r\n    return '#' + str;\r\n  } else if (colorFormat === 'CSS_RGB') {\r\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n  } else if (colorFormat === 'CSS_RGBA') {\r\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\r\n  } else if (colorFormat === 'HEX') {\r\n    return '0x' + color.hex.toString(16);\r\n  } else if (colorFormat === 'RGB_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ']';\r\n  } else if (colorFormat === 'RGBA_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\r\n  } else if (colorFormat === 'RGB_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\r\n  } else if (colorFormat === 'RGBA_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\r\n  } else if (colorFormat === 'HSV_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\r\n  } else if (colorFormat === 'HSVA_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\r\n  }\r\n  return 'unknown format';\r\n}\r\n\r\nvar ARR_EACH = Array.prototype.forEach;\r\nvar ARR_SLICE = Array.prototype.slice;\r\nvar Common = {\r\n  BREAK: {},\r\n  extend: function extend(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (!this.isUndefined(obj[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  defaults: function defaults(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (this.isUndefined(target[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  compose: function compose() {\r\n    var toCall = ARR_SLICE.call(arguments);\r\n    return function () {\r\n      var args = ARR_SLICE.call(arguments);\r\n      for (var i = toCall.length - 1; i >= 0; i--) {\r\n        args = [toCall[i].apply(this, args)];\r\n      }\r\n      return args[0];\r\n    };\r\n  },\r\n  each: function each(obj, itr, scope) {\r\n    if (!obj) {\r\n      return;\r\n    }\r\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\r\n      obj.forEach(itr, scope);\r\n    } else if (obj.length === obj.length + 0) {\r\n      var key = void 0;\r\n      var l = void 0;\r\n      for (key = 0, l = obj.length; key < l; key++) {\r\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    } else {\r\n      for (var _key in obj) {\r\n        if (itr.call(scope, obj[_key], _key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  defer: function defer(fnc) {\r\n    setTimeout(fnc, 0);\r\n  },\r\n  debounce: function debounce(func, threshold, callImmediately) {\r\n    var timeout = void 0;\r\n    return function () {\r\n      var obj = this;\r\n      var args = arguments;\r\n      function delayed() {\r\n        timeout = null;\r\n        if (!callImmediately) func.apply(obj, args);\r\n      }\r\n      var callNow = callImmediately || !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(delayed, threshold);\r\n      if (callNow) {\r\n        func.apply(obj, args);\r\n      }\r\n    };\r\n  },\r\n  toArray: function toArray(obj) {\r\n    if (obj.toArray) return obj.toArray();\r\n    return ARR_SLICE.call(obj);\r\n  },\r\n  isUndefined: function isUndefined(obj) {\r\n    return obj === undefined;\r\n  },\r\n  isNull: function isNull(obj) {\r\n    return obj === null;\r\n  },\r\n  isNaN: function (_isNaN) {\r\n    function isNaN(_x) {\r\n      return _isNaN.apply(this, arguments);\r\n    }\r\n    isNaN.toString = function () {\r\n      return _isNaN.toString();\r\n    };\r\n    return isNaN;\r\n  }(function (obj) {\r\n    return isNaN(obj);\r\n  }),\r\n  isArray: Array.isArray || function (obj) {\r\n    return obj.constructor === Array;\r\n  },\r\n  isObject: function isObject(obj) {\r\n    return obj === Object(obj);\r\n  },\r\n  isNumber: function isNumber(obj) {\r\n    return obj === obj + 0;\r\n  },\r\n  isString: function isString(obj) {\r\n    return obj === obj + '';\r\n  },\r\n  isBoolean: function isBoolean(obj) {\r\n    return obj === false || obj === true;\r\n  },\r\n  isFunction: function isFunction(obj) {\r\n    return Object.prototype.toString.call(obj) === '[object Function]';\r\n  }\r\n};\r\n\r\nvar INTERPRETATIONS = [\r\n{\r\n  litmus: Common.isString,\r\n  conversions: {\r\n    THREE_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    SIX_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9]{6})$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGB: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3])\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGBA: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3]),\r\n          a: parseFloat(test[4])\r\n        };\r\n      },\r\n      write: colorToString\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isNumber,\r\n  conversions: {\r\n    HEX: {\r\n      read: function read(original) {\r\n        return {\r\n          space: 'HEX',\r\n          hex: original,\r\n          conversionName: 'HEX'\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return color.hex;\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isArray,\r\n  conversions: {\r\n    RGB_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 3) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b];\r\n      }\r\n    },\r\n    RGBA_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 4) return false;\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2],\r\n          a: original[3]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b, color.a];\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isObject,\r\n  conversions: {\r\n    RGBA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    RGB_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b\r\n        };\r\n      }\r\n    },\r\n    HSVA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    HSV_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v\r\n        };\r\n      }\r\n    }\r\n  }\r\n}];\r\nvar result = void 0;\r\nvar toReturn = void 0;\r\nvar interpret = function interpret() {\r\n  toReturn = false;\r\n  var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\r\n  Common.each(INTERPRETATIONS, function (family) {\r\n    if (family.litmus(original)) {\r\n      Common.each(family.conversions, function (conversion, conversionName) {\r\n        result = conversion.read(original);\r\n        if (toReturn === false && result !== false) {\r\n          toReturn = result;\r\n          result.conversionName = conversionName;\r\n          result.conversion = conversion;\r\n          return Common.BREAK;\r\n        }\r\n      });\r\n      return Common.BREAK;\r\n    }\r\n  });\r\n  return toReturn;\r\n};\r\n\r\nvar tmpComponent = void 0;\r\nvar ColorMath = {\r\n  hsv_to_rgb: function hsv_to_rgb(h, s, v) {\r\n    var hi = Math.floor(h / 60) % 6;\r\n    var f = h / 60 - Math.floor(h / 60);\r\n    var p = v * (1.0 - s);\r\n    var q = v * (1.0 - f * s);\r\n    var t = v * (1.0 - (1.0 - f) * s);\r\n    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\r\n    return {\r\n      r: c[0] * 255,\r\n      g: c[1] * 255,\r\n      b: c[2] * 255\r\n    };\r\n  },\r\n  rgb_to_hsv: function rgb_to_hsv(r, g, b) {\r\n    var min = Math.min(r, g, b);\r\n    var max = Math.max(r, g, b);\r\n    var delta = max - min;\r\n    var h = void 0;\r\n    var s = void 0;\r\n    if (max !== 0) {\r\n      s = delta / max;\r\n    } else {\r\n      return {\r\n        h: NaN,\r\n        s: 0,\r\n        v: 0\r\n      };\r\n    }\r\n    if (r === max) {\r\n      h = (g - b) / delta;\r\n    } else if (g === max) {\r\n      h = 2 + (b - r) / delta;\r\n    } else {\r\n      h = 4 + (r - g) / delta;\r\n    }\r\n    h /= 6;\r\n    if (h < 0) {\r\n      h += 1;\r\n    }\r\n    return {\r\n      h: h * 360,\r\n      s: s,\r\n      v: max / 255\r\n    };\r\n  },\r\n  rgb_to_hex: function rgb_to_hex(r, g, b) {\r\n    var hex = this.hex_with_component(0, 2, r);\r\n    hex = this.hex_with_component(hex, 1, g);\r\n    hex = this.hex_with_component(hex, 0, b);\r\n    return hex;\r\n  },\r\n  component_from_hex: function component_from_hex(hex, componentIndex) {\r\n    return hex >> componentIndex * 8 & 0xFF;\r\n  },\r\n  hex_with_component: function hex_with_component(hex, componentIndex, value) {\r\n    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\r\n  }\r\n};\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\r\n  return typeof obj;\r\n} : function (obj) {\r\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar get = function get(object, property, receiver) {\r\n  if (object === null) object = Function.prototype;\r\n  var desc = Object.getOwnPropertyDescriptor(object, property);\r\n\r\n  if (desc === undefined) {\r\n    var parent = Object.getPrototypeOf(object);\r\n\r\n    if (parent === null) {\r\n      return undefined;\r\n    } else {\r\n      return get(parent, property, receiver);\r\n    }\r\n  } else if (\"value\" in desc) {\r\n    return desc.value;\r\n  } else {\r\n    var getter = desc.get;\r\n\r\n    if (getter === undefined) {\r\n      return undefined;\r\n    }\r\n\r\n    return getter.call(receiver);\r\n  }\r\n};\r\n\r\nvar inherits = function (subClass, superClass) {\r\n  if (typeof superClass !== \"function\" && superClass !== null) {\r\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\r\n  }\r\n\r\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n    constructor: {\r\n      value: subClass,\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true\r\n    }\r\n  });\r\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar possibleConstructorReturn = function (self, call) {\r\n  if (!self) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n\r\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\r\n};\r\n\r\nvar Color = function () {\r\n  function Color() {\r\n    classCallCheck(this, Color);\r\n    this.__state = interpret.apply(this, arguments);\r\n    if (this.__state === false) {\r\n      throw new Error('Failed to interpret color arguments');\r\n    }\r\n    this.__state.a = this.__state.a || 1;\r\n  }\r\n  createClass(Color, [{\r\n    key: 'toString',\r\n    value: function toString() {\r\n      return colorToString(this);\r\n    }\r\n  }, {\r\n    key: 'toHexString',\r\n    value: function toHexString() {\r\n      return colorToString(this, true);\r\n    }\r\n  }, {\r\n    key: 'toOriginal',\r\n    value: function toOriginal() {\r\n      return this.__state.conversion.write(this);\r\n    }\r\n  }]);\r\n  return Color;\r\n}();\r\nfunction defineRGBComponent(target, component, componentHexIndex) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'RGB') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateRGB(this, component, componentHexIndex);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'RGB') {\r\n        Color.recalculateRGB(this, component, componentHexIndex);\r\n        this.__state.space = 'RGB';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nfunction defineHSVComponent(target, component) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'HSV') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateHSV(this);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'HSV') {\r\n        Color.recalculateHSV(this);\r\n        this.__state.space = 'HSV';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nColor.recalculateRGB = function (color, component, componentHexIndex) {\r\n  if (color.__state.space === 'HEX') {\r\n    color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\r\n  } else if (color.__state.space === 'HSV') {\r\n    Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\r\n  } else {\r\n    throw new Error('Corrupted color state');\r\n  }\r\n};\r\nColor.recalculateHSV = function (color) {\r\n  var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\r\n  Common.extend(color.__state, {\r\n    s: result.s,\r\n    v: result.v\r\n  });\r\n  if (!Common.isNaN(result.h)) {\r\n    color.__state.h = result.h;\r\n  } else if (Common.isUndefined(color.__state.h)) {\r\n    color.__state.h = 0;\r\n  }\r\n};\r\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\r\ndefineRGBComponent(Color.prototype, 'r', 2);\r\ndefineRGBComponent(Color.prototype, 'g', 1);\r\ndefineRGBComponent(Color.prototype, 'b', 0);\r\ndefineHSVComponent(Color.prototype, 'h');\r\ndefineHSVComponent(Color.prototype, 's');\r\ndefineHSVComponent(Color.prototype, 'v');\r\nObject.defineProperty(Color.prototype, 'a', {\r\n  get: function get$$1() {\r\n    return this.__state.a;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.a = v;\r\n  }\r\n});\r\nObject.defineProperty(Color.prototype, 'hex', {\r\n  get: function get$$1() {\r\n    if (!this.__state.space !== 'HEX') {\r\n      this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\r\n    }\r\n    return this.__state.hex;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.space = 'HEX';\r\n    this.__state.hex = v;\r\n  }\r\n});\r\n\r\nvar Controller = function () {\r\n  function Controller(object, property) {\r\n    classCallCheck(this, Controller);\r\n    this.initialValue = object[property];\r\n    this.domElement = document.createElement('div');\r\n    this.object = object;\r\n    this.property = property;\r\n    this.__onChange = undefined;\r\n    this.__onFinishChange = undefined;\r\n  }\r\n  createClass(Controller, [{\r\n    key: 'onChange',\r\n    value: function onChange(fnc) {\r\n      this.__onChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'onFinishChange',\r\n    value: function onFinishChange(fnc) {\r\n      this.__onFinishChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'setValue',\r\n    value: function setValue(newValue) {\r\n      this.object[this.property] = newValue;\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this, newValue);\r\n      }\r\n      this.updateDisplay();\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'getValue',\r\n    value: function getValue() {\r\n      return this.object[this.property];\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'isModified',\r\n    value: function isModified() {\r\n      return this.initialValue !== this.getValue();\r\n    }\r\n  }]);\r\n  return Controller;\r\n}();\r\n\r\nvar EVENT_MAP = {\r\n  HTMLEvents: ['change'],\r\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\r\n  KeyboardEvents: ['keydown']\r\n};\r\nvar EVENT_MAP_INV = {};\r\nCommon.each(EVENT_MAP, function (v, k) {\r\n  Common.each(v, function (e) {\r\n    EVENT_MAP_INV[e] = k;\r\n  });\r\n});\r\nvar CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\r\nfunction cssValueToPixels(val) {\r\n  if (val === '0' || Common.isUndefined(val)) {\r\n    return 0;\r\n  }\r\n  var match = val.match(CSS_VALUE_PIXELS);\r\n  if (!Common.isNull(match)) {\r\n    return parseFloat(match[1]);\r\n  }\r\n  return 0;\r\n}\r\nvar dom = {\r\n  makeSelectable: function makeSelectable(elem, selectable) {\r\n    if (elem === undefined || elem.style === undefined) return;\r\n    elem.onselectstart = selectable ? function () {\r\n      return false;\r\n    } : function () {};\r\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\r\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\r\n    elem.unselectable = selectable ? 'on' : 'off';\r\n  },\r\n  makeFullscreen: function makeFullscreen(elem, hor, vert) {\r\n    var vertical = vert;\r\n    var horizontal = hor;\r\n    if (Common.isUndefined(horizontal)) {\r\n      horizontal = true;\r\n    }\r\n    if (Common.isUndefined(vertical)) {\r\n      vertical = true;\r\n    }\r\n    elem.style.position = 'absolute';\r\n    if (horizontal) {\r\n      elem.style.left = 0;\r\n      elem.style.right = 0;\r\n    }\r\n    if (vertical) {\r\n      elem.style.top = 0;\r\n      elem.style.bottom = 0;\r\n    }\r\n  },\r\n  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\r\n    var params = pars || {};\r\n    var className = EVENT_MAP_INV[eventType];\r\n    if (!className) {\r\n      throw new Error('Event type ' + eventType + ' not supported.');\r\n    }\r\n    var evt = document.createEvent(className);\r\n    switch (className) {\r\n      case 'MouseEvents':\r\n        {\r\n          var clientX = params.x || params.clientX || 0;\r\n          var clientY = params.y || params.clientY || 0;\r\n          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0,\r\n          0,\r\n          clientX,\r\n          clientY,\r\n          false, false, false, false, 0, null);\r\n          break;\r\n        }\r\n      case 'KeyboardEvents':\r\n        {\r\n          var init = evt.initKeyboardEvent || evt.initKeyEvent;\r\n          Common.defaults(params, {\r\n            cancelable: true,\r\n            ctrlKey: false,\r\n            altKey: false,\r\n            shiftKey: false,\r\n            metaKey: false,\r\n            keyCode: undefined,\r\n            charCode: undefined\r\n          });\r\n          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\r\n          break;\r\n        }\r\n      default:\r\n        {\r\n          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\r\n          break;\r\n        }\r\n    }\r\n    Common.defaults(evt, aux);\r\n    elem.dispatchEvent(evt);\r\n  },\r\n  bind: function bind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.addEventListener) {\r\n      elem.addEventListener(event, func, bool);\r\n    } else if (elem.attachEvent) {\r\n      elem.attachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  unbind: function unbind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.removeEventListener) {\r\n      elem.removeEventListener(event, func, bool);\r\n    } else if (elem.detachEvent) {\r\n      elem.detachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  addClass: function addClass(elem, className) {\r\n    if (elem.className === undefined) {\r\n      elem.className = className;\r\n    } else if (elem.className !== className) {\r\n      var classes = elem.className.split(/ +/);\r\n      if (classes.indexOf(className) === -1) {\r\n        classes.push(className);\r\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n      }\r\n    }\r\n    return dom;\r\n  },\r\n  removeClass: function removeClass(elem, className) {\r\n    if (className) {\r\n      if (elem.className === className) {\r\n        elem.removeAttribute('class');\r\n      } else {\r\n        var classes = elem.className.split(/ +/);\r\n        var index = classes.indexOf(className);\r\n        if (index !== -1) {\r\n          classes.splice(index, 1);\r\n          elem.className = classes.join(' ');\r\n        }\r\n      }\r\n    } else {\r\n      elem.className = undefined;\r\n    }\r\n    return dom;\r\n  },\r\n  hasClass: function hasClass(elem, className) {\r\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\r\n  },\r\n  getWidth: function getWidth(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\r\n  },\r\n  getHeight: function getHeight(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\r\n  },\r\n  getOffset: function getOffset(el) {\r\n    var elem = el;\r\n    var offset = { left: 0, top: 0 };\r\n    if (elem.offsetParent) {\r\n      do {\r\n        offset.left += elem.offsetLeft;\r\n        offset.top += elem.offsetTop;\r\n        elem = elem.offsetParent;\r\n      } while (elem);\r\n    }\r\n    return offset;\r\n  },\r\n  isActive: function isActive(elem) {\r\n    return elem === document.activeElement && (elem.type || elem.href);\r\n  }\r\n};\r\n\r\nvar BooleanController = function (_Controller) {\r\n  inherits(BooleanController, _Controller);\r\n  function BooleanController(object, property) {\r\n    classCallCheck(this, BooleanController);\r\n    var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__prev = _this2.getValue();\r\n    _this2.__checkbox = document.createElement('input');\r\n    _this2.__checkbox.setAttribute('type', 'checkbox');\r\n    function onChange() {\r\n      _this.setValue(!_this.__prev);\r\n    }\r\n    dom.bind(_this2.__checkbox, 'change', onChange, false);\r\n    _this2.domElement.appendChild(_this2.__checkbox);\r\n    _this2.updateDisplay();\r\n    return _this2;\r\n  }\r\n  createClass(BooleanController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      this.__prev = this.getValue();\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (this.getValue() === true) {\r\n        this.__checkbox.setAttribute('checked', 'checked');\r\n        this.__checkbox.checked = true;\r\n        this.__prev = true;\r\n      } else {\r\n        this.__checkbox.checked = false;\r\n        this.__prev = false;\r\n      }\r\n      return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return BooleanController;\r\n}(Controller);\r\n\r\nvar OptionController = function (_Controller) {\r\n  inherits(OptionController, _Controller);\r\n  function OptionController(object, property, opts) {\r\n    classCallCheck(this, OptionController);\r\n    var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\r\n    var options = opts;\r\n    var _this = _this2;\r\n    _this2.__select = document.createElement('select');\r\n    if (Common.isArray(options)) {\r\n      var map = {};\r\n      Common.each(options, function (element) {\r\n        map[element] = element;\r\n      });\r\n      options = map;\r\n    }\r\n    Common.each(options, function (value, key) {\r\n      var opt = document.createElement('option');\r\n      opt.innerHTML = key;\r\n      opt.setAttribute('value', value);\r\n      _this.__select.appendChild(opt);\r\n    });\r\n    _this2.updateDisplay();\r\n    dom.bind(_this2.__select, 'change', function () {\r\n      var desiredValue = this.options[this.selectedIndex].value;\r\n      _this.setValue(desiredValue);\r\n    });\r\n    _this2.domElement.appendChild(_this2.__select);\r\n    return _this2;\r\n  }\r\n  createClass(OptionController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (dom.isActive(this.__select)) return this;\r\n      this.__select.value = this.getValue();\r\n      return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return OptionController;\r\n}(Controller);\r\n\r\nvar StringController = function (_Controller) {\r\n  inherits(StringController, _Controller);\r\n  function StringController(object, property) {\r\n    classCallCheck(this, StringController);\r\n    var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\r\n    var _this = _this2;\r\n    function onChange() {\r\n      _this.setValue(_this.__input.value);\r\n    }\r\n    function onBlur() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'keyup', onChange);\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        this.blur();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(StringController, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (!dom.isActive(this.__input)) {\r\n        this.__input.value = this.getValue();\r\n      }\r\n      return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return StringController;\r\n}(Controller);\r\n\r\nfunction numDecimals(x) {\r\n  var _x = x.toString();\r\n  if (_x.indexOf('.') > -1) {\r\n    return _x.length - _x.indexOf('.') - 1;\r\n  }\r\n  return 0;\r\n}\r\nvar NumberController = function (_Controller) {\r\n  inherits(NumberController, _Controller);\r\n  function NumberController(object, property, params) {\r\n    classCallCheck(this, NumberController);\r\n    var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\r\n    var _params = params || {};\r\n    _this.__min = _params.min;\r\n    _this.__max = _params.max;\r\n    _this.__step = _params.step;\r\n    if (Common.isUndefined(_this.__step)) {\r\n      if (_this.initialValue === 0) {\r\n        _this.__impliedStep = 1;\r\n      } else {\r\n        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\r\n      }\r\n    } else {\r\n      _this.__impliedStep = _this.__step;\r\n    }\r\n    _this.__precision = numDecimals(_this.__impliedStep);\r\n    return _this;\r\n  }\r\n  createClass(NumberController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var _v = v;\r\n      if (this.__min !== undefined && _v < this.__min) {\r\n        _v = this.__min;\r\n      } else if (this.__max !== undefined && _v > this.__max) {\r\n        _v = this.__max;\r\n      }\r\n      if (this.__step !== undefined && _v % this.__step !== 0) {\r\n        _v = Math.round(_v / this.__step) * this.__step;\r\n      }\r\n      return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\r\n    }\r\n  }, {\r\n    key: 'min',\r\n    value: function min(minValue) {\r\n      this.__min = minValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'max',\r\n    value: function max(maxValue) {\r\n      this.__max = maxValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'step',\r\n    value: function step(stepValue) {\r\n      this.__step = stepValue;\r\n      this.__impliedStep = stepValue;\r\n      this.__precision = numDecimals(stepValue);\r\n      return this;\r\n    }\r\n  }]);\r\n  return NumberController;\r\n}(Controller);\r\n\r\nfunction roundToDecimal(value, decimals) {\r\n  var tenTo = Math.pow(10, decimals);\r\n  return Math.round(value * tenTo) / tenTo;\r\n}\r\nvar NumberControllerBox = function (_NumberController) {\r\n  inherits(NumberControllerBox, _NumberController);\r\n  function NumberControllerBox(object, property, params) {\r\n    classCallCheck(this, NumberControllerBox);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\r\n    _this2.__truncationSuspended = false;\r\n    var _this = _this2;\r\n    var prevY = void 0;\r\n    function onChange() {\r\n      var attempted = parseFloat(_this.__input.value);\r\n      if (!Common.isNaN(attempted)) {\r\n        _this.setValue(attempted);\r\n      }\r\n    }\r\n    function onFinish() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onBlur() {\r\n      onFinish();\r\n    }\r\n    function onMouseDrag(e) {\r\n      var diff = prevY - e.clientY;\r\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\r\n      prevY = e.clientY;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      onFinish();\r\n    }\r\n    function onMouseDown(e) {\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      prevY = e.clientY;\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        _this.__truncationSuspended = true;\r\n        this.blur();\r\n        _this.__truncationSuspended = false;\r\n        onFinish();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerBox, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\r\n      return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerBox;\r\n}(NumberController);\r\n\r\nfunction map(v, i1, i2, o1, o2) {\r\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\r\n}\r\nvar NumberControllerSlider = function (_NumberController) {\r\n  inherits(NumberControllerSlider, _NumberController);\r\n  function NumberControllerSlider(object, property, min, max, step) {\r\n    classCallCheck(this, NumberControllerSlider);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, { min: min, max: max, step: step }));\r\n    var _this = _this2;\r\n    _this2.__background = document.createElement('div');\r\n    _this2.__foreground = document.createElement('div');\r\n    dom.bind(_this2.__background, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__background, 'touchstart', onTouchStart);\r\n    dom.addClass(_this2.__background, 'slider');\r\n    dom.addClass(_this2.__foreground, 'slider-fg');\r\n    function onMouseDown(e) {\r\n      document.activeElement.blur();\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      onMouseDrag(e);\r\n    }\r\n    function onMouseDrag(e) {\r\n      e.preventDefault();\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n      return false;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onTouchStart(e) {\r\n      if (e.touches.length !== 1) {\r\n        return;\r\n      }\r\n      dom.bind(window, 'touchmove', onTouchMove);\r\n      dom.bind(window, 'touchend', onTouchEnd);\r\n      onTouchMove(e);\r\n    }\r\n    function onTouchMove(e) {\r\n      var clientX = e.touches[0].clientX;\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n    }\r\n    function onTouchEnd() {\r\n      dom.unbind(window, 'touchmove', onTouchMove);\r\n      dom.unbind(window, 'touchend', onTouchEnd);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.updateDisplay();\r\n    _this2.__background.appendChild(_this2.__foreground);\r\n    _this2.domElement.appendChild(_this2.__background);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerSlider, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\r\n      this.__foreground.style.width = pct * 100 + '%';\r\n      return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerSlider;\r\n}(NumberController);\r\n\r\nvar FunctionController = function (_Controller) {\r\n  inherits(FunctionController, _Controller);\r\n  function FunctionController(object, property, text) {\r\n    classCallCheck(this, FunctionController);\r\n    var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__button = document.createElement('div');\r\n    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\r\n    dom.bind(_this2.__button, 'click', function (e) {\r\n      e.preventDefault();\r\n      _this.fire();\r\n      return false;\r\n    });\r\n    dom.addClass(_this2.__button, 'button');\r\n    _this2.domElement.appendChild(_this2.__button);\r\n    return _this2;\r\n  }\r\n  createClass(FunctionController, [{\r\n    key: 'fire',\r\n    value: function fire() {\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this);\r\n      }\r\n      this.getValue().call(this.object);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n    }\r\n  }]);\r\n  return FunctionController;\r\n}(Controller);\r\n\r\nvar ColorController = function (_Controller) {\r\n    inherits(ColorController, _Controller);\r\n    function ColorController(object, property) {\r\n        classCallCheck(this, ColorController);\r\n        var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\r\n        _this2.__color = new Color(_this2.getValue());\r\n        _this2.__temp = new Color(0);\r\n        var _this = _this2;\r\n        _this2.domElement = document.createElement('div');\r\n        dom.makeSelectable(_this2.domElement, false);\r\n        _this2.__selector = document.createElement('div');\r\n        _this2.__selector.className = 'selector';\r\n        _this2.__saturation_field = document.createElement('div');\r\n        _this2.__saturation_field.className = 'saturation-field';\r\n        _this2.__field_knob = document.createElement('div');\r\n        _this2.__field_knob.className = 'field-knob';\r\n        _this2.__field_knob_border = '2px solid ';\r\n        _this2.__hue_knob = document.createElement('div');\r\n        _this2.__hue_knob.className = 'hue-knob';\r\n        _this2.__hue_field = document.createElement('div');\r\n        _this2.__hue_field.className = 'hue-field';\r\n        _this2.__input = document.createElement('input');\r\n        _this2.__input.type = 'text';\r\n        _this2.__input_textShadow = '0 1px 1px ';\r\n        dom.bind(_this2.__input, 'keydown', function (e) {\r\n            if (e.keyCode === 13) {\r\n                onBlur.call(this);\r\n            }\r\n        });\r\n        dom.bind(_this2.__input, 'blur', onBlur);\r\n        dom.bind(_this2.__selector, 'mousedown', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'mouseup', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        dom.bind(_this2.__selector, 'touchstart', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'touchend', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        var valueField = document.createElement('div');\r\n        Common.extend(_this2.__selector.style, {\r\n            width: '122px',\r\n            height: '102px',\r\n            padding: '3px',\r\n            backgroundColor: '#222',\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\r\n        });\r\n        Common.extend(_this2.__field_knob.style, {\r\n            position: 'absolute',\r\n            width: '12px',\r\n            height: '12px',\r\n            border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\r\n            borderRadius: '12px',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__hue_knob.style, {\r\n            position: 'absolute',\r\n            width: '15px',\r\n            height: '2px',\r\n            borderRight: '4px solid #fff',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__saturation_field.style, {\r\n            width: '100px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            marginRight: '3px',\r\n            display: 'inline-block',\r\n            cursor: 'pointer'\r\n        });\r\n        Common.extend(valueField.style, {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: 'none'\r\n        });\r\n        linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\r\n        Common.extend(_this2.__hue_field.style, {\r\n            width: '15px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            cursor: 'ns-resize',\r\n            position: 'absolute',\r\n            top: '3px',\r\n            right: '3px'\r\n        });\r\n        hueGradient(_this2.__hue_field);\r\n        Common.extend(_this2.__input.style, {\r\n            outline: 'none',\r\n            textAlign: 'center',\r\n            color: '#fff',\r\n            border: 0,\r\n            fontWeight: 'bold',\r\n            textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\r\n        });\r\n        dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\r\n        dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\r\n        function fieldDown(e) {\r\n            setSV(e);\r\n            dom.bind(window, 'mousemove', setSV);\r\n            dom.bind(window, 'touchmove', setSV);\r\n            dom.bind(window, 'mouseup', fieldUpSV);\r\n            dom.bind(window, 'touchend', fieldUpSV);\r\n        }\r\n        function fieldDownH(e) {\r\n            setH(e);\r\n            dom.bind(window, 'mousemove', setH);\r\n            dom.bind(window, 'touchmove', setH);\r\n            dom.bind(window, 'mouseup', fieldUpH);\r\n            dom.bind(window, 'touchend', fieldUpH);\r\n        }\r\n        function fieldUpSV() {\r\n            dom.unbind(window, 'mousemove', setSV);\r\n            dom.unbind(window, 'touchmove', setSV);\r\n            dom.unbind(window, 'mouseup', fieldUpSV);\r\n            dom.unbind(window, 'touchend', fieldUpSV);\r\n            onFinish();\r\n        }\r\n        function fieldUpH() {\r\n            dom.unbind(window, 'mousemove', setH);\r\n            dom.unbind(window, 'touchmove', setH);\r\n            dom.unbind(window, 'mouseup', fieldUpH);\r\n            dom.unbind(window, 'touchend', fieldUpH);\r\n            onFinish();\r\n        }\r\n        function onBlur() {\r\n            var i = interpret(this.value);\r\n            if (i !== false) {\r\n                _this.__color.__state = i;\r\n                _this.setValue(_this.__color.toOriginal());\r\n            } else {\r\n                this.value = _this.__color.toString();\r\n            }\r\n        }\r\n        function onFinish() {\r\n            if (_this.__onFinishChange) {\r\n                _this.__onFinishChange.call(_this, _this.__color.toOriginal());\r\n            }\r\n        }\r\n        _this2.__saturation_field.appendChild(valueField);\r\n        _this2.__selector.appendChild(_this2.__field_knob);\r\n        _this2.__selector.appendChild(_this2.__saturation_field);\r\n        _this2.__selector.appendChild(_this2.__hue_field);\r\n        _this2.__hue_field.appendChild(_this2.__hue_knob);\r\n        _this2.domElement.appendChild(_this2.__input);\r\n        _this2.domElement.appendChild(_this2.__selector);\r\n        _this2.updateDisplay();\r\n        function setSV(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__saturation_field.getBoundingClientRect();\r\n            var _ref = e.touches && e.touches[0] || e,\r\n                clientX = _ref.clientX,\r\n                clientY = _ref.clientY;\r\n            var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\r\n            var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (v > 1) {\r\n                v = 1;\r\n            } else if (v < 0) {\r\n                v = 0;\r\n            }\r\n            if (s > 1) {\r\n                s = 1;\r\n            } else if (s < 0) {\r\n                s = 0;\r\n            }\r\n            _this.__color.v = v;\r\n            _this.__color.s = s;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        function setH(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__hue_field.getBoundingClientRect();\r\n            var _ref2 = e.touches && e.touches[0] || e,\r\n                clientY = _ref2.clientY;\r\n            var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (h > 1) {\r\n                h = 1;\r\n            } else if (h < 0) {\r\n                h = 0;\r\n            }\r\n            _this.__color.h = h * 360;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        return _this2;\r\n    }\r\n    createClass(ColorController, [{\r\n        key: 'updateDisplay',\r\n        value: function updateDisplay() {\r\n            var i = interpret(this.getValue());\r\n            if (i !== false) {\r\n                var mismatch = false;\r\n                Common.each(Color.COMPONENTS, function (component) {\r\n                    if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\r\n                        mismatch = true;\r\n                        return {};\r\n                    }\r\n                }, this);\r\n                if (mismatch) {\r\n                    Common.extend(this.__color.__state, i);\r\n                }\r\n            }\r\n            Common.extend(this.__temp.__state, this.__color.__state);\r\n            this.__temp.a = 1;\r\n            var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\r\n            var _flip = 255 - flip;\r\n            Common.extend(this.__field_knob.style, {\r\n                marginLeft: 100 * this.__color.s - 7 + 'px',\r\n                marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\r\n                backgroundColor: this.__temp.toHexString(),\r\n                border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\r\n            });\r\n            this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\r\n            this.__temp.s = 1;\r\n            this.__temp.v = 1;\r\n            linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\r\n            this.__input.value = this.__color.toString();\r\n            Common.extend(this.__input.style, {\r\n                backgroundColor: this.__color.toHexString(),\r\n                color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\r\n                textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\r\n            });\r\n        }\r\n    }]);\r\n    return ColorController;\r\n}(Controller);\r\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\r\nfunction linearGradient(elem, x, a, b) {\r\n    elem.style.background = '';\r\n    Common.each(vendors, function (vendor) {\r\n        elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\r\n    });\r\n}\r\nfunction hueGradient(elem) {\r\n    elem.style.background = '';\r\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\r\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n}\r\n\r\nvar ControllerFactory = function ControllerFactory(object, property) {\r\n  var initialValue = object[property];\r\n  if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\r\n    return new OptionController(object, property, arguments[2]);\r\n  }\r\n  if (Common.isNumber(initialValue)) {\r\n    if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\r\n      if (Common.isNumber(arguments[4])) {\r\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4]);\r\n      }\r\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\r\n    }\r\n    if (Common.isNumber(arguments[4])) {\r\n      return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });\r\n    }\r\n    return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\r\n  }\r\n  if (Common.isString(initialValue)) {\r\n    return new StringController(object, property);\r\n  }\r\n  if (Common.isFunction(initialValue)) {\r\n    return new FunctionController(object, property, '');\r\n  }\r\n  if (Common.isBoolean(initialValue)) {\r\n    return new BooleanController(object, property);\r\n  }\r\n  return null;\r\n};\r\n\r\nvar CustomController = function (_Controller) {\r\n  inherits(CustomController, _Controller);\r\n  function CustomController(object, property) {\r\n    classCallCheck(this, CustomController);\r\n    var _this = possibleConstructorReturn(this, (CustomController.__proto__ || Object.getPrototypeOf(CustomController)).call(this, object, property));\r\n    _this.arguments = {\r\n      object: object, property: property, opts: Array.prototype.slice.call(arguments, 2)\r\n    };\r\n    if (object.property) _this.property = object.property(_this);\r\n    return _this;\r\n  }\r\n  createClass(CustomController, [{\r\n    key: 'controller',\r\n    set: function set$$1(newController) {\r\n      this._controller = newController;\r\n    },\r\n    get: function get$$1() {\r\n      return this._controller;\r\n    }\r\n  }]);\r\n  return CustomController;\r\n}(Controller);\r\n\r\nvar css = {\r\n  load: function load(url, indoc) {\r\n    var doc = indoc || document;\r\n    var link = doc.createElement('link');\r\n    link.type = 'text/css';\r\n    link.rel = 'stylesheet';\r\n    link.href = url;\r\n    doc.getElementsByTagName('head')[0].appendChild(link);\r\n  },\r\n  inject: function inject(cssContent, indoc) {\r\n    var doc = indoc || document;\r\n    var injected = document.createElement('style');\r\n    injected.type = 'text/css';\r\n    injected.innerHTML = cssContent;\r\n    var head = doc.getElementsByTagName('head')[0];\r\n    try {\r\n      head.appendChild(injected);\r\n    } catch (e) {\r\n    }\r\n  }\r\n};\r\n\r\nvar saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\r\n\r\nfunction requestAnimationFrame(callback) {\r\n  setTimeout(callback, 1000 / 60);\r\n}\r\nvar requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\r\n\r\nvar CenteredDiv = function () {\r\n  function CenteredDiv() {\r\n    classCallCheck(this, CenteredDiv);\r\n    this.backgroundElement = document.createElement('div');\r\n    Common.extend(this.backgroundElement.style, {\r\n      backgroundColor: 'rgba(0,0,0,0.8)',\r\n      top: 0,\r\n      left: 0,\r\n      display: 'none',\r\n      zIndex: '1000',\r\n      opacity: 0,\r\n      WebkitTransition: 'opacity 0.2s linear',\r\n      transition: 'opacity 0.2s linear'\r\n    });\r\n    dom.makeFullscreen(this.backgroundElement);\r\n    this.backgroundElement.style.position = 'fixed';\r\n    this.domElement = document.createElement('div');\r\n    Common.extend(this.domElement.style, {\r\n      position: 'fixed',\r\n      display: 'none',\r\n      zIndex: '1001',\r\n      opacity: 0,\r\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\r\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\r\n    });\r\n    document.body.appendChild(this.backgroundElement);\r\n    document.body.appendChild(this.domElement);\r\n    var _this = this;\r\n    dom.bind(this.backgroundElement, 'click', function () {\r\n      _this.hide();\r\n    });\r\n  }\r\n  createClass(CenteredDiv, [{\r\n    key: 'show',\r\n    value: function show() {\r\n      var _this = this;\r\n      this.backgroundElement.style.display = 'block';\r\n      this.domElement.style.display = 'block';\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n      this.layout();\r\n      Common.defer(function () {\r\n        _this.backgroundElement.style.opacity = 1;\r\n        _this.domElement.style.opacity = 1;\r\n        _this.domElement.style.webkitTransform = 'scale(1)';\r\n      });\r\n    }\r\n  }, {\r\n    key: 'hide',\r\n    value: function hide() {\r\n      var _this = this;\r\n      var hide = function hide() {\r\n        _this.domElement.style.display = 'none';\r\n        _this.backgroundElement.style.display = 'none';\r\n        dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\r\n        dom.unbind(_this.domElement, 'transitionend', hide);\r\n        dom.unbind(_this.domElement, 'oTransitionEnd', hide);\r\n      };\r\n      dom.bind(this.domElement, 'webkitTransitionEnd', hide);\r\n      dom.bind(this.domElement, 'transitionend', hide);\r\n      dom.bind(this.domElement, 'oTransitionEnd', hide);\r\n      this.backgroundElement.style.opacity = 0;\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n    }\r\n  }, {\r\n    key: 'layout',\r\n    value: function layout() {\r\n      this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\r\n      this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\r\n    }\r\n  }]);\r\n  return CenteredDiv;\r\n}();\r\n\r\nvar styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\r\n\r\ncss.inject(styleSheet);\r\nvar CSS_NAMESPACE = 'dg';\r\nvar HIDE_KEY_CODE = 72;\r\nvar CLOSE_BUTTON_HEIGHT = 20;\r\nvar DEFAULT_DEFAULT_PRESET_NAME = 'Default';\r\nvar SUPPORTS_LOCAL_STORAGE = function () {\r\n  try {\r\n    return !!window.localStorage;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}();\r\nvar SAVE_DIALOGUE = void 0;\r\nvar autoPlaceVirgin = true;\r\nvar autoPlaceContainer = void 0;\r\nvar hide = false;\r\nvar hideableGuis = [];\r\nvar GUI = function GUI(pars) {\r\n  var _this = this;\r\n  var params = pars || {};\r\n  this.domElement = document.createElement('div');\r\n  this.__ul = document.createElement('ul');\r\n  this.domElement.appendChild(this.__ul);\r\n  dom.addClass(this.domElement, CSS_NAMESPACE);\r\n  this.__folders = {};\r\n  this.__controllers = [];\r\n  this.__rememberedObjects = [];\r\n  this.__rememberedObjectIndecesToControllers = [];\r\n  this.__listening = [];\r\n  params = Common.defaults(params, {\r\n    closeOnTop: false,\r\n    autoPlace: true,\r\n    width: GUI.DEFAULT_WIDTH\r\n  });\r\n  params = Common.defaults(params, {\r\n    resizable: params.autoPlace,\r\n    hideable: params.autoPlace\r\n  });\r\n  if (!Common.isUndefined(params.load)) {\r\n    if (params.preset) {\r\n      params.load.preset = params.preset;\r\n    }\r\n  } else {\r\n    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\r\n  }\r\n  if (Common.isUndefined(params.parent) && params.hideable) {\r\n    hideableGuis.push(this);\r\n  }\r\n  params.resizable = Common.isUndefined(params.parent) && params.resizable;\r\n  if (params.autoPlace && Common.isUndefined(params.scrollable)) {\r\n    params.scrollable = true;\r\n  }\r\n  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\r\n  var saveToLocalStorage = void 0;\r\n  var titleRow = void 0;\r\n  Object.defineProperties(this,\r\n  {\r\n    parent: {\r\n      get: function get$$1() {\r\n        return params.parent;\r\n      }\r\n    },\r\n    scrollable: {\r\n      get: function get$$1() {\r\n        return params.scrollable;\r\n      }\r\n    },\r\n    autoPlace: {\r\n      get: function get$$1() {\r\n        return params.autoPlace;\r\n      }\r\n    },\r\n    closeOnTop: {\r\n      get: function get$$1() {\r\n        return params.closeOnTop;\r\n      }\r\n    },\r\n    preset: {\r\n      get: function get$$1() {\r\n        if (_this.parent) {\r\n          return _this.getRoot().preset;\r\n        }\r\n        return params.load.preset;\r\n      },\r\n      set: function set$$1(v) {\r\n        if (_this.parent) {\r\n          _this.getRoot().preset = v;\r\n        } else {\r\n          params.load.preset = v;\r\n        }\r\n        setPresetSelectIndex(this);\r\n        _this.revert();\r\n      }\r\n    },\r\n    width: {\r\n      get: function get$$1() {\r\n        return params.width;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.width = v;\r\n        setWidth(_this, v);\r\n      }\r\n    },\r\n    name: {\r\n      get: function get$$1() {\r\n        return params.name;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.name = v;\r\n        if (titleRow) {\r\n          titleRow.innerHTML = params.name;\r\n        }\r\n      }\r\n    },\r\n    closed: {\r\n      get: function get$$1() {\r\n        return params.closed;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.closed = v;\r\n        if (params.closed) {\r\n          dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        } else {\r\n          dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        }\r\n        this.onResize();\r\n        if (_this.__closeButton) {\r\n          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\r\n        }\r\n      }\r\n    },\r\n    load: {\r\n      get: function get$$1() {\r\n        return params.load;\r\n      }\r\n    },\r\n    useLocalStorage: {\r\n      get: function get$$1() {\r\n        return useLocalStorage;\r\n      },\r\n      set: function set$$1(bool) {\r\n        if (SUPPORTS_LOCAL_STORAGE) {\r\n          useLocalStorage = bool;\r\n          if (bool) {\r\n            dom.bind(window, 'unload', saveToLocalStorage);\r\n          } else {\r\n            dom.unbind(window, 'unload', saveToLocalStorage);\r\n          }\r\n          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\r\n        }\r\n      }\r\n    }\r\n  });\r\n  if (Common.isUndefined(params.parent)) {\r\n    this.closed = params.closed || false;\r\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\r\n    dom.makeSelectable(this.domElement, false);\r\n    if (SUPPORTS_LOCAL_STORAGE) {\r\n      if (useLocalStorage) {\r\n        _this.useLocalStorage = true;\r\n        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\r\n        if (savedGui) {\r\n          params.load = JSON.parse(savedGui);\r\n        }\r\n      }\r\n    }\r\n    this.__closeButton = document.createElement('div');\r\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\r\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\r\n    if (params.closeOnTop) {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\r\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\r\n    } else {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\r\n      this.domElement.appendChild(this.__closeButton);\r\n    }\r\n    dom.bind(this.__closeButton, 'click', function () {\r\n      _this.closed = !_this.closed;\r\n    });\r\n  } else {\r\n    if (params.closed === undefined) {\r\n      params.closed = true;\r\n    }\r\n    var titleRowName = document.createTextNode(params.name);\r\n    dom.addClass(titleRowName, 'controller-name');\r\n    titleRow = addRow(_this, titleRowName);\r\n    var onClickTitle = function onClickTitle(e) {\r\n      e.preventDefault();\r\n      _this.closed = !_this.closed;\r\n      return false;\r\n    };\r\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\r\n    dom.addClass(titleRow, 'title');\r\n    dom.bind(titleRow, 'click', onClickTitle);\r\n    if (!params.closed) {\r\n      this.closed = false;\r\n    }\r\n  }\r\n  if (params.autoPlace) {\r\n    if (Common.isUndefined(params.parent)) {\r\n      if (autoPlaceVirgin) {\r\n        autoPlaceContainer = document.createElement('div');\r\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\r\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\r\n        document.body.appendChild(autoPlaceContainer);\r\n        autoPlaceVirgin = false;\r\n      }\r\n      autoPlaceContainer.appendChild(this.domElement);\r\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\r\n    }\r\n    if (!this.parent) {\r\n      setWidth(_this, params.width);\r\n    }\r\n  }\r\n  this.__resizeHandler = function () {\r\n    _this.onResizeDebounced();\r\n  };\r\n  dom.bind(window, 'resize', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\r\n  this.onResize();\r\n  if (params.resizable) {\r\n    addResizeHandle(this);\r\n  }\r\n  saveToLocalStorage = function saveToLocalStorage() {\r\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\r\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\r\n    }\r\n  };\r\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\r\n  function resetWidth() {\r\n    var root = _this.getRoot();\r\n    root.width += 1;\r\n    Common.defer(function () {\r\n      root.width -= 1;\r\n    });\r\n  }\r\n  if (!params.parent) {\r\n    resetWidth();\r\n  }\r\n};\r\nGUI.toggleHide = function () {\r\n  hide = !hide;\r\n  Common.each(hideableGuis, function (gui) {\r\n    gui.domElement.style.display = hide ? 'none' : '';\r\n  });\r\n};\r\nGUI.CLASS_AUTO_PLACE = 'a';\r\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\r\nGUI.CLASS_MAIN = 'main';\r\nGUI.CLASS_CONTROLLER_ROW = 'cr';\r\nGUI.CLASS_TOO_TALL = 'taller-than-window';\r\nGUI.CLASS_CLOSED = 'closed';\r\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\r\nGUI.CLASS_CLOSE_TOP = 'close-top';\r\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\r\nGUI.CLASS_DRAG = 'drag';\r\nGUI.DEFAULT_WIDTH = 245;\r\nGUI.TEXT_CLOSED = 'Close Controls';\r\nGUI.TEXT_OPEN = 'Open Controls';\r\nGUI._keydownHandler = function (e) {\r\n  if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\r\n    GUI.toggleHide();\r\n  }\r\n};\r\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\r\nCommon.extend(GUI.prototype,\r\n{\r\n  add: function add(object, property) {\r\n    return _add(this, object, property, {\r\n      factoryArgs: Array.prototype.slice.call(arguments, 2)\r\n    });\r\n  },\r\n  addColor: function addColor(object, property) {\r\n    return _add(this, object, property, {\r\n      color: true\r\n    });\r\n  },\r\n  remove: function remove(controller) {\r\n    this.__ul.removeChild(controller.__li);\r\n    this.__controllers.splice(this.__controllers.indexOf(controller), 1);\r\n    var _this = this;\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  destroy: function destroy() {\r\n    if (this.parent) {\r\n      throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\r\n    }\r\n    if (this.autoPlace) {\r\n      autoPlaceContainer.removeChild(this.domElement);\r\n    }\r\n    var _this = this;\r\n    Common.each(this.__folders, function (subfolder) {\r\n      _this.removeFolder(subfolder);\r\n    });\r\n    dom.unbind(window, 'keydown', GUI._keydownHandler, false);\r\n    removeListeners(this);\r\n  },\r\n  addFolder: function addFolder(name) {\r\n    if (this.__folders[name] !== undefined) {\r\n      throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\r\n    }\r\n    var newGuiParams = { name: name, parent: this };\r\n    newGuiParams.autoPlace = this.autoPlace;\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[name]) {\r\n      newGuiParams.closed = this.load.folders[name].closed;\r\n      newGuiParams.load = this.load.folders[name];\r\n    }\r\n    var gui = new GUI(newGuiParams);\r\n    this.__folders[name] = gui;\r\n    var li = addRow(this, gui.domElement);\r\n    dom.addClass(li, 'folder');\r\n    return gui;\r\n  },\r\n  removeFolder: function removeFolder(folder) {\r\n    this.__ul.removeChild(folder.domElement.parentElement);\r\n    delete this.__folders[folder.name];\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[folder.name]) {\r\n      delete this.load.folders[folder.name];\r\n    }\r\n    removeListeners(folder);\r\n    var _this = this;\r\n    Common.each(folder.__folders, function (subfolder) {\r\n      folder.removeFolder(subfolder);\r\n    });\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  open: function open() {\r\n    this.closed = false;\r\n  },\r\n  close: function close() {\r\n    this.closed = true;\r\n  },\r\n  hide: function hide() {\r\n    this.domElement.style.display = 'none';\r\n  },\r\n  show: function show() {\r\n    this.domElement.style.display = '';\r\n  },\r\n  onResize: function onResize() {\r\n    var root = this.getRoot();\r\n    if (root.scrollable) {\r\n      var top = dom.getOffset(root.__ul).top;\r\n      var h = 0;\r\n      Common.each(root.__ul.childNodes, function (node) {\r\n        if (!(root.autoPlace && node === root.__save_row)) {\r\n          h += dom.getHeight(node);\r\n        }\r\n      });\r\n      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\r\n        dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\r\n      } else {\r\n        dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = 'auto';\r\n      }\r\n    }\r\n    if (root.__resize_handle) {\r\n      Common.defer(function () {\r\n        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\r\n      });\r\n    }\r\n    if (root.__closeButton) {\r\n      root.__closeButton.style.width = root.width + 'px';\r\n    }\r\n  },\r\n  onResizeDebounced: Common.debounce(function () {\r\n    this.onResize();\r\n  }, 50),\r\n  remember: function remember() {\r\n    if (Common.isUndefined(SAVE_DIALOGUE)) {\r\n      SAVE_DIALOGUE = new CenteredDiv();\r\n      SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\r\n    }\r\n    if (this.parent) {\r\n      throw new Error('You can only call remember on a top level GUI.');\r\n    }\r\n    var _this = this;\r\n    Common.each(Array.prototype.slice.call(arguments), function (object) {\r\n      if (_this.__rememberedObjects.length === 0) {\r\n        addSaveMenu(_this);\r\n      }\r\n      if (_this.__rememberedObjects.indexOf(object) === -1) {\r\n        _this.__rememberedObjects.push(object);\r\n      }\r\n    });\r\n    if (this.autoPlace) {\r\n      setWidth(this, this.width);\r\n    }\r\n  },\r\n  getRoot: function getRoot() {\r\n    var gui = this;\r\n    while (gui.parent) {\r\n      gui = gui.parent;\r\n    }\r\n    return gui;\r\n  },\r\n  getSaveObject: function getSaveObject() {\r\n    var toReturn = this.load;\r\n    toReturn.closed = this.closed;\r\n    if (this.__rememberedObjects.length > 0) {\r\n      toReturn.preset = this.preset;\r\n      if (!toReturn.remembered) {\r\n        toReturn.remembered = {};\r\n      }\r\n      toReturn.remembered[this.preset] = getCurrentPreset(this);\r\n    }\r\n    toReturn.folders = {};\r\n    Common.each(this.__folders, function (element, key) {\r\n      toReturn.folders[key] = element.getSaveObject();\r\n    });\r\n    return toReturn;\r\n  },\r\n  save: function save() {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n    }\r\n    this.load.remembered[this.preset] = getCurrentPreset(this);\r\n    markPresetModified(this, false);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  saveAs: function saveAs(presetName) {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\r\n    }\r\n    this.load.remembered[presetName] = getCurrentPreset(this);\r\n    this.preset = presetName;\r\n    addPresetOption(this, presetName, true);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  revert: function revert(gui) {\r\n    Common.each(this.__controllers, function (controller) {\r\n      if (!this.getRoot().load.remembered) {\r\n        controller.setValue(controller.initialValue);\r\n      } else {\r\n        recallSavedValue(gui || this.getRoot(), controller);\r\n      }\r\n      if (controller.__onFinishChange) {\r\n        controller.__onFinishChange.call(controller, controller.getValue());\r\n      }\r\n    }, this);\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.revert(folder);\r\n    });\r\n    if (!gui) {\r\n      markPresetModified(this.getRoot(), false);\r\n    }\r\n  },\r\n  listen: function listen(controller) {\r\n    var init = this.__listening.length === 0;\r\n    this.__listening.push(controller);\r\n    if (init) {\r\n      updateDisplays(this.__listening);\r\n    }\r\n  },\r\n  updateDisplay: function updateDisplay() {\r\n    Common.each(this.__controllers, function (controller) {\r\n      controller.updateDisplay();\r\n    });\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.updateDisplay();\r\n    });\r\n  }\r\n});\r\nfunction addRow(gui, newDom, liBefore) {\r\n  var li = document.createElement('li');\r\n  if (newDom) {\r\n    li.appendChild(newDom);\r\n  }\r\n  if (liBefore) {\r\n    gui.__ul.insertBefore(li, liBefore);\r\n  } else {\r\n    gui.__ul.appendChild(li);\r\n  }\r\n  gui.onResize();\r\n  return li;\r\n}\r\nfunction removeListeners(gui) {\r\n  dom.unbind(window, 'resize', gui.__resizeHandler);\r\n  if (gui.saveToLocalStorageIfPossible) {\r\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\r\n  }\r\n}\r\nfunction markPresetModified(gui, modified) {\r\n  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\r\n  if (modified) {\r\n    opt.innerHTML = opt.value + '*';\r\n  } else {\r\n    opt.innerHTML = opt.value;\r\n  }\r\n}\r\nfunction augmentController(gui, li, controller) {\r\n  controller.__li = li;\r\n  controller.__gui = gui;\r\n  Common.extend(controller,                                   {\r\n    options: function options(_options) {\r\n      if (arguments.length > 1) {\r\n        var nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: nextSibling,\r\n          factoryArgs: [Common.toArray(arguments)]\r\n        });\r\n      }\r\n      if (Common.isArray(_options) || Common.isObject(_options)) {\r\n        var _nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: _nextSibling,\r\n          factoryArgs: [_options]\r\n        });\r\n      }\r\n    },\r\n    name: function name(_name) {\r\n      controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\r\n      return controller;\r\n    },\r\n    listen: function listen() {\r\n      controller.__gui.listen(controller);\r\n      return controller;\r\n    },\r\n    remove: function remove() {\r\n      controller.__gui.remove(controller);\r\n      return controller;\r\n    }\r\n  });\r\n  if (controller instanceof NumberControllerSlider) {\r\n    var box = new NumberControllerBox(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });\r\n    Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function (method) {\r\n      var pc = controller[method];\r\n      var pb = box[method];\r\n      controller[method] = box[method] = function () {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        pb.apply(box, args);\r\n        return pc.apply(controller, args);\r\n      };\r\n    });\r\n    dom.addClass(li, 'has-slider');\r\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\r\n  } else if (controller instanceof NumberControllerBox) {\r\n    var r = function r(returned) {\r\n      if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\r\n        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\r\n        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\r\n        controller.remove();\r\n        var newController = _add(gui, controller.object, controller.property, {\r\n          before: controller.__li.nextElementSibling,\r\n          factoryArgs: [controller.__min, controller.__max, controller.__step]\r\n        });\r\n        newController.name(oldName);\r\n        if (wasListening) newController.listen();\r\n        return newController;\r\n      }\r\n      return returned;\r\n    };\r\n    controller.min = Common.compose(r, controller.min);\r\n    controller.max = Common.compose(r, controller.max);\r\n  } else if (controller instanceof BooleanController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__checkbox, 'click');\r\n    });\r\n    dom.bind(controller.__checkbox, 'click', function (e) {\r\n      e.stopPropagation();\r\n    });\r\n  } else if (controller instanceof FunctionController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__button, 'click');\r\n    });\r\n    dom.bind(li, 'mouseover', function () {\r\n      dom.addClass(controller.__button, 'hover');\r\n    });\r\n    dom.bind(li, 'mouseout', function () {\r\n      dom.removeClass(controller.__button, 'hover');\r\n    });\r\n  } else if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n    controller.updateDisplay = Common.compose(function (val) {\r\n      li.style.borderLeftColor = controller.__color.toString();\r\n      return val;\r\n    }, controller.updateDisplay);\r\n    controller.updateDisplay();\r\n  }\r\n  controller.setValue = Common.compose(function (val) {\r\n    if (gui.getRoot().__preset_select && controller.isModified()) {\r\n      markPresetModified(gui.getRoot(), true);\r\n    }\r\n    return val;\r\n  }, controller.setValue);\r\n}\r\nfunction recallSavedValue(gui, controller) {\r\n  var root = gui.getRoot();\r\n  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\r\n  if (matchedIndex !== -1) {\r\n    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\r\n    if (controllerMap === undefined) {\r\n      controllerMap = {};\r\n      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\r\n    }\r\n    controllerMap[controller.property] = controller;\r\n    if (root.load && root.load.remembered) {\r\n      var presetMap = root.load.remembered;\r\n      var preset = void 0;\r\n      if (presetMap[gui.preset]) {\r\n        preset = presetMap[gui.preset];\r\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\r\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\r\n      } else {\r\n        return;\r\n      }\r\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\r\n        var value = preset[matchedIndex][controller.property];\r\n        controller.initialValue = value;\r\n        controller.setValue(value);\r\n      }\r\n    }\r\n  }\r\n}\r\nfunction _add(gui, object, property, params) {\r\n  var customObject;\r\n  if (object.arguments) {\r\n    customObject = object;\r\n    object = customObject.arguments.object;\r\n    property = customObject.arguments.property;\r\n    params = {\r\n      factoryArgs: customObject.arguments.opts\r\n    };\r\n  }\r\n  if (customObject === undefined && object[property] === undefined) {\r\n    throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\r\n  }\r\n  var controller = void 0;\r\n  if (params.color) {\r\n    controller = new ColorController(object, property);\r\n  } else if (customObject !== undefined && typeof customObject.property === \"string\") {\r\n    controller = customObject;\r\n  } else {\r\n    var factoryArgs = [object, property].concat(params.factoryArgs);\r\n    controller = ControllerFactory.apply(gui, factoryArgs);\r\n  }\r\n  if (controller === null) controller = customObject;else if (customObject !== undefined) customObject.controller = controller;\r\n  if (params.before instanceof Controller) {\r\n    params.before = params.before.__li;\r\n  }\r\n  recallSavedValue(gui, controller);\r\n  dom.addClass(controller.domElement, 'c');\r\n  var name = document.createElement('span');\r\n  dom.addClass(name, 'property-name');\r\n  if (customObject !== undefined && _typeof(customObject.property) === \"object\") {\r\n    for (var propertyName in customObject.property) {\r\n      name.appendChild(customObject.property[propertyName]);\r\n    }\r\n  } else name.innerHTML = controller.property;\r\n  var container = document.createElement('div');\r\n  container.appendChild(name);\r\n  container.appendChild(controller.domElement);\r\n  var li = addRow(gui, container, params.before);\r\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\r\n  if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n  } else {\r\n    dom.addClass(li, _typeof(controller.getValue()));\r\n  }\r\n  augmentController(gui, li, controller);\r\n  gui.__controllers.push(controller);\r\n  return controller;\r\n}\r\nfunction getLocalStorageHash(gui, key) {\r\n  return document.location.href + '.' + key;\r\n}\r\nfunction addPresetOption(gui, name, setSelected) {\r\n  var opt = document.createElement('option');\r\n  opt.innerHTML = name;\r\n  opt.value = name;\r\n  gui.__preset_select.appendChild(opt);\r\n  if (setSelected) {\r\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\r\n  }\r\n}\r\nfunction showHideExplain(gui, explain) {\r\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\r\n}\r\nfunction addSaveMenu(gui) {\r\n  var div = gui.__save_row = document.createElement('li');\r\n  dom.addClass(gui.domElement, 'has-save');\r\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\r\n  dom.addClass(div, 'save-row');\r\n  var gears = document.createElement('span');\r\n  gears.innerHTML = '&nbsp;';\r\n  dom.addClass(gears, 'button gears');\r\n  var button = document.createElement('span');\r\n  button.innerHTML = 'Save';\r\n  dom.addClass(button, 'button');\r\n  dom.addClass(button, 'save');\r\n  var button2 = document.createElement('span');\r\n  button2.innerHTML = 'New';\r\n  dom.addClass(button2, 'button');\r\n  dom.addClass(button2, 'save-as');\r\n  var button3 = document.createElement('span');\r\n  button3.innerHTML = 'Revert';\r\n  dom.addClass(button3, 'button');\r\n  dom.addClass(button3, 'revert');\r\n  var select = gui.__preset_select = document.createElement('select');\r\n  if (gui.load && gui.load.remembered) {\r\n    Common.each(gui.load.remembered, function (value, key) {\r\n      addPresetOption(gui, key, key === gui.preset);\r\n    });\r\n  } else {\r\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\r\n  }\r\n  dom.bind(select, 'change', function () {\r\n    for (var index = 0; index < gui.__preset_select.length; index++) {\r\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\r\n    }\r\n    gui.preset = this.value;\r\n  });\r\n  div.appendChild(select);\r\n  div.appendChild(gears);\r\n  div.appendChild(button);\r\n  div.appendChild(button2);\r\n  div.appendChild(button3);\r\n  if (SUPPORTS_LOCAL_STORAGE) {\r\n    var explain = document.getElementById('dg-local-explain');\r\n    var localStorageCheckBox = document.getElementById('dg-local-storage');\r\n    var saveLocally = document.getElementById('dg-save-locally');\r\n    saveLocally.style.display = 'block';\r\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\r\n      localStorageCheckBox.setAttribute('checked', 'checked');\r\n    }\r\n    showHideExplain(gui, explain);\r\n    dom.bind(localStorageCheckBox, 'change', function () {\r\n      gui.useLocalStorage = !gui.useLocalStorage;\r\n      showHideExplain(gui, explain);\r\n    });\r\n  }\r\n  var newConstructorTextArea = document.getElementById('dg-new-constructor');\r\n  dom.bind(newConstructorTextArea, 'keydown', function (e) {\r\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\r\n      SAVE_DIALOGUE.hide();\r\n    }\r\n  });\r\n  dom.bind(gears, 'click', function () {\r\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\r\n    SAVE_DIALOGUE.show();\r\n    newConstructorTextArea.focus();\r\n    newConstructorTextArea.select();\r\n  });\r\n  dom.bind(button, 'click', function () {\r\n    gui.save();\r\n  });\r\n  dom.bind(button2, 'click', function () {\r\n    var presetName = prompt('Enter a new preset name.');\r\n    if (presetName) {\r\n      gui.saveAs(presetName);\r\n    }\r\n  });\r\n  dom.bind(button3, 'click', function () {\r\n    gui.revert();\r\n  });\r\n}\r\nfunction addResizeHandle(gui) {\r\n  var pmouseX = void 0;\r\n  gui.__resize_handle = document.createElement('div');\r\n  Common.extend(gui.__resize_handle.style, {\r\n    width: '6px',\r\n    marginLeft: '-3px',\r\n    height: '200px',\r\n    cursor: 'ew-resize',\r\n    position: 'absolute'\r\n  });\r\n  function drag(e) {\r\n    e.preventDefault();\r\n    gui.width += pmouseX - e.clientX;\r\n    gui.onResize();\r\n    pmouseX = e.clientX;\r\n    return false;\r\n  }\r\n  function dragStop() {\r\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.unbind(window, 'mousemove', drag);\r\n    dom.unbind(window, 'mouseup', dragStop);\r\n  }\r\n  function dragStart(e) {\r\n    e.preventDefault();\r\n    pmouseX = e.clientX;\r\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.bind(window, 'mousemove', drag);\r\n    dom.bind(window, 'mouseup', dragStop);\r\n    return false;\r\n  }\r\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\r\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\r\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\r\n}\r\nfunction setWidth(gui, w) {\r\n  gui.domElement.style.width = w + 'px';\r\n  if (gui.__save_row && gui.autoPlace) {\r\n    gui.__save_row.style.width = w + 'px';\r\n  }\r\n  if (gui.__closeButton) {\r\n    gui.__closeButton.style.width = w + 'px';\r\n  }\r\n}\r\nfunction getCurrentPreset(gui, useInitialValues) {\r\n  var toReturn = {};\r\n  Common.each(gui.__rememberedObjects, function (val, index) {\r\n    var savedValues = {};\r\n    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\r\n    Common.each(controllerMap, function (controller, property) {\r\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\r\n    });\r\n    toReturn[index] = savedValues;\r\n  });\r\n  return toReturn;\r\n}\r\nfunction setPresetSelectIndex(gui) {\r\n  for (var index = 0; index < gui.__preset_select.length; index++) {\r\n    if (gui.__preset_select[index].value === gui.preset) {\r\n      gui.__preset_select.selectedIndex = index;\r\n    }\r\n  }\r\n}\r\nfunction updateDisplays(controllerArray) {\r\n  if (controllerArray.length !== 0) {\r\n    requestAnimationFrame$1.call(window, function () {\r\n      updateDisplays(controllerArray);\r\n    });\r\n  }\r\n  Common.each(controllerArray, function (c) {\r\n    c.updateDisplay();\r\n  });\r\n}\r\n\r\nvar color = {\r\n  Color: Color,\r\n  math: ColorMath,\r\n  interpret: interpret\r\n};\r\nvar controllers = {\r\n  Controller: Controller,\r\n  BooleanController: BooleanController,\r\n  OptionController: OptionController,\r\n  StringController: StringController,\r\n  NumberController: NumberController,\r\n  NumberControllerBox: NumberControllerBox,\r\n  NumberControllerSlider: NumberControllerSlider,\r\n  FunctionController: FunctionController,\r\n  ColorController: ColorController,\r\n  CustomController: CustomController\r\n};\r\nvar dom$1 = { dom: dom };\r\nvar gui = { GUI: GUI };\r\nvar GUI$1 = GUI;\r\nvar index = {\r\n  color: color,\r\n  controllers: controllers,\r\n  dom: dom$1,\r\n  gui: gui,\r\n  GUI: GUI$1\r\n};\r\n\r\nexport { color, controllers, dom$1 as dom, gui, GUI$1 as GUI };\r\nexport default index;\r\n//# sourceMappingURL=dat.gui.module.js.map\r\n","/**\r\n * get position functions library\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n * \r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport three from './three.js'\r\n\r\n/**\r\n * gets the position from the geometry.attributes.position of the object.\r\n * @param {THREE.Mesh} object\r\n * @param {number} index index of position in the object.geometry.attributes.position\r\n * @returns position\r\n */\r\nexport function getObjectLocalPosition( object, index ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\tconst attributesPosition = object.geometry.attributes.position,\r\n\t\tposition = attributesPosition.itemSize >= 4 ? new THREE.Vector4( 0, 0, 0, 0 ) : new THREE.Vector3();\r\n\tposition.fromArray( attributesPosition.array, index * attributesPosition.itemSize );\r\n\treturn position;\r\n\r\n}\r\n\r\n/**\r\n * gets position of the vector in world coordinates, taking into account the position, scale and rotation of the 3D object\r\n * @param {THREE.Object3D} object\r\n * @param {THREE.Vector3} pos local position\r\n * @returns world position \r\n */\r\nexport function getWorldPosition( object, pos ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\tvar position = pos.clone();\r\n\r\n\t/*\r\n\t\t//https://stackoverflow.com/questions/11495089/how-to-get-the-absolute-position-of-a-vertex-in-three-js\r\n\t\t//Неудачная попытка вычислить абсолютную позицию точки\r\n\t\tobject.updateMatrixWorld();\r\n\t\tposition.applyMatrix4( object.matrixWorld );\r\n\t*/\r\n\tfunction getPosition( object, pos ) {\r\n\r\n\t\tvar position = new THREE.Vector3(),\r\n\t\t\tpositionAngle = new THREE.Vector3();\r\n\t\tposition = pos.clone();\r\n\t\tposition.multiply( object.scale );\r\n\r\n\t\t//rotation\r\n\t\tpositionAngle.copy( position );\r\n\t\tpositionAngle.applyEuler( object.rotation );\r\n\t\tposition.x = positionAngle.x;\r\n\t\tposition.y = positionAngle.y;\r\n\t\tposition.z = positionAngle.z;\r\n\r\n\t\tposition.add( object.position );\r\n\t\treturn position;\r\n\r\n\t}\r\n\tdo {\r\n\r\n\t\tposition = getPosition( object, position );\r\n\t\tobject = object.parent;\r\n\r\n\t} while ( object && object.parent );\r\n\treturn position;\r\n\r\n}\r\n\r\n/**\r\n * gets the position from the geometry.attributes.position of the object in world coordinates.\r\n * @param {THREE.Mesh} object\r\n * @param {number} index index of position in the object.geometry.attributes.position\r\n * @returns position\r\n */\r\nexport function getObjectPosition( object, index ) {\r\n\r\n\tif ( index === -1 )\r\n\t\treturn undefined;\r\n\tif ( index === undefined )\r\n\t\treturn object.position;\r\n\treturn getWorldPosition( object, getObjectLocalPosition( object, index ) )\r\n\r\n}\r\n\r\n","var WEBGL = {\r\n\r\n\tisWebGLAvailable: function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\treturn !! ( window.WebGLRenderingContext && ( canvas.getContext( 'webgl' ) || canvas.getContext( 'experimental-webgl' ) ) );\r\n\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tisWebGL2Available: function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\treturn !! ( window.WebGL2RenderingContext && canvas.getContext( 'webgl2' ) );\r\n\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetWebGLErrorMessage: function () {\r\n\r\n\t\treturn this.getErrorMessage( 1 );\r\n\r\n\t},\r\n\r\n\tgetWebGL2ErrorMessage: function () {\r\n\r\n\t\treturn this.getErrorMessage( 2 );\r\n\r\n\t},\r\n\r\n\tgetErrorMessage: function ( version ) {\r\n\r\n\t\tvar names = {\r\n\t\t\t1: 'WebGL',\r\n\t\t\t2: 'WebGL 2'\r\n\t\t};\r\n\r\n\t\tvar contexts = {\r\n\t\t\t1: window.WebGLRenderingContext,\r\n\t\t\t2: window.WebGL2RenderingContext\r\n\t\t};\r\n\r\n\t\tvar message = 'Your $0 does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000\">$1</a>';\r\n\r\n\t\tvar element = document.createElement( 'div' );\r\n\t\telement.id = 'webglmessage';\r\n\t\telement.style.fontFamily = 'monospace';\r\n\t\telement.style.fontSize = '13px';\r\n\t\telement.style.fontWeight = 'normal';\r\n\t\telement.style.textAlign = 'center';\r\n\t\telement.style.background = '#fff';\r\n\t\telement.style.color = '#000';\r\n\t\telement.style.padding = '1.5em';\r\n\t\telement.style.width = '400px';\r\n\t\telement.style.margin = '5em auto 0';\r\n\r\n\t\tif ( contexts[ version ] ) {\r\n\r\n\t\t\tmessage = message.replace( '$0', 'graphics card' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmessage = message.replace( '$0', 'browser' );\r\n\r\n\t\t}\r\n\r\n\t\tmessage = message.replace( '$1', names[ version ] );\r\n\r\n\t\telement.innerHTML = message;\r\n\r\n\t\treturn element;\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { WEBGL };\r\n","﻿/**\r\n * node.js version of the synchronous download of the file.\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//The myRequest is cross-browser XMLHttpRequest wrapper.\r\nfunction myRequest( options ) {\r\n\r\n\tthis.loadXMLDoc = function () {\r\n\t\tvar req;\r\n\r\n\t\tif ( window.XMLHttpRequest ) {\r\n\t\t\treq = new XMLHttpRequest();\r\n\t\t\tif ( !req )\r\n\t\t\t\tthrow \"new XMLHttpRequest() failed!\"\r\n\t\t}\r\n\t\telse if ( window.ActiveXObject ) {\r\n\t\t\treq = this.NewActiveXObject();\r\n\t\t\tif ( !req )\r\n\t\t\t\tthrow \"NewActiveXObject() failed!\"\r\n\t\t}\r\n\t\telse throw \"myRequest.loadXMLDoc(...) failed!\";\r\n\t\treturn req;\r\n\t}\r\n\r\n\tthis.NewActiveXObject = function () {\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP.6.0\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP.3.0\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Microsoft.XMLHTTP\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\tErrorMessage( 'This browser does not support XMLHttpRequest. Probably, your security settings do not allow Web sites to use ActiveX controls installed on your computer. Refresh your Web page to find out the current status of your Web page or enable the \"Initialize and script ActiveX controls not marked as safe\" and \"Run Active X controls and plug-ins\" of the Security settings of the Internet zone of your browser.' );\r\n\t\treturn null;\r\n\t}\r\n\r\n\tthis.XMLHttpRequestStart = function ( onreadystatechange, async ) {\r\n\r\n\t\tthis.XMLHttpRequestStop();//For compatibility with IE Windows Phone\r\n\r\n\t\tthis.req.onreadystatechange = onreadystatechange;\r\n\r\n\t\t//ATTENTION!!! do not works in IE\r\n\t\tif ( \"onerror\" in this.req ) {\r\n\t\t\tthis.req.onerror = function ( event ) {\r\n\t\t\t\tErrorMessage( \"XMLHttpRequest error. url: \" + this.url, false, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.XMLHttpRequestReStart( async );\r\n\t}\r\n\r\n\tthis.getUrl = function () {\r\n\t\tif ( ( typeof this.url == 'undefined' ) || ( this.url == null ) ) {\r\n\t\t\tthis.url = \"XMLHttpRequest.xml\";\r\n\t\t}\r\n\t\treturn this.url + ( this.params ? this.params : \"\" );\r\n\t}\r\n\r\n\tthis.XMLHttpRequestReStart = function ( async ) {\r\n\t\ttry {\r\n\t\t\tif ( typeof async == 'undefined' )\r\n\t\t\t\tasync = true;\r\n\t\t\tthis.req.open( \"GET\", this.getUrl(), async );\r\n\t\t\tif ( async ) {\r\n\t\t\t\tvar timeout = ( 60 + 30 ) * 1000;//Внимание!!! Задержка должна быть больше CSocketWaitEvent::WaitResponse\r\n\t\t\t\tif ( \"timeout\" in this.req )//for IE6\r\n\t\t\t\t\tthis.req.timeout = timeout;\r\n\t\t\t\tif ( \"ontimeout\" in this.req )\r\n\t\t\t\t\tthis.req.ontimeout = function () {\r\n\t\t\t\t\t\tErrorMessage( 'XMLHttpRequest timeout', false, false );\r\n\t\t\t\t\t}\r\n\t\t\t\telse {//for Safari, IE6\r\n\t\t\t\t\tclearTimeout( this.timeout_id_SendReq );\r\n\t\t\t\t\tthis.timeout_id_SendReq = setTimeout( function () {\r\n\t\t\t\t\t\tErrorMessage( 'XMLHttpRequest timeout 2', false, false );\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t, timeout );\r\n\t\t\t\t\t//console.log(\"setTimeout this.req.timeout_id_SendReq = \" + this.req.timeout_id_SendReq);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.req.send( null );\r\n\t\t} catch ( e ) {\r\n\t\t\tErrorMessage( e.message + \" url: \" + this.url, false, false );\r\n\t\t}\r\n\t}\r\n\r\n\tthis.XMLHttpRequestStop = function () {\r\n\t\t//console.log(\"XMLHttpRequestStop(...)\");\r\n\t\tif ( this.req == null )\r\n\t\t\treturn;\r\n\t\tthis.req.abort();\r\n\t}\r\n\r\n\tthis.ProcessReqChange = function ( processStatus200 ) {\r\n\t\tvar req = this.req;\r\n\t\tif ( ( typeof isIE === 'undefined' ) || !isIE ) {\r\n\t\t\t//\tconsole.log(\"processReqChange(); req.statusText: \" + req.statusText + \". req.status = \" + req.status + \". req.readyState = \" + req.readyState + \". req.responseText: \" + req.responseText);\r\n\t\t}\r\n\t\t// only if req shows \"complete\"\r\n\t\t//http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp\r\n\t\t//http://xmlhttprequest.ru/w3c\r\n\t\tswitch ( req.readyState ) {\r\n\t\t\tcase 4://request finished and response is ready\r\n\t\t\t\t{\r\n\t\t\t\t\tif ( typeof req.status == \"unknown\" ) {//IE5 timeout\r\n\t\t\t\t\t\tconsoleError( 'typeof XMLHttpRequest status == \"unknown\"' );\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//Я не могу вставлять switch один в другой\r\n\t\t\t\t\tif ( req.status == 200 )//OK)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclearTimeout( this.timeout_id_SendReq );\r\n\t\t\t\t\t\treturn processStatus200( this );\r\n\t\t\t\t\t}//200://OK\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tErrorMessage( \"Invalid XMLHttpRequest status : \" + req.status + \" url: \" + this.url );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1://server connection established\r\n\t\t\tcase 2://request received\r\n\t\t\tcase 3://processing request\r\n\t\t\t\tbreak;\r\n\t\t\t//\t\tcase 404:\r\n\t\t\tcase 0://request not initialized\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"processReqChange(); req.readyState = \" + req.readyState;\r\n\t\t\t\tbreak;\r\n\t\t}//switch(req.readyState)\r\n\t\treturn true;\r\n\t}\r\n\r\n\tthis.processStatus200Error = function () {\r\n\t\tvar error = this.GetElementText( 'error', true );\r\n\t\tif ( error ) {\r\n\t\t\tErrorMessage( error );\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tthis.GetElementText = function ( tagName, noDisplayErrorMessage ) {\r\n\t\tvar xmlhttp = this.req;\r\n\t\tif ( !xmlhttp.responseXML ) {\r\n\t\t\tif ( noDisplayErrorMessage != true )\r\n\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, ' + tagName + '); xmlhttp.responseXML is null.\\nxmlhttp.responseText:\\n' + xmlhttp.responseText );\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar element = xmlhttp.responseXML.getElementsByTagName( tagName );\r\n\r\n\t\t//ATTENTION!!! For IE set the content-type m_HttpResponse.SetContentType(\"text/xml\");\r\n\r\n\t\tif ( element.length == 0 ) {\r\n\t\t\tif ( noDisplayErrorMessage != true )\r\n\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, \"' + tagName + '\"); element.length == ' + element.length );\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tvar text = \"\";\r\n\t\tfor ( var i = 0; i < element.length; i++ ) {\r\n\t\t\tif ( typeof ( element[i].textContent ) == 'undefined' ) {\r\n\t\t\t\tif ( typeof ( element[i].text ) == 'undefined' ) {\r\n\t\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, ' + tagName + '); element[' + i + '].text) == undefined' );\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t\tif ( text != \"\" )\r\n\t\t\t\t\ttext += \" \";\r\n\t\t\t\ttext += element[i].text;//IE\r\n\t\t\t}\r\n\t\t\telse text += element[i].textContent;//Chrome\r\n\t\t}\r\n\t\treturn text;\r\n\t}\r\n\r\n\tif ( options.data ) {\r\n\t\tthis.req = options.data.req;\r\n\t\tthis.url = options.data.url;\r\n\t\tthis.params = options.data.params;\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tthis.req = this.loadXMLDoc();\r\n\t\t} catch ( e ) {\r\n\t\t\tvar message;\r\n\t\t\tif ( typeof e.message == 'undefined' )\r\n\t\t\t\tmessage = e;\r\n\t\t\telse message = e.message;\r\n\t\t\tErrorMessage( \"Your browser is too old and is not compatible with our site.\\n\\n\"\r\n\t\t\t\t+ window.navigator.appName + \" \" + window.navigator.appVersion + \"\\n\\n\" + message );\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif ( !this.req ) {\r\n\t\tconsoleError( \"Invalid myRequest.req: \" + this.req );\r\n\t\treturn;\r\n\t}\r\n\r\n\tfunction ErrorMessage( error ) {\r\n\r\n\t\tconsole.error( error );\r\n\t\toptions.onerror( error );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @callback onerror\r\n * @param {string} str - error details\r\n */\r\n\r\n/**\r\n * Synchronous load file\r\n * @param {string} url URL of an external file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured. Optional.\r\n * @returns {string} file content\r\n * @example\r\n * \r\n\t//Simplest example.\r\n\tdocument.getElementById( \"elID\" ).innerHTML = loadFile.sync('element.html');\r\n *\r\n * @example\r\n *\r\n\t//onload, onerror events.\r\n\tdocument.getElementById( \"elID\").innerHTML = loadFile.sync( 'element.html',\r\n\t{\r\n\t\tonload: function ( response ) {\r\n\r\n\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\tconsole.log( str );\r\n\r\n\t\t},\r\n\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\tconsole.error( str );\r\n\r\n\t\t},\r\n\t}, );\r\n */\r\nfunction sync( url, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.onload = options.onload || function () { };\r\n\toptions.onerror = options.onerror || function () { };\r\n\r\n\tvar response,\r\n\t\trequest = new myRequest( options );\r\n\trequest.url = url;\r\n\trequest.XMLHttpRequestStart(\r\n\r\n\t\tfunction () {//onreadystatechange\r\n\r\n\t\t\trequest.ProcessReqChange( function ( myRequest ) {//processStatus200\r\n\r\n\t\t\t\tif ( myRequest.processStatus200Error() )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tresponse = myRequest.req.responseText;\r\n\t\t\t\t//console.log( 'loadFile.sync.onload() ' + url );\r\n\t\t\t\toptions.onload( response, url );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\t, false//Synchronous mode\r\n\r\n\t);\r\n\t//console.log( 'sync(' + url + ')' );\r\n\treturn response;\r\n\r\n}\r\n\r\n/**\r\n * display a text to HTML\r\n * @param {string} str source text\r\n * @returns {string} escaped text\r\n */\r\nfunction escapeHtml( str ) {\r\n\r\n\treturn str.replace( /[&<>\"'\\/]/g, function ( s ) {\r\n\r\n\t\tvar entityMap = {\r\n\r\n\t\t\t\"&\": \"&amp;\",\r\n\t\t\t\"<\": \"&lt;\",\r\n\t\t\t\">\": \"&gt;\",\r\n\t\t\t'\"': '&quot;',\r\n\t\t\t\"'\": '&#39;',\r\n\t\t\t\"/\": '&#x2F;'\r\n\r\n\t\t};\r\n\r\n\t\treturn entityMap[s];\r\n\r\n\t} );\r\n}\r\n\r\nexport { sync, escapeHtml };\r\n","/**\r\n * node.js version of the load JavaScript file\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Thanks to:\r\n *http://javascript.ru/forum/events/21439-dinamicheskaya-zagruzka-skriptov.html\r\n *https://learn.javascript.ru/onload-onerror\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//Please download https://github.com/anhr/loadFileNodeJS into ../loadFileNodeJS folder\r\nimport { sync as loadFileSync, escapeHtml } from '../loadFileNodeJS/index.js';\r\n\r\n/**\r\n * @callback onerror\r\n * @param {string} str - error details\r\n */\r\n\r\n/**\r\n * Synchronous load JavaScript file\r\n * @param {string} src URL of an external script file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured. Optional.\r\n * @param {string}[options.appendTo] The node to which the new script will be append. Optional. Default is head node\r\n * @param {Object|string}[options.tag] The script's tag attributes (Object) or tag type (string). Optional.\r\n * Available tag types:\r\n *\t'style' - load a style file (.css extension)\r\n * @param {string} [options.tag.name] tag name. Default is 'script'\r\n * @param {Object} [options.tag.attribute] tag attribute. Optional.\r\n * @param {string} options.tag.attribute.name attribute name. Default is 'type'\r\n * @param {string} options.tag.attribute.value attribute value. Default is 'text/javascript'\r\n *\r\n * @example\r\n * \r\n\t//Simplest example. Append script into head node.\r\n\tloadScript.sync( 'sync.js' );\r\n\r\n * @example\r\n * \r\n\t//onload, onerror events. Append script into \"appendto\" element\r\n\tloadScript.sync( 'sync.js',\r\n\t\t{\r\n\t\t\tonload: function ( response ) {\r\n\r\n\t\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\t\tconsole.log( str );\r\n\r\n\t\t\t},\r\n\t\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\t\telSync2Res.style.color = 'red';\r\n\r\n\t\t\t},\r\n\t\t\tappendTo: document.getElementById( \"appendto\" ),\r\n\t\t},\r\n\t);\r\n *\r\n * @example\r\n *\r\n\t//Append style into head node.\r\n\tloadScript.sync( \"controls.css\",\r\n\t{\r\n\t\t//style rel=\"stylesheet\"\r\n\t\ttag: {\r\n\r\n\t\t\tname: 'style',\r\n\t\t\tattribute: {\r\n\r\n\t\t\t\tname: 'rel',\r\n\t\t\t\tvalue: 'stylesheet',\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n */\r\nfunction sync( src, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.onload = options.onload || function () { };\r\n\toptions.onerror = options.onerror || function () { };\r\n\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[0];\r\n\r\n\tif ( isScriptExists( options.appendTo, src ) ) {\r\n\r\n\t\t//options.onerror( 'duplicate downloading of the ' + src + ' file' );\r\n\t\toptions.onload();\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tif ( src instanceof Array ) {\r\n\r\n\t\tvar error,\r\n\t\t\toptionsItem = {\r\n\r\n\t\t\t\tappendTo: options.appendTo,\r\n\t\t\t\ttag: options.tag,\r\n\t\t\t\tonload: function ( response, url ) {\r\n\t\t\t\t\r\n\t\t\t\t\tconsole.log( 'loadScript.sync.onload: ' + url );\r\n\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tonerror: function ( str ) {\r\n\r\n\t\t\t\t\toptions.onerror( str );\r\n\t\t\t\t\terror = str;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t};\r\n\t\tfor ( var i = 0; i < src.length; i++ ) {\r\n\r\n\t\t\tvar item = src[ i ];\r\n\t\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\t\tscript.setAttribute( \"id\", item );\r\n\t\t\t\tscript.innerHTML = loadFileSync( item, optionsItem );\r\n\r\n\t\t\t}, optionsItem );\r\n\t\t\tif ( error !== undefined )\r\n\t\t\t\tbreak;\r\n\r\n\t\t};\r\n\t\tif ( error === undefined )\r\n\t\t\toptions.onload();\r\n\r\n\t} else loadScriptBase( function ( script ) {\r\n\r\n\t\tscript.setAttribute( \"id\", src );\r\n\t\tscript.innerHTML = loadFileSync( src, options );\r\n\r\n\t}, options );\r\n\r\n}\r\n\r\n/**\r\n * @callback onerrorasync\r\n * @param {string} str - error details\r\n * @param {Object} e - event\r\n */\r\n\r\n/**\r\n * Asynchronous load JavaScript file\r\n * @param {string|string[]} src URL of an external script file or array of the script file names.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerrorasync} [options.onerror] function ( str, e ) The onerror event occurs when an error has been occured. Optional.\r\n * @param {string}[options.appendTo] The node to which the new script will be append. Optional. Default is head node\r\n * @param {Object}[options.tag] The script's tag attributes. Optional.\r\n * @param {string} options.tag.name tag name. Default is 'script'\r\n * @param {Object} [options.tag.attribute] tag attribute. Optional.\r\n * @param {string} options.tag.attribute.name attribute name. Default is 'type'\r\n * @param {string} options.tag.attribute.value attribute value. Default is 'text/javascript'\r\n*\r\n * @example\r\n * \r\n\t//Simplest example. Append script into head node.\r\n\tloadScript.async( \"JavaScript.js);\r\n * \r\n * @example\r\n *\r\n\t//onload, onerror events. Append script into \"appendto\" element\r\n\tloadScript.async( \"JavaScript.js\",\r\n\t{\r\n \t\tonload: function () {\r\n \r\n \t\t\tvar str = 'file has been loaded successfully';\r\n \t\t\tconsole.log( str );\r\n \r\n \t\t},\r\n \t\tonerror: function ( str, e ) {\r\n \r\n \t\t\tconsole.error( str );\r\n \r\n \t\t},\r\n \t\tappendTo: document.getElementById( \"appendto\" ),\r\n \r\n \t}\r\n \r\n  );\r\n *\r\n * @example\r\n *\r\n\t//loading of array of JavaScript files. Append script into head node.\r\n\tloadScript.async( [\r\n \t\t\"JavaScript1.js\",\r\n \t\t\"JavaScript2.js\",\r\n \t],\r\n \t{\r\n \t\tonload: function () {\r\n \r\n \t\t\tvar str = 'file has been loaded successfully';\r\n \t\t\tconsole.log( str );\r\n \r\n \t\t},\r\n \t\tonerror: function ( str, e ) {\r\n \r\n \t\t\tconsole.error( str );\r\n \r\n \t\t},\r\n \r\n \t}\r\n \r\n  );\r\n */\r\nfunction async( src, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[ 0 ];\r\n\toptions.onload = options.onload || function () {};\r\n\r\n\tvar isrc;\r\n\r\n\tfunction async( srcAsync ) {\r\n\r\n\t\tfunction next() {\r\n\r\n\t\t\tif ( src instanceof Array && ( isrc < ( src.length - 1 ) ) ) {\r\n\r\n\t\t\t\tisrc++;\r\n\t\t\t\tasync( src[isrc] );\r\n\r\n\t\t\t} else options.onload();\r\n\r\n\t\t}\r\n\r\n\t\tif ( isScriptExists( options.appendTo, srcAsync, options.onload ) ) {\r\n\r\n\t\t\tnext();\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\tscript.setAttribute( \"id\", srcAsync );\r\n\r\n\t\t\tfunction _onload() {\r\n\r\n\t\t\t\tconsole.log( 'loadScript.async.onload() ' + srcAsync );\r\n\t\t\t\tif ( options.onload !== undefined ) {\r\n\r\n\t\t\t\t\tnext();\r\n/*\r\n\t\t\t\t\tif ( src instanceof Array && ( isrc < ( src.length - 1 ) ) ) {\r\n\r\n\t\t\t\t\t\tisrc++;\r\n\t\t\t\t\t\tasync( src[isrc] );\r\n\r\n\t\t\t\t\t} else options.onload();\r\n*/\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( script.readyState && ! script.onload ) {\r\n\r\n\t\t\t\t// IE, Opera\r\n\t\t\t\tscript.onreadystatechange = function () {\r\n\r\n\t\t\t\t\tif ( script.readyState == \"complete\" ) {\r\n\r\n\t\t\t\t\t\t// �� ������ �������� loaded\r\n\t\t\t\t\t\tif ( options.onload !== undefined ) options.onload(); // (2)\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( script.readyState == \"loaded\" ) {\r\n\r\n\t\t\t\t\t\tsetTimeout( options.onload, 0 ); // (1)\r\n\r\n\t\t\t\t\t\t// ������� ����������, ����� �� �������� �� complete\r\n\t\t\t\t\t\tthis.onreadystatechange = null;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Rest\r\n\t\t\t\tscript.onload = _onload;\r\n\r\n\t\t\t\tscript.onerror = function ( e ) {\r\n\r\n\t\t\t\t\tvar str = 'loadScript: \"' + this.src + '\" failed';\r\n\t\t\t\t\tif ( options.onerror !== undefined )\r\n\t\t\t\t\t\toptions.onerror( str, e );\r\n\t\t\t\t\tconsole.error( str );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscript.src = srcAsync;\r\n\r\n\t\t}, options );\r\n\r\n\t}\r\n\r\n\tif ( src instanceof Array ) {\r\n\r\n\t\tisrc = 0;\r\n\t\tasync( src[ isrc ] );\r\n\r\n\t} else async( src );\r\n\r\n}\r\n\r\nfunction loadScriptBase( callback, options ) {\r\n\r\n\toptions.tag = options.tag || {};\r\n\tif ( typeof options.tag === \"string\" ) {\r\n\r\n\t\tswitch ( options.tag ) {\r\n\r\n\t\t\tcase 'style':\r\n\t\t\t\toptions.tag = {\r\n\r\n\t\t\t\t\tname: 'style',\r\n\t\t\t\t\tattribute: {\r\n\r\n\t\t\t\t\t\tname: 'rel',\r\n\t\t\t\t\t\tvalue: 'stylesheet',\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: console.error( 'Invalid options.tag: ' + options.tag );\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toptions.tag.name = options.tag.name || 'script';\r\n\tvar script = document.createElement( options.tag.name );\r\n\r\n\toptions.tag.attribute = options.tag.attribute || {};\r\n\toptions.tag.attribute.name = options.tag.attribute.name || \"type\";\r\n\toptions.tag.attribute.value = options.tag.attribute.value || 'text/javascript';\r\n\tscript.setAttribute( options.tag.attribute.name, options.tag.attribute.value );\r\n\r\n\tcallback( script );\r\n\toptions.appendTo.appendChild( script );\r\n\r\n}\r\n\r\nfunction isScriptExists( elParent, srcAsync, onload ) {\r\n\r\n\tvar scripts = elParent.querySelectorAll( 'script' );\r\n\tfor ( var i = 0; i < scripts.length; i++ ) {\r\n\r\n\t\tvar child = scripts[i];\r\n\t\tif ( child.id === srcAsync ) {\r\n\r\n/*\r\n\t\t\tif ( onload !== undefined )\r\n\t\t\t\tonload();\r\n*/\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\treturn false;\r\n\r\n}\r\n\r\nexport { async, sync, escapeHtml };\r\n","﻿/**\r\n * node.js version of download of the scripts.\r\n * \r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport { sync, async } from './index.js';\r\n\r\nvar loadScript = {\r\n\r\n\tsync: sync,\r\n\tasync: async,\r\n\r\n}\r\nexport default loadScript;\r\n","/**\r\n * @module ColorPicker\r\n * @description Pure JavaScript color picker.\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Thanks to https://github.com/DavidDurman/FlexiColorPicker\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n */\r\n\r\n\r\nimport loadScript from '../loadScriptNodeJS/loadScript.js';\r\n//import loadScript from 'https://raw.githack.com/anhr/commonNodeJS/master/loadScriptNodeJS/loadScript.js';\r\n//import loadScript from 'http://localhost/anhr/commonNodeJS/master/loadScriptNodeJS/loadScript.js';\r\n\r\nimport three from '../three.js'\r\n\r\nconst optionsStyle = {\r\n\r\n\t//style rel=\"stylesheet\"\r\n\ttag: 'style'\r\n\r\n}\r\n\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\n//Такая же функция есть в frustumPoints.js но если ее использовать то она будет возвращать путь на frustumPoints.js\r\nconst getCurrentScript = function () {\r\n\r\n\tif ( document.currentScript && ( document.currentScript.src !== '' ) )\r\n\t\treturn document.currentScript.src;\r\n\tconst scripts = document.getElementsByTagName( 'script' ),\r\n\t\tstr = scripts[scripts.length - 1].src;\r\n\tif ( str !== '' )\r\n\t\treturn src;\r\n\t//Thanks to https://stackoverflow.com/a/42594856/5175935\r\n\treturn new Error().stack.match( /(https?:[^:]*)/ )[0];\r\n\r\n};\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\nconst getCurrentScriptPath = function () {\r\n\tconst script = getCurrentScript(),\r\n\t\tpath = script.substring( 0, script.lastIndexOf( '/' ) );\r\n\treturn path;\r\n};\r\n//console.warn( 'getCurrentScriptPath = ' + getCurrentScriptPath() );\r\nconst currentScriptPath = getCurrentScriptPath();\r\n\r\n//loadScript.sync( 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.css', optionsStyle );\r\nloadScript.sync( currentScriptPath + '/colorpicker.css', optionsStyle );\r\n\r\nconst type = ( window.SVGAngle || document.implementation.hasFeature( \"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\" ) ? \"SVG\" : \"VML\" ),\r\n\tsvgNS = 'http://www.w3.org/2000/svg';\r\nvar uniqID = 0;\r\n\r\nclass ColorPicker {\r\n\r\n\t/**Pure JavaScript color picker.\r\n\t * @class\r\n\t * @see [FlexiColorPicker]{@link https://github.com/DavidDurman/FlexiColorPicker}\r\n\t * */\r\n\tconstructor() {\r\n\r\n\t\tconst _this = this;\r\n\t\t/**\r\n\t\t * enumeration of available palettes.\r\n\t\t * @readonly\r\n\t\t * @enum {number}\r\n\t\t */\r\n\t\tthis.paletteIndexes = {\r\n\r\n\t\t\t/** <a href=\"../Example/index.html#BGYW\" target=\"_blank\">blue, green, yellow, white</a> palette. This is the default palette*/\r\n\t\t\tBGYW: 0,\r\n\t\t\t/** <a href=\"../Example/index.html#Monochrome\" target=\"_blank\">monochrome</a> palette */\r\n\t\t\tmonochrome: 1,\r\n\t\t\t/** <a href=\"../Example/index.html#Bidirectional\" target=\"_blank\">red, black, green</a> palette */\r\n\t\t\tbidirectional: 2,//\r\n\t\t\t/** <a href=\"../Example/index.html#rainbow\" target=\"_blank\">rainbow</a> palette */\r\n\t\t\trainbow: 3,\r\n\r\n\t\t}\r\n\r\n\t\tfunction CreateSVGElement( el, attrs, children ) {\r\n\r\n\t\t\tel = document.createElementNS( svgNS, el );\r\n\t\t\tfor ( var key in attrs )\r\n\t\t\t\tel.setAttribute( key, attrs[key] );\r\n\t\t\tif ( Object.prototype.toString.call( children ) != '[object Array]' ) children = [children];\r\n\t\t\tvar i = 0, len = ( children[0] && children.length ) || 0;\r\n\t\t\tfor ( ; i < len; i++ )\r\n\t\t\t\tel.appendChild( children[i] );\r\n\t\t\treturn el;\r\n\t\t}\r\n\r\n\t\tvar boCreated = false;\r\n\t\t/**\r\n\t\t * @callback callback\r\n\t\t * @description Called whenever the color is changed provided chosen color in RGB HEX format. See options.sliderIndicator.callback param of the create method.\r\n\t\t * @param {object} c color\r\n\t\t * @param {string} c.hex A hexadecimal color is specified with: #RRGGBB, where the RR (red), GG (green) and BB (blue)\r\n\t\t * <pre>\r\n\t\t * hexadecimal integers specify the components of the color. All values must be between 00 and FF.\r\n\t\t * Example #00ff00\r\n\t\t * </pre>\r\n\t\t * @param {number} c.r red of RGB color value. Must be between 0 and 255.\r\n\t\t * @param {number} c.g green of RGB color value. Must be between 0 and 255.\r\n\t\t * @param {number} c.b blue of RGB color value. Must be between 0 and 255.\r\n\t\t * @param {number} percent position of the mouse pointer in the percents. See details in options.direction param\r\n\t\t */\r\n\r\n\t\t/**\r\n\t\t * @callback onError\r\n\t\t * @param {string} message error message\r\n\t\t */\r\n\r\n\t\t/**\r\n\t\t * creates an instance of ColorPicker\r\n\t\t * @param {string|HTMLElement} elSliderWrapper id of the ColorPicker element or ColorPicker element\r\n\t\t * @param {object} [options] followed options is availablee\r\n\t\t * @param {paletteIndexes|object[]|Palette} [options.palette] Palette index or palette array or Palette. The following indexes are available:\r\n\t\t * <pre>\r\n\t\t * paletteIndexes.BGYW: 0 - blue, green, red, white palette.\r\n\t\t * paletteIndexes.monochrome: 1,\r\n\t\t * paletteIndexes.bidirectional: 2,//red, black, green\r\n\t\t * paletteIndexes.rainbow: 3,\r\n\t\t * Default is paletteIndexes.BGYW index.\r\n\t\t * Example of palette array:\r\n\t\t[\r\n\t\t\t{ percent: 0, r: 0, g: 0, b: 0, },\r\n\t\t\t{ percent: 10, r: 0xff, g: 255, b: 0xff, },\r\n\t\t\t{ percent: 100, r: 0xff, g: 255, b: 0xff, },\r\n\t\t]\r\n\t\t * Palette see function Palette( options ) for details\r\n\t\t * </pre>\r\n\t\t * @param {object} [options.orientation] orientation of the element. Available \"horizontal\" or \"vertical\" orientation\r\n\t\t * @param {object} [options.direction] true - position of the mouse pointer relative left side for 'horizontal' slider\r\n\t\t * or bottom side for 'vertical' slider in the percents.\r\n\t\t * <p>\r\n\t\t * false - position of the mouse pointer relative right side for 'horizontal' slider\r\n\t\t * or relative top side for 'vertical' slider in the percents.\r\n\t\t * </p>\r\n\t\t * Default is true.\r\n\t\t * @param {object} [options.style] style statements\r\n\t\t * @param {object} [options.style.width] width of the element. Default is 200px for options.orientation = \"horizontal\"\r\n\t\t * and 30px for options.orientation = \"vertical\".\r\n\t\t * @param {object} [options.style.height] height of the element. Default is 30px for options.orientation = \"horizontal\"\r\n\t\t * and 200px for options.orientation = \"vertical\".\r\n\t\t * @param {string} [options.style.border] elSliderWrapper border. Example: '1px solid black'\r\n\t\t * @param {object} [options.sliderIndicator] adds a slider-indicator element for choose by mouse a color from palette.\r\n\t\t * Default is undefuned\r\n\t\t * @param {callback} [options.sliderIndicator.callback] Called whenever the color is changed provided chosen color in RGB HEX format.\r\n\t\t * @param {number} [options.sliderIndicator.value] Initial position of the slider indicator in percent. Default is 0.\r\n\t\t * @param {onError} [options.onError] Called whenever an error has occurred.\r\n\t\t * @param {boolean} [options.duplicate] true - allow to create two or more palettes on your web page.\r\n\t\t */\r\n\t\tthis.create = function( elSliderWrapper, options ) {\r\n\r\n\t\t\toptions = options || {};\r\n\t\t\toptions.orientation = options.orientation || 'horizontal';\r\n\r\n\t\t\tfunction isHorizontal() { return options.orientation === \"horizontal\"; }\r\n\r\n\t\t\tif ( options.direction === undefined )\r\n\t\t\t\toptions.direction = true;\r\n\t\t\toptions.style = options.style || {};\r\n\t\t\t//\t\toptions.style.width = options.style.width || ( isHorizontal() ? '200px' : '30px' );\r\n\t\t\toptions.style.width = options.style.width || ( isHorizontal() ? 200 : 30 );\r\n\t\t\toptions.style.height = options.style.height || ( isHorizontal() ? 30 : 200 );\r\n\r\n\t\t\toptions.onError = options.onError || function () { }\r\n\r\n\t\t\tif ( elSliderWrapper instanceof HTMLElement !== true ) {\r\n\r\n\t\t\t\tif ( typeof elSliderWrapper !== \"string\" ) {\r\n\r\n\t\t\t\t\tconsole.error( 'ColorPicker.create: invalid elSliderWrapper = ' + elSliderWrapper );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\telSliderWrapper = document.getElementById( elSliderWrapper );\r\n\t\t\t\tif ( elSliderWrapper === null ) {\r\n\r\n\t\t\t\t\tconsole.error( 'ColorPicker.create: invalid elSliderWrapper = ' + elSliderWrapper );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telSliderWrapper.classList.add( 'slider-wrapper' );\r\n\t\t\tfor ( var style in options.style ) {\r\n\r\n\t\t\t\telSliderWrapper.style[style] = options.style[style];\r\n\r\n\t\t\t}\r\n\r\n//\t\t\tconst palette = options.palette instanceof Palette ? options.palette : new Palette( options );\r\n\t\t\tconst palette = options.palette instanceof this.palette ? options.palette : new this.palette( options );\r\n\t\t\tvar slide;\r\n\t\t\tfunction getSlideHeight() {\r\n\r\n\t\t\t\tif ( typeof options.style.height === \"string\" )\r\n\t\t\t\t\treturn parseInt( options.style.height );\r\n\t\t\t\treturn options.style.height;\r\n\r\n\t\t\t}\r\n\t\t\tfunction getSlideWidth() { return slide.clientWidth; }\r\n\t\t\t/**\r\n\t\t\t * sets color from palette\r\n\t\t\t * @param {number} value coordinate of color from palette in percent\r\n\t\t\t * @param {number} position coordinate of color from palette\r\n\t\t\t */\r\n\t\t\tfunction setValue( value, position ) {\r\n\r\n\t\t\t\tif ( slideIndicator === undefined ) {\r\n\r\n\t\t\t\t\tconsole.error( 'Set value of this instance of the ColorPicker is impossible because options.sliderIndicator is not defined.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst c = palette.hsv2rgb( value );\r\n\t\t\t\tif ( c === undefined ) {\r\n\r\n\t\t\t\t\tconsole.error( 'ColorPicker.setValue: invalud c = ' + c );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvalue = c.percent;\r\n\t\t\t\tif ( position === undefined )\r\n\t\t\t\t\tposition = isHorizontal() ?\r\n\t\t\t\t\t\t( getSlideWidth() * value ) / 100 :\r\n\t\t\t\t\t\tgetSlideHeight() - ( getSlideHeight() * ( options.direction ? value : 100 - value ) ) / 100;\r\n\t\t\t\tpositionIndicators( position );\r\n\t\t\t\tif ( options.sliderIndicator.callback !== undefined ) {\r\n\r\n\t\t\t\t\t//console.warn( 'callback: ' + c.percent + ' percent c.hex = ' + c.hex );\r\n\t\t\t\t\toptions.sliderIndicator.callback( c );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar slideIndicator;\r\n\t\t\tif ( options.sliderIndicator !== undefined ) {\r\n\r\n\t\t\t\tslideIndicator = document.createElement( 'div' );\r\n\t\t\t\tslideIndicator.className = 'slider-indicator';\r\n\t\t\t\tif ( isHorizontal() )\r\n\t\t\t\t\tslideIndicator.style.width = '10px';\r\n\t\t\t\telse slideIndicator.style.height = '10px';\r\n\t\t\t\telSliderWrapper.appendChild( slideIndicator );\r\n\t\t\t\tslideIndicator.style.pointerEvents = 'none';\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Helper to position indicators.\r\n\t\t\t * @param {number} position Coordinates of the mouse cursor in the slide area.\r\n\t\t\t */\r\n\t\t\tfunction positionIndicators( position ) {\r\n\r\n\t\t\t\tif ( slideIndicator === undefined )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tif ( isHorizontal() ) {\r\n\r\n\t\t\t\t\tif ( ( position < 0 ) || ( position > getSlideWidth() ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'ColorPicker.positionIndicators: Invalid position = ' + position );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tslideIndicator.style.top = '0px';\r\n\t\t\t\t\tslideIndicator.style.left = ( ( options.direction ? position : getSlideWidth() - position ) - slideIndicator.offsetWidth / 2 ) + 'px';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( ( position < 0 ) || ( position > getSlideHeight() ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'ColorPicker.positionIndicators: Invalid position = ' + position );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tslideIndicator.style.left = '0px';\r\n\t\t\t\t\tslideIndicator.style.top = ( position - slideIndicator.offsetHeight / 2 ) + 'px';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\tif ( type == 'SVG' ) {\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tconst linearGradient = 'linearGradient';\r\n\t\t\t\t\tslide = CreateSVGElement( 'svg', {\r\n\t\t\t\t\t\txmlns: 'http://www.w3.org/2000/svg',\r\n\t\t\t\t\t\tversion: '1.1',\r\n\t\t\t\t\t\twidth: isHorizontal() ? '100%' : options.style.width,\r\n\t\t\t\t\t\theight: options.style.height,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\tCreateSVGElement( 'defs', {},\r\n\t\t\t\t\t\t\t\tCreateSVGElement( linearGradient, {\r\n\r\n\t\t\t\t\t\t\t\t\tid: 'gradient-hsv-' + uniqID,\r\n\t\t\t\t\t\t\t\t\tx1: isHorizontal() && options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\t\t\ty1: !isHorizontal() && !options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\t\t\tx2: isHorizontal() && !options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\t\t\ty2: !isHorizontal() && options.direction ? '100%' : '0%',\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tpalette.getPalette()\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\tCreateSVGElement( 'rect', { x: '0', y: '0', width: '100%', height: '100%', fill: 'url(#gradient-hsv-' + uniqID + ')' } )\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\t\t\t\tslide.style.cursor = isHorizontal() ? 'e-resize' : 's-resize';\r\n\t\t\t\t\t\tslideIndicator.style.cursor = slide.style.cursor;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\t\t//I can not get \r\n\t\t\t\t\t// slide.querySelector( linearGradient );\r\n\t\t\t\t\t//in Safari 5.1.7 browser for Windows\r\n\t\t\t\t\t//Instead I see the error message:\r\n\t\t\t\t\t// 'null' is not an object( evaluating 'hsvGradient.id = 'gradient - hsv - ' + uniqID' )\r\n\t\t\t\t\tconsole.error( 'Create SVG element failed! ' + e.message );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\telSliderWrapper.appendChild( slide );\r\n\t\t\t\telSliderWrapper.style.height = getSlideHeight() + 'px';\r\n\r\n\t\t\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\t\t\tif ( isHorizontal() )\r\n\t\t\t\t\t\tslideIndicator.style.height = ( parseInt( options.style.height ) - 2 ) + 'px';\r\n\t\t\t\t\telse slideIndicator.style.width = ( parseInt( options.style.width ) - 2 ) + 'px';\r\n\r\n\t\t\t\t\toptions.sliderIndicator.value = options.sliderIndicator.value || 0;\r\n\t\t\t\t\tsetValue( options.sliderIndicator.value );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tuniqID++;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'Under constraction' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction mouseMove( mouse ) {\r\n\r\n\t\t\t\t//for IE\r\n\t\t\t\tmouse.x = parseInt( mouse.x );\r\n\t\t\t\tmouse.y = parseInt( mouse.y );\r\n\r\n\t\t\t\tvar position, size, value;\r\n\t\t\t\tif ( isHorizontal() ) {\r\n\r\n\t\t\t\t\tposition = mouse.x;\r\n\t\t\t\t\tsize = getSlideWidth() - 1;\r\n\r\n\t\t\t\t\tif ( position >= getSlideWidth() )\r\n\t\t\t\t\t\tposition = size;\r\n\t\t\t\t\tvalue = ( position * 100 ) / size;\r\n\t\t\t\t\tif ( !options.direction ) {\r\n\r\n\t\t\t\t\t\tvalue = 100 - value;\r\n\t\t\t\t\t\tposition = size - position;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tposition = mouse.y;\r\n\t\t\t\t\tsize = getSlideHeight() - 1;\r\n\r\n\t\t\t\t\tif ( position >= getSlideHeight() )\r\n\t\t\t\t\t\tposition = size;\r\n\t\t\t\t\tvalue = ( 1 - position / size ) * 100;\r\n\t\t\t\t\tif ( !options.direction ) {\r\n\r\n\t\t\t\t\t\tvalue = 100 - value;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tsetValue( value, position );\r\n\r\n\t\t\t}\r\n\t\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\t\tvar mouseout = false;\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Return click event handler for the slider.\r\n\t\t\t\t * Sets picker background color and calls options.sliderIndicator.callback if provided.\r\n\t\t\t\t */\r\n\t\t\t\tfunction slideListener() {\r\n\r\n\t\t\t\t\treturn function ( evt ) {\r\n\r\n\t\t\t\t\t\tif ( mouseout )\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\tevt = evt || window.event;\r\n\r\n\t\t\t\t\t\t/**\r\n\t\t\t\t\t\t * Return mouse position relative to the element el.\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tfunction mousePosition( evt ) {\r\n\t\t\t\t\t\t\t// IE:\r\n\t\t\t\t\t\t\tif ( window.event && window.event.contentOverflow !== undefined ) {\r\n\t\t\t\t\t\t\t\treturn { x: window.event.offsetX, y: window.event.offsetY };\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Webkit:\r\n\t\t\t\t\t\t\tif ( evt.offsetX !== undefined && evt.offsetY !== undefined ) {\r\n\t\t\t\t\t\t\t\treturn { x: evt.offsetX, y: evt.offsetY };\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Firefox:\r\n\t\t\t\t\t\t\tvar wrapper = evt.target.parentNode.parentNode;\r\n\t\t\t\t\t\t\treturn { x: evt.layerX - wrapper.offsetLeft, y: evt.layerY - wrapper.offsetTop };\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tmouseMove( mousePosition( evt ) );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tfunction addEventListener( element, event, listener ) {\r\n\r\n\t\t\t\t\tif ( element === null )\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tif ( element.attachEvent ) {\r\n\r\n\t\t\t\t\t\telement.attachEvent( 'on' + event, listener );\r\n\r\n\t\t\t\t\t} else if ( element.addEventListener ) {\r\n\r\n\t\t\t\t\t\telement.addEventListener( event, listener, false );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\taddEventListener( slide, 'click', slideListener() );\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * @callback listener\r\n\t\t\t\t*/\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Enable drag&drop color selection.\r\n\t\t\t\t * @param {object} ctx ColorPicker instance.\r\n\t\t\t\t * @param {listener} listener Function that will be called whenever mouse is dragged over the element with event object as argument.\r\n\t\t\t\t */\r\n\t\t\t\tfunction enableDragging( ctx, listener ) {\r\n\r\n\t\t\t\t\tvar element = slide;\r\n\r\n\t\t\t\t\t//Touchscreen support\r\n\r\n\t\t\t\t\taddEventListener( element, 'touchstart', function ( evt ) { } );\r\n\t\t\t\t\taddEventListener( element, 'touchmove', function ( evt ) {\r\n\r\n\t\t\t\t\t\tevt.preventDefault();\r\n\r\n\t\t\t\t\t\tvar rect = evt.srcElement.getBoundingClientRect(),\r\n\t\t\t\t\t\t\tx = ( evt.touches[0].clientX - rect.left ),\r\n\t\t\t\t\t\t\ty = ( evt.touches[0].clientY - rect.top );\r\n\t\t\t\t\t\tif ( x < 0 ) x = 0;\r\n\t\t\t\t\t\tif ( y < 0 ) y = 0;\r\n\t\t\t\t\t\tmouseMove( { x: x, y: y } );\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\taddEventListener( element, 'touchend', function ( evt ) {\r\n\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t//mouse support\r\n\t\t\t\t\taddEventListener( element, 'mousedown', function ( evt ) {\r\n\r\n\t\t\t\t\t\tconst mouseup = 'mouseup', mousemove = 'mousemove';\r\n\t\t\t\t\t\tfunction onMouseUp() {\r\n\r\n\t\t\t\t\t\t\t//console.warn( mouseup );\r\n\t\t\t\t\t\t\tfunction removeEventListener( element, event, listener ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( element === null )\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\tif ( element.detachEvent ) {\r\n\r\n\t\t\t\t\t\t\t\t\telement.detachEvent( 'on' + event, listener );\r\n\r\n\t\t\t\t\t\t\t\t} else if ( element.removeEventListener ) {\r\n\r\n\t\t\t\t\t\t\t\t\telement.removeEventListener( event, listener, false );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tremoveEventListener( window, mouseup, onMouseUp );\r\n\t\t\t\t\t\t\tremoveEventListener( window, mousemove, listener );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\taddEventListener( window, mouseup, onMouseUp );\r\n\t\t\t\t\t\taddEventListener( window, mousemove, listener );\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\taddEventListener( element, 'mouseout', function ( evt ) { mouseout = true; } );\r\n\t\t\t\t\taddEventListener( element, 'mouseover', function ( evt ) { mouseout = false; } );\r\n\t\t\t\t}\r\n\t\t\t\tenableDragging( this, slideListener() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tsetValue: setValue,\r\n\r\n\t\t\t};\r\n\t\t}\r\n\t\t/**\r\n\t\t * create palette\r\n\t\t * @param {object} [options] the following options are available\r\n\t\t * @param {paletteIndexes|object[]} [options.palette] Palette index or palette array. The following indexes are available:\r\n\t\t * <pre>\r\n\t\t * paletteIndexes.BGYW: 0 - blue, green, yellow, white palette.\r\n\t\t * paletteIndexes.monochrome: 1,\r\n\t\t * paletteIndexes.bidirectional: 2,//red, black, green\r\n\t\t * paletteIndexes.rainbow: 3,\r\n\t\t * Default is paletteIndexes.BGYW index.\r\n\t\t * Example of palette array:\r\n\t\t[\r\n\t\t\t{ percent: 0, r: 0, g: 0, b: 0, },\r\n\t\t\t{ percent: 10, r: 0xff, g: 255, b: 0xff, },\r\n\t\t\t{ percent: 100, r: 0xff, g: 255, b: 0xff, },\r\n\t\t]\r\n\t\t* </pre>\r\n\t\t*/\r\n\t\tthis.palette = function( options ) {\r\n\r\n\r\n\t\t\tfunction paletteitem( percent, r, g, b ) {\r\n\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tpercent: percent,\r\n\t\t\t\t\tr: r,\r\n\t\t\t\t\tg: g,\r\n\t\t\t\t\tb: b,\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\toptions = options || {};\r\n\t\t\t/*есть случай когда для каждой точки создается своя палитра\r\n\t\t\t\tif ( !options.duplicate && boCreated ) {\r\n\t\t\t\r\n\t\t\t\t\tconsole.warn( 'Palette: duplicate palette' );\r\n\t\t\t\t\treturn;\r\n\t\t\t\r\n\t\t\t\t}\r\n\t\t\t*/\r\n\t\t\tif ( options.palette === undefined )\r\n\t\t\t\toptions.palette = _this.paletteIndexes.BGYW;\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * @returns Index of palette.\r\n\t\t\t * <pre>\r\n\t\t\t * 0 - <a href=\"../Example/index.html#BGYW\" target=\"_blank\">BGYW</a>\r\n\t\t\t * 1 - <a href=\"../Example/index.html#Monochrome\" target=\"_blank\">monochrome</a>\r\n\t\t\t * 2 - <a href=\"../Example/index.html#Bidirectional\" target=\"_blank\">bidirectional</a>\r\n\t\t\t * 3 - <a href=\"../Example/index.html#rainbow\" target=\"_blank\">rainbow</a>\r\n\t\t\t * </pre>\r\n\t\t\t * */\r\n\t\t\tthis.getPaletteIndex = function () { return options.palette; }\r\n\r\n\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\tnew paletteitem( 0, 0x00, 0x00, 0xFF ),//blue\r\n\t\t\t\tnew paletteitem( 33, 0x00, 0xFF, 0x00 ),//green\r\n\t\t\t\tnew paletteitem( 66, 0xFF, 0xFF, 0x00 ),//yellow\r\n\t\t\t\tnew paletteitem( 100, 0xFF, 0xFF, 0xFF ),//white\r\n\r\n\t\t\t];\r\n\t\t\tswitch ( typeof options.palette ) {\r\n\r\n\t\t\t\tcase 'number':\r\n\t\t\t\t\tswitch ( options.palette ) {\r\n\r\n\t\t\t\t\t\tcase _this.paletteIndexes.BGYW:\r\n\t\t\t\t\t\t\tbreak;//default palette\r\n\t\t\t\t\t\tcase _this.paletteIndexes.monochrome:\r\n\t\t\t\t\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\t\t\t\t\tnew paletteitem( 0, 0x00, 0x00, 0x00 ),//blach\r\n\t\t\t\t\t\t\t\tnew paletteitem( 100, 0xFF, 0xFF, 0xFF ),//white\r\n\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase _this.paletteIndexes.bidirectional:\r\n\t\t\t\t\t\t\tvar arrayPalette = [\r\n\t\t\t\t\t\t\t\tnew paletteitem( 0, 0xff, 0x30, 0x30 ),//red\r\n\t\t\t\t\t\t\t\tnew paletteitem( 50, 0x30, 0x30, 0x30 ),//gray\r\n\t\t\t\t\t\t\t\tnew paletteitem( 100, 0x30, 0xFF, 0x30 ),//green\r\n\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase _this.paletteIndexes.rainbow:\r\n\t\t\t\t\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\t\t\t\t\tnew paletteitem( 0, 0xff, 0x32, 0x32 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 16, 0xfc, 0xf5, 0x28 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 32, 0x28, 0xfc, 0x28 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 50, 0x28, 0xfc, 0xf8 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 66, 0x27, 0x2e, 0xf9 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 82, 0xff, 0x28, 0xfb ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 100, 0xff, 0x32, 0x32 ),\r\n\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault: console.error( 'ColorPicker.create.Palette: invalid options.palette = ' + options.palette );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"object\":\r\n\t\t\t\t\tif ( Array.isArray( options.palette ) ) {\r\n\r\n\t\t\t\t\t\t//Custom palette\r\n\t\t\t\t\t\tarrayPalette = options.palette;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tvar message = 'invalid options.palette = ' + options.palette;\r\n\t\t\t\t\tconsole.error( 'ColorPicker.create.Palette: ' + message );\r\n\t\t\t\t\toptions.onError( message );\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t* @returns {object[]} palette array\r\n\t\t\t*/\r\n\t\t\tthis.getPalette = function () {\r\n\r\n\t\t\t\tconst palette = [];\r\n\t\t\t\tarrayPalette.forEach( function ( item ) {\r\n\r\n\t\t\t\t\tpalette.unshift( CreateSVGElement( 'stop', {\r\n\r\n\t\t\t\t\t\toffset: ( 100 - item.percent ) + '%', 'stop-color': '#'\r\n\t\t\t\t\t\t\t//Thanks to https://stackoverflow.com/a/13240395/5175935\r\n\t\t\t\t\t\t\t+ ( \"0\" + ( Number( item.r ).toString( 16 ) ) ).slice( -2 ).toUpperCase()\r\n\t\t\t\t\t\t\t+ ( \"0\" + ( Number( item.g ).toString( 16 ) ) ).slice( -2 ).toUpperCase()\r\n\t\t\t\t\t\t\t+ ( \"0\" + ( Number( item.b ).toString( 16 ) ) ).slice( -2 ).toUpperCase(),\r\n\t\t\t\t\t\t'stop-opacity': '1'\r\n\r\n\t\t\t\t\t} ) );\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn palette;\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t* converts a percent or value from min to max  to object with r, g, b, hex and percent.\r\n\t\t\t* @param {number} stringPercent coordinate of color from palette in percent or value from min to max\r\n\t\t\t* @param {number} [min] min stringPercent.\r\n\t\t\t* @param {number} [max] max stringPercent.\r\n\t\t\t* @returns {object} object with r, g, b, hex and percent\r\n\t\t\t*/\r\n\t\t\tthis.hsv2rgb = function ( stringPercent, min, max ) {\r\n\r\n\t\t\t\tvar percent = parseFloat( stringPercent );\r\n\t\t\t\tif ( min !== undefined && max !== undefined )\r\n\t\t\t\t\tpercent = ( 100 / ( max - min ) ) * ( percent - min );\r\n\t\t\t\tvar lastPalette = arrayPalette[arrayPalette.length - 1];\r\n\t\t\t\tif ( lastPalette.percent !== 100 ) {\r\n\r\n\t\t\t\t\t//not compatible with Safari for Windows\r\n\t\t\t\t\t//var lastItem = Object.assign( {}, arrayPalette[arrayPalette.length - 1] );\r\n\r\n\t\t\t\t\tconst lastItem = {};\r\n\t\t\t\t\tObject.keys( lastPalette ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\tlastItem[key] = lastPalette[key];\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tlastItem.percent = 100;\r\n\t\t\t\t\tarrayPalette.push( lastItem );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tvar itemPrev;\r\n\t\t\t\tfor ( var i = 0; i < arrayPalette.length; i++ ) {\r\n\r\n\t\t\t\t\tconst item = arrayPalette[i];\r\n\t\t\t\t\tif ( itemPrev === undefined )\r\n\t\t\t\t\t\titemPrev = item;\r\n\t\t\t\t\tif ( ( ( percent >= itemPrev.percent ) && ( percent <= item.percent ) ) ) {\r\n\r\n\t\t\t\t\t\tfunction color( percentPrev, prev, percentItem, item ) {\r\n\r\n\t\t\t\t\t\t\tvar percentD = percentItem - percentPrev;\r\n\t\t\t\t\t\t\tif ( percentD === 0 )\r\n\t\t\t\t\t\t\t\treturn prev;\r\n\t\t\t\t\t\t\treturn Math.round( prev + ( ( item - prev ) / percentD ) * ( percent - percentPrev ) );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst r = color( itemPrev.percent, itemPrev.r, item.percent, item.r ),\r\n\t\t\t\t\t\t\tg = color( itemPrev.percent, itemPrev.g, item.percent, item.g ),\r\n\t\t\t\t\t\t\tb = color( itemPrev.percent, itemPrev.b, item.percent, item.b );\r\n\t\t\t\t\t\treturn {\r\n\r\n\t\t\t\t\t\t\tr: r,\r\n\t\t\t\t\t\t\tg: g,\r\n\t\t\t\t\t\t\tb: b,\r\n\t\t\t\t\t\t\thex: \"#\" + ( 16777216 | b | ( g << 8 ) | ( r << 16 ) ).toString( 16 ).slice( 1 ),\r\n\t\t\t\t\t\t\tpercent: percent\r\n\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\titemPrev = item;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( options.onError !== undefined )\r\n\t\t\t\t\toptions.onError( 'Invalid color value of the ColorPicker: ' + stringPercent );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t* converts a value in percentages to color.\r\n\t\t\t* @param {number} value coordinate of color from palette in percent. Default value range from 0 to 100.\r\n\t\t\t* @param {number} [min] minimal value\r\n\t\t\t* @param {number} [max] maximal value\r\n\t\t\t* @returns {THREE.Color} [color]{@link https://threejs.org/docs/index.html?q=Colo#api/en/math/Color}\r\n\t\t\t*/\r\n\t\t\tthis.toColor = function ( value, min, max ) {\r\n\r\n\t\t\t\tconst THREE = three.THREE;\r\n\t\t\t\t/*\r\n\t\t\t\t\t\tif ( typeof THREE === 'undefined' ) {\r\n\t\t\t\t\r\n\t\t\t\t\t\t\tconsole.error( 'Call ColorPicker.palette.setTHREE(THREE) first.' );\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\tif ( value instanceof THREE.Color )\r\n\t\t\t\t\treturn value;\r\n\t\t\t\tvar c = this.hsv2rgb( value, min, max );\r\n\t\t\t\tif ( c === undefined )\r\n\t\t\t\t\tc = { r: 255, g: 255, b: 255 }\r\n\t\t\t\treturn new THREE.Color( \"rgb(\" + c.r + \", \" + c.g + \", \" + c.b + \")\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tboCreated = true;\r\n\r\n\t\t}\r\n\t}\r\n}\r\nColorPicker = new ColorPicker();\r\nexport default ColorPicker;\r\n","import three from '../three.js'\r\n/*\r\nimport {\r\n\tEventDispatcher,\r\n\tMOUSE,\r\n\tQuaternion,\r\n\tSpherical,\r\n\tTOUCH,\r\n\tVector2,\r\n\tVector3\r\n} from '../../../build/three.module.js';\r\n*/\r\n// This set of controls performs orbiting, dollying (zooming), and panning.\r\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\r\n//\r\n//    Orbit - left mouse / touch: one-finger move\r\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\r\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\r\n\r\nvar OrbitControls = function ( object, domElement ) {\r\n\r\n\tconst EventDispatcher = three.THREE.EventDispatcher,\r\n\t\tMOUSE = three.THREE.MOUSE,\r\n\t\tQuaternion = three.THREE.Quaternion,\r\n\t\tSpherical = three.THREE.Spherical,\r\n\t\tTOUCH = three.THREE.TOUCH,\r\n\t\tVector2 = three.THREE.Vector2,\r\n\t\tVector3 = three.THREE.Vector3;\r\n/*\r\n\tOrbitControls.prototype = Object.create( EventDispatcher.prototype );\r\n\tOrbitControls.prototype.constructor = OrbitControls;\r\n\t\r\n\tMapControls.prototype = Object.create( EventDispatcher.prototype );\r\n\tMapControls.prototype.constructor = MapControls;\r\n*/\r\n\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\r\n\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\r\n\r\n\tthis.object = object;\r\n\tthis.domElement = domElement;\r\n\r\n\t// Set to false to disable this control\r\n\tthis.enabled = true;\r\n\r\n\t// \"target\" sets the location of focus, where the object orbits around\r\n\tthis.target = new Vector3();\r\n\r\n\t// How far you can dolly in and out ( PerspectiveCamera only )\r\n\tthis.minDistance = 0;\r\n\tthis.maxDistance = Infinity;\r\n\r\n\t// How far you can zoom in and out ( OrthographicCamera only )\r\n\tthis.minZoom = 0;\r\n\tthis.maxZoom = Infinity;\r\n\r\n\t// How far you can orbit vertically, upper and lower limits.\r\n\t// Range is 0 to Math.PI radians.\r\n\tthis.minPolarAngle = 0; // radians\r\n\tthis.maxPolarAngle = Math.PI; // radians\r\n\r\n\t// How far you can orbit horizontally, upper and lower limits.\r\n\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\r\n\tthis.minAzimuthAngle = - Infinity; // radians\r\n\tthis.maxAzimuthAngle = Infinity; // radians\r\n\r\n\t// Set to true to enable damping (inertia)\r\n\t// If damping is enabled, you must call controls.update() in your animation loop\r\n\tthis.enableDamping = false;\r\n\tthis.dampingFactor = 0.05;\r\n\r\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\r\n\t// Set to false to disable zooming\r\n\tthis.enableZoom = true;\r\n\tthis.zoomSpeed = 1.0;\r\n\r\n\t// Set to false to disable rotating\r\n\tthis.enableRotate = true;\r\n\tthis.rotateSpeed = 1.0;\r\n\r\n\t// Set to false to disable panning\r\n\tthis.enablePan = true;\r\n\tthis.panSpeed = 1.0;\r\n\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\r\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\r\n\r\n\t// Set to true to automatically rotate around the target\r\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\r\n\tthis.autoRotate = false;\r\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\r\n\r\n\t// The four arrow keys\r\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\r\n\r\n\t// Mouse buttons\r\n\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\r\n\r\n\t// Touch fingers\r\n\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\r\n\r\n\t// for reset\r\n\tthis.target0 = this.target.clone();\r\n\tthis.position0 = this.object.position.clone();\r\n\tthis.zoom0 = this.object.zoom;\r\n\r\n\t// the target DOM element for key events\r\n\tthis._domElementKeyEvents = null;\r\n\r\n\t//\r\n\t// public methods\r\n\t//\r\n\r\n\tthis.getPolarAngle = function () {\r\n\r\n\t\treturn spherical.phi;\r\n\r\n\t};\r\n\r\n\tthis.getAzimuthalAngle = function () {\r\n\r\n\t\treturn spherical.theta;\r\n\r\n\t};\r\n\r\n\tthis.listenToKeyEvents = function ( domElement ) {\r\n\r\n\t\tdomElement.addEventListener( 'keydown', onKeyDown );\r\n\t\tthis._domElementKeyEvents = domElement;\r\n\r\n\t};\r\n\r\n\tthis.saveState = function () {\r\n\r\n\t\tscope.target0.copy( scope.target );\r\n\t\tscope.position0.copy( scope.object.position );\r\n\t\tscope.zoom0 = scope.object.zoom;\r\n\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tscope.target.copy( scope.target0 );\r\n\t\tscope.object.position.copy( scope.position0 );\r\n\t\tscope.object.zoom = scope.zoom0;\r\n\r\n\t\tscope.object.updateProjectionMatrix();\r\n\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\tscope.update();\r\n\r\n\t\tstate = STATE.NONE;\r\n\r\n\t};\r\n\r\n\t// this method is exposed, but perhaps it would be better if we can make it private...\r\n\tthis.update = function () {\r\n\r\n\t\tvar offset = new Vector3();\r\n\r\n\t\t// so camera.up is the orbit axis\r\n\t\tvar quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\r\n\t\tvar quatInverse = quat.clone().invert();\r\n\r\n\t\tvar lastPosition = new Vector3();\r\n\t\tvar lastQuaternion = new Quaternion();\r\n\r\n\t\tvar twoPI = 2 * Math.PI;\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\tvar position = scope.object.position;\r\n\r\n\t\t\toffset.copy( position ).sub( scope.target );\r\n\r\n\t\t\t// rotate offset to \"y-axis-is-up\" space\r\n\t\t\toffset.applyQuaternion( quat );\r\n\r\n\t\t\t// angle from z-axis around y-axis\r\n\t\t\tspherical.setFromVector3( offset );\r\n\r\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\r\n\r\n\t\t\t\trotateLeft( getAutoRotationAngle() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( scope.enableDamping ) {\r\n\r\n\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\r\n\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tspherical.theta += sphericalDelta.theta;\r\n\t\t\t\tspherical.phi += sphericalDelta.phi;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// restrict theta to be between desired limits\r\n\r\n\t\t\tvar min = scope.minAzimuthAngle;\r\n\t\t\tvar max = scope.maxAzimuthAngle;\r\n\r\n\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\r\n\r\n\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\r\n\r\n\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\r\n\r\n\t\t\t\tif ( min <= max ) {\r\n\r\n\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\r\n\t\t\t\t\t\tMath.max( min, spherical.theta ) :\r\n\t\t\t\t\t\tMath.min( max, spherical.theta );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// restrict phi to be between desired limits\r\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\r\n\r\n\t\t\tspherical.makeSafe();\r\n\r\n\r\n\t\t\tspherical.radius *= scale;\r\n\r\n\t\t\t// restrict radius to be between desired limits\r\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\r\n\r\n\t\t\t// move target to panned location\r\n\r\n\t\t\tif ( scope.enableDamping === true ) {\r\n\r\n\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tscope.target.add( panOffset );\r\n\r\n\t\t\t}\r\n\r\n\t\t\toffset.setFromSpherical( spherical );\r\n\r\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\r\n\t\t\toffset.applyQuaternion( quatInverse );\r\n\r\n\t\t\tposition.copy( scope.target ).add( offset );\r\n\r\n\t\t\tscope.object.lookAt( scope.target );\r\n\r\n\t\t\tif ( scope.enableDamping === true ) {\r\n\r\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\r\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\r\n\r\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\r\n\r\n\t\t\t\tpanOffset.set( 0, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscale = 1;\r\n\r\n\t\t\t// update condition is:\r\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\r\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\r\n\r\n\t\t\tif ( zoomChanged ||\r\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\r\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\r\n\r\n\t\t\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\t\t\tlastPosition.copy( scope.object.position );\r\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\r\n\t\t\t\tzoomChanged = false;\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\tthis.dispose = function () {\r\n\r\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\r\n\r\n\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\r\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\r\n\r\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart );\r\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd );\r\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove );\r\n\r\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\r\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\r\n\r\n\r\n\t\tif ( scope._domElementKeyEvents !== null ) {\r\n\r\n\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\r\n\r\n\t\t}\r\n\r\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\r\n\r\n\t};\r\n\r\n\t//\r\n\t// internals\r\n\t//\r\n\r\n\tvar scope = this;\r\n\r\n\tvar changeEvent = { type: 'change' };\r\n\tvar startEvent = { type: 'start' };\r\n\tvar endEvent = { type: 'end' };\r\n\r\n\tvar STATE = {\r\n\t\tNONE: - 1,\r\n\t\tROTATE: 0,\r\n\t\tDOLLY: 1,\r\n\t\tPAN: 2,\r\n\t\tTOUCH_ROTATE: 3,\r\n\t\tTOUCH_PAN: 4,\r\n\t\tTOUCH_DOLLY_PAN: 5,\r\n\t\tTOUCH_DOLLY_ROTATE: 6\r\n\t};\r\n\r\n\tvar state = STATE.NONE;\r\n\r\n\tvar EPS = 0.000001;\r\n\r\n\t// current position in spherical coordinates\r\n\tvar spherical = new Spherical();\r\n\tvar sphericalDelta = new Spherical();\r\n\r\n\tvar scale = 1;\r\n\tvar panOffset = new Vector3();\r\n\tvar zoomChanged = false;\r\n\r\n\tvar rotateStart = new Vector2();\r\n\tvar rotateEnd = new Vector2();\r\n\tvar rotateDelta = new Vector2();\r\n\r\n\tvar panStart = new Vector2();\r\n\tvar panEnd = new Vector2();\r\n\tvar panDelta = new Vector2();\r\n\r\n\tvar dollyStart = new Vector2();\r\n\tvar dollyEnd = new Vector2();\r\n\tvar dollyDelta = new Vector2();\r\n\r\n\tfunction getAutoRotationAngle() {\r\n\r\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\r\n\r\n\t}\r\n\r\n\tfunction getZoomScale() {\r\n\r\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\r\n\r\n\t}\r\n\r\n\tfunction rotateLeft( angle ) {\r\n\r\n\t\tsphericalDelta.theta -= angle;\r\n\r\n\t}\r\n\r\n\tfunction rotateUp( angle ) {\r\n\r\n\t\tsphericalDelta.phi -= angle;\r\n\r\n\t}\r\n\r\n\tvar panLeft = function () {\r\n\r\n\t\tvar v = new Vector3();\r\n\r\n\t\treturn function panLeft( distance, objectMatrix ) {\r\n\r\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\r\n\t\t\tv.multiplyScalar( - distance );\r\n\r\n\t\t\tpanOffset.add( v );\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\tvar panUp = function () {\r\n\r\n\t\tvar v = new Vector3();\r\n\r\n\t\treturn function panUp( distance, objectMatrix ) {\r\n\r\n\t\t\tif ( scope.screenSpacePanning === true ) {\r\n\r\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\r\n\t\t\t\tv.crossVectors( scope.object.up, v );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tv.multiplyScalar( distance );\r\n\r\n\t\t\tpanOffset.add( v );\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\t// deltaX and deltaY are in pixels; right and down are positive\r\n\tvar pan = function () {\r\n\r\n\t\tvar offset = new Vector3();\r\n\r\n\t\treturn function pan( deltaX, deltaY ) {\r\n\r\n\t\t\tvar element = scope.domElement;\r\n\r\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\t\t// perspective\r\n\t\t\t\tvar position = scope.object.position;\r\n\t\t\t\toffset.copy( position ).sub( scope.target );\r\n\t\t\t\tvar targetDistance = offset.length();\r\n\r\n\t\t\t\t// half of the fov is center to top of screen\r\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\r\n\r\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\r\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\r\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\r\n\r\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\t\t// orthographic\r\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\r\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// camera neither orthographic nor perspective\r\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\r\n\t\t\t\tscope.enablePan = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\tfunction dollyOut( dollyScale ) {\r\n\r\n\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\tscale /= dollyScale;\r\n\r\n\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\r\n\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\tzoomChanged = true;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\r\n\t\t\tscope.enableZoom = false;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction dollyIn( dollyScale ) {\r\n\r\n\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\tscale *= dollyScale;\r\n\r\n\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\r\n\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\tzoomChanged = true;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\r\n\t\t\tscope.enableZoom = false;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\t// event callbacks - update the object state\r\n\t//\r\n\r\n\tfunction handleMouseDownRotate( event ) {\r\n\r\n\t\trotateStart.set( event.clientX, event.clientY );\r\n\r\n\t}\r\n\r\n\tfunction handleMouseDownDolly( event ) {\r\n\r\n\t\tdollyStart.set( event.clientX, event.clientY );\r\n\r\n\t}\r\n\r\n\tfunction handleMouseDownPan( event ) {\r\n\r\n\t\tpanStart.set( event.clientX, event.clientY );\r\n\r\n\t}\r\n\r\n\tfunction handleMouseMoveRotate( event ) {\r\n\r\n\t\trotateEnd.set( event.clientX, event.clientY );\r\n\r\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\r\n\r\n\t\tvar element = scope.domElement;\r\n\r\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\r\n\r\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\r\n\r\n\t\trotateStart.copy( rotateEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleMouseMoveDolly( event ) {\r\n\r\n\t\tdollyEnd.set( event.clientX, event.clientY );\r\n\r\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\r\n\r\n\t\tif ( dollyDelta.y > 0 ) {\r\n\r\n\t\t\tdollyOut( getZoomScale() );\r\n\r\n\t\t} else if ( dollyDelta.y < 0 ) {\r\n\r\n\t\t\tdollyIn( getZoomScale() );\r\n\r\n\t\t}\r\n\r\n\t\tdollyStart.copy( dollyEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleMouseMovePan( event ) {\r\n\r\n\t\tpanEnd.set( event.clientX, event.clientY );\r\n\r\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\r\n\r\n\t\tpan( panDelta.x, panDelta.y );\r\n\r\n\t\tpanStart.copy( panEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleMouseUp( /*event*/ ) {\r\n\r\n\t\t// no-op\r\n\r\n\t}\r\n\r\n\tfunction handleMouseWheel( event ) {\r\n\r\n\t\tif ( event.deltaY < 0 ) {\r\n\r\n\t\t\tdollyIn( getZoomScale() );\r\n\r\n\t\t} else if ( event.deltaY > 0 ) {\r\n\r\n\t\t\tdollyOut( getZoomScale() );\r\n\r\n\t\t}\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleKeyDown( event ) {\r\n\r\n\t\tvar needsUpdate = false;\r\n\r\n\t\tswitch ( event.keyCode ) {\r\n\r\n\t\t\tcase scope.keys.UP:\r\n\t\t\t\tpan( 0, scope.keyPanSpeed );\r\n\t\t\t\tneedsUpdate = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase scope.keys.BOTTOM:\r\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\r\n\t\t\t\tneedsUpdate = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase scope.keys.LEFT:\r\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\r\n\t\t\t\tneedsUpdate = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase scope.keys.RIGHT:\r\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\r\n\t\t\t\tneedsUpdate = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tif ( needsUpdate ) {\r\n\r\n\t\t\t// prevent the browser from scrolling on cursor keys\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tscope.update();\r\n\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tfunction handleTouchStartRotate( event ) {\r\n\r\n\t\tif ( event.touches.length == 1 ) {\r\n\r\n\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\r\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\r\n\r\n\t\t\trotateStart.set( x, y );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction handleTouchStartPan( event ) {\r\n\r\n\t\tif ( event.touches.length == 1 ) {\r\n\r\n\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\r\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\r\n\r\n\t\t\tpanStart.set( x, y );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction handleTouchStartDolly( event ) {\r\n\r\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\r\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\r\n\r\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\r\n\r\n\t\tdollyStart.set( 0, distance );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchStartDollyPan( event ) {\r\n\r\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\r\n\r\n\t\tif ( scope.enablePan ) handleTouchStartPan( event );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchStartDollyRotate( event ) {\r\n\r\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\r\n\r\n\t\tif ( scope.enableRotate ) handleTouchStartRotate( event );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchMoveRotate( event ) {\r\n\r\n\t\tif ( event.touches.length == 1 ) {\r\n\r\n\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\r\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\r\n\r\n\t\t\trotateEnd.set( x, y );\r\n\r\n\t\t}\r\n\r\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\r\n\r\n\t\tvar element = scope.domElement;\r\n\r\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\r\n\r\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\r\n\r\n\t\trotateStart.copy( rotateEnd );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchMovePan( event ) {\r\n\r\n\t\tif ( event.touches.length == 1 ) {\r\n\r\n\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\r\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\r\n\r\n\t\t\tpanEnd.set( x, y );\r\n\r\n\t\t}\r\n\r\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\r\n\r\n\t\tpan( panDelta.x, panDelta.y );\r\n\r\n\t\tpanStart.copy( panEnd );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchMoveDolly( event ) {\r\n\r\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\r\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\r\n\r\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\r\n\r\n\t\tdollyEnd.set( 0, distance );\r\n\r\n\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\r\n\r\n\t\tdollyOut( dollyDelta.y );\r\n\r\n\t\tdollyStart.copy( dollyEnd );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchMoveDollyPan( event ) {\r\n\r\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\r\n\r\n\t\tif ( scope.enablePan ) handleTouchMovePan( event );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchMoveDollyRotate( event ) {\r\n\r\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\r\n\r\n\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchEnd( /*event*/ ) {\r\n\r\n\t\t// no-op\r\n\r\n\t}\r\n\r\n\t//\r\n\t// event handlers - FSM: listen for events and reset state\r\n\t//\r\n\r\n\tfunction onPointerDown( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tswitch ( event.pointerType ) {\r\n\r\n\t\t\tcase 'mouse':\r\n\t\t\tcase 'pen':\r\n\t\t\t\tonMouseDown( event );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t// TODO touch\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onPointerMove( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tswitch ( event.pointerType ) {\r\n\r\n\t\t\tcase 'mouse':\r\n\t\t\tcase 'pen':\r\n\t\t\t\tonMouseMove( event );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t// TODO touch\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onPointerUp( event ) {\r\n\r\n\t\tswitch ( event.pointerType ) {\r\n\r\n\t\t\tcase 'mouse':\r\n\t\t\tcase 'pen':\r\n\t\t\t\tonMouseUp( event );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t// TODO touch\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onMouseDown( event ) {\r\n\r\n\t\t// Prevent the browser from scrolling.\r\n\t\tevent.preventDefault();\r\n\r\n\t\t// Manually set the focus since calling preventDefault above\r\n\t\t// prevents the browser from setting it automatically.\r\n\r\n\t\tscope.domElement.focus ? scope.domElement.focus() : window.focus();\r\n\r\n\t\tvar mouseAction;\r\n\r\n\t\tswitch ( event.button ) {\r\n\r\n\t\t\tcase 0:\r\n\r\n\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 1:\r\n\r\n\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2:\r\n\r\n\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tmouseAction = - 1;\r\n\r\n\t\t}\r\n\r\n\t\tswitch ( mouseAction ) {\r\n\r\n\t\t\tcase MOUSE.DOLLY:\r\n\r\n\t\t\t\tif ( scope.enableZoom === false ) return;\r\n\r\n\t\t\t\thandleMouseDownDolly( event );\r\n\r\n\t\t\t\tstate = STATE.DOLLY;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase MOUSE.ROTATE:\r\n\r\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\r\n\r\n\t\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\thandleMouseDownPan( event );\r\n\r\n\t\t\t\t\tstate = STATE.PAN;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\thandleMouseDownRotate( event );\r\n\r\n\t\t\t\t\tstate = STATE.ROTATE;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase MOUSE.PAN:\r\n\r\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\r\n\r\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\thandleMouseDownRotate( event );\r\n\r\n\t\t\t\t\tstate = STATE.ROTATE;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\thandleMouseDownPan( event );\r\n\r\n\t\t\t\t\tstate = STATE.PAN;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t}\r\n\r\n\t\tif ( state !== STATE.NONE ) {\r\n\r\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointermove', onPointerMove );\r\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerup', onPointerUp );\r\n\r\n\t\t\tscope.dispatchEvent( startEvent );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onMouseMove( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tswitch ( state ) {\r\n\r\n\t\t\tcase STATE.ROTATE:\r\n\r\n\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\thandleMouseMoveRotate( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase STATE.DOLLY:\r\n\r\n\t\t\t\tif ( scope.enableZoom === false ) return;\r\n\r\n\t\t\t\thandleMouseMoveDolly( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase STATE.PAN:\r\n\r\n\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\thandleMouseMovePan( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onMouseUp( event ) {\r\n\r\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\r\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\thandleMouseUp( event );\r\n\r\n\t\tscope.dispatchEvent( endEvent );\r\n\r\n\t\tstate = STATE.NONE;\r\n\r\n\t}\r\n\r\n\tfunction onMouseWheel( event ) {\r\n\r\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tscope.dispatchEvent( startEvent );\r\n\r\n\t\thandleMouseWheel( event );\r\n\r\n\t\tscope.dispatchEvent( endEvent );\r\n\r\n\t}\r\n\r\n\tfunction onKeyDown( event ) {\r\n\r\n\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\r\n\r\n\t\thandleKeyDown( event );\r\n\r\n\t}\r\n\r\n\tfunction onTouchStart( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault(); // prevent scrolling\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\r\n\r\n\t\t\t\tswitch ( scope.touches.ONE ) {\r\n\r\n\t\t\t\t\tcase TOUCH.ROTATE:\r\n\r\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\thandleTouchStartRotate( event );\r\n\r\n\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase TOUCH.PAN:\r\n\r\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\thandleTouchStartPan( event );\r\n\r\n\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2:\r\n\r\n\t\t\t\tswitch ( scope.touches.TWO ) {\r\n\r\n\t\t\t\t\tcase TOUCH.DOLLY_PAN:\r\n\r\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\thandleTouchStartDollyPan( event );\r\n\r\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\r\n\r\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\thandleTouchStartDollyRotate( event );\r\n\r\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t}\r\n\r\n\t\tif ( state !== STATE.NONE ) {\r\n\r\n\t\t\tscope.dispatchEvent( startEvent );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onTouchMove( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault(); // prevent scrolling\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tswitch ( state ) {\r\n\r\n\t\t\tcase STATE.TOUCH_ROTATE:\r\n\r\n\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\thandleTouchMoveRotate( event );\r\n\r\n\t\t\t\tscope.update();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase STATE.TOUCH_PAN:\r\n\r\n\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\thandleTouchMovePan( event );\r\n\r\n\t\t\t\tscope.update();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase STATE.TOUCH_DOLLY_PAN:\r\n\r\n\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\r\n\r\n\t\t\t\thandleTouchMoveDollyPan( event );\r\n\r\n\t\t\t\tscope.update();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\r\n\r\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\r\n\r\n\t\t\t\thandleTouchMoveDollyRotate( event );\r\n\r\n\t\t\t\tscope.update();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onTouchEnd( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\thandleTouchEnd( event );\r\n\r\n\t\tscope.dispatchEvent( endEvent );\r\n\r\n\t\tstate = STATE.NONE;\r\n\r\n\t}\r\n\r\n\tfunction onContextMenu( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\r\n\r\n\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\r\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel );\r\n\r\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart );\r\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd );\r\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove );\r\n\r\n\t// force an update at start\r\n\r\n\tthis.update();\r\n\r\n};\r\n/*\r\nOrbitControls.prototype = Object.create( EventDispatcher.prototype );\r\nOrbitControls.prototype.constructor = OrbitControls;\r\n*/\r\n\r\n// This set of controls performs orbiting, dollying (zooming), and panning.\r\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\r\n// This is very similar to OrbitControls, another set of touch behavior\r\n//\r\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\r\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\r\n//    Pan - left mouse, or arrow keys / touch: one-finger move\r\n\r\nvar MapControls = function ( object, domElement ) {\r\n\r\n\tOrbitControls.call( this, object, domElement );\r\n\r\n\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\r\n\r\n\tthis.mouseButtons.LEFT = MOUSE.PAN;\r\n\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\r\n\r\n\tthis.touches.ONE = TOUCH.PAN;\r\n\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\r\n\r\n};\r\n/*\r\nMapControls.prototype = Object.create( EventDispatcher.prototype );\r\nMapControls.prototype.constructor = MapControls;\r\n*/\r\n\r\nvar createEventDispatcher = function () {\r\n\r\n\tOrbitControls.prototype = Object.create( three.THREE.EventDispatcher.prototype );\r\n\tOrbitControls.prototype.constructor = OrbitControls;\r\n\r\n\tMapControls.prototype = Object.create( three.THREE.EventDispatcher.prototype );\r\n\tMapControls.prototype.constructor = MapControls;\r\n\r\n};\r\nexport { OrbitControls, MapControls, createEventDispatcher };\r\n","/**\r\n * @module cookie\r\n * @description node.js version of the cookie.\r\n * Cookies let you store user information in web pages.\r\n * @see {@link https://www.w3schools.com/js/js_cookies.asp}\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nexport { isEnabled, set, setObject, get, getObject, copyObject, remove, defaultCookie };\r\n\r\n/**\r\n * Is the cookie enabled in your web browser?\r\n * @returns {boolean} true if cookie enabled\r\n * \r\n * @example\r\n\tvar isCookieEnabled = cookie.isEnabled('age', 25);\r\n */\r\nfunction isEnabled() {\r\n\r\n\treturn navigator.cookieEnabled;\r\n\t//Enable cookie\r\n\t//Chrome: Settings/Show advanced settings.../Privacy/Content settings.../Cookies/Allow local data to be set\r\n\r\n}\r\n\r\n/**\r\n * Set a cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} value cookie value.\r\n * @param {Date} [cookie_date] expiry date (in UTC time). Optional.\r\n * @example\r\n\tcookie.set('age', 25);\r\n */\r\nfunction set( name, value, cookie_date ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\tvalue = value.toString();\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tif ( cookie_date === undefined ) {\r\n\r\n\t\tcookie_date = new Date();  // Curent date and time\r\n\t\tcookie_date.setTime( cookie_date.getTime() + 1000 * 60 * 60 * 24 * 365 );//expiry date is one year\r\n\r\n\t}\r\n\tdocument.cookie = name + \"=\" + value + ( ( typeof settings == 'undefined' ) ? '' : settings ) + \"; expires=\" + cookie_date.toGMTString();\r\n\tif ( document.cookie === '' )\r\n\t\tconsole.error( 'document.cookie is empty' );\r\n\r\n}\r\n\r\n/**\r\n * sets an object into cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} object an object for saving into cookie\r\n */\r\nfunction setObject( name, object ) {\r\n\r\n\tset( name, JSON.stringify( object ) );\r\n\r\n};\r\n\r\n/**\r\n * Get a cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} [defaultValue] cookie default value. Optional.\r\n * @returns {string} cookie value or defaultValue if cookie was not found.\r\n * @example\r\n\tvar age = cookie.get('age', 25);\r\n */\r\nfunction get( name, defaultValue ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tvar results = document.cookie.match( '(^|;) ?' + name + '=([^;]*)(;|$)' );\r\n\r\n\tif ( results )\r\n\t\treturn ( unescape( results[2] ) );\r\n\tif ( typeof defaultValue == 'undefined' )\r\n\t\treturn '';\r\n\treturn defaultValue;\r\n\r\n}\r\n\r\n/**\r\n * gets an object from cookie.\r\n * @param {string} name name of the object\r\n * @param {any} options load an object from cookie into options\r\n * @param {Object} optionsDefault copy to options this default object if named object is not exists in the cookie.\r\n */\r\nfunction getObject( name, options, optionsDefault ) {\r\n\r\n//\tnew defaultCookie().getObject( name, options, JSON.parse( get( name, JSON.stringify( optionsDefault ) ) ) );\r\n\tnew defaultCookie().getObject( name, options, copyObject( name, optionsDefault ) );\r\n\r\n};\r\n\r\n/**\r\n * gets an object from cookie and returns a copy of object.\r\n * @param {string} name name of the object\r\n * @param {Object} objectDefault copy to options this default object if named object is not exists in the cookie.\r\n * @returns copy of object from cookie\r\n */\r\nfunction copyObject( name, objectDefault ) {\r\n\r\n\treturn JSON.parse( get( name, JSON.stringify( objectDefault ) ) );\r\n\r\n}\r\n\r\n/**\r\n * Remove cookie\r\n * @param {string} name cookie name.\r\n */\r\nfunction remove( name ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tvar cookie_date = new Date();  // ������� ���� � �����\r\n\tcookie_date.setTime( cookie_date.getTime() - 1 );\r\n\tdocument.cookie = name += \"=; expires=\" + cookie_date.toGMTString();\r\n\r\n}\r\n\r\nfunction consoleCookieEnabled() {\r\n\r\n\tconsole.error( 'navigator.cookieEnabled = ' + navigator.cookieEnabled );\r\n\r\n}\r\n\r\n/**\r\n * Default cookie is not saving settings\r\n * @param {any} name is not using\r\n */\r\nfunction defaultCookie( name ) {\r\n\r\n\t/**\r\n\t * Default cookie is not loading settings\r\n\t * @param {any} defaultValue\r\n\t * @returns defaultValue\r\n\t */\r\n\tthis.get = function ( defaultValue ) {\r\n\r\n\t\treturn defaultValue;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * Default cookie is not saving settings\r\n\t */\r\n\tthis.set = function () {\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * Default cookie is not loading objects\r\n\t * @param {string} name is not using\r\n\t * @param {any} options load an object from optionsDefault into options\r\n\t * @param {Object} optionsDefault source object\r\n\t */\r\n\tthis.getObject = function ( name, options, optionsDefault ) {\r\n\r\n\t\t// \r\n\t\tif ( !optionsDefault )\r\n\t\t\treturn;//object's settings is not saving\r\n\t\tObject.keys( optionsDefault ).forEach( function ( key ) {\r\n\r\n\t\t\t//I cannot modify options[key] if optionsDefault is read only and options[key] is not copy of optionsDefault[key]\r\n\t\t\t//options[key] = optionsDefault[key];\r\n\t\t\t//copy key\r\n\t\t\tvar option = optionsDefault[key];\r\n\t\t\tif ( ( option !== undefined ) && ( typeof option !== 'function' ) )\r\n\t\t\t\toptions[key] = JSON.parse( JSON.stringify( option ) );\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * copy and returns an object from objectDefault\r\n\t * @param {string} name is not using\r\n\t * @param {any} objectDefault source object\r\n\t */\r\n\tthis.copyObject = function ( name, objectDefault ){\r\n\r\n\t\treturn JSON.parse( JSON.stringify( objectDefault ) );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Default cookie is not saving object's settings\r\n\t */\r\n\tthis.setObject = function () {\r\n\r\n\t};\r\n\r\n\tthis.isTrue = function ( defaultValue ) {\r\n\r\n\t\treturn defaultValue;\r\n\r\n\t};\r\n\r\n};\r\n","﻿/**\r\n * node.js version of the cookie.\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\nimport { set as setCookie, get as getCookie, getObject, copyObject, setObject, defaultCookie } from './index.js';\r\nvar cookie = {\r\n\r\n\tset: setCookie,\r\n\tsetObject: setObject,\r\n\tget: getCookie,\r\n\tgetObject: getObject,\r\n\tcopyObject: copyObject,\r\n\tdefaultCookie: defaultCookie,\r\n\r\n}\r\n\r\nexport default cookie;","/**\r\n * @module Localization.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n/**\r\n * returns the \"primary language\" subtag of the version of the browser.\r\n * See the \"Syntax\" paragraph of RFC 4646 https://tools.ietf.org/html/rfc4646#section-2.1 for details.\r\n */\r\nexport function getLanguageCode() {\r\n\r\n\t//returns the language version of the browser.\r\n\tfunction _getLocale() {\r\n\r\n\t\tif ( !navigator ) {\r\n\r\n\t\t\tconsole.error( \"getLocale() failed! !navigator\" );\r\n\t\t\treturn \"\";\r\n\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\t( navigator.languages !== undefined )\r\n\t\t\t&& ( typeof navigator.languages !== 'unknown' )//for IE6\r\n\t\t\t&& ( navigator.languages.length > 0 )\r\n\t\t)\r\n\t\t\treturn navigator.languages[0];//Chrome\r\n\r\n\t\t//IE\r\n\t\tif ( navigator.language ) {\r\n\r\n\t\t\treturn navigator.language;\r\n\r\n\t\t} else if ( navigator.browserLanguage ) {\r\n\r\n\t\t\treturn navigator.browserLanguage;\r\n\r\n\t\t} else if ( navigator.systemLanguage ) {\r\n\r\n\t\t\treturn navigator.systemLanguage;\r\n\r\n\t\t} else if ( navigator.userLanguage ) {\r\n\r\n\t\t\treturn navigator.userLanguage;\r\n\r\n\t\t}\r\n\r\n\t\tconsole.error( \"getLocale() failed!\" );\r\n\t\treturn \"\";\r\n\r\n\t}\r\n\r\n\treturn _getLocale().toLowerCase().match( /([a-z]+)(?:-([a-z]+))?/ )[1];\r\n\r\n};\r\n\r\n","/**\r\n * @module CreateFullScreenSettings\r\n * @description creates functions for resize of the canvas to fullscreen and restore to default size.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import StereoEffect from 'https://raw.githack.com/anhr/commonNodeJS/master/StereoEffect/StereoEffect.js';\r\nimport StereoEffect from './StereoEffect/StereoEffect.js';\r\n\r\n/**\r\n * @callback onFullScreenToggle\r\n * @param {boolean} fullScreen false - full screen mode of the canvas.\r\n */\r\n\r\n/**\r\n * @class creates functions for resize of the canvas to fullscreen and restore to default size.\r\n * @param {THREE} THREE [THREE]{@link https://threejs.org/}\r\n * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}\r\n * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n * @param {object} options the following options are available:\r\n * @param {CanvasMenu} [options.canvasMenu] <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">CanvasMenu</a>\r\n * @param {StereoEffect} [options.stereoEffect] <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a> instance.\r\n * @param {object} [options.fullScreen] followed fullScreen methods available:\r\n * @param {onFullScreenToggle} [options.fullScreen.onFullScreenToggle] user toggled fullscreen mode of the canvas.\r\n */\r\nfunction CreateFullScreenSettings( THREE, renderer, camera, options ) {\r\n\r\n\tvar fullScreen = false, canvasMenu, stereoEffect;\r\n\r\n\toptions.fullScreen = options.fullScreen || {};\r\n\tif ( options.canvasMenu ) canvasMenu = options.canvasMenu;\r\n\tif ( options.stereoEffect ) stereoEffect = options.stereoEffect;\r\n\trenderer.setSize( renderer.domElement.width, renderer.domElement.height );\r\n\r\n\tvar style;\r\n\r\n\t/**\r\n\t * @returns <b>true</b> if <b>canvas</b> is full screen.\r\n\t */\r\n\tthis.isFullScreen = function () { return fullScreen; }\r\n\t/**\r\n\t * @param {StereoEffect} _stereoEffect <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a>.\r\n\t */\r\n\tthis.setStereoEffect = function ( _stereoEffect ) { stereoEffect = _stereoEffect; }\r\n\t/**\r\n\t * Sets the full screen of the canvas.\r\n\t * @param {boolean} [fullScreen=false] false - full screen of the canvas.\r\n\t */\r\n\tthis.setFullScreen = function ( fs=false ) {\r\n\r\n\t\tconst size = new THREE.Vector2();\r\n\t\trenderer.getSize( size );\r\n\t\tfullScreen = fs;\r\n\t\tif ( fullScreen ) {\r\n\r\n\t\t\tif ( style !== undefined ) {\r\n\r\n\t\t\t\t//restore size of the canvas\r\n\t\t\t\trenderer.setSize( style.sizeOriginal.x, style.sizeOriginal.y );\r\n\t\t\t\trenderer.domElement.style.position = style.position;\r\n\t\t\t\trenderer.domElement.style.left = style.left;\r\n\t\t\t\trenderer.domElement.style.top = style.top;\r\n\t\t\t\trenderer.domElement.style.width = style.width;\r\n\t\t\t\trenderer.domElement.style.height = style.height;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( style === undefined ) {\r\n\r\n\t\t\t\tstyle = {\r\n\r\n\t\t\t\t\tsizeOriginal: new THREE.Vector2(),\r\n\t\t\t\t\tposition: renderer.domElement.style.position,\r\n\t\t\t\t\tleft: renderer.domElement.style.left,\r\n\t\t\t\t\ttop: renderer.domElement.style.top,\r\n\t\t\t\t\twidth: renderer.domElement.style.width,\r\n\t\t\t\t\theight: renderer.domElement.style.height,\r\n\r\n\t\t\t\t}\r\n\t\t\t\trenderer.getSize( style.sizeOriginal );\r\n\t\t\t}\r\n\r\n\t\t\t//Full screen of the canvas\r\n\t\t\trenderer.setSize( window.innerWidth, window.innerHeight );\r\n\t\t\trenderer.domElement.style.position = 'fixed';\r\n\t\t\trenderer.domElement.style.left = 0;\r\n\t\t\trenderer.domElement.style.top = 0;\r\n\t\t\trenderer.domElement.style.width = '100%';\r\n\t\t\trenderer.domElement.style.height = '100%';\r\n\r\n\t\t}\r\n\t\t\t\r\n\t\tif ( options.fullScreen.onFullScreenToggle !== undefined ) options.fullScreen.onFullScreenToggle( fullScreen );\r\n\t\t\r\n\t\tcamera.aspect = size.x / size.y;\r\n\t\tcamera.updateProjectionMatrix();\r\n\t\tfullScreen = !fullScreen;\r\n\t\tif ( canvasMenu && canvasMenu.setFullScreenButton ) canvasMenu.setFullScreenButton( fullScreen );\r\n\t\tCreateFullScreenSettings.RendererSetSize( renderer, options.canvasMenu );\r\n\r\n\t}\r\n\t/**\r\n\t * User has clicked the \"Full Screen\" button on the <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">CanvasMenu</a>.\r\n\t * @event\r\n\t */\r\n\tthis.onclick = function () {\r\n\r\n\t\tif (\r\n\t\t\t( stereoEffect !== undefined )\r\n\t\t\t&& ( parseInt( stereoEffect.settings.spatialMultiplex ) !== StereoEffect.spatialMultiplexsIndexs.Mono )\r\n\t\t) {\r\n\r\n\t\t\tstereoEffect.settings.spatialMultiplex = StereoEffect.spatialMultiplexsIndexs.Mono;\r\n\r\n\t\t}\r\n\r\n\t\tthis.setFullScreen( fullScreen );\r\n\t\treturn fullScreen;\r\n\r\n\t}\r\n\r\n}\r\n/** @namespace\r\n * @description set size of renderer.\r\n * @param {THREE.WebGLRenderer} renderer [THREE.WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}.\r\n * @param {CanvasMenu} canvasMenu <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">CanvasMenu</a>\r\n */\r\nCreateFullScreenSettings.RendererSetSize = function ( renderer, canvasMenu ){\r\n\r\n\tif ( renderer.setSizeOld )\r\n\t\treturn;\r\n\t\t\r\n\trenderer.setSizeOld = renderer.setSize;\r\n\trenderer.setSize = function ( width, height, updateStyle ) {\r\n\r\n\t\trenderer.setSizeOld( width, height, updateStyle );\r\n\t\tconst elCanvas = renderer.domElement, elContainer = elCanvas.parentElement;\r\n\r\n\t\tsetTimeout( function () {\r\n\r\n\t\t\telContainer.style.height = elCanvas.style.height;\r\n\t\t\telContainer.style.width = elCanvas.style.width;\r\n\t\t\telContainer.style.left = elCanvas.style.left;\r\n\t\t\telContainer.style.top = elCanvas.style.top;\r\n\t\t\telContainer.style.position = elCanvas.style.position;\r\n\t\t\tif ( canvasMenu ) canvasMenu.setSize( width, height );\r\n\r\n\t\t}, 0 );\r\n\r\n\t};\r\n\r\n}\r\nexport default CreateFullScreenSettings;","/**\r\n * @module SpriteText\r\n * @description A sprite based text component. Text that always faces towards the camera.\r\n * @see {@link https://threejs.org/docs/index.html#api/en/objects/Sprite|THREE.Sprite}\r\n * \r\n * @author Andrej Hristoliubov. {@link https://anhr.github.io/AboutMe/|AboutMe}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\n//var THREE;\r\nimport three from '../three.js'\r\n\r\n/**\r\n * A sprite based text component.\r\n * @param {string|number} text The text to be displayed on the sprite. You can include a multiline text separated by \"\\r\\n\".\r\n * @param {THREE.Vector3} [position=new THREE.Vector3()] Position of the text.\r\n * @param {object} [options={}] the following options are available\r\n * @param {string} [options.name] Name of the <b>SpriteText</b> instance.\r\n * @param {THREE.Group} [options.group] Parent group of the SpriteText with common options.\r\n * See {@link https://github.com/anhr/SpriteText#groupuserdataoptionsspritetext---common-options-for-the-group-of-the-spritetext|common options for the group of the SpriteText}.\r\n * Default is undefined.\r\n * @param {number} [options.textHeight=0.04] The height of the text.\r\n * @param {number} [options.fov] Camera frustum vertical field of view, from bottom to top of view, in degrees.\r\n * {@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera.fov|PerspectiveCamera.fov}\r\n * Set the fov option as camera.fov if you want to see text size is independent from camera.fov. The text height will be calculated as textHeight = fov * textHeight / 50\r\n * Default is undefined.\r\n * @param {boolean} [options.sizeAttenuation=false] Whether the size of the sprite is attenuated by the camera depth. (Perspective camera only.)\r\n * See {@link https://threejs.org/docs/index.html#api/en/materials/SpriteMaterial.sizeAttenuation|SpriteMaterial.sizeAttenuation}\r\n * @param {number} [options.rotation=0] The rotation of the sprite in radians.\r\n * See {@link https://threejs.org/docs/index.html#api/en/materials/SpriteMaterial.rotation|SpriteMaterial.rotation}\r\n * @param {string} [options.fontFace='Arial'] CSS font-family - specifies the font of the text.\r\n * @param {string[]} [options.fontFaces] array of fontFaces. Example ['Arial', 'Verdana', 'Times'].\r\n * @param {string} [options.fontColor='rgba(255, 255, 255, 1)'] RGBA object or RGB object or HEX value.\r\n *\tExamples 'rgba(0, 0, 255, 0.5)', '#00FF00'.\r\n * @param {boolean} [options.bold=false] CSS font-weight. Equivalent of 700.\r\n * @param {boolean} [options.italic=false] CSS font-style.\r\n * @param {string} [options.fontProperties] Other font properties. The font property uses the same syntax as the CSS font property.\r\n * \tDefault is empty string. Example \"900\", \"oblique lighter\".\r\n * @param {object} [options.rect={}] rectangle around the text.\r\n * @param {boolean} [options.rect.displayRect=false] true - the rectangle around the text is visible.\r\n * @param {string} [options.rect.backgroundColor='rgba(0, 0, 0, 0)' - black transparent] background color. RGBA object or RGB object or HEX value\r\n * <pre>\r\n * \tExamples 'rgba(0, 0, 255, 0.5)', '#00FF00'.\r\n * </pre>\r\n * @param {string} [options.rect.borderColor] border color. RGBA object or RGB object or HEX value. Default is same as options.fontColor 'rgba(255, 255, 255, 1)' - white.\r\n * @param {number} [options.rect.borderThickness=0 is invisible border] border thickness.\r\n * @param {number} [options.rect.borderRadius=0 is no radius] border corners radius.\r\n * @param {THREE.Vector2|object} [options.center] If <b>center.x</b> and <b>center.y</b> is defined, then it the text's anchor point.\r\n * <pre>\r\n * See {@link https://threejs.org/docs/index.html#api/en/objects/Sprite.center|Sprite.center}\r\n * \tA value of (0.5, 0.5) corresponds to the midpoint of the text.\r\n * \tA value of (0, 0) corresponds to the left lower corner of the text.\r\n * \tA value of (0, 1) corresponds to the left upper corner of the text.\r\n * \t\r\n * Otherwise, the center is calculated so that the text is always inside the canvas.\r\n * Please define <b>center.camera</b> and <b>center.canvas</b> for it. See below for details.\r\n * \r\n * If <b>options.center</b> is not defined, center is left upper corner: <b>new THREE.Vector2( 0, 1 )</b>\r\n * </pre>\r\n * @param {THREE.PerspectiveCamera} [center.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n * @param {HTMLElement} [center.canvas] <b>canvas</b> element.\r\n * @see Thanks to {@link https://github.com/vasturiano/three-spritetext|three-spritetext}\r\n */\r\nexport function SpriteText( text, position,\toptions = {} ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\r\n\tposition = position || new THREE.Vector3( 0, 0, 0 );\r\n\r\n\tconst sprite = new THREE.Sprite( new THREE.SpriteMaterial( {\r\n\r\n\t\tmap: new THREE.Texture(),\r\n\t\tsizeAttenuation: options.sizeAttenuation !== undefined ? options.sizeAttenuation :\r\n\t\t\tfalse,//The size of the sprite is not attenuated by the camera depth. (Perspective camera only.)\r\n\r\n\t} ) );\r\n\tconst canvas = document.createElement( 'canvas' );\r\n\tsprite.material.map.minFilter = THREE.LinearFilter;\r\n\tconst fontSize = 90;\r\n\tconst context = canvas.getContext( '2d' );\r\n\r\n\tif ( options.name ) sprite.name = options.name;\r\n\r\n\tsprite.userData.update = function ( /*optionsUpdate*/ ) {\r\n\r\n\t\tconst optionsUpdate = {};\r\n\t\tif ( sprite.parent )\r\n\t\t\tupdateOptions( sprite.parent, optionsUpdate );\r\n\t\telse if ( options.group )\r\n\t\t\tupdateOptions( options.group, optionsUpdate );\r\n\t\tvar textHeight = options.textHeight || optionsUpdate.textHeight || 0.04;\r\n\t\tconst fov = options.fov || optionsUpdate.fov,\r\n\t\t\tsizeAttenuation = options.sizeAttenuation || optionsUpdate.sizeAttenuation || false,\r\n\t\t\trotation = options.rotation || optionsUpdate.rotation || 0,\r\n\t\t\tfontFace = options.fontFace || optionsUpdate.fontFace || 'Arial',\r\n\t\t\tbold = options.bold || optionsUpdate.bold || false,\r\n\t\t\titalic = options.italic || optionsUpdate.italic || false,\r\n\t\t\tfontProperties = options.fontProperties || optionsUpdate.fontProperties || '',\r\n\t\t\trect = options.rect || optionsUpdate.rect || {},\r\n\t\t\tcolor = 'rgba(255, 255, 255, 1)',\r\n\t\t\tfontColor = options.fontColor || optionsUpdate.fontColor || color,\r\n\t\t\tcenter = SpriteText.getCenter( options.center || optionsUpdate.center, position );\r\n\t\t\t\r\n\t\tif ( fov !== undefined )\r\n\t\t\ttextHeight = fov * textHeight / 50;\r\n\r\n\t\trect.displayRect = rect.displayRect || false;\r\n\t\tconst borderThickness = rect.borderThickness ? rect.borderThickness : 5,\r\n\t\t\tfont = `${fontProperties}${bold ? 'bold ' : ''}${italic ? 'italic ' : ''}${fontSize}px ${fontFace}`;\r\n\r\n\t\tcontext.font = font;\r\n\r\n\t\tvar width = 0, linesCount = 1,\r\n\t\t\tlines;\r\n\t\tif ( typeof text === 'string' ) {\r\n\r\n\t\t\tlinesCount = 0;\r\n\t\t\tlines = text.split( /\\r\\n|\\r|\\n/ );\r\n\t\t\tlines.forEach( function ( line ) {\r\n\r\n\t\t\t\tvar lineWidth = context.measureText( line ).width;\r\n\t\t\t\tif ( width < lineWidth )\r\n\t\t\t\t\twidth = lineWidth;\r\n\t\t\t\tlinesCount += 1;\r\n\r\n\t\t\t} );\r\n\r\n\t\t} else width = context.measureText( text ).width;\r\n\r\n\t\twidth += borderThickness * 2;\r\n\r\n\t\tconst textWidth = width;\r\n\t\tcanvas.width = textWidth;\r\n\t\tcanvas.height = fontSize * linesCount + borderThickness * 2;\r\n\r\n\t\tcontext.font = font;\r\n\r\n\t\t//Rect\r\n\t\t//Thanks to http://stemkoski.github.io/Three.js/Sprite-Text-Labels.html\r\n\t\tif ( rect.displayRect ) {\r\n\r\n\t\t\t// background color\r\n\t\t\tcontext.fillStyle = rect.backgroundColor ? rect.backgroundColor : 'rgba(0, 0, 0, 1)';\r\n\r\n\t\t\t// border color\r\n\t\t\tcontext.strokeStyle = rect.borderColor ? rect.borderColor : fontColor;\r\n\r\n\t\t\tcontext.lineWidth = borderThickness;\r\n\r\n\t\t\t// function for drawing rounded rectangles\r\n\t\t\tfunction roundRect( ctx, x, y, w, h, r ) {\r\n\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.moveTo( x + r, y );\r\n\t\t\t\tctx.lineTo( x + w - r, y );\r\n\t\t\t\tctx.quadraticCurveTo( x + w, y, x + w, y + r );\r\n\t\t\t\tctx.lineTo( x + w, y + h - r );\r\n\t\t\t\tctx.quadraticCurveTo( x + w, y + h, x + w - r, y + h );\r\n\t\t\t\tctx.lineTo( x + r, y + h );\r\n\t\t\t\tctx.quadraticCurveTo( x, y + h, x, y + h - r );\r\n\t\t\t\tctx.lineTo( x, y + r );\r\n\t\t\t\tctx.quadraticCurveTo( x, y, x + r, y );\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.stroke();\r\n\r\n\t\t\t}\r\n\t\t\troundRect( context,\r\n\t\t\t\tborderThickness / 2,\r\n\t\t\t\tborderThickness / 2,\r\n\t\t\t\tcanvas.width - borderThickness,\r\n\t\t\t\tcanvas.height - borderThickness,\r\n\t\t\t\trect.borderRadius === undefined ? 0 : rect.borderRadius\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tcontext.fillStyle = fontColor;\r\n\t\tcontext.textBaseline = 'bottom';\r\n\t\tif ( linesCount > 1 ) {\r\n\t\t\tfor ( var i = 0; i < lines.length; i++ ) {\r\n\r\n\t\t\t\tconst line = lines[i];\r\n\t\t\t\tcontext.fillText( line, borderThickness, canvas.height - ( ( lines.length - i - 1 ) * fontSize ) - borderThickness );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else context.fillText( text, borderThickness, canvas.height - borderThickness );\r\n\r\n\t\t// Inject canvas into sprite\r\n\t\tsprite.material.map.image = canvas;\r\n\t\tsprite.material.map.needsUpdate = true;\r\n\r\n\t\tconst th = textHeight * linesCount;// * angleDistance;\r\n\t\tsprite.scale.set( th * canvas.width / canvas.height, th );\r\n\t\tsprite.position.copy( position );\r\n\t\tsprite.center = center;\r\n\r\n\t\t//size attenuation. Whether the size of the sprite is attenuated by the camera depth. (Perspective camera only.) Default is false.\r\n\t\t//See https://threejs.org/docs/index.html#api/en/materials/SpriteMaterial.sizeAttenuation\r\n\t\tsprite.material.sizeAttenuation = sizeAttenuation;\r\n\r\n\t\tsprite.material.rotation = rotation;\r\n\t\tsprite.material.needsUpdate = true;\r\n\r\n\t};\r\n\tsprite.userData.update();\r\n\r\n\tsprite.userData.updateText = function ( _text ) {\r\n\r\n\t\ttext = _text;\r\n\t\tconst options = {}\r\n\t\tupdateOptions( sprite.parent, options );\r\n\t\tsprite.userData.update( options );\r\n\r\n\t}\r\n\tif ( options.group )\r\n\t\toptions.group.add( sprite );\r\n\r\n\tsprite.userData.optionsSpriteText = options;\r\n\r\n\treturn sprite;\r\n\r\n};\r\n\r\n/**\r\n * @namespace\r\n * @description Returns {@link https://threejs.org/docs/index.html#api/en/objects/Sprite.center|center}\r\n * @param {THREE.Vector2|object} center If <b>center.x</b> and <b>center.y</b> is defined, then it the text's anchor point.\r\n * <pre>\r\n * Otherwise, the center is calculated so that the text is always inside the canvas.\r\n * Please define <b>center.camera</b> and <b>center.canvas</b> for it. See below for details.\r\n * </pre>\r\n * @param {THREE.PerspectiveCamera} [center.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n * @param {HTMLElement} [center.canvas] <b>canvas</b> element.\r\n * @param {THREE.Vector3} [position] Position of the text. Uses only if <b>center.camera</b> and <b>center.canvas</b> is defined\r\n * @returns center. If <b>center</b> is not defined, returns the left upper corner: <b>new THREE.Vector2( 0, 1 )</b>;\r\n */\r\nSpriteText.getCenter = function ( center = {}, position ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\tconst canvas = center.canvas ? center.canvas : undefined;\r\n\t/**\r\n\t * Converting World coordinates to Screen coordinates\r\n\t * https://stackoverflow.com/questions/11586527/converting-world-coordinates-to-screen-coordinates-in-three-js-using-projection\r\n\t */\r\n\tfunction worldToScreen() {\r\n\r\n\t\tconst width = canvas.width, height = canvas.height,\r\n\t\t\twidthHalf = width / 2, heightHalf = height / 2;\r\n//\t\t\tpos = position.clone();\r\n\t\tconst pos = new THREE.Vector3().copy( position );\r\n\t\tpos.project( center.camera );\r\n\t\tpos.x = ( pos.x * widthHalf ) + widthHalf;\r\n\t\tpos.y = - ( pos.y * heightHalf ) + heightHalf;\r\n\t\treturn pos;\r\n\r\n\t}\r\n\tconst screenPos = center.canvas ? worldToScreen() : undefined;\r\n\treturn center instanceof THREE.Vector2 ||\r\n\t\t( ( typeof center === \"object\" ) && ( center.x !== undefined ) && ( center.y !== undefined )//При копироваении и при чтении из cockie THREE.Vector2 превращается в Object{x: x, y: y}\r\n\t\t) ? center : screenPos ?\r\n\t\t\tnew THREE.Vector2( screenPos.x < ( canvas.width / 2 ) ? 0 : 1, screenPos.y < ( canvas.height / 2 ) ? 1 : 0 ) :\r\n\t\t\tnew THREE.Vector2( 0, 1 );//Default is left upper corner\r\n\r\n}\r\n\r\nfunction updateOptions( group, options ) {\r\n\r\n\tif ( group.userData.optionsSpriteText )\r\n\t\tObject.keys( group.userData.optionsSpriteText ).forEach( function ( key ) {\r\n\r\n\t\t\tif ( options[key] === undefined )//Child options have more priority before parent options\r\n\t\t\t\toptions[key] = group.userData.optionsSpriteText[key];\r\n\r\n\t\t} );\r\n\twhile ( group.parent ) {\r\n\r\n\t\tgroup = group.parent;\r\n\t\tupdateOptions( group, options );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @namespace\r\n * @description Call <b>SpriteText.updateSpriteTextGroup</b> if you want to update of the <b>options</b> of all <a href=\"module-SpriteText.html\" target=\"_blank\">SpriteText</a>, added in to <b>group</b> and all <b>child groups</b>.\r\n * @param {THREE.Group|THREE.Scene} group [group]{@link https://threejs.org/docs/index.html?q=gr#api/en/objects/Group} or [scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene} of the <b>SpriteText</b> and of all <b>child groups</b> of the <b>SpriteText</b> for which these settings will have an effect.\r\n * @example\r\n<script>\r\n\toptionsSpriteText = {\r\n\r\n\t\ttextHeight: 0.1,\r\n\t\tsizeAttenuation: false,\r\n\r\n\t}\r\n\tconst fSpriteTextAll = SpriteTextGui( scene, options, {\r\n\r\n\t\tsettings: { zoomMultiplier: 1.5, },\r\n\t\toptions: optionsSpriteText\r\n\r\n\t} );\r\n\r\n\t//Change of the text height\r\n\toptionsSpriteText.textHeight = 0.2;\r\n\r\n\t//update of the options of all SpriteText, added in to group and all child groups\r\n\tSpriteText.updateSpriteTextGroup( group );\r\n\r\n\t//To do something...\r\n\r\n\t//Restore options.textHeight to 0.1\r\n\tfSpriteTextAll.userData.restore();\r\n</script>\r\n*/\r\nSpriteText.updateSpriteTextGroup = function( group ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\tgroup.children.forEach( function ( spriteItem ) {\r\n\r\n\t\tif ( spriteItem instanceof THREE.Sprite ) {\r\n\r\n\t\t\tif ( spriteItem.userData.update !== undefined )\r\n\t\t\t\tspriteItem.userData.update();\r\n\r\n\t\t} //else if ( spriteItem instanceof THREE.Group )\r\n\t\t\tSpriteText.updateSpriteTextGroup( spriteItem );\r\n\r\n\t} );\r\n\r\n}\r\n","/**\r\n * @module StereoEffect\r\n * @description Uses dual PerspectiveCameras for Parallax Barrier effects.\r\n * @see About {@link https://en.wikipedia.org/wiki/Parallax_barrier|Parallax barrier}.\r\n * \r\n * @author {@link https://anhr.github.io/AboutMe/|Andrej Hristoliubov}\r\n * @author {@link http://alteredqualia.com/|alteredq}\r\n * @author {@link http://mrdoob.com/|mrdoob}\r\n * @author {@link http://aleksandarrodic.com/|arodic}\r\n * @author {@link http://fonserbc.github.io/|fonserbc}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport three from '../three.js'\r\n\r\nimport PositionController from '../PositionController.js';\r\n//import PositionController from 'https://raw.githack.com/anhr/commonNodeJS/master/PositionController.js';\r\n\r\n//import cookie from '../cookieNodeJS/cookie.js';\r\n//import cookie from 'https://raw.githack.com/anhr/commonNodeJS/master/cookieNodeJS/cookie.js';\r\n\r\n//import { dat } from '../dat/dat.module.js';\r\n//import { dat } from 'https://raw.githack.com/anhr/commonNodeJS/master/dat/dat.module.js';\r\n\r\nimport CreateFullScreenSettings from '../createFullScreenSettings.js';\r\nimport Options from '../Options.js'\r\n\r\nclass StereoEffect {\r\n\r\n\t/**\r\n\t * @class\r\n\t * Uses dual PerspectiveCameras for [Parallax Barrier]{@link https://en.wikipedia.org/wiki/Parallax_barrier} effects.\r\n\t * @param {THREE.WebGLRenderer} renderer {@link https://threejs.org/docs/#api/en/renderers/WebGLRenderer|WebGL renderer}\r\n\t * @param {Options} [options=new Options()] <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a> instance.\r\n\t * See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] Your custom getLanguageCode() function.\r\n\t * <pre>\r\n\t * returns the \"primary language\" subtag of the language version of the browser.\r\n\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t * See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|Syntax} paragraph of RFC 4646 for details.\r\n\t * </pre>\r\n\t * @param {Object} [options.lang] Object with localized language values.\r\n\t * @param {boolean} [options.dat.cookie] false - do not save to cookie the StereoEffects  settings\r\n\t * @param {string} [options.dat.cookieName] Name of the cookie is \"StereoEffect\" + options.dat.cookieName.\r\n\t * @param {boolean|Object} [options.stereoEffect] false - do not create a <b>StereoEffect</b> instance.\r\n\t * <p>Or:</p>\r\n\t * @param {number} [options.stereoEffect.spatialMultiplex=spatialMultiplexsIndexs.Mono] spatial multiplex\r\n\t * <pre>\r\n\t * See {@link https://en.wikipedia.org/wiki/DVB_3D-TV|DVB 3D-TV} for details\r\n\t * \tAvailable values\r\n\t *\r\n\t * \t\tspatialMultiplexsIndexs.Mono - no stereo effacts\r\n\t *\r\n\t * \t\tspatialMultiplexsIndexs.SbS - 'Side by side' format just put the left and right images one next to the other.\r\n\t * \t\t\tSee https://en.wikipedia.org/wiki/DVB_3D-TV#Side_by_side for dretails\r\n\t *\r\n\t * \t\tspatialMultiplexsIndexs.TaB - 'Top and bottom' format put left and right images one above the other.\r\n\t * \t\t\tSee //https://en.wikipedia.org/wiki/DVB_3D-TV#Top_and_bottom for details\r\n\t *\r\n\t * \tExample - options.stereoEffect.spatialMultiplex: StereoEffect.spatialMultiplexsIndexs.Mono\r\n\t * </pre>\r\n\t * @param {THREE.PerspectiveCamera} [options.stereoEffect.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}. Use the <b>camera</b> key if you want control cameras focus.\r\n\t * @param {Float} [options.stereoEffect.far=10] Camera frustum far plane. The <b>far</b> key uses for correct calculation default values of Eye separation.\r\n\t * See <b>far</b> parameter of the [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=PerspectiveCamera#api/en/cameras/PerspectiveCamera.far}\r\n\t * @param {Float} [options.stereoEffect.eyeSep=( new THREE.StereoCamera().eyeSep / 10 ) * options.stereoEffect.far] Eye separation.\r\n\t * See [StereoCamera.eyeSep]{@link https://threejs.org/docs/index.html?q=StereoCamera#api/en/cameras/StereoCamera.eyeSep}.\r\n\t * @param {Float} [options.stereoEffect.stereoAspect=1] [THREE.StereoCamera.aspect]{@link https://threejs.org/docs/index.html?q=StereoCamera#api/en/cameras/StereoCamera.aspect}. Camera frustum aspect ratio.\r\n\t * @param {boolean} [options.stereoEffect.rememberSize] true - remember default size of the canvas. Resize of the canvas to full screen for stereo mode and restore to default size if no stereo effacts.\r\n\t * @param {HTMLElement} [options.stereoEffect.elParent] parent of the canvas.\r\n\t * Use only if you use {@link https://threejs.org/docs/index.html#api/en/core/Raycaster|THREE.Raycaster} (working out what objects in the 3d space the mouse is over)\r\n\t * and your canvas is not full screen.\r\n\t */\r\n\tconstructor( renderer, options = new Options() ) {\r\n\r\n\t\tif ( !renderer ) {\r\n\r\n\t\t\tconsole.error( 'StereoEffect: renderer = ' + renderer );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n//\t\tsettings = settings || {};\r\n//\t\tsettings.options = settings.options || new Options();\r\n//\t\tconst options = settings.options;\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\toptions = new Options( options );\r\n/*\r\n\t\t\tconsole.error( 'StereoEffect: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n*/\t\t\t\r\n\r\n\t\t}\r\n\t\tif ( options.stereoEffect === false ) return;\r\n\r\n\t\tif( options.dat.gui ) options.dat.mouseenter = false;//true - мышка находится над gui или canvasMenu\r\n\t\t\t\t//В этом случае не надо обрабатывать событие elContainer 'pointerdown'\r\n\t\t\t\t//по которому выбирается точка на canvas.\r\n\t\t\t\t//В противном случае если пользователь щелкнет на gui, то он может случайно выбрать точку на canvas.\r\n\t\t\t\t//Тогда открывается папка Meshes и все органы управления сдвигаются вниз. Это неудобно.\r\n\t\t\t\t//И вообще нехорошо когда выбирается точка когда пользователь не хочет это делать.\r\n\r\n\t\tconst THREE = three.THREE;\r\n\t\tassign();\r\n//\t\tconst _this = this;\r\n\r\n\t\toptions.stereoEffect = options.stereoEffect || {};\r\n\r\n\t\tconst settings = options.stereoEffect;\r\n\t\t/**\r\n\t\t * See <b>options.stereoEffect</b> parameter of the <b>StereoEffect</b> class above.\r\n\t\t * */\r\n\t\tthis.settings = settings;\r\n\t\t/**\r\n\t\t * See <b>options</b> parameter of the <b>StereoEffect</b> class above.\r\n\t\t * */\r\n\t\tthis.options = options;\r\n/*\r\n\t\tif ( options.stereoEffect ) {\r\n\r\n\t\t\tconsole.error( 'StereoEffect: duplicate stereoEffect.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n*/\r\n\t\toptions.stereoEffect = this;\r\n\r\n\t\t//Убрал spatialMultiplex: settings.spatialMultiplex !== undefined ? settings.spatialMultiplex : spatialMultiplexsIndexs.Mono,//SbS,\r\n\t\t//из const optionsDefault\r\n\t\t//Потому что будет ошибка \r\n\t\t//THREE.StereoEffect.render: Invalid \"Spatial  multiplex\" parameter: NaN\r\n\t\t//если в приложении не используется StereoEffect.gui\r\n\t\t//и не определен settings.spatialMultiplex\r\n\t\tif ( settings.spatialMultiplex === undefined ) settings.spatialMultiplex = spatialMultiplexsIndexs.Mono;//SbS\r\n\r\n\t\tsettings.stereo = new THREE.StereoCamera();\r\n\t\tsettings.stereo.aspect = settings.stereoAspect || 1;//0.5;\r\n\t\tif ( settings.far === undefined )\r\n\t\t\tsettings.far = new THREE.PerspectiveCamera().focus;\r\n\t\tsettings.focus = settings.camera === undefined ? new THREE.PerspectiveCamera().focus :\r\n\t\t\tnew THREE.Vector3().distanceTo( settings.camera.position );\r\n\t\tsettings.zeroParallax = 0;\r\n\t\tsettings.eyeSep = settings.eyeSep || ( new THREE.StereoCamera().eyeSep / 10 ) * settings.far;\r\n\t\tif ( settings.camera !== undefined )\r\n\t\t\tsettings.camera.focus = settings.focus;\r\n\r\n\t\t/**\r\n\t\t * Sets eye separation.\r\n\t\t * @param {any} eyeSep See <b>options.stereoEffect.eyeSep</b> parameter of the <b>StereoEffect</b> class above.\r\n\t\t */\r\n\t\tthis.setEyeSeparation = function ( eyeSep ) {\r\n\r\n\t\t\tsettings.stereo.eyeSep = eyeSep;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setEyeSeparation( settings.eyeSep );\r\n\r\n\t\t/**\r\n\t\t * Convert mouse position to renderer coordinates.\r\n\t\t * @returns <pre>\r\n\t\t * {\r\n\t\t *\r\n\t\t *\tgetMousePosition:function\r\n\t\t *\r\n\t\t * }\r\n\t\t * </pre>\r\n\t\t */\r\n\t\tthis.getRendererSize = function () {\r\n\r\n\t\t\treturn Options.raycaster.EventListeners.getRendererSize( renderer, settings.elParent );\r\n/*\r\n\t\t\tconst el = settings.elParent || renderer.domElement,\r\n\t\t\t\tstyle = {\r\n\r\n\t\t\t\t\tposition: el.style.position,\r\n\t\t\t\t\tleft: el.style.left,\r\n\t\t\t\t\ttop: el.style.top,\r\n\t\t\t\t\twidth: el.style.width,\r\n\t\t\t\t\theight: el.style.height,\r\n\r\n\t\t\t\t},\r\n\t\t\t\trect = el.getBoundingClientRect(),\r\n\t\t\t\tleft = Math.round( rect.left ),\r\n\t\t\t\ttop = Math.round( rect.top ),\r\n\t\t\t\tsize = new THREE.Vector2();\r\n\t\t\trenderer.getSize( size );\r\n\t\t\treturn {\r\n\r\n\t\t\t\tgetMousePosition: function ( mouse, event ) {\r\n\r\n\t\t\t\t\tmouse.x = ( event.clientX / size.x ) * 2 - 1 - ( left / size.x ) * 2;\r\n\t\t\t\t\tmouse.y = - ( event.clientY / size.y ) * 2 + 1 + ( top / size.y ) * 2;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t};\r\n*/\r\n\r\n\t\t};\r\n\t\tvar fullScreenSettings;\r\n\t\tvar spatialMultiplexCur;\r\n\t\t/**\r\n\t\t * Render a scene or another type of object using a camera.\r\n\t\t * @see [WebGLRenderer.render]{@link https://threejs.org/docs/index.html?q=WebGLRenderer#api/en/renderers/WebGLRenderer.render}\r\n\t\t * @param {THREE.Scene} scene [Scene]{@link https://threejs.org/docs/index.html#api/en/scenes/Scene}.\r\n\t\t * @param {THREE.Camera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=persp#api/en/cameras/PerspectiveCamera}.\r\n\t\t */\r\n\t\tthis.render = function ( scene, camera ) {\r\n\r\n\t\t\tconst spatialMultiplex = parseInt( settings.spatialMultiplex );\r\n\r\n\t\t\tif ( settings.rememberSize && !fullScreenSettings ) {\r\n\r\n\t\t\t\tif ( _canvasMenu && _canvasMenu.getFullScreenSettings )\r\n\t\t\t\t\tfullScreenSettings = _canvasMenu.getFullScreenSettings( this );\r\n\t\t\t\telse fullScreenSettings = new CreateFullScreenSettings( THREE, renderer, camera,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcanvasMenu: _canvasMenu,\r\n\t\t\t\t\t\tstereoEffect: this,\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscene.updateMatrixWorld();\r\n\r\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\r\n\r\n\t\t\tconst size = new THREE.Vector2();\r\n\t\t\trenderer.getSize( size );\r\n\r\n\t\t\tif ( renderer.autoClear ) renderer.clear();\r\n\t\t\trenderer.setScissorTest( true );\r\n\r\n\t\t\tvar xL, yL, widthL, heightL,\r\n\t\t\t\txR, yR, widthR, heightR;\r\n\t\t\tconst parallax = settings.zeroParallax;\r\n\t\t\t/*\t\t\r\n\t\t\t\t\tfunction setFullScreen( fullScreen, stereoEffect ){\r\n\t\t\t\r\n\t\t\t\t\t\tif ( !fullScreenSettings || ( spatialMultiplexCur === spatialMultiplex ) )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tfullScreenSettings.setFullScreen( fullScreen );\r\n\t\t\t\t\t\tspatialMultiplexCur = spatialMultiplex;\r\n\t\t\t\t\t\tif ( stereoEffect.setControllerSpatialMultiplex ) stereoEffect.setControllerSpatialMultiplex( spatialMultiplex );\r\n\t\t\t\t\t\telse if ( stereoEffect.setSpatialMultiplex ) stereoEffect.setSpatialMultiplex( spatialMultiplex );\r\n\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t*/\r\n\t\t\tfunction setMultiplex( stereoEffect ) {\r\n\r\n\t\t\t\tif ( !fullScreenSettings || ( spatialMultiplexCur === spatialMultiplex ) )\r\n\t\t\t\t\treturn false;\r\n\t\t\t\tspatialMultiplexCur = spatialMultiplex;\r\n\t\t\t\tif ( stereoEffect.setControllerSpatialMultiplex ) stereoEffect.setControllerSpatialMultiplex( spatialMultiplex );\r\n\t\t\t\telse if ( stereoEffect.setSpatialMultiplex ) stereoEffect.setSpatialMultiplex( spatialMultiplex );\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\t\t\tfunction setFullScreen( fullScreen, stereoEffect ) {\r\n\r\n\t\t\t\tif ( setMultiplex( stereoEffect ) )\r\n\t\t\t\t\tfullScreenSettings.setFullScreen( fullScreen );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( spatialMultiplex ) {\r\n\r\n\t\t\t\tcase spatialMultiplexsIndexs.Mono://Mono\r\n\r\n\t\t\t\t\trenderer.setScissor( 0, 0, size.width, size.height );\r\n\t\t\t\t\trenderer.setViewport( 0, 0, size.width, size.height );\r\n\t\t\t\t\trenderer.render( scene, camera );\r\n\t\t\t\t\trenderer.setScissorTest( false );\r\n\r\n\t\t\t\t\t//если оствить setFullScreen то canvas не перейдет в full screen\r\n\t\t\t\t\t//если в программе по умолчанию был задан full screen и используется canvasMenu\r\n\t\t\t\t\t//Для провероки\r\n\t\t\t\t\t//в файле \"D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\commonNodeJS\\master\\myThree\\Examples\\html\\index.html\"\r\n\t\t\t\t\t//\tдля new MyThree(...)\r\n\t\t\t\t\t//\t\tустановить canvasMenu: true,\r\n\t\t\t\t\t//\t\tубрать canvas: { fullScreen: false, }. Тоесть по умолчанию canvas перейдет в full screen\r\n\t\t\t\t\t//открыть http://localhost/anhr/commonNodeJS/master/myThree/Examples/html/\r\n\r\n\t\t\t\t\t//setFullScreen( true, this );\r\n\r\n\t\t\t\t\t//если оставить setFullScreen то canvas не перейдет в full screen\r\n\t\t\t\t\t//если убрать setFullScreen то canvas перейдет в full screen\r\n\t\t\t\t\t//но тогда будет неправильно выбираться пункт меню stereo Effects в canvasMenu в случае, если \r\n\t\t\t\t\t//Выбрать пункт \"слева направо\" меню stereo Effects в canvasMenu.\r\n\t\t\t\t\t//\tвключится стерео режим.\r\n\t\t\t\t\t//\tcanvas перейдет в full screen.\r\n\t\t\t\t\t//Выбрать пункт \"Восстановить размеры экрана\" меню stereo Effects в canvasMenu.\r\n\t\t\t\t\t//\tcanvas выйдет из full screen.\r\n\t\t\t\t\t//\tстерео режим отключится\r\n\t\t\t\t\t//\tНО! ОСТАНЕТСЯ ВЫБРАННЫМ пункт \"слева направо\" меню stereo Effects в canvasMenu.\r\n\t\t\t\t\t//Для решения проблемы вставил строку ниже\r\n\r\n\t\t\t\t\tsetMultiplex( this );\r\n\r\n\t\t\t\t\t//Теперь в режиме full screen при выборе пункта \"Моно\" меню stereo Effects в canvasMenu\r\n\t\t\t\t\t//canvas не выходит из full screen. Ну и фиг с ним.\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tcase spatialMultiplexsIndexs.SbS://'Side by side'\r\n\r\n\t\t\t\t\tconst _width = size.width / 2;\r\n\r\n\t\t\t\t\txL = 0 + parallax; yL = 0; widthL = _width; heightL = size.height;\r\n\t\t\t\t\txR = _width - parallax; yR = 0; widthR = _width; heightR = size.height;\r\n\r\n\t\t\t\t\tsetFullScreen( false, this );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase spatialMultiplexsIndexs.TaB://'Top and bottom'\r\n\r\n\t\t\t\t\txL = 0 + parallax; yL = 0; widthL = size.width; heightL = size.height / 2;\r\n\t\t\t\t\txR = 0 - parallax; yR = size.height / 2; widthR = size.width; heightR = size.height / 2;\r\n\r\n\t\t\t\t\tsetFullScreen( false, this );\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error( 'THREE.StereoEffect.render: Invalid \"Spatial  multiplex\" parameter: ' + spatialMultiplex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsettings.stereo.update( camera );\r\n\r\n\t\t\trenderer.setScissor( xL, yL, widthL, heightL );\r\n\t\t\trenderer.setViewport( xL, yL, widthL, heightL );\r\n\t\t\trenderer.render( scene, settings.stereo.cameraL );\r\n\r\n\t\t\trenderer.setScissor( xR, yR, widthR, heightR );\r\n\t\t\trenderer.setViewport( xR, yR, widthR, heightR );\r\n\t\t\trenderer.render( scene, settings.stereo.cameraR );\r\n\r\n\t\t\trenderer.setScissorTest( false );\r\n\r\n\t\t};\r\n\r\n\t\t//Localization\r\n\t\tfunction getLang( params ) {\r\n\r\n\t\t\tparams = params || {};\r\n\t\t\tconst _lang = {\r\n\r\n\t\t\t\tstereoEffects: 'Stereo effects',\r\n\r\n\t\t\t\tspatialMultiplexName: 'Spatial  multiplex',\r\n\t\t\t\tspatialMultiplexTitle: 'Choose a way to do spatial multiplex.',\r\n\r\n\t\t\t\tspatialMultiplexs: {\r\n\t\t\t\t\t'Mono': spatialMultiplexsIndexs.Mono,\r\n\t\t\t\t\t'Side by side': spatialMultiplexsIndexs.SbS, //https://en.wikipedia.org/wiki/DVB_3D-TV#Side_by_side\r\n\t\t\t\t\t'Top and bottom': spatialMultiplexsIndexs.TaB, //https://en.wikipedia.org/wiki/DVB_3D-TV#Top_and_bottom\r\n\t\t\t\t},\r\n\r\n\t\t\t\teyeSeparationName: 'Eye separation',\r\n\t\t\t\teyeSeparationTitle: 'The distance between left and right cameras.',\r\n\r\n\t\t\t\tfocus: 'Focus',\r\n\t\t\t\tfocusTitle: 'Object distance.',\r\n\r\n\t\t\t\tzeroParallaxName: 'Zero parallax',\r\n\t\t\t\tzeroParallaxTitle: 'Distance to objects with zero parallax.',\r\n\r\n\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\tdefaultTitle: 'Restore default stereo effects settings.',\r\n\r\n\t\t\t};\r\n\r\n\t\t\tconst _languageCode = params.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t: params.getLanguageCode();\r\n\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t_lang.stereoEffects = 'Стерео эффекты';//'Stereo effects'\r\n\r\n\t\t\t\t\t_lang.spatialMultiplexName = 'Мультиплекс';//'Spatial  multiplex'\r\n\t\t\t\t\t_lang.spatialMultiplexTitle = 'Выберите способ создания пространственного мультиплексирования.';\r\n\r\n\t\t\t\t\t_lang.spatialMultiplexs = {\r\n\t\t\t\t\t\t'Моно': spatialMultiplexsIndexs.Mono, //Mono\r\n\t\t\t\t\t\t'Слева направо': spatialMultiplexsIndexs.SbS, //https://en.wikipedia.org/wiki/DVB_3D-TV#Side_by_side\r\n\t\t\t\t\t\t'Сверху вниз': spatialMultiplexsIndexs.TaB, //https://en.wikipedia.org/wiki/DVB_3D-TV#Top_and_bottom\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_lang.eyeSeparationName = 'Развод камер';\r\n\t\t\t\t\t_lang.eyeSeparationTitle = 'Расстояние между левой и правой камерами.';\r\n\r\n\t\t\t\t\t_lang.focus = 'Фокус';\r\n\t\t\t\t\t_lang.focusTitle = 'Расстояние до объекта.';\r\n\r\n\t\t\t\t\t_lang.zeroParallaxName = 'Параллакс 0';\r\n\t\t\t\t\t_lang.zeroParallaxTitle = 'Расстояние до объектов с нулевым параллаксом.';\r\n\r\n\t\t\t\t\t_lang.defaultButton = 'Восстановить';\r\n\t\t\t\t\t_lang.defaultTitle = 'Восстановить настройки стерео эффектов по умолчанию.';\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault://Custom language\r\n\t\t\t\t\tif ( ( params.lang === undefined ) || ( params.lang._languageCode != _languageCode ) )\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tObject.keys( params.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\tif ( _lang[key] === undefined )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t_lang[key] = params.lang[key];\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\treturn _lang;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Adds StereoEffects folder into dat.GUI.\r\n\t\t * @see {@link https://github.com/anhr/dat.gui|dat.gui}.\r\n\t\t * @param {Object} [guiParams={}] the following params are available.\r\n\t\t * @param {GUI} [guiParams.dat] [dat.GUI()]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t * @param {GUI} [guiParams.folder] <b>StereoEffects</b> folder. See {@link https://github.com/anhr/dat.gui|dat.gui} for details\r\n\t\t * @param {Function} [guiParams.onChangeMode] The event is fired if user has changed the stereo mode.\r\n\t\t * <pre>\r\n\t\t * parameter is new stereo mode.\r\n\t\t * See the <b>settings.spatialMultiplex</b> parameter of the <b>StereoEffect</b> class for details.\r\n\t\t * <pre>\r\n\t\t * @param {number} [guiParams.scale=1] scale of allowed values.\r\n\t\t */\r\n\t\tthis.gui = function ( guiParams = {} ) {\r\n\r\n/*\r\n\t\t\tif ( !optionsGui.boOptions ) {\r\n\r\n\t\t\t\tconsole.error( 'StereoEffect.gui: call optionsGui = new Options( options ) first' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n*/\r\n\t\t\tconst gui = guiParams.folder || options.dat.gui;\r\n\t\t\tif ( !gui || options.dat.stereoEffectsGui === false )\r\n\t\t\t\treturn;\r\n\t\t\tconst dat = guiParams.dat || three.dat;//options.dat.dat;\r\n\t\t\tif ( guiParams === undefined ) guiParams = {};\r\n\t\t\tguiParams.scale = guiParams.scale || 1;\r\n/*\r\n\r\n\t\t\tconst _lang = getLang( { getLanguageCode: guiParams.getLanguageCode, lang: guiParams.lang } );\r\n\r\n\t\t\tconst stereoEffect = 'StereoEffect' + ( guiParams.cookieName || '' );\r\n\t\t\tguiParams.cookie = guiParams.cookie || new cookie.defaultCookie();\r\n*/\r\n\t\t\tconst stereoEffect = options.dat.getCookieName( 'StereoEffect' ),\r\n\t\t\t\t_lang = getLang( { getLanguageCode: options.getLanguageCode, lang: options.lang } );\r\n\t\t\t\r\n\t\t\tconst optionsDefault = {\r\n\r\n\t\t\t\t//spatialMultiplex: settings.spatialMultiplex !== undefined ? settings.spatialMultiplex : spatialMultiplexsIndexs.Mono,//SbS,\r\n\t\t\t\tspatialMultiplex: settings.spatialMultiplex,\r\n\t\t\t\teyeSep: ( new THREE.StereoCamera().eyeSep / 10 ) * settings.far,\r\n\t\t\t\tfocus: settings.focus,\r\n\t\t\t\tzeroParallax: 0,\r\n\r\n\t\t\t}\r\n\t\t\tObject.freeze( optionsDefault );\r\n\t\t\toptions.dat.cookie.getObject( stereoEffect, settings, optionsDefault );\r\n\t\t\tsettings.spatialMultiplex = parseInt( settings.spatialMultiplex );\r\n\r\n\t\t\tif ( this.setSpatialMultiplex ) this.setSpatialMultiplex( settings.spatialMultiplex );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfunction displayControllers( value ) {\r\n\r\n\t\t\t\tconst display = value == spatialMultiplexsIndexs.Mono ? 'none' : 'block';\r\n\t\t\t\t_fEyeSeparation.domElement.style.display = display;\r\n\t\t\t\tif ( _controllerCameraFocus !== undefined )\r\n\t\t\t\t\t_controllerCameraFocus.__li.style.display = display;\r\n\t\t\t\t_controllerDefaultF.__li.style.display = display;\r\n\t\t\t\t_controllerZeroParallax.__li.style.display = display;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst _fStereoEffects = gui.addFolder( _lang.stereoEffects );//Stero effects folder\r\n\r\n\t\t\t//Spatial multiplex\r\n\t\t\tconst _controllerSpatialMultiplex = _fStereoEffects.add( settings, 'spatialMultiplex',\r\n\t\t\t\t_lang.spatialMultiplexs ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\tvalue = parseInt( value );\r\n\t\t\t\t\tdisplayControllers( value );\r\n\t\t\t\t\tsetObject( stereoEffect );\r\n\t\t\t\t\tif ( guiParams.onChangeMode )\r\n\t\t\t\t\t\tguiParams.onChangeMode( value );\r\n\t\t\t\t\tif ( menuItemStereoEffect )\r\n\t\t\t\t\t\tmenuItemStereoEffect.select( value )\r\n\r\n\t\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( _controllerSpatialMultiplex, _lang.spatialMultiplexName, _lang.spatialMultiplexTitle );\r\n\t\t\tthis.setControllerSpatialMultiplex = function ( index ) {\r\n\r\n\t\t\t\tsaveToCookie = false;\r\n\t\t\t\t_controllerSpatialMultiplex.setValue( index );\r\n\t\t\t\tsaveToCookie = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//eyeSeparation\r\n\t\t\t//http://paulbourke.net/papers/vsmm2007/stereoscopy_workshop.pdf\r\n\t\t\tconst _fEyeSeparation = _fStereoEffects.addFolder( _lang.eyeSeparationName );//Eye Separation\r\n\t\t\tdat.folderNameAndTitle( _fEyeSeparation, _lang.eyeSeparationName, _lang.eyeSeparationTitle );\r\n\t\t\t_fEyeSeparation.add( new PositionController( function ( shift ) {\r\n\r\n\t\t\t\tsettings.eyeSep += shift;\r\n\t\t\t\t_controllerEyeSep.setValue( settings.eyeSep );\r\n\r\n\t\t\t}, { settings: { offset: 0.01 }, min: 0.0001, max: 0.01, step: 0.0001 }\r\n\t\t\t) );\r\n\t\t\tconst _controllerEyeSep = dat.controllerZeroStep( _fEyeSeparation, settings.stereo, 'eyeSep', function ( value ) {\r\n\r\n\t\t\t\tsettings.eyeSep = value;\r\n\t\t\t\tsetObject( stereoEffect );\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( _controllerEyeSep, _lang.eyeSeparationName, _lang.eyeSeparationTitle );\r\n\r\n\t\t\tif ( settings.camera !== undefined ) settings.camera.focus = settings.focus;\r\n\t\t\t\r\n\t\t\tvar _controllerCameraFocus;\r\n\t\t\tif ( settings.camera ) {\r\n\r\n\t\t\t\t_controllerCameraFocus = _fStereoEffects.add( settings.camera,\r\n\t\t\t\t\t'focus', optionsDefault.focus / 10, optionsDefault.focus * 2, optionsDefault.focus / 1000 )\r\n\t\t\t\t\t.onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\t//\t\t\t\t\tsettings.camera.focus = value;\r\n\t\t\t\t\t\tsettings.focus = value;\r\n\t\t\t\t\t\tsetObject( stereoEffect );\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\tdat.controllerNameAndTitle( _controllerCameraFocus, _lang.focus, _lang.focusTitle );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Zero parallax\r\n\t\t\t//http://paulbourke.net/papers/vsmm2007/stereoscopy_workshop.pdf\r\n\t\t\tconst _minMax = ( 60 - ( 400 / 9 ) ) * guiParams.scale + 400 / 9;\r\n\t\t\tconst _controllerZeroParallax = _fStereoEffects.add( settings, 'zeroParallax', - _minMax, _minMax )\r\n\t\t\t\t.onChange( function ( value ) {\r\n\r\n\t\t\t\t\tsettings.zeroParallax = value;\r\n\t\t\t\t\tsetObject( stereoEffect );\r\n\r\n\t\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( _controllerZeroParallax, _lang.zeroParallaxName, _lang.zeroParallaxTitle );\r\n\r\n\t\t\t//default button\r\n\t\t\tconst _controllerDefaultF = _fStereoEffects.add( {\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\tsettings.stereo.eyeSep = optionsDefault.eyeSep;\r\n\t\t\t\t\t_controllerEyeSep.setValue( settings.stereo.eyeSep );\r\n\r\n\t\t\t\t\tif ( settings.camera ) {\r\n\r\n\t\t\t\t\t\tsettings.camera.focus = optionsDefault.focus;\r\n\t\t\t\t\t\t_controllerCameraFocus.setValue( settings.camera.focus );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tsettings.zeroParallax = optionsDefault.zeroParallax;\r\n\t\t\t\t\t_controllerZeroParallax.setValue( settings.zeroParallax );\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' );\r\n\t\t\tdat.controllerNameAndTitle( _controllerDefaultF, _lang.defaultButton, _lang.defaultTitle );\r\n\r\n\t\t\tdisplayControllers( settings.spatialMultiplex );\r\n\r\n\t\t\tvar saveToCookie = true;\r\n\t\t\t/**\r\n\t\t\t * sets an object into cookie.\r\n\t\t\t * @param {string} name cookie name.\r\n\t\t\t */\r\n\t\t\tfunction setObject( name ) {\r\n\r\n\t\t\t\tif ( !saveToCookie )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tconst object = {};\r\n\t\t\t\tObject.keys( optionsDefault ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\tobject[key] = settings[key];\r\n\r\n\t\t\t\t} );\r\n//\t\t\t\tguiParams.cookie.setObject( name, object );\r\n\t\t\t\toptions.dat.cookie.setObject( name, object );\r\n\r\n\t\t\t};\r\n\r\n\t\t};\r\n\r\n\t\tvar _canvasMenu, menuItemStereoEffect;\r\n\t\t/**\r\n\t\t * Adds a StereoEffect's menu item into [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t * @param {CanvasMenu} [canvasMenu] [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t * @param {Object} [params] the following params are available.\r\n\t\t * @param {Function} [params.getLanguageCode=language code of your browser] Your custom getLanguageCode() function.\r\n\t\t * <pre>\r\n\t\t   * returns the \"primary language\" subtag of the language version of the browser.\r\n\t\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t * See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|Syntax} paragraph of RFC 4646 for details.\r\n\t\t * </pre>\r\n\t\t   * @param {Object} [guiParams.lang] Object with localized language values.\r\n\t\t */\r\n\t\tthis.createCanvasMenuItem = function ( canvasMenu, params ) {\r\n\r\n\t\t\t_canvasMenu = canvasMenu;\r\n\t\t\tparams = params || {};\r\n\t\t\tconst _lang = getLang( { getLanguageCode: params.getLanguageCode, lang: params.lang } ),\r\n\t\t\t\tspatialMultiplexs = Object.keys( _lang.spatialMultiplexs );\r\n\t\t\tmenuItemStereoEffect = {\r\n\r\n\t\t\t\tname: '⚭',\r\n\t\t\t\ttitle: _lang.stereoEffects,//'Stereo effects',\r\n\t\t\t\tid: 'menuButtonStereoEffects',\r\n\t\t\t\tdrop: 'up',\r\n\t\t\t\titems: [\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: spatialMultiplexs[spatialMultiplexsIndexs.Mono],//'Mono',\r\n\t\t\t\t\t\tid: 'menuButtonStereoEffectsMono',\r\n\t\t\t\t\t\tradio: true,\r\n\t\t\t\t\t\tchecked: settings.spatialMultiplex === spatialMultiplexsIndexs.Mono,\r\n\t\t\t\t\t\tspatialMultiplex: spatialMultiplexsIndexs.Mono,\r\n\t\t\t\t\t\tonclick: function ( event ) {\r\n\r\n\t\t\t\t\t\t\tsettings.spatialMultiplex = spatialMultiplexsIndexs.Mono;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: spatialMultiplexs[spatialMultiplexsIndexs.SbS],//'Side by side',\r\n\t\t\t\t\t\tid: 'menuButtonStereoEffectsSbS',\r\n\t\t\t\t\t\tradio: true,\r\n\t\t\t\t\t\tchecked: settings.spatialMultiplex === spatialMultiplexsIndexs.SbS,\r\n\t\t\t\t\t\tspatialMultiplex: spatialMultiplexsIndexs.SbS,\r\n\t\t\t\t\t\tonclick: function ( event ) {\r\n\r\n\t\t\t\t\t\t\tsettings.spatialMultiplex = spatialMultiplexsIndexs.SbS;\r\n\t\t\t\t\t\t\t//if ( canvasMenu.setFullScreen ) canvasMenu.setFullScreen( false );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: spatialMultiplexs[spatialMultiplexsIndexs.TaB],//'Top and bottom',\r\n\t\t\t\t\t\tid: 'menuButtonStereoEffectsTaB',\r\n\t\t\t\t\t\tradio: true,\r\n\t\t\t\t\t\tchecked: settings.spatialMultiplex === spatialMultiplexsIndexs.TaB,\r\n\t\t\t\t\t\tspatialMultiplex: spatialMultiplexsIndexs.TaB,\r\n\t\t\t\t\t\tonclick: function ( event ) {\r\n\r\n\t\t\t\t\t\t\tsettings.spatialMultiplex = spatialMultiplexsIndexs.TaB;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t],\r\n\r\n\t\t\t}\r\n\t\t\tmenuItemStereoEffect.select = function ( value ) {\r\n\r\n\t\t\t\tmenuItemStereoEffect.items.forEach( function ( item ) {\r\n\r\n\t\t\t\t\tif ( item.spatialMultiplex === value ) {\r\n\r\n\t\t\t\t\t\tif ( !item.checked )\r\n\t\t\t\t\t\t\titem.elName.onclick( { target: item.elName } );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\tthis.setSpatialMultiplex = function ( index ) {\r\n\r\n\t\t\t\tmenuItemStereoEffect.select( index );\r\n\r\n\t\t\t}\r\n\t\t\tcanvasMenu.menu.push( menuItemStereoEffect );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n/*\r\nconst spatialMultiplexsIndexs = {\r\n\tMono: 0,\r\n\tSbS: 1, //\r\n\tTaB: 2, //\r\n}\r\nObject.freeze( spatialMultiplexsIndexs );\r\n*/\r\n/**\r\n * Enumeration of available stereo modes. Available as <b>StereoEffect.spatialMultiplexsIndexs</b>.\r\n * @see {@link https://en.wikipedia.org/wiki/DVB_3D-TV|DVB 3D-TV} for details\r\n * @readonly\r\n * @enum {number}\r\n */\r\nStereoEffect.spatialMultiplexsIndexs = {\r\n\t/** No stereo effect */\r\n\tMono: 0,\r\n\t/** {@link https://en.wikipedia.org/wiki/DVB_3D-TV#Side_by_side|Side by side} */\r\n\tSbS: 1, //\r\n\t/** {@link https://en.wikipedia.org/wiki/DVB_3D-TV#Top_and_bottom|Top and bottom} */\r\n\tTaB: 2, //\r\n}\r\nObject.freeze( StereoEffect.spatialMultiplexsIndexs );\r\nconst spatialMultiplexsIndexs = StereoEffect.spatialMultiplexsIndexs;\r\n\r\n/* * @namespace\r\n * @description Assigh setStereoEffect to [THREE.Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster}\r\n */\r\nfunction assign() {\r\n\r\n\tconst THREE = three.THREE;\r\n/*\r\n\tif ( THREE ) {\r\n\r\n\t\tif ( !Object.is( THREE, _THREE ) )\r\n\t\t\tconsole.error( 'setTHREE: duplicate THREE. Please use one instance of the THREE library.' )\r\n\t\treturn;\r\n\r\n\t}\r\n\tTHREE = _THREE;\r\n\tSpriteText.setTHREE( THREE );\r\n*/\r\n\tif ( new THREE.Raycaster().setStereoEffect )\r\n\t\treturn;\r\n\t\t\r\n\t//Modifying of THREE.Raycaster for StereoEffect\r\n\tObject.assign( THREE.Raycaster.prototype, {\r\n\r\n\t\t/**\r\n\t\t * @namespace\r\n\t\t * @description Sets the <b>StereoEffect</b> settings to the {@link https://threejs.org/docs/#api/en/core/Raycaster|THREE.Raycaster}.\r\n\t\t * Available as <b>THREE.Raycaster.setStereoEffect(...)</b>.\r\n\t\t * @param {Object} [settings]\r\n\t\t * @param {THREE.PerspectiveCamera} settings.camera {@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera|PerspectiveCamera}\r\n\t\t * @param {StereoEffect} [settings.stereoEffect=no stereo effects] stereoEffect.\r\n\t\t * @param {THREE.WebGLRenderer} [settings.renderer=renderer parameter of THREE.StereoEffect] renderer. The {@link https://threejs.org/docs/#api/en/renderers/WebGLRenderer|WebGL renderer} displays your beautifully crafted scenes using WebGL.\r\n\t\t * @param {boolean} [settings.raycasterEvents=true] true - add raycaster events: mousemove and pointerdown.\r\n\t\t */\r\n\t\tsetStereoEffect: function ( settings ) {\r\n\r\n\t\t\tsettings = settings || {};\r\n\t\t\tsettings.raycasterEvents = settings.raycasterEvents === undefined ? true : settings.raycasterEvents;\r\n\t\t\tconst camera = settings.camera, renderer = settings.renderer;\r\n\r\n\t\t\tif ( settings.raycasterEvents ){\r\n\r\n\t\t\t\tconst mouse = new THREE.Vector2();\r\n\t\t\t\twindow.addEventListener( 'mousemove', function ( event ) {\r\n\r\n\t\t\t\t\t// calculate mouse position in normalized device coordinates\r\n\t\t\t\t\t// (-1 to +1) for both components\r\n\r\n\t\t\t\t\tmouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;\r\n\t\t\t\t\tmouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;\r\n\r\n\t\t\t\t\t// update the picking ray with the camera and mouse position\r\n\t\t\t\t\traycaster.setFromCamera( mouse, camera );\r\n\r\n\t\t\t\t\traycaster.stereo.onDocumentMouseMove( event );\r\n\r\n\t\t\t\t}, false );\r\n\t\t\t\twindow.addEventListener( 'pointerdown', function ( event ) {\r\n\r\n\t\t\t\t\traycaster.stereo.onDocumentMouseDown( event );\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst stereoEffect = settings.stereoEffect !== undefined ? settings.stereoEffect : typeof effect !== 'undefined' ? effect :\r\n/*\t\t\t\r\n\t\t\t\tnew StereoEffect( renderer, {\r\n\r\n\t\t\t\t\tspatialMultiplex: spatialMultiplexsIndexs.Mono, //.SbS,\r\n\t\t\t\t\tfar: camera ? camera.far : undefined,\r\n\t\t\t\t\tcamera: camera,\r\n\t\t\t\t\tstereoAspect: 1,\r\n\r\n\t\t\t\t} ),\r\n*/\t\t\t\t\r\n\t\t\t\tnew StereoEffect( renderer, {\r\n\r\n\t\t\t\t\tstereoEffect : {\r\n\r\n\t\t\t\t\t\tspatialMultiplex: spatialMultiplexsIndexs.Mono, //.SbS,\r\n\t\t\t\t\t\tfar: camera ? camera.far : undefined,\r\n\t\t\t\t\t\tcamera: camera,\r\n\t\t\t\t\t\tstereoAspect: 1,\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} ),\r\n\t\t\t\traycaster = this,\r\n\t\t\t\tmouseL = new THREE.Vector2(),\r\n\t\t\t\tmouseR = new THREE.Vector2();\r\n\t\t\tvar particles, //The object or array of objects to check for intersection with the ray. See THREE.Raycaster.intersectObject https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject for details.\r\n\t\t\t\tintersects, //An array of intersections is returned by THREE.Raycaster.intersectObject or THREE.Raycaster.intersectObjects.\r\n\t\t\t\tmouse; //Attention!!! Do not assign new THREE.Vector2() here\r\n\t\t\t//for prevention of invalid detection of intersection with zero point ( THREE.Vector3( 0, 0, 0 ) )\r\n\t\t\t//after opening of the web page and before user has moved mouse.\r\n\r\n\t\t\tfunction getMousePosition() {\r\n\r\n\t\t\t\tstereoEffect.getRendererSize().getMousePosition( mouse, event );\r\n\r\n\t\t\t\tfunction mousePosition( vectorName, b ) {\r\n\r\n\t\t\t\t\tmouseL.copy( mouse );\r\n\t\t\t\t\tmouseR.copy( mouse );\r\n\t\t\t\t\tconst a = 0.5;\r\n\r\n\t\t\t\t\tmouseL[vectorName] += a;\r\n\t\t\t\t\tmouseL[vectorName] *= 2;\r\n\r\n\t\t\t\t\tmouseR[vectorName] -= a;\r\n\t\t\t\t\tmouseR[vectorName] *= 2;\r\n\r\n\t\t\t\t\t//zeroParallax\r\n\t\t\t\t\tconst size = new THREE.Vector2();\r\n\t\t\t\t\trenderer.getSize( size );\r\n\t\t\t\t\tconst zeroParallax = ( stereoEffect.settings.zeroParallax / size.x ) * b;\r\n\t\t\t\t\tmouseL.x -= zeroParallax;\r\n\t\t\t\t\tmouseR.x += zeroParallax;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch ( parseInt( stereoEffect.settings.spatialMultiplex ) ) {\r\n\r\n\t\t\t\t\tcase spatialMultiplexsIndexs.Mono:\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tcase spatialMultiplexsIndexs.SbS:\r\n\t\t\t\t\t\tmousePosition( 'x', 4 );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase spatialMultiplexsIndexs.TaB:\r\n\t\t\t\t\t\tmousePosition( 'y', 2 );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: console.error( 'THREE.Raycaster.setStereoEffect.getMousePosition: Invalid effect.settings.spatialMultiplex = ' + effect.settings.spatialMultiplex );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tfunction getIntersects() {\r\n\r\n\t\t\t\tif ( particles === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tintersects = Array.isArray( particles ) ? raycaster.intersectObjects( particles ) : raycaster.intersectObject( particles );\r\n\r\n\t\t\t}\r\n\t\t\tvar intersectedObject = undefined;\r\n\t\t\tfunction intersection( optionsIntersection ) {\r\n\r\n\t\t\t\tif ( mouse === undefined )\r\n\t\t\t\t\treturn;//User has not moved mouse\r\n\r\n\t\t\t\toptionsIntersection = optionsIntersection || settings;\r\n\t\t\t\tfunction isIntersection() {\r\n\r\n\t\t\t\t\tgetIntersects();\r\n\t\t\t\t\tif ( intersects.length > 0 ) {\r\n\r\n\t\t\t\t\t\tconst intersection = intersects[0];\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tintersection &&\r\n\t\t\t\t\t\t\tintersection.object.userData.raycaster &&\r\n\t\t\t\t\t\t\tintersection.object.userData.raycaster.onIntersection\r\n\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\tintersection.object.userData.raycaster.onIntersection( intersection, mouse );\r\n\t\t\t\t\t\t\tintersectedObject = intersection.object;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( intersectedObject ){\r\n\r\n\t\t\t\t\t\tintersectedObject.userData.raycaster.onIntersectionOut();\r\n\t\t\t\t\t\tintersectedObject = undefined;\r\n\r\n\t\t\t\t\t}\r\n/*\t\t\t\t\t\r\n\t\t\t\t\tif ( intersectedObject && ( intersects.length === 0 ) ) {\r\n\r\n\t\t\t\t\t\tintersectedObject.userData.raycaster.onIntersectionOut();\r\n\t\t\t\t\t\tintersectedObject = undefined;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if ( !intersectedObject ) {\r\n\r\n\t\t\t\t\t\tvar intersection = intersects[0];\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tintersection &&\r\n\t\t\t\t\t\t\tintersection.object.userData.raycaster &&\r\n\t\t\t\t\t\t\tintersection.object.userData.raycaster.onIntersection\r\n\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\tintersection.object.userData.raycaster.onIntersection( intersection, mouse );\r\n\t\t\t\t\t\t\tintersectedObject = intersection.object;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n*/\t\t\t\t\t\r\n\t\t\t\t\treturn intersects.length > 0;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( parseInt( stereoEffect.settings.spatialMultiplex ) !== spatialMultiplexsIndexs.Mono ) {\r\n\r\n\t\t\t\t\tconst mouseCur = mouse;\r\n\t\t\t\t\tmouse = mouseL;\r\n\t\t\t\t\traycaster.setFromCamera( mouseL, camera );\r\n\t\t\t\t\tif ( !isIntersection() ) {\r\n\r\n\t\t\t\t\t\tmouse = mouseR;\r\n\t\t\t\t\t\traycaster.setFromCamera( mouseR, camera );\r\n\t\t\t\t\t\tisIntersection();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmouse = mouseCur;\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\traycaster.setFromCamera( mouse, camera );\r\n\t\t\t\tisIntersection();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * @namespace\r\n\t\t\t * @description\r\n\t\t\t * <pre>\r\n\t\t\t * [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} helper.\r\n\t\t\t * Available as <b>raycaster.stereo</b>.\r\n\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t * </pre>\r\n\t\t\t * */\r\n\t\t\tthis.stereo = {\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * [mousemove]{@link https://developer.mozilla.org/en-US/docs/Web/API/Element/mousemove_event} event.\r\n\t\t\t\t * User is moving of mouse over canvas.\r\n\t\t\t\t * @param {object} event\r\n\t\t\t\t */\r\n\t\t\t\tonDocumentMouseMove: function ( event ) {\r\n\r\n\t\t\t\t\tif ( particles === undefined )\r\n\t\t\t\t\t\treturn;//The object or array of objects to check for intersection with the ray is not defined. See THREE.Raycaster.intersectObject https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject for details.\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tif ( mouse === undefined )\r\n\t\t\t\t\t\tmouse = new THREE.Vector2();\r\n\t\t\t\t\tgetMousePosition();\r\n\t\t\t\t\tintersection();\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * [pointerdown]{@link https://developer.mozilla.org/en-US/docs/Web/API/Document/pointerdown_event} event.\r\n\t\t\t\t * User has clicked over an object from the <b>particles</b> array.\r\n\t\t\t\t * @param {object} event\r\n\t\t\t\t */\r\n\t\t\t\tonDocumentMouseDown: function ( event ) {\r\n\r\n\t\t\t\t\tif ( stereoEffect.options.dat.mouseenter )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif ( intersects && intersects.length > 0 ) {\r\n\r\n\t\t\t\t\t\tif ( intersects[0].object.userData.raycaster ) {\r\n\r\n\t\t\t\t\t\t\tconst intersect = intersects[0];\r\n\t\t\t\t\t\t\tif ( intersect.object.userData.raycaster.onMouseDown )\r\n\t\t\t\t\t\t\t\tintersect.object.userData.raycaster.onMouseDown( intersect );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * Available as <b>raycaster.stereo.isAddedToParticles( particle )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class instance for check is added to <b>particles</b>.\r\n\t\t\t\t * @returns true if <b>particle</b> is added to <b>particles</b>.\r\n\t\t\t\t */\r\n\t\t\t\tisAddedToParticles: function ( particle ) {\r\n\r\n\t\t\t\t\tif ( !particles )\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\treturn particles.includes( particle );\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * Adds new particle into array of objects to check for intersection with the ray.\r\n\t\t\t\t * Available as <b>raycaster.stereo.addParticle( particle )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class instance for check for intersection with the ray.\r\n\t\t\t\t */\r\n\t\t\t\taddParticle: function ( particle ) {\r\n\r\n\t\t\t\t\tif ( particles === undefined )\r\n\t\t\t\t\t\tparticles = [];\r\n\t\t\t\t\tif ( this.isAddedToParticles( particle ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Duplicate particle \"' + particle.name + '\"' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparticles.push( particle );\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * New array of objects to check for intersection with the ray.\r\n\t\t\t\t * Available as <b>raycaster.stereo.addParticles( particles )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {array} newParticles New array of objects to check for intersection with the ray.\r\n\t\t\t\t */\r\n\t\t\t\taddParticles: function ( newParticles ) {\r\n\r\n\t\t\t\t\tif ( particles !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( !Array.isArray( particles ) ) {\r\n\r\n\t\t\t\t\t\t\tvar particlesCur = particles;\r\n\t\t\t\t\t\t\tparticles = [];\r\n\t\t\t\t\t\t\tparticles.push( particlesCur );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparticles.push( newParticles );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparticles = newParticles;\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * Remove particle from array of objects to check for intersection with the ray.\r\n\t\t\t\t * Available as <b>raycaster.stereo.removeParticle( particle )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class instance for removing from array of objects for check for intersection with the ray.\r\n\t\t\t\t */\r\n\t\t\t\tremoveParticle: function ( particle ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < particles.length; i++ ) {\r\n\r\n\t\t\t\t\t\tif ( Object.is( particle, particles[i] ) ) {\r\n\r\n\t\t\t\t\t\t\tparticles.splice( i, 1 );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * remove array of objects to check for intersection with the ray.\r\n\t\t\t\t * Available as <b>raycaster.stereo.removeParticles()</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t */\r\n\t\t\t\tremoveParticles: function () { particles = undefined; },\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * get position of intersected object\r\n\t\t\t\t * Available as <b>raycaster.stereo.getPosition( intersection )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @param {object} intersection first item of array of intersections.\r\n\t\t\t\t * @See [Raycaster.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details\r\n\t\t\t\t */\r\n\t\t\t\tgetPosition: function ( intersection ) {\r\n\r\n\t\t\t\t\tconst attributesPosition = intersection.object.geometry.attributes.position;\r\n\r\n\t\t\t\t\t//Если опредедить как const, то при выполнении npm run build появится ошибка\r\n\t\t\t\t\t//(babel plugin) SyntaxError: D:/My documents/MyProjects/webgl/three.js/GitHub/commonNodeJS/master/StereoEffect/StereoEffect.js: \"position\" is read-only\r\n\t\t\t\t\tvar position = attributesPosition.itemSize >= 4 ? new THREE.Vector4( 0, 0, 0, 0 ) : new THREE.Vector3();\r\n\r\n\t\t\t\t\tif ( intersection.index !== undefined ) {\r\n\r\n\t\t\t\t\t\tposition.fromArray( attributesPosition.array, intersection.index * attributesPosition.itemSize );\r\n\r\n\t\t\t\t\t\tposition.multiply( intersection.object.scale );\r\n\r\n\t\t\t\t\t\tposition.add( intersection.object.position );\r\n\r\n\t\t\t\t\t} else position = intersection.object.position;\r\n\t\t\t\t\treturn position;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\t\t\t//\t\tvar stereo = this.stereo;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n}\r\nStereoEffect.assign = assign;\r\n//StereoEffect.setTHREE = setTHREE;\r\n\r\n//Localization\r\n\r\nimport { getLanguageCode } from '../lang.js';\r\n//import { getLanguageCode } from 'https://raw.githack.com/anhr/commonNodeJS/master/lang.js';\r\n\r\nconst lang = {\r\n\r\n\tmesh: 'Mesh',\r\n\tpointName: 'Point Name',\r\n\tcolor: 'Сolor',\r\n\topacity: 'Opacity',\r\n\r\n};\r\n\r\nswitch ( getLanguageCode() ) {\r\n\r\n\tcase 'ru'://Russian language\r\n\t\tlang.mesh = '3D объект';\r\n\t\tlang.pointName = 'Имя точки';\r\n\t\tlang.color = 'Цвет';\r\n\t\tlang.opacity = 'Непрозрачность';\r\n\t\tbreak;\r\n\r\n}\r\n\r\nimport { SpriteText } from '../SpriteText/SpriteText.js';\r\n//import { SpriteText } from 'https://raw.githack.com/anhr/commonNodeJS/master/SpriteText/SpriteText.js';\r\n//SpriteText.setTHREE( THREE );\r\n\r\nimport { getObjectPosition } from '../getPosition.js';\r\n//getPositionSetTHREE( THREE );\r\n//import { getObjectPosition } from '../guiSelectPoint/guiSelectPoint.js';\r\n//import { getObjectPosition } from 'https://raw.githack.com/anhr/commonNodeJS/master/guiSelectPoint/guiSelectPoint.js';\r\n\r\n/** @namespace\r\n * @description Creates the <a href=\"../../SpriteText/jsdoc\" target=\"_blank\">SpriteText</a> instance with information about point, intersected with mouse cursor.\r\n * @param {THREE.Raycaster.intersectObject} intersection See [intersection]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details.\r\n * @param {object} [options={}] The following options are available\r\n * @param {object} [options.scales] axes scales.\r\n * See <b>options.scales</b> parameter of the <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a> class for details.\r\n * @param {object} [options.spriteOptions={}] Options of the <b>SpriteText</b>.\r\n * See [SpriteText]{@link https://raw.githack.com/anhr/commonNodeJS/master/SpriteText/jsdoc/module-SpriteText..html} for details.\r\n * @returns <b>new SpriteText</b> with information about point, intersected with mouse cursor.\r\n */\r\nStereoEffect.getTextIntersection = function ( intersection, options = {} ) {\r\n\r\n\tconst spriteText = Options.findSpriteTextIntersection( options.spriteOptions.group );\r\n\tif ( spriteText )\r\n\t\treturn spriteText;\r\n\t\t\r\n\tconst THREE = three.THREE;\r\n\tconst position = getObjectPosition( intersection.object, intersection.index ),\r\n\t\tscales = options.scales || {},\r\n\t\tisArrayFuncs = (\r\n\t\t\t( intersection.index !== undefined ) &&\r\n\t\t\t( intersection.object.userData.player !== undefined ) &&\r\n\t\t\t( intersection.object.userData.player.arrayFuncs !== undefined ) \r\n\t\t),\r\n\t\tfuncs = !isArrayFuncs ? undefined : intersection.object.userData.player.arrayFuncs,\r\n\t\tfunc = ( funcs === undefined ) || ( typeof funcs === \"function\" ) ? undefined : funcs[intersection.index],\r\n\t\tpointName = isArrayFuncs && func ? func.name : undefined,\r\n\t\tcolor = !isArrayFuncs || ( func === undefined ) ?\r\n\t\t\tundefined :\r\n\t\t\tArray.isArray( func.w ) ?\r\n\t\t\t\tPlayer.execFunc( func, 'w', group.userData.t, options ) ://.a, options.b ) :\r\n\t\t\t\tfunc.w;\r\n\r\n\tconst boXYZ = !scales.x &&  !scales.y &&  !scales.z;\r\n\toptions.spriteOptions.name = Options.findSpriteTextIntersection.spriteTextIntersectionName;\r\n\treturn new SpriteText(\r\n\r\n\t\t//text\r\n\t\t( intersection.object.name === '' ? '' : lang.mesh + ': ' + intersection.object.name ) +\r\n\t\t( pointName === undefined ? '' : '\\n'+ lang.pointName + ': ' + pointName ) +\r\n\t\t( !boXYZ && !scales.x ? '' : '\\n' + ( scales.x && scales.x.name ? scales.x.name : 'X' ) + ': ' + position.x ) +\r\n\t\t( !boXYZ && !scales.y ? '' : '\\n' + ( scales.y && scales.y.name ? scales.y.name : 'Y' ) + ': ' + position.y ) +\r\n\t\t( !boXYZ && !scales.z ? '' : '\\n' + ( scales.z && scales.z.name ? scales.z.name : 'Z' ) + ': ' + position.z ) + \r\n\t\t(//w\r\n\t\t\t!isArrayFuncs ?\r\n\t\t\t\t'' :\r\n\t\t\t\tfuncs[intersection.index] instanceof THREE.Vector4 ||\r\n\t\t\t\t\tfuncs[intersection.index] instanceof THREE.Vector3 ||\r\n\t\t\t\t\ttypeof funcs === \"function\" ?\r\n\t\t\t\t\tcolor instanceof THREE.Color ?\r\n\t\t\t\t\t\t'\\n' + lang.color + ': ' + new THREE.Color( color.r, color.g, color.b ).getHexString() :\r\n\t\t\t\t\t\tposition.w !== undefined ? '\\n' + ( scales.w && scales.w.name ? scales.w.name : 'W' ) + ': ' + position.w : '' :\r\n\t\t\t\t\t''\r\n\r\n\t\t) +\r\n\t\t(//opacity\r\n\t\t\t( intersection.object.geometry.attributes.ca === undefined ) ||\r\n\t\t\t\t( intersection.object.geometry.attributes.ca.itemSize < 4 ) ?\r\n\t\t\t\t'' :\r\n\t\t\t\t'\\n' + lang.opacity + ': ' + new THREE.Vector4().fromArray(\r\n\r\n\t\t\t\t\tintersection.object.geometry.attributes.ca.array,\r\n\t\t\t\t\tintersection.index * intersection.object.geometry.attributes.ca.itemSize\r\n\r\n\t\t\t\t).w\r\n\t\t),\r\n\r\n\t\tposition, options.spriteOptions\r\n\t);\r\n\r\n}\r\n\r\n//export { StereoEffect, spatialMultiplexsIndexs };\r\nexport default StereoEffect;","/**\r\n * options of the canvas\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//При выполнении npm run build получаю ошибку\r\n//(babel plugin) ReferenceError: Unknown plugin \"external-helpers\" specified in \"base\" at 1, attempted to resolve relative to \"D:\\\\My documents\\\\MyProjects\\\\webgl\\\\three.js\\\\GitHub\\\\three.js\\\\dev\\\\examples\\\\jsm\"\r\n//import { WEBGL } from '../../three.js/dev/examples/jsm/WebGL.js';\r\n\r\nimport { WEBGL } from './WebGL.js';\r\n//import { WEBGL } from 'https://raw.githack.com/anhr/three.js/dev/examples/jsm/WebGL.js';\r\n\r\n//for testing open FireFox and read https://support.biodigital.com/hc/en-us/articles/218322977-How-to-turn-on-WebGL-in-my-browser#h_01EJW3MGDF7KH3PH6TG2DE13H6\r\nif ( WEBGL.isWebGLAvailable() === false ) {\r\n\r\n\tdocument.body.appendChild( WEBGL.getWebGLErrorMessage() );\r\n\talert( WEBGL.getWebGLErrorMessage().innerHTML );\r\n\r\n}\r\n\r\nimport ColorPicker from './colorpicker/colorpicker.js';\r\n//import ColorPicker from 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.js';\r\n\r\nimport three from './three.js'\r\n\r\nimport { OrbitControls, createEventDispatcher } from './OrbitControls/OrbitControls.js';\r\n//import { OrbitControls } from '../../three.js/dev/examples/jsm/controls/OrbitControls.js';\r\n//import { OrbitControls } from 'http://localhost/anhr/three.js/dev/examples/jsm/controls/OrbitControls.js';\r\n//import { OrbitControls } from 'https://raw.githack.com/anhr/three.js/dev/examples/jsm/controls/OrbitControls.js';\r\n//import { OrbitControls } from 'https://threejs.org/examples/jsm/controls/OrbitControls.js';\r\n\r\n//для сщздания пустого cookie который ничего не запоминает\r\nimport Cookie from './cookieNodeJS/cookie.js';\r\n//import Cookie from 'https://raw.githack.com/anhr/commonNodeJS/master/cookieNodeJS/cookie.js';\r\n\r\nimport cookie from './cookieNodeJS/cookie.js';\r\n//import cookie from 'https://raw.githack.com/anhr/commonNodeJS/master/cookieNodeJS/cookie.js';\r\n\r\n//import { dat } from './dat/dat.module.js';\r\n//import { dat } from 'https://raw.githack.com/anhr/commonNodeJS/master/dat/dat.module.js';\r\n\r\nimport { getLanguageCode } from './lang.js';\r\n//import { getLanguageCode } from 'https://raw.githack.com/anhr/commonNodeJS/master/lang.js';\r\n\r\nimport Player from './player/player.js';\r\nimport StereoEffect from './StereoEffect/StereoEffect.js';\r\n\r\nclass Options {\r\n\r\n\t/**\r\n\t * options of the canvas\r\n\t * @param {Object} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t */\r\n\tconstructor( options ) {\r\n\r\n\t\tconst _this = this;\r\n\t\toptions = options || {};\r\n\t\tif ( options.boOptions )\r\n\t\t\treturn options;//duplucate new Options\r\n//\t\toptions.boOptions = true;\r\n\r\n\t\tif ( options.a === undefined ) options.a = 1;\r\n\t\tif ( options.b === undefined ) options.b = 0;\r\n\r\n\t\t/* *\r\n\t\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t * */\r\n//\t\tthis.options = options;\r\n\t\t/**\r\n\t\t * set the <b>scales.w</b> key of the <b>options</b>\r\n\t\t * @param {Object} options\r\n\t\t * @param {string} [options.scales.w.name=\"W\"] axis name.\r\n\t\t * @param {number} [options.scales.w.min=0] Minimum range of the <a href=\"../../colorpicker/jsdoc/index.html\" target=\"_blank\">color palette</a> index.\r\n\t\t * @param {number} [options.scales.w.max=1] Maximum range of the <a href=\"../../colorpicker/jsdoc/index.html\" target=\"_blank\">color palette</a> index.\r\n\t\t */\r\n\t\tthis.setW = function ( optionsCur ) {\r\n\r\n\t\t\toptionsCur = optionsCur || options;\r\n\t\t\tconst axisName = 'w';\r\n\t\t\toptionsCur.scales = optionsCur.scales || {};\r\n\t\t\toptionsCur.scales.w = optionsCur.scales.w || {};\r\n\t\t\tconst scale = optionsCur.scales.w;\r\n\t\t\tscale.name = scale.name || axisName;\r\n\t\t\tif ( !optionsCur.palette )\r\n\t\t\t\tthis.setPalette( optionsCur );\r\n\r\n\t\t\tscale.min = scale.min === undefined ? 0 : scale.min;\r\n\r\n\t\t\t//максимальное значение шкалы w по умолчанию беру из THREE.Vector4\r\n\t\t\t//потому что в противном случае неверно будет отображаться цвет точки, заданной как THREE.Vector4()\r\n\t\t\tscale.max = scale.max === undefined ? new three.THREE.Vector4().w : scale.max;\r\n\r\n\t\t}\r\n\t\toptions.scales = options.scales || {};\r\n\t\tconst boCreateScale = !options.scales.x && !options.scales.y && !options.scales.z;\r\n\t\tfunction setScale( axisName ) {\r\n\r\n\t\t\t//Не надо создавать ось потому что иначе будут создавться контролы для осей, которые не хочет видеть пользователь и будет рмсоватся пунктирная линия к не существующей оси если пользователь нажал на точку\r\n\t\t\tif ( boCreateScale )\r\n\t\t\t\toptions.scales[axisName] = options.scales[axisName] || {};\r\n\r\n\t\t\tif ( !options.scales[axisName] )\r\n\t\t\t\treturn;\r\n\r\n\t\t\toptions.scales[axisName].name = options.scales[axisName].name || axisName;\r\n\t\t\toptions.scales[axisName].min = options.scales[axisName].min === undefined ? -1 : options.scales[axisName].min;\r\n\t\t\toptions.scales[axisName].max = options.scales[axisName].max === undefined ? 1 : options.scales[axisName].max;\r\n//\t\t\tif ( callBack ) callBack( options.scales[axisName] );\r\n\r\n\t\t}\r\n\t\tsetScale( 'x' );\r\n\t\tsetScale( 'y' );\r\n\t\tsetScale( 'z' );\r\n\t\toptions.scales.setW = function () { _this.setW(); }\r\n\t\toptions.point = options.point || {};\r\n\t\toptions.point.size = options.point.size || 5.0;\r\n\t\toptions.point.sizePointsMaterial = options.point.sizePointsMaterial || 100.0;\r\n\r\n\t\t/**\r\n\t\t * set the <b>palette</b> key of the <b>options</b>.\r\n\t\t * See <a href=\"../../colorpicker/jsdoc/module-ColorPicker-ColorPicker.html#palette\" target=\"_blank\">color palette</a>.\r\n\t\t */\r\n\t\tthis.setPalette = function () {\r\n\r\n\t\t\tif ( options.palette )\r\n\t\t\t\treturn;\r\n\t\t\toptions.palette = new ColorPicker.palette();//ColorPicker.paletteIndexes.BGYW \r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Create [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}\r\n\t\t * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}. Use the <b>camera</b> key if you want control cameras focus.\r\n\t\t * @param {THREE.WebGLRenderer} renderer [THREE.WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}.\r\n\t\t * @param {THREE.Scene} scene [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}.\r\n\t\t */\r\n\t\tthis.createOrbitControls = function ( camera, renderer, scene ) {\r\n\r\n/*\r\n\t\t\tif ( options.orbitControls !== false ) options.orbitControls = options.orbitControls || {};\r\n\t\t\tif ( !options.orbitControls )\r\n\t\t\t\treturn;\r\n*/\r\n\t\t\tif ( options.orbitControls === false )\r\n\t\t\t\treturn;\r\n/*\r\n\t\t\tif ( _this.orbitControls ) {\r\n\r\n\t\t\t\tconsole.error( 'Options.createOrbitControls: duplicate orbitControls.' );\r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t}\r\n*/\t\t\t\r\n\r\n\t\t\tcreateEventDispatcher();\r\n\t\t\t_this.orbitControls = new OrbitControls( camera, renderer.domElement );\r\n/*непонятно зачем это\r\n\t\t\tif ( _this.orbitControls.settings ) console.error( 'OrbitControls.settings = ' + controls.settings );\r\n\t\t\t_this.orbitControls.settings = options.orbitControls;\r\n*/\r\n\t\t\t_this.orbitControls.target.set( scene.position.x * 2, scene.position.y * 2, scene.position.z * 2 );\r\n\t\t\t_this.orbitControls.saveState();//For reset of the orbitControls settings in the CameraGui and OrbitControlsGui\r\n\t\t\t_this.orbitControls.update();\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Reset <a href=\"../../Player/jsdoc\" target=\"_blank\">Player</a> and restore [camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera} position.\r\n\t\t * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t\t * @param {THREE.Scene} scene [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}.\r\n\t\t */\r\n\t\tthis.restoreSceneController = function ( camera, scene ) {\r\n\r\n\t\t\tif ( !three.dat )//options.dat.dat\r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t//Localization\r\n\r\n\t\t\tconst lang = {\r\n\r\n\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\tdefaultTitle: 'Reset player and restore camera position.',\r\n\r\n\t\t\t};\r\n\r\n\t\t\tswitch ( this.getLanguageCode() ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\t\tlang.defaultTitle = 'Восстановить положение сцены и проирывателя.';\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst scenePosition = new three.THREE.Vector3().copy( scene.position ),\r\n\t\t\t\tcameraPosition = new three.THREE.Vector3().copy( camera.position );\r\n\r\n\t\t\tthree.dat.controllerNameAndTitle( options.dat.gui.add( {\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\tif ( options.player ) options.player.setTime( options.playerOptions.min );\r\n\r\n//\t\t\t\t\tcamera.position.copy( camera.userData.default.options.position );\r\n\t\t\t\t\tcamera.position.copy( cameraPosition );\r\n\t\t\t\t\tscene.position.copy( scenePosition );\r\n\t\t\t\t\t//scene.position.add( options.axesHelper.position );\r\n\t\t\t\t\t//\t\t\t\t\t\tscene.position.add( options.scene.position );\r\n\t\t\t\t\t//scene.position.copy( options.scene.position );\r\n\t\t\t\t\tif ( options.orbitControls !== false ) {\r\n\r\n\t\t\t\t\t\toptions.orbitControls.target = new three.THREE.Vector3();\r\n\t\t\t\t\t\toptions.orbitControls.object.position.copy( camera.position );\r\n\t\t\t\t\t\toptions.orbitControls.update();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/*\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tcontrols.target = new THREE.Vector3();\r\n\t\t\t\t\t\t\t\t\t\t\tcontrols.object.position.copy( camera.position );\r\n\t\t\t\t\t\t\t\t\t\t\tcontrols.update();\r\n\t\t\t\t\t*/\r\n\t\t\t\t\t/*\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tPlayer.selectPlayScene( group, { options: options } );\r\n\t\t\t\t\t\t\t\t\t\t\t\tremoveTraceLines();\r\n\t\t\t\t\t*/\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\t}\r\n\r\n\t\tObject.defineProperties( this, {\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * \r\n\t\t\t * playerOptions = {\r\n\t\t\t * \r\n\t\t\t *\tmin: 0,// Minimum range of the axis.\r\n\t\t\t *\tmax: 1,// Maximum range of the axis.\r\n\t\t\t *\tmarks: 10,// Ticks count of the playing. Number of scenes of 3D objects animation.\r\n\t\t\t *\t\t//Have effect for <b>max</b> is not Infinity.\r\n\t\t\t *\tdt: 0.1,// Step of the animation. Have effect only if <b>max</b> is infinity.\r\n\t\t\t *\trepeat: false,// true - Infinitely repeating 3D objects animation.\r\n\t\t\t *\tinterval: 1,// Ticks per seconds.\r\n\t\t\t *\tzoomMultiplier: 1.1,// zoom multiplier of the time.\r\n\t\t\t *\toffset: 0.1,// offset of the time.\r\n\t\t\t *\tname: \"\",// name of the time.\r\n\t\t\t *\r\n\t\t\t * }\r\n\t\t\t * </pre>\r\n\t\t\t * @param {number} [playerOptions=0] Minimum range of the axis.\r\n\t\t\t */\r\n\t\t\tplayerOptions: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n//\t\t\t\t\tconst options = this.options;\r\n\t\t\t\t\toptions.playerOptions = options.playerOptions || {};\r\n\t\t\t\t\tconst playerOptions = options.playerOptions;\r\n\t\t\t\t\tplayerOptions.min = playerOptions.min || 0;\r\n\t\t\t\t\tif ( playerOptions.max === Infinity ) playerOptions.max = null;//Заменяю Infinity на null потому что из cockie Infinity читается как null\r\n\t\t\t\t\tif ( playerOptions.max !== null ) {\r\n\r\n\t\t\t\t\t\tif ( playerOptions.max === undefined ) playerOptions.max = 1;\r\n\t\t\t\t\t\tplayerOptions.marks = playerOptions.marks || 10;//2;\r\n\r\n\t\t\t\t\t} else playerOptions.marks = null;\r\n\t\t\t\t\tif ( playerOptions.max === null ) playerOptions.dt = playerOptions.dt || 0.1;\r\n\t\t\t\t\telse playerOptions.dt = ( playerOptions.max - playerOptions.min ) / ( playerOptions.marks - 1 );\r\n\t\t\t\t\tplayerOptions.repeat = playerOptions.repeat || false;\r\n\t\t\t\t\tplayerOptions.interval = playerOptions.interval || 1;//25;\r\n\t\t\t\t\tplayerOptions.zoomMultiplier = playerOptions.zoomMultiplier || 1.1;\r\n\t\t\t\t\tplayerOptions.offset = playerOptions.offset || 0.1;\r\n\t\t\t\t\tplayerOptions.name = playerOptions.name || '';\r\n\t\t\t\t\tif ( !playerOptions.cameraTarget ) {\r\n\r\n\t\t\t\t\t\tconst cameraTarget = new Player.cameraTarget();\r\n\t\t\t\t\t\tObject.defineProperties( playerOptions, {\r\n\r\n\t\t\t\t\t\t\tcameraTarget: {\r\n\r\n\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\treturn cameraTarget;\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn options.playerOptions;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( playerOptions ) { options.playerOptions = playerOptions; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * See <b>options.a</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.execFunc.html\" target=\"_blank\">Player.execFunc</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\ta: {\r\n\r\n\t\t\t\tget: function () { return options.a; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * See <b>options.b</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.execFunc.html\" target=\"_blank\">Player.execFunc</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tb: {\r\n\r\n\t\t\t\tget: function () { return options.b; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * See the <b>options.dat</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * dat = {\r\n\t\t\t * \r\n\t\t\t *\tgui: new [dat.GUI()]{@link https://github.com/dataarts/dat.gui} instance,\r\n\t\t\t *\t\tundefined - do not use dat-gui JavaScript Controller Library. [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tcookie: false,// do not save to cookie all user settings\r\n\t\t\t *\tcookieName:,// Name of the cookie.\r\n\t\t\t *\taxesHelperGui: false,// - do not adds a <a href=\"../../AxesHelper/jsdoc/module-AxesHelperGui.html\" target=\"_blank\">AxesHelperGui</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tstereoEffectsGui: false,// - do not adds <a href=\"../../StereoEffect/jsdoc/module-StereoEffect-StereoEffect.html#gui\" target=\"_blank\">Stereo Effects folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tplayerGui: true,// - adds a <a href=\"../../player/jsdoc/module-Player.html#~Player.gui\" target=\"_blank\">Player controllers</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tguiSelectPoint: true,// - displays the <a href=\"../../guiSelectPoint/jsdoc/module-GuiSelectPoint.html\" target=\"_blank\">Select Point</a>. [dat.gui]{@link https://github.com/dataarts/dat.gui} based graphical user interface for select a point from the mesh.\r\n\t\t\t *\tguiFrustumPoints: true,// - Adds <a href=\"../../FrustumPoints/jsdoc/FrustumPoints.html#gui\" target=\"_blank\">Frustum Points folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tcameraGui: true,// - Adds <a href=\"../../jsdoc/CameraGui/module-CameraGui-CameraGui.html\" target=\"_blank\">Camera folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tmoveScene: true,// - displays the <a href=\"../../jsdoc/MoveGroupGui/index.html\" target=\"_blank\">move group gui</a>.\r\n\t\t\t *\tspriteTextGui: true,// - displays the <a href=\"../../SpriteText/jsdoc/module-SpriteTextGui.html\" target=\"_blank\">SpriteTextGui</a>.\r\n\t\t\t *\r\n\t\t\t * }\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tdat: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tclass Dat{\r\n\r\n\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t * dat options\r\n\t\t\t\t\t\t * @param {dat} dat [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tconstructor( dat ) {\r\n\r\n\t\t\t\t\t\t\tdat = dat || {};\r\n\t\t\t\t\t\t\tif ( dat.boDat )\r\n\t\t\t\t\t\t\t\treturn dat;//duplucate new Options\r\n\t\t\t\t\t\t\tObject.defineProperties( this, {\r\n\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * returns true if <b>dat</b> was converted by <b>new Dat( options );</b>\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tboDat: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return true; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter and setter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tdat: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.warn('get dat depreacated. Use three.dat = dat.');\r\n\t\t\t\t\t\t\t\t\t\treturn three.dat;\r\n//\t\t\t\t\t\t\t\t\t\treturn dat.dat;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tset: function ( dat ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.warn('Set dat depreacated. Use three.dat = dat.');\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tdat.dat &&\r\n\t\t\t\t\t\t\t\t\t\t\t( dat.dat.constructor.name === dat.constructor.name ) &&\r\n\t\t\t\t\t\t\t\t\t\t\t( dat.dat.constructor.name !== 'Object' )\r\n\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error( 'duplicate dat.' );\r\n\t\t\t\t\t\t\t\t\t\tdat.dat = dat;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * Name of the cookie.\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tcookieName : {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.cookieName ; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * [dat.GUI()]{@link https://github.com/dataarts/dat.gui} instance.\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tgui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( !dat.gui && three.dat ) dat.gui = new three.dat.GUI();\r\n\t\t\t\t\t\t\t\t\t\treturn dat.gui;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcookie: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.cookie; },\r\n\t\t\t\t\t\t\t\t\tset: function ( cookie ) { dat.cookie = cookie; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tguiSelectPoint: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.guiSelectPoint; },\r\n\t\t\t\t\t\t\t\t\tset: function ( guiSelectPoint ) { dat.guiSelectPoint = guiSelectPoint; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcameraGui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.cameraGui; },\r\n\t\t\t\t\t\t\t\t\tset: function ( cameraGui ) { dat.cameraGui = cameraGui; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t//For debugging. Find a hidden keys\r\n\t\t\t\t\t\t\tfor ( var propertyName in dat ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( this[propertyName] === undefined ) console.error( 'Dat: dat.' + propertyName + ' key is hidden' );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\toptions.dat = new Dat( options.dat );\r\n//\t\t\t\t\toptions.dat.gui = options.dat.gui || new dat.GUI();\r\n//\t\t\t\t\tif ( !options.dat.gui && options.dat.dat ) options.dat.gui = new options.dat.dat.GUI();\r\n\t\t\t\t\tif ( options.dat.gui ) {\r\n\r\n\t\t\t\t\t\tconst className = options.dat.gui.domElement.className;\r\n\t\t\t\t\t\tvar guiCount = 0;\r\n\t\t\t\t\t\toptions.dat.gui.domElement.parentElement.childNodes.forEach( function ( node ) {\r\n\r\n\t\t\t\t\t\t\tif ( node.className === className ) guiCount++;\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tif ( guiCount > 1 )\r\n\t\t\t\t\t\t\tconsole.error( 'Options: duplicate dat.GUI' );\r\n\r\n\t\t\t\t\t\toptions.dat.gui.domElement.addEventListener( 'mouseenter', function ( event ) { options.dat.mouseenter = true; } );\r\n\t\t\t\t\t\toptions.dat.gui.domElement.addEventListener( 'mouseleave', function ( event ) { options.dat.mouseenter = false; } );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( options.dat.cookie === false ) options.dat.cookie = new Cookie.defaultCookie();\r\n\t\t\t\t\telse if ( options.dat.cookie === undefined ) options.dat.cookie = cookie;\r\n//\t\t\t\t\toptions.dat.cookie = options.dat.cookie !== false ? cookie : new Cookie.defaultCookie();\r\n\t\t\t\t\toptions.dat.getCookieName = function ( cookieName = '' ) {\r\n\r\n\t\t\t\t\t\tconst name = options.dat.cookieName ||\r\n\t\t\t\t\t\t\t( options.elContainer ?\r\n\t\t\t\t\t\t\t\ttypeof options.elContainer === \"object\" ?\r\n\t\t\t\t\t\t\t\t\toptions.elContainer.id :\r\n\t\t\t\t\t\t\t\t\ttypeof options.elContainer === \"string\" ?\r\n\t\t\t\t\t\t\t\t\t\toptions.elContainer :\r\n\t\t\t\t\t\t\t\t\t\t'' :\r\n\t\t\t\t\t\t\t\t'' );\r\n\t\t\t\t\t\treturn cookieName + ( ( cookieName !== '' ) && ( name !== '' ) ? '_' : '' ) + name;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//axesHelperGui: false,\r\n\t\t\t\t\t//playerGui: false,\r\n\t\t\t\t\t//guiSelectPoint: false,\r\n\t\t\t\t\t//moveScene: false,\r\n\t\t\t\t\t//cameraGui: false,\r\n\t\t\t\t\t//stereoEffectsGui: false,\r\n\t\t\t\t\t//spriteTextGui: false,\r\n\t\t\t\t\t//folderPoint: false,\r\n\t\t\t\t\treturn options.dat;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( dat ) { options.dat = dat; },\r\n/*\r\n\t\t\t\tcookieName: {\r\n\r\n\t\t\t\t\tget: function ( cookieName = '' ) {\r\n\r\n\t\t\t\t\t\tconst name = options.dat.cookieName ||\r\n\t\t\t\t\t\t\t( options.elContainer ?\r\n\t\t\t\t\t\t\t\ttypeof options.elContainer === \"object\" ?\r\n\t\t\t\t\t\t\t\t\toptions.elContainer.id :\r\n\t\t\t\t\t\t\t\t\ttypeof options.elContainer === \"string\" ?\r\n\t\t\t\t\t\t\t\t\t\toptions.elContainer :\r\n\t\t\t\t\t\t\t\t\t\t'' :\r\n\t\t\t\t\t\t\t\t'' );\r\n\t\t\t\t\t\treturn cookieName + ( ( cookieName !== '' ) && ( name !== '' ) ? '_' : '' ) + name;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n*/\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Your custom getLanguageCode() function.\r\n\t\t\t * returns the \"primary language\" subtag of the language version of the browser.\r\n\t\t\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t\t * See the \"Syntax\" paragraph of RFC 4646 {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t\t\t * Default returns the language code of your browser.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tgetLanguageCode: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( typeof options.getLanguageCode === \"string\" )\r\n\t\t\t\t\t\treturn function () {\r\n\r\n/*\r\n\t\t\t\t\t\t\tif ( !this || !this.options )\r\n\t\t\t\t\t\t\t\treturn 'en';//English language\r\n*/\r\n\t\t\t\t\t\t\treturn options.getLanguageCode;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\treturn options.getLanguageCode || getLanguageCode;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * See <b>options.scales</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tscales: {\r\n\r\n\t\t\t\tget: function () { return options.scales; },\r\n\t\t\t\tset: function ( scales ) { options.scales = scales; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Points сolor.\r\n\t\t\t * See <b>options.palette</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tpalette: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.palette !== undefined ) {\r\n\r\n\t\t\t\t\t\tswitch ( typeof options.palette ) {\r\n\r\n\t\t\t\t\t\t\tcase 'number':\r\n\t\t\t\t\t\t\t\toptions.palette = new ColorPicker.palette( { palette: options.palette } );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'boolean':\r\n\t\t\t\t\t\t\t\tif ( options.palette )\r\n\t\t\t\t\t\t\t\t\toptions.palette = new ColorPicker.palette();// { palette: ColorPicker.paletteIndexes.BGYW } );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault: {\r\n\r\n\t\t\t\t\t\t\t\tif ( options.palette instanceof ColorPicker.palette === false )\r\n\t\t\t\t\t\t\t\t\tconsole.error( 'MyThree: invalid typeof options.palette: ' + typeof options.palette );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn options.palette;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * returns true if <b>options</b> was converted by <b>new Options( options );</b>\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tboOptions: {\r\n\r\n\t\t\t\tget: function () { return true;/*options.boOptions;*/ },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * returns {\r\n\t\t\t *\r\n\t\t\t * \tsize = 5.0; point size\r\n\t\t\t * \tsizePointsMaterial = 100.0; The <b>size</b> property of the parameters of the [THREE.PointsMaterial]{@link https://threejs.org/docs/index.html?q=PointsMaterial#api/en/materials/PointsMaterial}.\r\n\t\t\t *\r\n\t\t\t * }\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tpoint: {\r\n\r\n\t\t\t\tget: function () { return options.point; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * <b>SpriteText</b> options\r\n\t\t\t * See <b>options</b> parameter of the <a href=\"../../SpriteText/jsdoc/module-SpriteText.html\" target=\"_blank\">SpriteText</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tspriteText: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.spriteText ) return options.spriteText;\r\n\t\t\t\t\treturn {};\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster}.\r\n\t\t\t **/\r\n\t\t\traycaster: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.raycaster ) return options.raycaster;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( raycaster ) { options.raycaster = raycaster; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t\t\t * See <b>options.camera</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcamera: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\toptions.camera = options.camera || {};\r\n/*\t\t\t\t\t\r\n\t\t\t\t\toptions.camera.position = options.camera.position || new three.THREE.Vector3( 0.4, 0.4, 2 );\r\n\t\t\t\t\toptions.camera.scale = options.camera.scale || new three.THREE.Vector3( 1, 1, 1 );\r\n*/\t\t\t\t\t\r\n\t\t\t\t\tif ( !options.camera.position ) options.camera.position = new three.THREE.Vector3( 0.4, 0.4, 2 );\r\n\t\t\t\t\tif ( !options.camera.scale ) options.camera.scale = new three.THREE.Vector3( 1, 1, 1 );\r\n\t\t\t\t\treturn options.camera;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( camera ) { options.camera = camera; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Camera looking at selected point during playing. See the <b>cameraTarget</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.cameraTarget.html#init\" target=\"_blank\">Player.cameraTarget.init(...)</a> function for details.\r\n\t\t\t * See <b>options.cameraTarget</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcameraTarget: {\r\n\r\n\t\t\t\tget: function () { return options.cameraTarget; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * The <b>HTMLElement</b>, contains a <b>canvas</b>.\r\n\t\t\t * See <b>options.elContainer</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\telContainer: {\r\n\r\n\t\t\t\tget: function () { return options.elContainer; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * true - use my <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">dropdown menu for canvas</a> in my version of [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n\t\t\t * See <b>options.canvasMenu</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcanvasMenu: {\r\n\r\n\t\t\t\tget: function () { return options.canvasMenu; },\r\n\t\t\t\tset: function ( canvasMenu ) {\r\n\r\n\t\t\t\t\tif ( options.canvasMenu && ( options.canvasMenu !== true ) && ( options.canvasMenu !== false ) ) console.warn( 'Duplicate canvasMenu' );\r\n\t\t\t\t\toptions.canvasMenu = canvasMenu;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * <b>canvas</b> properties.\r\n\t\t\t * See <b>options.canvas</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcanvas: {\r\n\r\n\t\t\t\tget: function () { return options.canvas; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Creates a <a href=\"../../frustumPoints/jsdoc/index.html\" target=\"_blank\">FrustumPoints</a> instance.\r\n\t\t\t * See <b>options.frustumPoints</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tfrustumPoints: {\r\n\r\n\t\t\t\tget: function () { return options.frustumPoints; },\r\n\t\t\t\tset: function ( frustumPoints ) {\r\n\r\n\t\t\t\t\tif (\r\n\r\n\t\t\t\t\t\toptions.frustumPoints &&\r\n\t\t\t\t\t\t( options.frustumPoints.constructor.name === frustumPoints.constructor.name ) &&\r\n\t\t\t\t\t\t( options.frustumPoints.constructor.name !== 'Object' )\r\n\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tconsole.error( 'duplicate frustumPoints.' );\r\n\t\t\t\t\toptions.frustumPoints = frustumPoints;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a>.\r\n\t\t\t * See <b>options.stereoEffect</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tstereoEffect: {\r\n\r\n\t\t\t\tget: function () { return options.stereoEffect; },\r\n\t\t\t\tset: function ( stereoEffect ) {\r\n\r\n\t\t\t\t\tif (\r\n\r\n\t\t\t\t\t\toptions.stereoEffect &&\r\n\t\t\t\t\t\t( options.stereoEffect.constructor.name === stereoEffect.constructor.name ) &&\r\n\t\t\t\t\t\t( options.stereoEffect.constructor.name !== 'Object' )\r\n\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tconsole.error( 'duplicate stereoEffect.' );\r\n\t\t\t\t\toptions.stereoEffect = stereoEffect;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a>.\r\n\t\t\t * See <b>options.player</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tplayer: {\r\n\r\n\t\t\t\tget: function () { return options.player; },\r\n\t\t\t\tset: function ( player ) {\r\n\r\n\t\t\t\t\tif ( options.player ) console.error( 'duplicate player.' );\r\n\t\t\t\t\toptions.player = player;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * current time of the <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\ttime: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.player )\r\n\t\t\t\t\t\treturn options.player.getTime();\r\n\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../axesHelper/jsdoc/index.html\" target=\"_blank\">AxesHelper</a>.\r\n\t\t\t * See <b>options.axesHelper</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\taxesHelper: {\r\n\r\n\t\t\t\tget: function () { return options.axesHelper; },\r\n\t\t\t\tset: function ( axesHelper ) {\r\n\r\n\t\t\t\t\tif ( options.axesHelper ) console.error( 'duplicate axesHelper.' );\r\n\t\t\t\t\toptions.axesHelper = axesHelper;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">CanvasMenu</a>.\r\n\t\t\t * See <b>options.canvasMenu</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcanvasMenu: {\r\n\r\n\t\t\t\tget: function () { return options.canvasMenu; },\r\n\t\t\t\tset: function ( canvasMenu ) {\r\n\r\n\t\t\t\t\tif ( options.canvasMenu ) console.error( 'duplicate canvasMenu.' );\r\n\t\t\t\t\toptions.canvasMenu = canvasMenu;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use [OrbitControls]{@link https://threejs.org/docs/index.html?q=orb#examples/en/controls/OrbitControls}.\r\n\t\t\t * See <b>options.orbitControls</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\torbitControls: {\r\n\r\n\t\t\t\tget: function () { return options.orbitControls; },\r\n\t\t\t\tset: function ( orbitControls ) {\r\n\r\n\t\t\t\t\tif (\r\n\r\n\t\t\t\t\t\toptions.orbitControls &&\r\n\t\t\t\t\t\t( options.orbitControls.constructor.name === orbitControls.constructor.name ) &&\r\n\t\t\t\t\t\t( options.orbitControls.constructor.name !== 'Object' )\r\n\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tconsole.error( 'duplicate orbitControls.' );\r\n\t\t\t\t\toptions.orbitControls = orbitControls;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter returns 1\r\n\t\t\t **/\r\n\t\t\tscale: {\r\n\r\n\t\t\t\tget: function () { return 1; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../jsdoc/pointLight/index.html\" target=\"_blank\">pointLight</a>.\r\n\t\t\t * See <b>options.pointLight</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tpointLight: {\r\n\r\n\t\t\t\tget: function () { return options.pointLight; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * <a href=\"../../player/jsdoc/module-Player-Player.cameraTarget.html\" target=\"_blank\">Player.cameraTarget</a> class instance. Functions for camera for looking at selected point.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcameraTarget: {\r\n\r\n\t\t\t\tget: function () { return options.cameraTarget; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use [OrbitControls]{@link https://threejs.org/docs/index.html?q=orb#examples/en/controls/OrbitControls}.\r\n\t\t\t * See <b>options.orbitControls</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\teventListeners: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.eventListeners ) return options.eventListeners;\r\n\t\t\t\t\treturn { addParticle: function(){}, }\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( eventListeners ) {\r\n\r\n\t\t\t\t\tif ( options.eventListeners )\r\n\t\t\t\t\t\tconsole.error( 'duplicate eventListeners.' );\r\n\t\t\t\t\toptions.eventListeners = eventListeners;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/* *\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use [OrbitControls]{@link https://threejs.org/docs/index.html?q=orb#examples/en/controls/OrbitControls}.\r\n\t\t\t * See <b>options.orbitControls</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n/*Не отбражаются пунктирные линии до осей координат если полльзовател щелкнул на точку и если нет guiSelectPoint\r\n\t\t\tguiSelectPoint: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.guiSelectPoint ) return options.guiSelectPoint;\r\n\t\t\t\t\treturn {\r\n\r\n\t\t\t\t\t\tadd: function () { },\r\n\t\t\t\t\t\taddMesh: function () { },\r\n\t\t\t\t\t\tsetMesh: function () { },\r\n\t\t\t\t\t\tgetSelectedPointIndex: function () { },\r\n\t\t\t\t\t\tisSelectedMesh: function () { },\r\n\t\t\t\t\t\tselect: function () { },\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( guiSelectPoint ) {\r\n\r\n\t\t\t\t\tif ( options.guiSelectPoint )\r\n\t\t\t\t\t\tconsole.error( 'duplicate guiSelectPoint.' );\r\n\t\t\t\t\toptions.guiSelectPoint = guiSelectPoint;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n*/\t\t\t\r\n\r\n\t\t} ); \r\n\r\n\t\t//For debugging. Find a hidden keys\r\n\t\tfor( var propertyName in options ) {\r\n\r\n\t\t   if ( this[propertyName] === undefined ) console.error( 'Options: options.' + propertyName + ' key is hidden' );\r\n\r\n\t\t}\r\n\t\tthis.playerOptions.cameraTarget.init( this.cameraTarget, this, false );\r\n\r\n\t}\r\n\r\n} \r\n\r\n/**\r\n * Finds on the [Scene]{@link https://threejs.org/docs/index.html?q=Scene#api/en/scenes/Scene} a child item of the \"Sprite\" type and \"spriteTextIntersection\" name.\r\n * @param {THREE.Scene} scene [Scene]{@link https://threejs.org/docs/index.html?q=Scene#api/en/scenes/Scene} instance.\r\n * @returns item of the \"Sprite\" type and \"spriteTextIntersection\" name or undefined.\r\n */\r\nOptions.findSpriteTextIntersection = function ( scene ) {\r\n\r\n\tvar spriteTextIntersection;\r\n\tscene.children.forEach( function ( item ) {\r\n\r\n\t\tif ( ( item.type === \"Sprite\" ) && ( item.name === Options.findSpriteTextIntersection.spriteTextIntersectionName ) ) {\r\n\r\n\t\t\tspriteTextIntersection = item;\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\treturn spriteTextIntersection;\r\n\r\n}\r\n/**\r\n * @returns \"spriteTextIntersection\"\r\n * */\r\nOptions.findSpriteTextIntersection.spriteTextIntersectionName = 'spriteTextIntersection';\r\n\r\nclass Raycaster {\r\n\r\n\t/**\r\n\t * [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} methods.\r\n\t * */\r\n\tconstructor() {\r\n\r\n\t\tvar cursor;\r\n\t\t/**\r\n\t\t * @description Displays a sprite text if you move mouse over an 3D object\r\n\t\t * @param {Object} intersection See [.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details.\r\n\t\t * @param {Options} options the following options are available.\r\n\t\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t * @param {object} [options.spriteText] spriteText options. See <a href=\"../../SpriteText/jsdoc/module-SpriteText.html\" target=\"_blank\">SpriteText</a> <b>options</b> parameter for details.\r\n\t\t * @param {object} [options.scales] axes scales.\r\n\t\t * See <b>options.scales</b> parameter of the <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a> class for details.\r\n\t\t * @param {THREE.Scene} scene [Scene]{@link https://threejs.org/docs/index.html?q=sc#api/en/scenes/Scene}.\r\n\t\t * @param {THREE.Camera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=persp#api/en/cameras/PerspectiveCamera}.\r\n\t\t * @param {canvas} canvas [canvas]{@link https://www.w3schools.com/tags/tag_canvas.asp} tag.\r\n\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html?q=WebGLRenderer#api/en/renderers/WebGLRenderer} instance.\r\n\t\t */\r\n\t\tthis.onIntersection = function ( intersection, options, scene, camera, canvas, renderer ) {\r\n\r\n\t\t\tif ( intersection.object.userData.isInfo !== undefined && !intersection.object.userData.isInfo() )\r\n\t\t\t\treturn;\r\n\t\t\tvar spriteTextIntersection = Options.findSpriteTextIntersection( scene );\r\n\t\t\tif ( spriteTextIntersection === undefined ) {\r\n\r\n\r\n\t\t\t\tconst rect = options.spriteText.rect ? JSON.parse( JSON.stringify( options.spriteText.rect ) ) : {};\r\n\t\t\t\trect.displayRect = true;\r\n\t\t\t\trect.backgroundColor = 'rgba(0, 0, 0, 1)';\r\n\t\t\t\tspriteTextIntersection = StereoEffect.getTextIntersection( intersection, {\r\n\r\n\t\t\t\t\tscales: options.scales,\r\n\t\t\t\t\tspriteOptions: {\r\n\r\n\t\t\t\t\t\ttextHeight: options.spriteText.textHeight,\r\n\t\t\t\t\t\tfontColor: options.spriteText.fontColor,\r\n\t\t\t\t\t\trect: rect,\r\n\t\t\t\t\t\tgroup: scene,\r\n\t\t\t\t\t\tcenter: {\r\n\r\n\t\t\t\t\t\t\tcamera: camera,\r\n\t\t\t\t\t\t\tcanvas: canvas,\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n//\t\t\t\tspriteTextIntersection.name = Options.findSpriteTextIntersection.spriteTextIntersectionName;\r\n\t\t\t\tspriteTextIntersection.scale.divide( scene.scale );\r\n\t\t\t\tscene.add( spriteTextIntersection );\r\n\t\t\t\t\r\n\t\t\t\tif ( cursor === undefined ) cursor = renderer.domElement.style.cursor;\r\n\t\t\t\trenderer.domElement.style.cursor = 'pointer';\r\n\r\n\t\t\t} else spriteTextIntersection.position.copy( intersection.point );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @description Hides a sprite text if you move mouse out an object.\r\n\t\t * @param {THREE.Scene} scene [Scene]{@link https://threejs.org/docs/index.html?q=sc#api/en/scenes/Scene}.\r\n\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html?q=WebGLRenderer#api/en/renderers/WebGLRenderer} instance.\r\n\t\t */\r\n\t\tthis.onIntersectionOut = function ( scene, renderer ) {\r\n\r\n\t\t\tvar detected = false;\r\n\t\t\tdo {\r\n\r\n\t\t\t\tvar spriteTextIntersection = Options.findSpriteTextIntersection( scene );\r\n\t\t\t\tif ( spriteTextIntersection !== undefined ) {\r\n\r\n\t\t\t\t\tscene.remove( spriteTextIntersection );\r\n\t\t\t\t\tif ( detected )\r\n\t\t\t\t\t\tconsole.error( 'Duplicate spriteTextIntersection' );\r\n\t\t\t\t\tdetected = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} while ( spriteTextIntersection !== undefined )\r\n\r\n\t\t\trenderer.domElement.style.cursor = cursor;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * @description The [pointerdown]{@link https://developer.mozilla.org/en-US/docs/Web/API/Document/pointerdown_event}\r\n\t\t * event is fired when a pointer becomes active. For mouse, it is fired when the device transitions from no buttons depressed to at least one button depressed. For touch, it is fired when physical contact is made with the digitizer. For pen, it is fired when the stylus makes physical contact with the digitizer.\r\n\t\t * @param {Object} intersection See [.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details.\r\n\t\t * @param {Options} options the following options are available.\r\n\t\t * @param {GuiSelectPoint} [options.guiSelectPoint] <a href=\"../../guiSelectPoint/jsdoc/index.html\" target=\"_blank\">GuiSelectPoint</a> instance was created.\r\n\t\t * @param {AxesHelper} [options.axesHelper] <a href=\"../../AxesHelper/jsdoc/index.html\" target=\"_blank\">AxesHelper</a> instance was created.\r\n\t\t */\r\n\t\tthis.onMouseDown = function ( intersection, options ) {\r\n\r\n\t\t\tif ( ( intersection.object.userData.isInfo !== undefined ) && !intersection.object.userData.isInfo() )\r\n\t\t\t\treturn;//No display information about frustum point\r\n\t\t\tif ( options.guiSelectPoint )\r\n\t\t\t\toptions.guiSelectPoint.select( intersection );\r\n\t\t\telse if ( options.axesHelper )\r\n\t\t\t\toptions.axesHelper.exposePosition( intersection );\r\n\t\t\t/*infinity loop\r\n\t\t\t\t\tif ( options.raycaster.onMouseDown )\r\n\t\t\t\t\t\toptions.raycaster.onMouseDown( intersection );\r\n\t\t\t*/\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @class\r\n\t\t */\r\n\t\tthis.EventListeners = class {\r\n\r\n\t\t\t/**\r\n\t\t\t * Create a mouse events listeners for [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance\r\n\t\t\t * @param {THREE.Camera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=persp#api/en/cameras/PerspectiveCamera} instance\r\n\t\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer} instance\r\n\t\t\t * @param {Object} [settings={}] the following settings are available\r\n\t\t\t * @param {Options} [settings.options={}] <b>Options</b> instance\r\n\t\t\t * @param {number} [settings.threshold=0.03] Precision of the raycaster when intersecting objects, in world units.\r\n\t\t\t * See [Raycaster.params]{@link https://threejs.org/docs/#api/en/core/Raycaster.params}.\r\n\t\t\t */\r\n\t\t\tconstructor( camera, renderer, settings = {} ) {\r\n\r\n\t\t\t\tvar intersects, intersectedObject;\r\n\t\t\t\tconst THREE = three.THREE, mouse = new THREE.Vector2(), particles = [],\r\n\t\t\t\t\traycaster = new THREE.Raycaster(), options = settings.options || {};\r\n\t\t\t\traycaster.params.Points.threshold = settings.threshold !== undefined ? settings.threshold : 0.03;\r\n\r\n\t\t\t\tif ( raycaster.setStereoEffect ) {\r\n\r\n\t\t\t\t\t//the precision of the raycaster when intersecting objects, in world units.\r\n\t\t\t\t\t//See https://threejs.org/docs/#api/en/core/Raycaster.params.\r\n\r\n\t\t\t\t\traycaster.setStereoEffect( {\r\n\r\n\t\t\t\t\t\trenderer: renderer,\r\n\t\t\t\t\t\tcamera: camera,\r\n\t\t\t\t\t\tstereoEffect: options.stereoEffect,\r\n\t\t\t\t\t\traycasterEvents: false,\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\t//\t\t\t\traycaster.stereo.addParticles( arrayParticles );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\twindow.addEventListener( 'mousemove', function ( event ) {\r\n\r\n\t\t\t\t\tif ( raycaster.stereo !== undefined ) {\r\n\r\n\t\t\t\t\t\traycaster.stereo.onDocumentMouseMove( event );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tOptions.raycaster.EventListeners.getRendererSize( renderer ).getMousePosition( mouse, event );\r\n\t\t\t\t\t/*\t\t\t\r\n\t\t\t\t\t\t\t\t// calculate mouse position in normalized device coordinates\r\n\t\t\t\t\t\t\t\t// (-1 to +1) for both components\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tmouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;\r\n\t\t\t\t\t\t\t\tmouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;\r\n\t\t\t\t\t\t\t\t//\t\t\tconsole.warn( 'mouse.x = ' + mouse.x + ' mouse.y = ' + mouse.y );\r\n\t\t\t\t\t*/\r\n\r\n\t\t\t\t\t//Raycaster https://threejs.org/docs/index.html#api/en/core/Raycaster\r\n\r\n\t\t\t\t\t// update the picking ray with the camera and mouse position\r\n\t\t\t\t\traycaster.setFromCamera( mouse, camera );\r\n\t\t\t\t\t// calculate objects intersecting the picking ray\r\n\t\t\t\t\tintersects = raycaster.intersectObjects( particles );\r\n\t\t\t\t\tif ( !intersects )\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tif ( intersects.length === 0 ) {\r\n\r\n\t\t\t\t\t\tif ( intersectedObject ) {\r\n\r\n\t\t\t\t\t\t\tintersectedObject.userData.raycaster.onIntersectionOut();\r\n\t\t\t\t\t\t\tintersectedObject = undefined;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconst intersect = intersects[0], object = intersect.object;\r\n\t\t\t\t\t\tobject.userData.raycaster.onIntersection( intersect );\r\n\t\t\t\t\t\tintersectedObject = object;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/*\t\t\t\r\n\t\t\t\t\t\t\t\tarrayintersectObjects.forEach( function ( object ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t//\t\t\t\tvar bIntersected = false;\r\n\t\t\t\t\t\t\t\t\tif ( intersectedObject && ( intersects.length === 0 ) ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tintersectedObject.userData.raycaster.onIntersectionOut();\r\n\t\t\t\t\t\t\t\t\t\tintersectedObject = undefined;\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse if ( !intersectedObject )\r\n\t\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < intersects.length; i++ ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tconst intersect = intersects[i];\r\n\t\t\t\t\t\t\t\t\t\t\tif ( Object.is( object, intersect.object ) ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tobject.userData.raycaster.onIntersection( intersect );\r\n\t\t\t\t\t\t\t\t\t\t\t\tintersectedObject = object;\r\n\t\t\t\t\t\t\t\t\t\t\t\t//\t\t\t\t\t\tbIntersected = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t//\t\t\t\t\t\tbIntersectedOut = true;\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t*/\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\t//ATTENTION!!! The 'mousedown' event is not fired you use new version of the OrbitControls.\r\n\t\t\t\t//See \"OrbitControls: Implement Pointer events.\" commit https://github.com/mrdoob/three.js/commit/1422e36e9facbdc5f9d86cf6b97b005a2723a24a#diff-3285de3826a51619836a5c9adc6bee74\r\n\t\t\t\t//window.addEventListener( 'mousedown', function( event )\r\n\t\t\t\twindow.addEventListener( 'pointerdown', function ( event ) {\r\n\r\n\t\t\t\t\tif ( raycaster === undefined )\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tif ( raycaster.stereo !== undefined ) {\r\n\r\n\t\t\t\t\t\traycaster.stereo.onDocumentMouseDown( event );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( intersects && ( intersects.length > 0 ) ) {\r\n\r\n\t\t\t\t\t\tconst intersect = intersects[0];\r\n\t\t\t\t\t\tif ( intersect.object.userData.raycaster ) {\r\n\r\n\t\t\t\t\t\t\tintersect.object.userData.raycaster.onMouseDown( intersect );\r\n\t\t\t\t\t\t\tif ( options && options.guiSelectPoint ) options.guiSelectPoint.select( intersect );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, false );\r\n\t\t\t\tfunction isAddedToParticles( particle ) { return particles.includes( particle ); };\r\n\t\t\t\t/**\r\n\t\t\t\t * Adds new particle into array of objects to check for intersection with the ray.\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class instance for check for intersection with the ray.\r\n\t\t\t\t */\r\n\t\t\t\tthis.addParticle = function ( particle ) {\r\n\r\n\t\t\t\t\tif ( particle.userData.boFrustumPoints )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif ( raycaster.stereo ) {\r\n\r\n\t\t\t\t\t\traycaster.stereo.addParticle( particle );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( isAddedToParticles( particle ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Duplicate particle \"' + particle.name + '\"' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparticles.push( particle );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Convert mouse position to renderer coordinates.\r\n\t\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}\r\n\t\t\t * @param {HTMLElement} [el] parent of the <b>canvas</b>.\r\n\t\t\t * @returns <pre>\r\n\t\t\t * {\r\n\t\t\t *\r\n\t\t\t *\tgetMousePosition:function\r\n\t\t\t *\r\n\t\t\t * }\r\n\t\t\t * </pre>\r\n\t\t\t */\r\n\t\t\tstatic getRendererSize( renderer, el ) {\r\n\r\n\t\t\t\tel = el || renderer.domElement;\r\n\t\t\t\tconst style = {\r\n\r\n\t\t\t\t\tposition: el.style.position,\r\n\t\t\t\t\tleft: el.style.left,\r\n\t\t\t\t\ttop: el.style.top,\r\n\t\t\t\t\twidth: el.style.width,\r\n\t\t\t\t\theight: el.style.height,\r\n\r\n\t\t\t\t},\r\n\t\t\t\t\trect = el.getBoundingClientRect(),\r\n\t\t\t\t\tleft = Math.round( rect.left ),\r\n\t\t\t\t\ttop = Math.round( rect.top ),\r\n\t\t\t\t\tsize = new three.THREE.Vector2();\r\n\t\t\t\trenderer.getSize( size );\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tgetMousePosition: function ( mouse, event ) {\r\n\r\n\t\t\t\t\t\tmouse.x = ( event.clientX / size.x ) * 2 - 1 - ( left / size.x ) * 2;\r\n\t\t\t\t\t\tmouse.y = - ( event.clientY / size.y ) * 2 + 1 + ( top / size.y ) * 2;\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n/**@namespace\r\n * @description [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} methods.\r\n * @See <a href=\"./Raycaster.html\" target=\"_blank\">Raycaster</a> for details.\r\n * */\r\nOptions.raycaster = new Raycaster();\r\n\r\nexport default Options;","/**\r\n * @module Player\r\n * @description 3D objects animation.\r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import cookie from '../cookieNodeJS/cookie.js';\r\n//import cookie from 'https://raw.githack.com/anhr/commonNodeJS/master/cookieNodeJS/cookie.js';\r\n\r\nimport ScaleController from '../ScaleController.js';\r\nimport PositionController from '../PositionController.js';\r\n//import { dat } from '../dat/dat.module.js';\r\nimport { controllers } from '../dat.gui/CustomController/build/dat.gui.module.js';\r\n\r\n//import GuiSelectPoint from '../guiSelectPoint/guiSelectPoint.js';\r\n//import { GuiSelectPoint, getObjectPosition } from '../guiSelectPoint/guiSelectPoint.js';\r\n//import { GuiSelectPoint, getObjectPosition } from 'https://raw.githack.com/anhr/commonNodeJS/master/guiSelectPoint/guiSelectPoint.js';\r\n\r\n//import ColorPicker from '../colorpicker/colorpicker.js';\r\n//import ColorPicker from 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.js';\r\n\r\n//import { lang } from '../controllerPlay/index.js';\r\n\r\n//import Cookie from '../cookieNodeJS/cookie.js';\r\n//import Cookie from 'https://raw.githack.com/anhr/cookieNodeJS/master/cookie.js';\r\n//import Cookie from 'https://raw.githack.com/anhr/commonNodeJS/master/cookieNodeJS/cookie.js';\r\n\r\n//import { getWorldPosition } from '../guiSelectPoint/guiSelectPoint.js';\r\nimport { getWorldPosition } from '../getPosition.js';\r\n//getPositionSetTHREE( THREE );\r\n\r\nimport three from '../three.js'\r\n//import setOptions from '../setOptions.js'\r\nimport Options from '../Options.js'\r\n\r\n//var _timeSettings,\r\n\r\n\t//сделал общим для всех плееров потому что в getShaderMaterialPoints вызывается Player.selectMeshPlayScene\r\n\t//что бы установить начальные точки. Т.е. установить цвет и положение точек.\r\n\t//Начальные точки в getShaderMaterialPoints устанавливаются отдельно потому что в getShaderMaterialPoints точки создаются в отдельной нити\r\n\t//потому что сначала загружаются Shader файлы. Поэтому когда вызывается setTimeout( function () { onSelectScene(); }, 0 );\r\n\t//что бы цвет точек был верным еще до начала проигрывания, точки из getShaderMaterialPoints еще не добавлены в группу для проигрывания.\r\n\t//Кроме того цвет точек в getShaderMaterialPoints задается аттрибутом 'ca' а не 'color'.\r\n//\tvar _options;\r\n\r\n/**\r\n * @callback onSelectScene\r\n * @description This function is called at each new step of the playing. See <b>settings.onSelectScene</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a> class.\r\n * @param {number} index current index of the scene of the animation\r\n * @param {number} t current time\r\n */\r\n\r\n/**\r\n * @callback onChangeScaleT\r\n * @description User has updated the time settings. See <b>settings.onChangeScaleT</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a> class.\r\n * @param {object} scale the updated time settings\r\n */\r\n\r\nclass Player {\r\n\r\n\t/**\r\n\t * 3D objects animation.\r\n\t * @class\r\n\t * @param {THREE.Group|THREE.Scene} group [THREE.Group]{@link https://threejs.org/docs/index.html?q=group#api/en/objects/Group} or [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene} of the meshes for playing.\r\n\t * @param {Object} [settings={}] the following settings are available\r\n\t * \r\n\t * @param {Options} [settings.options=new Options()] <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a> instance. The following options are available.\r\n\t * See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {boolean} [settings.options.dat.playerGui] false - do not adds a <a href=\"../../player/jsdoc/module-Player-Player.html#gui\" target=\"_blank\">Player controllers</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean} [settings.options.dat.playController] false - do not adds a <a href=\"../../player/jsdoc/module-Player-Player_PlayController_PlayController.html\" target=\"_blank\">PlayController</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {Object} [settings.options.playerOptions] Player settings.\r\n\t * @param {number} [settings.options.playerOptions.min=0] Minimum range of the axis.\r\n\t * @param {number} [settings.options.playerOptions.max=1] Maximum range of the axis.\r\n\t * @param {number} [settings.options.playerOptions.marks=10] Ticks count of the playing. Number of scenes of 3D objects animation.\r\n\t * Have effect for <b>max</b> is not Infinity.\r\n\t * @param {number} [settings.options.playerOptions.dt=0.1] Step of the animation. Have effect only if <b>max</b> is infinity.\r\n\t * @param {boolean} [settings.options.playerOptions.repeat=false] true - Infinitely repeating 3D objects animation.\r\n\t * @param {number} [settings.options.playerOptions.interval=1] Ticks per seconds.\r\n\t * @param {number} [settings.options.playerOptions.zoomMultiplier=1.1] zoom multiplier of the time.\r\n\t * @param {number} [settings.options.playerOptions.offset=0.1] offset of the time.\r\n\t * @param {number} [settings.options.playerOptions.name=\"\"] name of the time.\r\n\t * @param {boolean} [settings.options.player] false - do not create a <b>Player</b> instance.\r\n\t *\r\n\t * @param {onSelectScene} [settings.onSelectScene] This function is called at each new step of the playing. See <a href=\"../../player/jsdoc/module-Player.html#~onSelectScene\" target=\"_blank\">onSelectScene</a>.\r\n\t * @param {onChangeScaleT} [settings.onChangeScaleT] event. User has updated the time settings. See <a href=\"../../player/jsdoc/module-Player.html#~onChangeScaleT\" target=\"_blank\">onChangeScaleT</a>.\r\n\t * @param {FrustumPoints} [settings.frustumPoints] See <a href=\"../../frustumPoints/jsdoc/index.html\" target=\"_blank\">FrustumPoints</a>.\r\n\t * Have effect only if <b>settings.options</b> is not defined.\r\n\t * @param {THREE.PerspectiveCamera} settings.cameraTarget.camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t */\r\n\tconstructor( group, settings={} ) {\r\n\r\n\t\tassign();\r\n/*\r\n\t\tif ( Player.isCreated() ) {\r\n\r\n\t\t\tconsole.error( 'Player: duplicate player.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n*/\r\n//\t\tsettings = settings || {};\r\n\r\n\t\tif ( !settings.options && settings.frustumPoints ) settings.options = settings.frustumPoints.getOptions();\r\n\t\tsettings.options = settings.options || new Options();\r\n\t\tconst options = settings.options;\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'Player: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n/*\r\n\t\tif ( options.playerOptions && settings.playerOptions ) {\r\n\r\n\t\t\tconsole.warn( 'Player: Duplicate options of the player. Sets priority of the options of the current player.' );\r\n\t\t\toptions.playerOptions = settings.playerOptions;//приоритет имеет настройки данного плеера\r\n\r\n\t\t}\r\n\t\toptions.playerOptions = options.playerOptions || settings.playerOptions;\r\n//\t\tsetOptions.setPlayerOptions( options );\r\n//\t\toptions.setPlayerOptions();\r\n\t\tsettings.playerOptions = options.playerOptions;\r\n*/\r\n\r\n//\t\tif ( options.playerOptions === false ) return;\r\n\t\tif ( options.player === false ) return;\r\n\r\n//Deprecated\r\n//Player.player = this;\r\n\r\n\t\toptions.boPlayer = options.boPlayer || false;\r\n\r\n/*\r\n\t\toptions.a = settings.a || 1;\r\n\t\toptions.b = settings.b || 0;\r\n*/\t\t\r\n\r\n\t\t//если тут создавать палитру то она не создастся если не создается плееер\r\n\t\t//palette = new palette();\r\n\r\n//\t\tassignSettings();\r\n\r\n\t\tif ( options.player ) {\r\n\r\n\t\t\tconsole.error( 'Player: duplicate player.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\toptions.player = this;\r\n\r\n\t\tsettings.cameraTarget = settings.cameraTarget || {};\r\n\r\n\t\t/**\r\n\t\t * @description This function is called at each new step of the playing.\r\n\t\t * @param {number} [index=0] current index of the scene of the animation\r\n\t\t */\r\n\t\tfunction onSelectScene( index ) {\r\n\r\n\t\t\tindex = index || 0;\r\n\t\t\tconst t = _this.getTime();\r\n\t\t\tPlayer.selectPlayScene( group, { t: t, index: index, options: settings.options } );\r\n//\t\t\t_this.setIndex( index, ( _timeSettings.name === '' ? '' : _timeSettings.name + ': ' ) + t );\r\n\t\t\t_this.setIndex( index, ( options.playerOptions.name === '' ? '' : options.playerOptions.name + ': ' ) + t );\r\n\t\t\tif ( settings.onSelectScene ) settings.onSelectScene( index, t );\r\n\t\t\tif ( options.frustumPoints ) options.frustumPoints.updateCloudPoints();\r\n\r\n\t\t}\r\n\r\n\t\t//Теперь не нужно создавать color attribute на веб странице что бы цвет точек был верным еще до начала проигрывания\r\n\t\t//Кроме того трассировака начинается с нулевой точки\r\n\t\tsetTimeout( function () { onSelectScene(); }, 0 );\r\n\r\n\t\tvar selectSceneIndex = 0;\r\n\t\tconst _this = this;\r\n\r\n\t\t/**\r\n\t\t * get time\r\n\t\t */\r\n\t\tthis.getTime = function () {\r\n\r\n\t\t\tconst playerOptions = options.playerOptions, t = playerOptions.min + selectSceneIndex * playerOptions.dt;\r\n\t\t\tif ( isNaN( t ) ) console.error( 'Player.getTime(): t = ' + t );\r\n\t\t\tif ( ( playerOptions.max !== null ) && ( t > playerOptions.max ) )\r\n\t\t\t\tconsole.error( 'Player.getTime(): t = ' + t + ' playerOptions.max = ' + playerOptions.max );\r\n\t\t\tif ( ( t < playerOptions.min ) && ( playerOptions.max !== null ) )\r\n\t\t\t\tconsole.error( 'Player.getTime(): t = ' + t + ' playerOptions.min = ' + playerOptions.min );\r\n/*\r\n\t\t\tconst t = _timeSettings.min + selectSceneIndex * _timeSettings.dt;\r\n\t\t\tif ( isNaN( t ) ) console.error( 'Player.getTime(): t = ' + t );\r\n\t\t\tif ( ( _timeSettings.max !== null ) && ( t > _timeSettings.max ) )\r\n\t\t\t\tconsole.error( 'Player.getTime(): t = ' + t + ' _timeSettings.max = ' + _timeSettings.max );\r\n\t\t\tif ( ( t < _timeSettings.min ) && ( _timeSettings.max !== null ) )\r\n\t\t\t\tconsole.error( 'Player.getTime(): t = ' + t + ' _timeSettings.min = ' + _timeSettings.min );\r\n*/\r\n\t\t\treturn t;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * set time\r\n\t\t * @param {number} t time\r\n\t\t */\r\n\t\tthis.setTime = function ( t ) {\r\n\r\n//\t\t\tthis.selectScene( parseInt( ( t - _timeSettings.min ) / _timeSettings.dt ) );\r\n\t\t\tthis.selectScene( parseInt( ( t - options.playerOptions.min ) / options.playerOptions.dt ) );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * select scene for playing\r\n\t\t * @param {number} index Index of the scene. Range from 0 to options.playerOptions.marks - 1\r\n\t\t */\r\n\t\tthis.selectScene = function ( index ) {\r\n\r\n\t\t\tif ( index === undefined ) {\r\n\r\n\t\t\t\tonSelectScene( selectSceneIndex );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tindex = parseInt( index );\r\n//\t\t\tif ( _timeSettings.max !== null )\r\n\t\t\tif ( options.playerOptions.max !== null ) {\r\n\r\n//\t\t\t\tif ( index >= _timeSettings.marks )\r\n\t\t\t\tif ( index >= options.playerOptions.marks )\r\n\t\t\t\t\tindex = 0;\r\n\t\t\t\telse if ( index < 0 )\r\n\t\t\t\t\tindex = options.playerOptions.marks - 1;\r\n//\t\t\t\t\tindex = _timeSettings.marks - 1;\r\n/*\t\t\t\t\t\r\n\t\t\t\tif ( selectSceneIndex > _timeSettings.marks )\r\n\t\t\t\t\tselectSceneIndex = _timeSettings.marks;\r\n*/\t\t\t\t\t\r\n\t\t\t\tif ( selectSceneIndex > options.playerOptions.marks )\r\n\t\t\t\t\tselectSceneIndex = options.playerOptions.marks;\r\n\r\n\t\t\t}\r\n\t\t\twhile ( selectSceneIndex !== index ) {\r\n\r\n\t\t\t\tif ( selectSceneIndex < index )\r\n\t\t\t\t\tselectSceneIndex++;\r\n\t\t\t\telse selectSceneIndex--;\r\n\t\t\t\tonSelectScene( selectSceneIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Go to next object 3D\r\n\t\t */\r\n\t\tthis.next = function () {\r\n\r\n\t\t\t_this.selectScene( selectSceneIndex + 1 );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Go to previous object 3D\r\n\t\t */\r\n\t\tthis.prev = function () {\r\n\r\n\t\t\t_this.selectScene( selectSceneIndex - 1 );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Add controller into controllers array\r\n\t\t * @param {controller} controller\r\n\t\t */\r\n\t\tthis.pushController = function ( controller ) {\r\n\r\n\t\t\tif ( ( controller.object !== undefined ) && ( controller.object.playRate !== undefined ) )\r\n\t\t\t\tcontroller.object.playRate = options.playerOptions.min;\r\n//\t\t\t\tcontroller.object.playRate = _timeSettings.min;\r\n\t\t\tthis.controllers.push( controller );\r\n\r\n\t\t}\r\n\r\n\t\t//Play/Pause\r\n\r\n\t\tthis.controllers = [];\r\n\t\tvar playing = false, time, timeNext;\r\n\r\n\t\tfunction RenamePlayButtons() {\r\n\r\n//\t\t\tPlayer.player.controllers.forEach( function ( controller ) { if ( controller.onRenamePlayButtons ) controller.onRenamePlayButtons( playing ); } );\r\n\t\t\toptions.player.controllers.forEach( function ( controller ) { if ( controller.onRenamePlayButtons ) controller.onRenamePlayButtons( playing ); } );\r\n\r\n\t\t}\r\n\r\n\t\tfunction play() {\r\n\r\n//\t\t\tif ( ( selectSceneIndex === -1 ) || ( ( selectSceneIndex === _timeSettings.marks ) && ( _timeSettings.max !== null ) ) )\r\n\t\t\tif (\r\n\t\t\t\t( selectSceneIndex === -1 ) ||\r\n\t\t\t\t(\r\n\t\t\t\t\t( selectSceneIndex === options.playerOptions.marks ) &&\r\n\t\t\t\t\t( options.playerOptions.max !== null )\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\r\n\t\t\t\tselectSceneIndex = 0;\r\n\r\n\t\t\t}\r\n\t\t\tonSelectScene( selectSceneIndex );\r\n\r\n\t\t}\r\n\r\n\t\tfunction pause() {\r\n\r\n\t\t\tplaying = false;\r\n\t\t\tRenamePlayButtons();\r\n\r\n\t\t\ttime = undefined;\r\n\r\n\t\t}\r\n\t\tfunction isRepeat() {\r\n\r\n//\t\t\treturn _timeSettings.repeat;\r\n\t\t\treturn options.playerOptions.repeat;\r\n\r\n\t\t}\r\n\r\n\t\tfunction playNext() {\r\n\r\n\t\t\tselectSceneIndex++;\r\n//\t\t\tif ( ( _timeSettings.max !== null ) && selectSceneIndex >= _timeSettings.marks )\r\n\t\t\tif ( ( options.playerOptions.max !== null ) && selectSceneIndex >= options.playerOptions.marks ) {\r\n\r\n\t\t\t\tif ( isRepeat() )\r\n\t\t\t\t\tselectSceneIndex = 0;\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\t//Для вычисления текущего времени в случае:\r\n\t\t\t\t\t//1. Запустить плеер и дождаться когда проигрывание остановится после достижения максимального времени\r\n\t\t\t\t\t//2. В guiSelectPoint выбрать точку, цвет которой зависит от времени\r\n\t\t\t\t\t//Тогда если убрать эту строку, то selectSceneIndex и время окажется за диапазоном допустимых значений\r\n\t\t\t\t\t//и цвет точки окажется неверным\r\n\t\t\t\t\tselectSceneIndex = options.playerOptions.marks - 1;\r\n//\t\t\t\t\tselectSceneIndex = _timeSettings.marks - 1;\r\n\r\n\t\t\t\t\tpause();\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tplay();\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * User has clicked the Play ► / Pause ❚❚ button\r\n\t\t */\r\n\t\tthis.play3DObject = function () {\r\n\r\n\t\t\tif ( playing ) {\r\n\r\n\t\t\t\tpause();\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tplaying = true;\r\n//\t\t\tif ( ( _timeSettings.max !== null ) && ( selectSceneIndex >= ( _timeSettings.marks - 1 ) ) )\r\n\t\t\tif ( ( options.playerOptions.max !== null ) && ( selectSceneIndex >= ( options.playerOptions.marks - 1 ) ) )\r\n\t\t\t\tselectSceneIndex = 0;//-1;\r\n\t\t\tplayNext();\r\n\t\t\tRenamePlayButtons();\r\n\r\n\t\t\tfunction step( timestamp ) {\r\n\r\n\t\t\t\tif ( playing )\r\n\t\t\t\t\twindow.requestAnimationFrame( step );\r\n\t\t\t\telse time = undefined;\r\n\r\n\t\t\t\tif ( time === undefined ) {\r\n\r\n\t\t\t\t\ttime = timestamp;\r\n//\t\t\t\t\ttimeNext = time + 1000 / _timeSettings.interval;\r\n\t\t\t\t\ttimeNext = time + 1000 / options.playerOptions.interval;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( isNaN( timeNext ) || ( timeNext === Infinity ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'Player.animate: timeNext = ' + timeNext );\r\n\t\t\t\t\tplaying = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( timestamp < timeNext )\r\n\t\t\t\t\treturn;\r\n\t\t\t\twhile ( timestamp > timeNext )\r\n\t\t\t\t\ttimeNext += 1000 / options.playerOptions.interval;\r\n//\t\t\t\t\ttimeNext += 1000 / _timeSettings.interval;\r\n\t\t\t\tplayNext();\r\n\r\n\t\t\t}\r\n\t\t\twindow.requestAnimationFrame( step );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * User has clicked the repeat ⥀ button\r\n\t\t */\r\n\t\tthis.repeat = function () {\r\n\r\n\t\t\toptions.playerOptions.repeat = !options.playerOptions.repeat;\r\n\t\t\tthis.onChangeRepeat( options.playerOptions.repeat );\r\n/*\r\n\t\t\t_timeSettings.repeat = !_timeSettings.repeat;\r\n\t\t\tthis.onChangeRepeat( _timeSettings.repeat );\r\n*/\t\t\t\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns Player settings.\r\n\t\t */\r\n\t\tthis.getSettings = function () { return settings; }\r\n\t\t/**\r\n\t\t * @returns selected scene index.\r\n\t\t */\r\n\t\tthis.getSelectSceneIndex = function () { return selectSceneIndex; }\r\n\r\n\t\t/**@namespace\r\n\t\t * @descriptionUser has pressed the <b>Repeat</b> button of the <a href=\"../../player/jsdoc/module-Player-Player_PlayController_PlayController.html\" target=\"_blank\">Player.PlayController</a>.\r\n\t\t * @param {boolean} value true - repeat is off\r\n\t\t * <p>false - repeat is on</p>\r\n\t\t */\r\n\t\tthis.onChangeRepeat = function ( value ) {\r\n\r\n//\t\t\t_timeSettings.repeat = value;\r\n\t\t\toptions.playerOptions.repeat = value;\r\n\t\t\tthis.controllers.forEach( function ( controller ) { if ( controller.onChangeRepeat ) controller.onChangeRepeat(); } );\r\n\r\n\t\t}\r\n\r\n\t\t//Localization\r\n\t\tfunction getLang( params ) {\r\n\r\n\t\t\tparams = params || {};\r\n\t\t\tconst lang = {\r\n\r\n\t\t\t\tplayer: 'Player',\r\n\t\t\t\tplayerTitle: '3D objects animation.',\r\n\r\n\t\t\t\tmin: 'Min',\r\n\t\t\t\tmax: 'Max',\r\n\t\t\t\tdt: 'Step',\r\n\t\t\t\tdtTitle: 'Time between frames',\r\n\r\n\t\t\t\tmarks: 'Frames',\r\n\t\t\t\tmarksTitle: 'Player frames count',\r\n\r\n\t\t\t\tinterval: 'Rate',\r\n\t\t\t\tintervalTitle: 'Rate of changing of animation scenes per second.',\r\n\r\n\t\t\t\ttime: 'Time',\r\n\r\n\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\tdefaultTitle: 'Restore default player settings.',\r\n\r\n\t\t\t};\r\n\r\n\t\t\tconst _languageCode = params.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t: params.getLanguageCode();\r\n\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.player = 'Проигрыватель';\r\n\t\t\t\t\tlang.playerTitle = 'Анимация 3D объектов.';\r\n\r\n\t\t\t\t\tlang.min = 'Минимум';\r\n\t\t\t\t\tlang.max = 'Максимум';\r\n\t\t\t\t\tlang.dt = 'Шаг';\r\n\t\t\t\t\tlang.dtTitle = 'Веремя между кадрами';\r\n\r\n\t\t\t\t\tlang.marks = 'Кадры';\r\n\t\t\t\t\tlang.marksTitle = 'Количество кадров проигрывателя';\r\n\r\n\t\t\t\t\tlang.interval = 'Темп',\r\n\t\t\t\t\t\tlang.intervalTitle = 'Скорость смены кадров в секунду.';\r\n\r\n\t\t\t\t\tlang.time = 'Время';\r\n\r\n\t\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\t\tlang.defaultTitle = 'Восстановить настройки проигрывателя по умолчанию.';\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault://Custom language\r\n\t\t\t\t\tif ( ( params.lang === undefined ) || ( params.lang._languageCode != _languageCode ) )\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tObject.keys( params.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\tif ( _lang[key] === undefined )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t_lang[key] = params.lang[key];\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\treturn lang;\r\n\r\n\t\t}\r\n\r\n\t\t//PlayController localization\r\n\r\n\t\tconst lang = {\r\n\r\n\t\t\tprevSymbol: '←',\r\n\t\t\tprevSymbolTitle: 'Go to previous animation scene',\r\n\t\t\tnextSymbol: '→',\r\n\t\t\tnextSymbolTitle: 'Go to next animation scene',\r\n\t\t\tplaySymbol: '►',\r\n\t\t\tplayTitle: 'Play',\r\n\t\t\tpause: '❚❚',\r\n\t\t\tpauseTitle: 'Pause',\r\n\t\t\trepeat: '⥀',\r\n\t\t\trepeatOn: 'Turn repeat on',\r\n\t\t\trepeatOff: 'Turn repeat off',\r\n\t\t\tcontrollerTitle: 'Current time.',\r\n\t\t\tstereoEffects: 'Stereo effects',\r\n\t\t\tmono: 'Mono',\r\n\t\t\tsideBySide: 'Side by side',\r\n\t\t\ttopAndBottom: 'Top and bottom',\r\n\r\n\t\t};\r\n\t\tfunction localization( getLanguageCode ) {\r\n\t\t\tswitch ( getLanguageCode() ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\t\t\t\t\tlang.prevSymbolTitle = 'Кадр назад';//'Go to previous animation scene',\r\n\t\t\t\t\tlang.playTitle = 'Проиграть';//'Play'\r\n\t\t\t\t\tlang.nextSymbolTitle = 'Кадр вперед';//'Go to next animation scene';\r\n\t\t\t\t\tlang.pauseTitle = 'Пауза';//'Pause',\r\n\t\t\t\t\tlang.repeatOn = 'Повторять проигрывание';\r\n\t\t\t\t\tlang.repeatOff = 'Остановить повтор проигрывания';\r\n\t\t\t\t\tlang.controllerTitle = 'Текущее время.';\r\n\t\t\t\t\tlang.stereoEffects = 'Стерео эффекты';\r\n\t\t\t\t\tlang.mono = 'Моно';\r\n\t\t\t\t\tlang.sideBySide = 'Слева направо';\r\n\t\t\t\t\tlang.topAndBottom = 'Сверху вниз';\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t/** <a href=\"../../player/jsdoc/module-Player-Player_PlayController_PlayController.html\" target=\"_blank\">PlayController</a> localization\r\n\t\t* @param {Function} [getLanguageCode=\"en\"] Your custom getLanguageCode() function.\r\n\t\t* <pre>\r\n\t\t* returns the \"primary language\" subtag of the language version of the browser.\r\n\t\t* Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t* See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t\t* Default returns the 'en' is English language.\r\n\t\t* You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n\t\t* </pre>\r\n\t    * @returns Names and titles of the <b>PlayController</b> controls\r\n\t\t*/\r\n\t\tthis.localization = function ( getLanguageCode = function() { return 'en' } ) {\r\n\r\n\t\t\tlocalization( getLanguageCode );\r\n\t\t\treturn lang;\r\n\r\n\t\t}\r\n\r\n\t\tthis.PlayController = class extends controllers.CustomController {\r\n\r\n\t\t\t/**\r\n\t\t\t * @class playController class for using in my version of [dat.gui]{@link https://github.com/anhr/dat.gui} for animate of 3D objects in my projects.\r\n\t\t\t * @extends dat.controllers.CustomController. See [CustomController.js]{@link https://github.com/anhr/commonNodeJS/blob/master/dat.gui/CustomController/src/dat/controllers/CustomController.js}\r\n\t\t\t * @param {GUI} [gui] [new dat.GUI(...)]{@link https://github.com/anhr/dat.gui}. Folder for controller\r\n\t\t\t */\r\n\t\t\tconstructor( gui ) {\r\n\r\n//\t\t\t\tconst player = Player.player;\r\n\t\t\t\tconst player = options.player, getLanguageCode = options.getLanguageCode;\r\n\r\n\t\t\t\tgui = gui || options.dat.gui;\r\n\t\t\t\tif ( !gui || options.dat.playController === false ) {\r\n\r\n\t\t\t\t\tsuper( {} );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlocalization( getLanguageCode );\r\n\r\n\t\t\t\tfunction addButton( innerHTML, title, onclick ) {\r\n\r\n\t\t\t\t\tconst button = document.createElement( 'span' );\r\n\t\t\t\t\tbutton.innerHTML = innerHTML;\r\n\t\t\t\t\tbutton.title = title;\r\n\t\t\t\t\tbutton.style.cursor = 'pointer';\r\n\t\t\t\t\tbutton.style.margin = '0px 2px';\r\n\t\t\t\t\tbutton.onclick = onclick;\r\n\t\t\t\t\treturn button;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar _getGroup, _selectScene, _renamePlayButtons, _renameRepeatButtons, _repeat;//,_playNext, timerId, _prev, _play, _next;\r\n\t\t\t\tconst colorOff = 'rgb(255,255,255)', colorOn = 'rgb(128,128,128)';//'rgb(200,200,200)';\r\n\r\n\t\t\t\tsuper( {\r\n\r\n\t\t\t\t\tplayRate: 1,//Default play rate is 1 changes per second\r\n\t\t\t\t\tproperty: function ( customController ) {\r\n\r\n\t\t\t\t\t\tvar buttons = {};\r\n\t\t\t\t\t\tfunction RenamePlayButtons( innerHTML, title ) {\r\n\r\n\t\t\t\t\t\t\tbuttons.buttonPlay.innerHTML = innerHTML;\r\n\t\t\t\t\t\t\tbuttons.buttonPlay.title = title;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_renamePlayButtons = RenamePlayButtons;\r\n\r\n\t\t\t\t\t\tbuttons.buttonPrev = addButton( lang.prevSymbol, lang.prevSymbolTitle, player.prev );\r\n\t\t\t\t\t\tbuttons.buttonPlay = addButton( playing ? lang.pause : lang.playSymbol,\r\n\t\t\t\t\t\t\tplaying ? lang.pauseTitle : lang.playTitle, player.play3DObject );\r\n\r\n\t\t\t\t\t\tif ( player.getSettings().options.playerOptions.max !== null ) {\r\n\r\n\t\t\t\t\t\t\t//Repeat button\r\n\r\n\t\t\t\t\t\t\tfunction RenameRepeatButtons( isRepeat ) {\r\n\r\n\t\t\t\t\t\t\t\tvar title, color;\r\n\t\t\t\t\t\t\t\tif ( isRepeat ) {\r\n\r\n\t\t\t\t\t\t\t\t\ttitle = lang.repeatOff;\r\n\t\t\t\t\t\t\t\t\tcolor = colorOff;\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\ttitle = lang.repeatOn;\r\n\t\t\t\t\t\t\t\t\tcolor = colorOn;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ( buttons.buttonRepeat.title === title )\r\n\t\t\t\t\t\t\t\t\treturn;//stop of infinite recursive call\r\n\r\n\t\t\t\t\t\t\t\tbuttons.buttonRepeat.title = title;\r\n\t\t\t\t\t\t\t\tbuttons.buttonRepeat.style.color = color;\r\n\r\n\t\t\t\t\t\t\t\tplayer.onChangeRepeat( isRepeat );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_renameRepeatButtons = RenameRepeatButtons;\r\n\t\t\t\t\t\t\tfunction repeat( value ) {\r\n\r\n\t\t\t\t\t\t\t\tRenameRepeatButtons( buttons.buttonRepeat.title === lang.repeatOn );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_repeat = repeat;\r\n\t\t\t\t\t\t\tvar title, color;\r\n\t\t\t\t\t\t\tif ( player.getSettings().repeat ) {\r\n\r\n\t\t\t\t\t\t\t\ttitle = lang.repeatOff;\r\n\t\t\t\t\t\t\t\tcolor = colorOff;\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\ttitle = lang.repeatOn;\r\n\t\t\t\t\t\t\t\tcolor = colorOn;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbuttons.buttonRepeat = addButton( lang.repeat, title, repeat );\r\n\t\t\t\t\t\t\tbuttons.buttonRepeat.style.color = color;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbuttons.buttonNext = addButton( lang.nextSymbol, lang.nextSymbolTitle, player.next );\r\n\t\t\t\t\t\tfunction getGroup() {\r\n\r\n\t\t\t\t\t\t\treturn group;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_getGroup = getGroup;\r\n\r\n\t\t\t\t\t\treturn buttons;\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t}, 'playRate' );//, 1, 25, 1 );\r\n\t\t\t\tplayer.PlayController = this;\r\n\t\t\t\tthis.lang = lang;\r\n\t\t\t\t\r\n\t\t\t\t/** @namespace\r\n\t\t\t\t * @description Get array of THREE.Vector4 points. User has pressed the <b>Play</b> button. Rename the <b>Play</b> putton.\r\n\t\t\t\t * @param {boolean} playing true - name is \"❚❚\"\r\n\t\t\t\t * <p>false = name is \"►\"\r\n\t\t\t\t */\r\n\t\t\t\tthis.onRenamePlayButtons = function ( playing ) {\r\n\r\n\t\t\t\t\tvar name, title;\r\n\t\t\t\t\tif ( playing ) {\r\n\r\n\t\t\t\t\t\tname = lang.pause;\r\n\t\t\t\t\t\ttitle = lang.pauseTitle;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tname = lang.playSymbol;\r\n\t\t\t\t\t\ttitle = lang.playTitle;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_renamePlayButtons( name, title, true );\r\n\r\n\t\t\t\t}\r\n\t\t\t\t/** @namespace\r\n\t\t\t\t * @description User has pressed the <b>Repeat</b> button.\r\n\t\t\t\t */\r\n\t\t\t\tthis.onChangeRepeat = function () {\r\n\r\n//\t\t\t\t\t_renameRepeatButtons( player.getSettings().timeSettings.repeat );\r\n\t\t\t\t\t_renameRepeatButtons( player.getSettings().options.playerOptions.repeat );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tplayer.pushController( this );\r\n\t\t\t\t/**\r\n\t\t\t\t * @param {number} value current time of the playing\r\n\t\t\t\t */\r\n\t\t\t\tthis.setValue = function ( value ) {\r\n\r\n\t\t\t\t\tthis._controller.domElement.childNodes[0].value = value;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst controler = gui.add( this );\r\n\t\t\t\t//что бы можно было вводить цифры после запятой\r\n\t\t\t\tcontroler.__truncationSuspended = true;\r\n\r\n\t\t\t}\r\n\t\t\tset controller( newController ) {\r\n\r\n\t\t\t\tthis._controller = newController;\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tthis._controller.onChange( function ( value ) { options.player.setTime( value ); /*_this.onChange( value );*/ } );\r\n\t\t\t\tthis._controller.domElement.title = this.lang.controllerTitle;\r\n\r\n\t\t\t}\r\n\t\t\tget controller() { return this._controller; }\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Adds a Player's controllers into [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n\t\t * @param {GUI} [folder] Player's folder\r\n\t\t */\r\n\t\tthis.gui = function ( folder ) {\r\n\r\n/*\r\n\t\t\tguiParams.getLanguageCode = guiParams.getLanguageCode || function () { return \"en\"; };\r\n\t\t\tguiParams.cookie = guiParams.cookie || new Cookie.defaultCookie();\r\n\t\t\tguiParams.cookieName = guiParams.cookieName || '';\r\n\r\n\t\t\tconst cookie = guiParams.cookie, cookieName = 'Player' + guiParams.cookieName;\r\n*/\r\n\t\t\tconst cookie = options.dat.cookie,\r\n\t\t\t\tcookieName = options.dat.getCookieName( 'Player' ),\r\n\t\t\t\tgetLanguageCode = options.getLanguageCode,\r\n\t\t\t\tdat = three.dat;// options.dat.dat;\r\n\r\n\t\t\tfolder = folder || options.dat.gui;\r\n\t\t\tif ( !folder || options.dat.playerGui === false )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tfunction setDT() {\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t\tif ( _timeSettings.max === null ) _timeSettings.dt = _timeSettings.dt || 0.1;\r\n\t\t\t\t\telse _timeSettings.dt = ( _timeSettings.max - _timeSettings.min ) / ( _timeSettings.marks - 1 );\r\n\t\t\t\t*/\r\n\t\t\t\tif ( options.playerOptions.max === null ) options.playerOptions.dt = options.playerOptions.dt || 0.1;\r\n\t\t\t\telse options.playerOptions.dt = ( options.playerOptions.max - options.playerOptions.min ) / ( options.playerOptions.marks - 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction setSettings() {\r\n\r\n\t\t\t\tsetDT();\r\n/*\r\n\t\t\t\tcookie.setObject( cookieName, _timeSettings );\r\n\t\t\t\tif ( settings.onChangeScaleT ) settings.onChangeScaleT( _timeSettings );\r\n*/\r\n\t\t\t\tcookie.setObject( cookieName, options.playerOptions );\r\n\t\t\t\tif ( settings.onChangeScaleT ) settings.onChangeScaleT( options.playerOptions );\r\n\r\n\t\t\t}\r\n\t\t\t//function setMax() { if ( _timeSettings.max !== null ) _timeSettings.max = _timeSettings.min + _timeSettings.dt * ( _timeSettings.marks - 1 ); }\r\n\t\t\tfunction setMax() {\r\n\r\n\t\t\t\tif ( options.playerOptions.max !== null )\r\n\t\t\t\t\toptions.playerOptions.max = options.playerOptions.min + options.playerOptions.dt * ( options.playerOptions.marks - 1 );\r\n\r\n\t\t\t}\r\n\t\t\tsetMax();\r\n//\t\t\tconst axesDefault = JSON.parse( JSON.stringify( _timeSettings ) ),\r\n\t\t\tconst axesDefault = JSON.parse( JSON.stringify( options.playerOptions ) ),\r\n\t\t\t\tlang = getLang( {\r\n\r\n\t\t\t\t\tgetLanguageCode: getLanguageCode,\r\n\r\n\t\t\t\t} );\r\n\t\t\tObject.freeze( axesDefault );\r\n/*\r\n\t\t\tconst max = _timeSettings.max, marks = _timeSettings.marks;\r\n\t\t\tcookie.getObject( cookieName, _timeSettings, _timeSettings );\r\n*/\r\n\t\t\tconst max = options.playerOptions.max, marks = options.playerOptions.marks;\r\n\t\t\tcookie.getObject( cookieName, options.playerOptions, options.playerOptions );\r\n\t\t\tif ( ( max === null ) || ( max === Infinity ) ||\r\n//\t\t\t\t( _timeSettings.max === null )//раньше на веб странице плеер был настроен на бесконечное проигрыванияе а сейчас проигрывание ограничено по времени\r\n\t\t\t\t( options.playerOptions.max === null )//раньше на веб странице плеер был настроен на бесконечное проигрыванияе а сейчас проигрывание ограничено по времени\r\n\t\t\t) {\r\n\r\n/*\r\n\t\t\t\t_timeSettings.max = max;\r\n\t\t\t\t_timeSettings.marks = marks;\r\n*/\r\n\t\t\t\toptions.playerOptions.max = max;\r\n\t\t\t\toptions.playerOptions.marks = marks;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst fPlayer = folder.addFolder( lang.player );\r\n\t\t\tdat.folderNameAndTitle( fPlayer, lang.player, lang.playerTitle );\r\n\r\n\t\t\tfunction scale() {\r\n\r\n//\t\t\t\tconst axes = _timeSettings,\r\n\t\t\t\tconst axes = options.playerOptions,\r\n\t\t\t\t\tscaleControllers = {};\r\n\t\t\t\tfunction onclick( customController, action ) {\r\n\r\n\t\t\t\t\tvar zoom = customController.controller.getValue();\r\n\r\n\t\t\t\t\taxes.min = action( axes.min, zoom );\r\n\t\t\t\t\tscaleControllers.min.setValue( axes.min );\r\n\t\t\t\t\tif ( axes.max ) {\r\n\r\n\t\t\t\t\t\taxes.max = action( axes.max, zoom );\r\n\t\t\t\t\t\tsetDT();\r\n\t\t\t\t\t\tscaleControllers.max.setValue( axes.max );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscaleControllers.folder = fPlayer.addFolder( axes.name !== '' ? axes.name : lang.time );\r\n\r\n\t\t\t\tscaleControllers.scaleController = scaleControllers.folder.add( new ScaleController( onclick,\r\n\t\t\t\t\t{ settings: settings.options.playerOptions, getLanguageCode: getLanguageCode, } ) ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\taxes.zoomMultiplier = value;\r\n\t\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\tconst positionController = new PositionController( function ( shift ) {\r\n\r\n\t\t\t\t\tonclick( positionController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\tvalue += shift;//zoom;\r\n\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}, { settings: settings.options.playerOptions, getLanguageCode: getLanguageCode, } );\r\n\t\t\t\tscaleControllers.positionController = scaleControllers.folder.add( positionController ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\taxes.offset = value;\r\n\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t//min\r\n\t\t\t\tscaleControllers.min = dat.controllerZeroStep( scaleControllers.folder, axes, 'min', function ( value ) { setSettings(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.min, lang.min );\r\n\r\n\t\t\t\t//max\r\n\t\t\t\t//axes.max сейчас используется исключитьельно для удобства пользовательского интерфейса\r\n\t\t\t\t//Вместо axes.max используется axes.dt\r\n\t\t\t\tsetMax();\r\n\t\t\t\tif ( axes.max !== null ) {\r\n\r\n\t\t\t\t\tscaleControllers.max = dat.controllerZeroStep( scaleControllers.folder, axes, 'max', function ( value ) { setSettings(); } );\r\n\t\t\t\t\tdat.controllerNameAndTitle( scaleControllers.max, lang.max );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t//dt\r\n\t\t\t\t\tscaleControllers.dt = dat.controllerZeroStep( scaleControllers.folder, axes, 'dt', function ( value ) { setSettings(); } );\r\n\t\t\t\t\tdat.controllerNameAndTitle( scaleControllers.dt, lang.dt, lang.dtTitle );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//marks\r\n\t\t\t\tif ( axes.marks ) {\r\n\r\n\t\t\t\t\tscaleControllers.marks = scaleControllers.folder.add( axes, 'marks' ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\taxes.marks = parseInt( axes.marks );\r\n\t\t\t\t\t\tsetSettings();\r\n\t\t\t\t\t\tconst elSlider = getSliderElement();\r\n//\t\t\t\t\t\tif ( elSlider ) elSlider.max = _timeSettings.marks - 1;\r\n\t\t\t\t\t\tif ( elSlider ) elSlider.max = options.playerOptions.marks - 1;\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tdat.controllerNameAndTitle( scaleControllers.marks, axes.marksName === undefined ? lang.marks : axes.marksName,\r\n\t\t\t\t\t\taxes.marksTitle === undefined ? lang.marksTitle : axes.marksTitle );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Ticks per seconds.\r\n\t\t\t\tscaleControllers.interval = scaleControllers.folder.add( settings.options.playerOptions/*timeSettings*/, 'interval', 1, 25, 1 ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.interval, lang.interval, lang.intervalTitle );\r\n\r\n\t\t\t\t//Default button\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.folder.add( {\r\n\r\n\t\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\t\taxes.zoomMultiplier = axesDefault.zoomMultiplier;\r\n\t\t\t\t\t\tscaleControllers.scaleController.setValue( axes.zoomMultiplier );\r\n\r\n\t\t\t\t\t\taxes.offset = axesDefault.offset;\r\n\t\t\t\t\t\tscaleControllers.positionController.setValue( axes.offset );\r\n\r\n\t\t\t\t\t\taxes.min = axesDefault.min;\r\n\t\t\t\t\t\tscaleControllers.min.setValue( axes.min );\r\n\r\n\t\t\t\t\t\tif ( scaleControllers.max ) {\r\n\r\n\t\t\t\t\t\t\taxes.max = axesDefault.max;\r\n\t\t\t\t\t\t\tsetDT();\r\n\t\t\t\t\t\t\tscaleControllers.max.setValue( axes.max );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( scaleControllers.dt ) {\r\n\r\n\t\t\t\t\t\t\taxes.dt = axesDefault.dt;\r\n\t\t\t\t\t\t\tscaleControllers.dt.setValue( axes.dt );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( axesDefault.marks ) {\r\n\r\n\t\t\t\t\t\t\taxes.marks = axesDefault.marks;\r\n\r\n\t\t\t\t\t\t\t//scaleControllers.marks is undefined если программист сначала установил max: Infinity,\r\n\t\t\t\t\t\t\t//соханил Player in cookie, например изменил marks\r\n\t\t\t\t\t\t\t//удалил max: Infinity,\r\n\t\t\t\t\t\t\t//Нажал кнопку Default для проигрывателя\r\n\t\t\t\t\t\t\tif ( scaleControllers.marks )\r\n\t\t\t\t\t\t\t\tscaleControllers.marks.setValue( axes.marks );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\taxes.interval = axesDefault.interval;\r\n\t\t\t\t\t\tscaleControllers.interval.setValue( axes.interval );\r\n\r\n\t\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\t\t}\r\n\t\t\tscale();\r\n\r\n\t\t}\r\n\r\n\t\tvar _canvasMenu;\r\n\t\t/**\r\n\t\t * Adds a Player's menu item into [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t * @param {CanvasMenu} canvasMenu [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t* @param {Function} [getLanguageCode=\"en\"] Your custom getLanguageCode() function.\r\n\t\t* <pre>\r\n\t\t* returns the \"primary language\" subtag of the language version of the browser.\r\n\t\t* Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t* See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t\t* Default returns the 'en' is English language.\r\n\t\t* You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n\t\t* </pre>\r\n\t\t */\r\n\t\tthis.createCanvasMenuItem = function ( canvasMenu, getLanguageCode = function() { return 'en' } ) {\r\n\r\n\t\t\t_canvasMenu = canvasMenu;\r\n\r\n//\t\t\tconst player = this, menu = canvasMenu.menu, lang = Player.player.localization( getLanguageCode );//Player.player.PlayController.lang;\r\n\t\t\tconst player = this, menu = canvasMenu.menu, lang = player.localization( getLanguageCode );\r\n\r\n\t\t\t//Previous button\r\n\t\t\tmenu.push( {\r\n\r\n\t\t\t\tname: lang.prevSymbol,\r\n\t\t\t\ttitle: lang.prevSymbolTitle,\r\n\t\t\t\tonclick: function ( event ) { player.prev(); }\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//Play button\r\n\t\t\tmenu.push( {\r\n\r\n\t\t\t\tname: playing ? lang.pause : lang.playSymbol,\r\n\t\t\t\ttitle: playing ? lang.pauseTitle : lang.playTitle,\r\n\t\t\t\tid: \"menuButtonPlay\",\r\n\t\t\t\tonclick: function ( event ) {\r\n\r\n\t\t\t\t\tplayer.play3DObject();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n//\t\t\tif ( _timeSettings.max !== null )\r\n\t\t\tif ( options.playerOptions.max !== null ) {\r\n\r\n\t\t\t\t//Repeat button\r\n\t\t\t\tmenu.push( {\r\n\r\n\t\t\t\t\tname: lang.repeat,\r\n\t\t\t\t\ttitle: this.getSettings().repeat ? lang.repeatOff : lang.repeatOn,\r\n\t\t\t\t\tid: \"menuButtonRepeat\",\r\n\t\t\t\t\tonclick: function ( event ) { player.repeat(); }\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Next button\r\n\t\t\tmenu.push( {\r\n\r\n\t\t\t\tname: lang.nextSymbol,\r\n\t\t\t\ttitle: lang.nextSymbolTitle,\r\n\t\t\t\tonclick: function ( event ) { player.next(); }\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tthis.controllers.push( {\r\n\r\n\t\t\t\t/* *\r\n\t\t\t\t * Renames the \"Play\" button of the player's menu.\r\n\t\t\t\t * @param {boolean} playing <b>true</b> - pause.\r\n\t\t\t\t * <p><b>false</b> - play</p>\r\n\t\t\t\t */\r\n\t\t\t\tonRenamePlayButtons: function ( playing ) {\r\n\r\n\t\t\t\t\tvar name, title;\r\n\t\t\t\t\tif ( playing ) {\r\n\r\n\t\t\t\t\t\tname = lang.pause;\r\n\t\t\t\t\t\ttitle = lang.pauseTitle;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tname = lang.playSymbol;\r\n\t\t\t\t\t\ttitle = lang.playTitle;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst elMenuButtonPlay = canvasMenu.querySelector( '#menuButtonPlay' );\r\n\t\t\t\t\telMenuButtonPlay.innerHTML = name;\r\n\t\t\t\t\telMenuButtonPlay.title = title;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\t/* *\r\n\t\t\t\t * Changes \"Repeat\" button of the player's menu between <b>repeat Off</b> and <b>repeat On</b>.\r\n\t\t\t\t */\r\n\t\t\t\tonChangeRepeat: function () {\r\n\r\n//\t\t\t\t\tcanvasMenu.querySelector( '#menuButtonRepeat' ).title = _timeSettings.repeat ? lang.repeatOff : lang.repeatOn;\r\n\t\t\t\t\tcanvasMenu.querySelector( '#menuButtonRepeat' ).title = options.playerOptions.repeat ? lang.repeatOff : lang.repeatOn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Adds slider menu item into [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t */\r\n\t\tthis.addSlider = function () {\r\n\r\n//\t\t\tif ( _timeSettings.max === null )\r\n\t\t\tif ( options.playerOptions.max === null )\r\n\t\t\t\treturn;\r\n\r\n\t\t\t_canvasMenu.menu.push( {\r\n\r\n//\t\t\t\tname: '<input type=\"range\" min=\"0\" max=\"' + ( Player.getSettings().marks - 1 ) + '\" value=\"0\" class=\"slider\" id=\"sliderPosition\">',\r\n\t\t\t\tname: '<input type=\"range\" min=\"0\" max=\"' + ( options.playerOptions.marks - 1 ) + '\" value=\"0\" class=\"slider\" id=\"sliderPosition\">',\r\n\t\t\t\tstyle: 'float: right;',\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getSliderElement() { if ( _canvasMenu ) return _canvasMenu.querySelector( '#sliderPosition' ); }\r\n\r\n\t\t/**\r\n\t\t * Adds an events into slider menu item of the [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t * @returns slider element\r\n\t\t */\r\n\t\tthis.addSliderEvents = function () {\r\n\r\n\t\t\tconst elSlider = getSliderElement(), player = this;\r\n\t\t\tif ( elSlider ) {\r\n\r\n\t\t\t\telSlider.onchange = function ( event ) { player.selectScene( parseInt( elSlider.value ) ); };\r\n\t\t\t\telSlider.oninput = function ( event ) { player.selectScene( parseInt( elSlider.value ) ); };\r\n\r\n\t\t\t\tvar pointerdown;\r\n\t\t\t\tconst player = this;\r\n\t\t\t\telSlider.addEventListener( 'pointerdown', e => { pointerdown = true; } );\r\n\t\t\t\telSlider.addEventListener( 'pointerup', e => { pointerdown = false; } );\r\n\t\t\t\telSlider.addEventListener( 'mousemove', e => {\r\n\r\n\t\t\t\t\tif ( !pointerdown )\r\n\t\t\t\t\t\treturn;\r\n//\t\t\t\t\tplayer.selectScene( ( _timeSettings.marks - 1 ) * e.offsetX / elSlider.clientWidth );\r\n\t\t\t\t\tplayer.selectScene( ( options.playerOptions.marks - 1 ) * e.offsetX / elSlider.clientWidth );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\treturn elSlider;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Sets <b>index</b> and <b>title</b> of the slider element of the player's menu.\r\n\t\t * @param {string} index\r\n\t\t * @param {string} title\r\n\t\t */\r\n\t\tthis.setIndex = function ( index, title ) {\r\n\r\n\t\t\tif ( typeof this.PlayController === \"object\" ) this.PlayController.setValue( this.getTime() );\r\n\t\t\tconst elSlider = getSliderElement();\r\n\t\t\tif ( elSlider ) {\r\n\r\n\t\t\t\telSlider.value = index;\r\n\t\t\t\telSlider.title = title;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Changes the \"max\" value of the slider of the player's menu. Moves <b>Player</b> to the first scene.\r\n\t\t * @param {Object} scale See  <b>options.playerOptions</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t */\r\n\t\tthis.onChangeScale = function ( scale ) {\r\n\r\n\t\t\tgetSliderElement().max = scale.marks - 1;\r\n\t\t\tthis.selectScene( 0 );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/* * @namespace\r\n * @description Is player created?\r\n * @returns true if Player is created\r\n */\r\n//Player.isCreated = function () { return Player.player ? true : false; }\r\n\r\n\r\n/**\r\n * @class\r\n */\r\nPlayer.cameraTarget = class {\r\n\r\n\t/**\r\n\t * Functions for camera for looking at selected point.\r\n\t */\r\n\tconstructor() {\r\n\r\n\t\tconst cameraTargetDefault = { boLook: false, },//По умолчанию не слежу за точкой\r\n\t\t\t_cameraTarget = {\r\n\r\n\t\t\t\tboLook: cameraTargetDefault.boLook,\r\n\t\t\t\tgetDistanceToCamera() {\r\n\r\n\t\t\t\t\tif ( typeof this.distanceToCameraCur !== 'undefined' ) return this.distanceToCameraCur;\r\n\t\t\t\t\treturn this.distanceToCamera;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\tvar _options;\r\n\t\t//\tcameraTargetDefault.boLook = false;\r\n\t\tcameraTargetDefault.rotation = {};\r\n\t\t_cameraTarget.rotation = {};\r\n\t\tvar boTarget = false,//true - target point was detected. For displaying of the console warning if duplicate target point was detected\r\n\t\t\tboPlayer = false;//true - была попытка получить camera из _options.player. Добавил что бы не выполнялась лишняя работа\r\n\r\n\t\t//Если определен ( boCameraTargetLook !== undefined ) , то явно было задано следить или не следить за точкой.\r\n\t\t//Тогда если есть точка, за которой надо следить ( cameraTarget.bodefault === false )\r\n\t\t//и явно не было задано следить или не следить заточкой  ( boCameraTargetLook === undefined ),\r\n\t\t//то надо следить за точкой ( cameraTargetDefault.boLook = true )\r\n\t\tvar boCameraTargetLook;\r\n\r\n\t\t/**\r\n\t\t * get camera target\r\n\t\t * @param {Object} [options] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t * @param {Object} [options.player] <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> instance.\r\n\t\t */\r\n\t\tthis.get = function ( options ) {\r\n\r\n\t\t\tif ( !options && !_options )\r\n\t\t\t\tconsole.error( 'Player.cameraTarget.get: options = ' + options );\r\n\t\t\telse if ( _options && options && !Object.is( _options, options ) )\r\n\t\t\t\tconsole.error( 'Player.cameraTarget.get: options is ambiguous' );\r\n\t\t\t_options = _options || options;\r\n/*\r\n\t\t\tif ( !_cameraTarget.camera && !boPlayer && Player.player ) {\r\n\r\n\t\t\t\tcameraTargetDefault.camera = Player.player.getSettings().cameraTarget.camera;\r\n\t\t\t\tif ( cameraTargetDefault.camera ) setCameraTarget();\r\n\t\t\t\tboPlayer = true;\r\n\r\n\t\t\t}\r\n*/\t\t\t\r\n\t\t\tif ( !_cameraTarget.camera && !boPlayer && _options.player ) {\r\n\r\n\t\t\t\tcameraTargetDefault.camera = _options.player.getSettings().cameraTarget.camera;\r\n\t\t\t\tif ( cameraTargetDefault.camera ) setCameraTarget();\r\n\t\t\t\tboPlayer = true;\r\n\r\n\t\t\t}\r\n\t\t\tif ( _cameraTarget.camera )\r\n\t\t\t\treturn _cameraTarget;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Create default camera target\r\n\t\t * @param {object} cameraTarget the following cameraTarget are available:\r\n\t\t * @param {THREE.PerspectiveCamera} [cameraTarget.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n\t\t * @param {boolean} [cameraTarget.boLook=false] true - camera look at the target.\r\n\t\t * @param {THREE.Vector3} [cameraTarget.distanceToCamera] Distance from target point to camera.\r\n\t\t   * You can set the distance to the camera depending on the time.\r\n\t\t * <pre>\r\n\t\t *\tExample 1: new THREE.Vector3( 0, 0, new Function( 't', 'return 2+t' ) )\r\n\t\t *\tExample 2: new THREE.Vector3( 0, 0,\r\n\t\t *\t\t[ { t: 0, v: 5 }, { t: 1, v: 2 }, { t: 10, v: 2 }, { t: 11, v: 5 } ] )\r\n\t\t *\tDefault is camera.position.\r\n\t\t * </pre>\r\n\t\t * @param {object} [cameraTarget.rotation] rotation camera around point specified by an axis and an angle. Default is undefined - no rotation\r\n\t\t * @param {number|function|array} [cameraTarget.rotation.angle=0] Angle of rotation in radians.\r\n\t\t * <pre>\r\n\t\t *   number. Example: Math.PI / 2 rotate to 90 degrees.\r\n\t\t *   function. Example: new Function( 't', 'return 5*t' ).\r\n\t\t *   array.\r\n\t\t *     Example 1: [0, Math.PI]\r\n\t\t *       0 is angle for t = min is start time of the playing.\r\n\t\t *       Math.PI is rotate to 180 degrees\r\n\t\t *         for t = max is time of the stopping of the playing.\r\n\t\t *       If max time is infinity, then angle is for t = min.\r\n\t\t *     Example 2: [{ t: 0, v: 0 }, { t: 1, v: Math.PI / 2 }\r\n\t\t *       t is time,\r\n\t\t *       v is angle for current t.\r\n\t\t * </pre>\r\n\t\t * @param {THREE.Vector3} [cameraTarget.rotation.axis] Axis of rotattion.\r\n\t\t * <pre>\r\n\t\t *   Example: new THREE.Vector3( 1, 0, 0 ) - rotate around x axis.\r\n\t\t *   Default is rotate around y axis\r\n\t\t * </pre>\r\n\t\t * @param {Object} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t * @param {boolean} [boErrorMessage=true] false - Do not send an error message to the console if <b>cameraTarget.camera</b> is not defined.\r\n\t\t */\r\n\t\tthis.init = function ( cameraTarget, options, boErrorMessage = true ) {\r\n\r\n\t\t\tif ( !cameraTarget ) return;\r\n\t\t\t\r\n\t\t\tif ( !options && !_options )\r\n\t\t\t\tconsole.error( 'Player.cameraTarget.init: options = ' + options );\r\n\t\t\telse if ( _options && options && !Object.is( _options, options ) )\r\n\t\t\t\tconsole.error( 'Player.cameraTarget.init: options is ambiguous' );\r\n\t\t\t_options = _options || options;\r\n\t\t\t\r\n\t\t\t//если вызывается эта функция значит надо следить за точкой\r\n\t\t\t//если нет точки, за которой надо следить, и создан OrbitControls, то следить за OrbitControls.target https://threejs.org/docs/index.html?q=orbit#examples/en/controls/OrbitControls.target\r\n//\t\t\tif ( cameraTarget.boLook === undefined ) cameraTarget.boLook = true;\r\n\r\n\t\t\t//cameraTargetDefault.boLook = false по умолчанию камера не смотритт на выбранную точку если:\r\n\t\t\t// 1 ни разу не вызывается init. Тоесть нет настроек cameraTargetDefault и нет ни однойточки, на которую смотрит камера\r\n\t\t\t// 2 cameraTarget.bodefault !== false и cameraTarget.boLook = false - программист явно запретил смотреть на точку\r\n\r\n\t\t\t//Если есть хоть одна точка, на которую должна смотреть камера cameraTarget.bodefault === false,\r\n\t\t\t//то для этой точки не устанавливаем playerCameraTarget.cameraTargetDefault\r\n\t\t\t//Другими словами если есть точка, на которую должна смотреть камера,\r\n\t\t\t//то камера будет на нее смотреть если нет запрета смотеть на точку - playerCameraTarget.cameraTargetDefault = false\r\n\t\t\tif ( cameraTarget.bodefault !== false ) {\r\n\r\n\t\t\t\tif ( boTarget )\r\n\t\t\t\t\treturn;//Не надо устанавливать cameraTargetDefault после того,\r\n\t\t\t\t//как были устанвлены настройки cameraTargetDefault из точек\r\n\t\t\t\t//Иначе натройки точки не будут приоритетными\r\n\r\n\t\t\t\tif ( cameraTarget.boLook !== undefined ) {\r\n\r\n\t\t\t\t\tcameraTargetDefault.boLook = cameraTarget.boLook;\r\n\t\t\t\t\tboCameraTargetLook = cameraTarget.boLook;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( cameraTarget.boLook === true ) {\r\n\r\n\t\t\t\t//Есть точка, за которой надо следить\r\n\r\n\t\t\t\tif ( boTarget ) console.warn( 'playerCameraTarget().init(...): duplicate target point' );\r\n\t\t\t\tboTarget = true;\r\n\r\n\t\t\t\tif ( boCameraTargetLook === undefined )\r\n\t\t\t\t\tcameraTargetDefault.boLook = true;//запрета на слежение камерой за точкой не было и есть точка, за которой надо следить\r\n\r\n\t\t\t} else return;\r\n//\t\t\tcameraTargetDefault.camera = cameraTargetDefault.camera || cameraTarget.camera || ( Player.player ? Player.player.getSettings().cameraTarget.camera : undefined );\r\n\t\t\tcameraTargetDefault.camera = cameraTargetDefault.camera ||\r\n\t\t\t\tcameraTarget.camera ||\r\n\t\t\t\t( _options.player ? _options.player.getSettings().cameraTarget.camera : undefined );\r\n\t\t\tif ( !cameraTargetDefault.camera && boErrorMessage ) {\r\n\r\n\t\t\t\tconsole.error( 'playerCameraTarget().init(...): cameraTargetDefault.camera = ' + cameraTargetDefault.camera );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tcameraTargetDefault.distanceToCamera = cameraTargetDefault.distanceToCamera || cameraTarget.distanceToCamera;\r\n\t\t\tcameraTarget.rotation = cameraTarget.rotation || {};\r\n\t\t\tcameraTargetDefault.rotation.angle = cameraTargetDefault.rotation.angle || cameraTarget.rotation.angle;\r\n\t\t\tcameraTargetDefault.rotation.axis = cameraTargetDefault.rotation.axis || cameraTarget.rotation.axis;\r\n\t\t\tsetCameraTarget( cameraTarget );\r\n\r\n\t\t}\r\n\t\tfunction setCameraTarget( cameraTarget ) {\r\n\r\n\t\t\tassign();\r\n\r\n\t\t\tif ( !cameraTarget )\r\n\t\t\t\tcameraTarget = cameraTargetDefault;//У выбранной для слежения точки нет cameraTarget\r\n\t\t\tif ( !_cameraTarget.boMaual ) {//если не делать эту проверку, то пользователь не сможет изменить вручную _cameraTarget.boLook когда выбрана точка, за которой надо следить\r\n\r\n\t\t\t\tif ( cameraTarget.boLook !== undefined )\r\n\t\t\t\t\t_cameraTarget.boLook = cameraTarget.boLook;\r\n\t\t\t\telse _cameraTarget.boLook = cameraTargetDefault.boLook;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_cameraTarget.camera = cameraTarget.camera || cameraTargetDefault.camera;\r\n\r\n\t\t\t//Если в программе не определены функции distanceToCamera (тоесть cameraTarget.distanceToCamera === undefined и cameraTargetDefault.distanceToCamera === undefined),\r\n\t\t\t//то при проигрывании каждый раз distanceToCamera будет равна camera.position\r\n\t\t\t//\t\t_cameraTarget.distanceToCamera = cameraTarget.distanceToCamera || cameraTargetDefault.distanceToCamera || new THREE.Vector3().copy( cameraTargetDefault.camera.position );\r\n\r\n\t\t\t//Если в программе не определены функции distanceToCamera (тоесть cameraTarget.distanceToCamera === undefined и cameraTargetDefault.distanceToCamera === undefined),\r\n\t\t\t//То сначала _cameraTarget.distanceToCamera будет равна camera.position, а потом при проигрывании не будет меняться\r\n\t\t\t_cameraTarget.distanceToCamera =\r\n\t\t\t\tcameraTarget.distanceToCamera ||\r\n\t\t\t\tcameraTargetDefault.distanceToCamera ||\r\n\t\t\t\t_cameraTarget.distanceToCamera ||\r\n\t\t\t\tnew THREE.Vector3().copy( cameraTargetDefault.camera.position );\r\n\r\n\t\t\tif ( !cameraTarget.rotation ) cameraTarget.rotation = {};\r\n\t\t\tif ( cameraTarget.rotation.angle !== undefined )\r\n\t\t\t\t_cameraTarget.rotation.angle = cameraTarget.rotation.angle;\r\n\t\t\telse _cameraTarget.rotation.angle = cameraTargetDefault.rotation.angle || 0;\r\n\t\t\t_cameraTarget.rotation.axis = cameraTarget.rotation.axis || cameraTargetDefault.rotation.axis || new THREE.Vector3( 0, 1, 0 );//Rotate around y axis\r\n\r\n\t\t}\r\n\r\n\t\t/* *\r\n\t\t * Set a target point, what camera is look at.\r\n\t\t * @param {THREE.Mesh} mesh [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} with selected point as target for camera.\r\n\t\t*/\r\n/*\r\n\t\tthis.setTarget = function ( mesh ) {\r\n\r\n\t\t\tif ( !mesh.geometry )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tconst arrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\t\tif ( arrayFuncs === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\t\t\tvar funcs = arrayFuncs[i];\r\n\t\t\t\tPlayer.cameraTarget.changeTarget( mesh, i );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n*/\r\n\t\t/**\r\n\t\t * Change target.\r\n\t\t * @param {THREE.Mesh} mesh [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} with selected point as target for camera.\r\n\t\t * @param {number} i index of the point.\r\n\t\t */\r\n\t\tthis.changeTarget = function ( mesh, i ) {\r\n\r\n\t\t\tassign();\r\n\r\n//\t\t\tconst cameraTarget = Player.cameraTarget.get();\r\n\t\t\tconst cameraTarget = _options.playerOptions.cameraTarget.get();\r\n\r\n\t\t\t//Update cameraTarget\r\n\t\t\tconst func = !mesh.userData.player || ( typeof mesh.userData.player.arrayFuncs === \"function\" ) ? {} : mesh.userData.player.arrayFuncs[i];\r\n\t\t\tif ( !func.cameraTarget )\r\n\t\t\t\tfunc.cameraTarget = { boLook: false };\r\n\t\t\tsetCameraTarget( func.cameraTarget );\r\n\r\n\t\t\tif ( cameraTarget && cameraTarget.boLook ) {\r\n\r\n\t\t\t\tconst target = getWorldPosition( mesh, new THREE.Vector3().fromArray( mesh.geometry.attributes.position.array, i * mesh.geometry.attributes.position.itemSize ) );\r\n\t\t\t\tcameraTarget.target = target;\r\n\r\n\t\t\t} else delete cameraTarget.target;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Update camera settings.\r\n\t\t * @param {Object} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t */\r\n\t\tthis.setCameraTarget = function ( options ) {\r\n\r\n\t\t\tassign();\r\n\r\n//\t\t\tvar cameraTarget = Player.cameraTarget.get( options );\r\n\t\t\tvar cameraTarget = options.playerOptions.cameraTarget.get( options );\r\n\t\t\tif ( !cameraTarget ) cameraTarget = cameraTarget || {};\r\n\t\t\tconst camera = cameraTarget.camera;\r\n\r\n\t\t\tif ( !camera )\r\n\t\t\t\treturn;//В этом приложении невозможно следить за точкой, потому что ни разу не была вызывана Player.cameraTarget.init()\r\n\r\n\t\t\t//На случай когда не определена ни одна точка как cameraTarget и пользователь поставил птичку в controllerCameraTarget\r\n\t\t\tif ( !cameraTarget.distanceToCamera )\r\n\t\t\t\tcameraTarget.distanceToCamera = new THREE.Vector3().copy( camera.position );\r\n\r\n\t\t\tif ( !cameraTarget.distanceToCameraCur )\r\n\t\t\t\tcameraTarget.distanceToCameraCur = new THREE.Vector3();\r\n\r\n//\t\t\tconst t = Player.getTime(),\r\n\t\t\tconst t = options.time,\r\n\t\t\t\tdistanceToCamera = cameraTarget.distanceToCamera,\r\n\t\t\t\tdistanceToCameraCur = new THREE.Vector3().copy( cameraTarget.distanceToCameraCur );\r\n\t\t\tcameraTarget.distanceToCameraCur.set(\r\n\r\n\t\t\t\tPlayer.execFunc( distanceToCamera, 'x', t, options ),\r\n\t\t\t\tPlayer.execFunc( distanceToCamera, 'y', t, options ),\r\n\t\t\t\tPlayer.execFunc( distanceToCamera, 'z', t, options )\r\n\r\n\t\t\t);\r\n\r\n//\t\t\tif ( !cameraTarget.setCameraPosition || update )\r\n\t\t\tif ( !cameraTarget.setCameraPosition )\r\n\t\t\t\tcameraTarget.setCameraPosition = function ( /*setCameraDefault*/ ) {\r\n\r\n\t\t\t\t\tvar target = cameraTarget.target;\r\n\r\n\t\t\t\t\t//не менять позицию камеры если\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t!cameraTarget.boLook ||//не следить за точкой\r\n\t\t\t\t\t\t(//или\r\n\t\t\t\t\t\t\t!target &&//нет точки, за которой надо следить\r\n\t\t\t\t\t\t\tcameraTarget.distanceToCameraCur.equals( distanceToCameraCur )//и не изменилось расстояние камеры до target\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t) {\r\n\r\n/*\r\n\t\t\t\t\t\tif ( camera.userData.default && camera.userData.default.setDefault && setCameraDefault )\r\n\t\t\t\t\t\t\tcamera.userData.default.setDefault();\r\n*/\r\n\t\t\t\t\t\treturn;//Камере не нужно следить за выбранной точкой или ни одна точка не определена как target\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tdistanceToCameraCur.copy( cameraTarget.distanceToCameraCur );\r\n//\t\t\t\t\tconst t = Player.getTime();\r\n\t\t\t\t\tconst t = options.time;\r\n\t\t\t\t\tcamera.position.copy( cameraTarget.distanceToCameraCur );\r\n\t\t\t\t\tcamera.position.applyAxisAngle( cameraTarget.rotation.axis, Player.execFunc( cameraTarget.rotation, 'angle', t, options ) );\r\n\t\t\t\t\tif ( !target ) {\r\n\r\n\t\t\t\t\t\tif ( Player.orbitControls ) target = Player.orbitControls.target;\r\n\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t//console.warn( 'Under constaction' );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcamera.position.add( target );\r\n\t\t\t\t\tcamera.lookAt( target );\r\n\t\t\t\t\tif ( options.orbitControls ) {\r\n\r\n\t\t\t\t\t\tif ( !options.orbitControls.target.equals( target ) ) {\r\n\r\n\t\t\t\t\t\t\toptions.orbitControls.target.copy( target );\r\n\t\t\t\t\t\t\tif ( options.orbitControlsGui )\r\n\t\t\t\t\t\t\t\toptions.orbitControlsGui.setTarget( target );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( options.orbitControls._listeners )\r\n\t\t\t\t\t\t\toptions.orbitControls._listeners.change[0]();//move frustumpoints\r\n\r\n\t\t\t\t\t}\r\n/*\t\t\t\t\t\r\n\t\t\t\t\tif ( Player.orbitControls ) {\r\n\r\n\t\t\t\t\t\tif ( !Player.orbitControls.target.equals( target ) ) {\r\n\r\n\t\t\t\t\t\t\tPlayer.orbitControls.target.copy( target );\r\n\t\t\t\t\t\t\tif ( Player.orbitControlsGui )\r\n\t\t\t\t\t\t\t\tPlayer.orbitControlsGui.setTarget( target );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tPlayer.orbitControls._listeners.change[0]();//move frustumpoints\r\n\r\n\t\t\t\t\t}\r\n*/\t\t\t\t\t\r\n//Если тут это взывать, то не будет обновляться cameraGui если не выбрана ни одна точка как target\r\n//\t\t\t\t\tif ( options.cameraGui ) options.cameraGui.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\tif ( options.cameraGui ) options.cameraGui.update();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n//Player.cameraTarget = new Player.cameraTarget();\r\n\r\n/** @namespace\r\n * @description execute function\r\n * @param {THREE.Vector4} funcs vector of the functions for executing.\r\n * @param {string} axisName axis name of the function for executing. Can be as \"x\", \"y\", \"z\", \"w\".\r\n * @param {number} t time. First parameter of the function for executing.\r\n * @param {object} [options={}] the following options are available:\r\n * @param {number} [options.a=1] multiplier. Second parameter of the function for executing.\r\n * @param {number} [options.b=0] addendum. Third parameter of the function for executing.\r\n * @returns function execution value.\r\n */\r\nPlayer.execFunc = function ( funcs, axisName, t, options={} ) {\r\n\r\n//\tsetOptions.setPlayerOptions( options );\r\n//\toptions.setPlayerOptions();\r\n/*\r\n\tif ( options.a === undefined ) options.a = 1;\r\n\tif ( options.b === undefined ) options.b = 0;\r\n*/\t\r\n\tvar func = funcs[axisName];\r\n\tconst a = options.a, b = options.b, typeofFuncs = typeof func;\r\n\tif ( typeof t === \"undefined\" ) t = options.playerOptions ? options.playerOptions.min : 0;\r\n\tswitch ( typeofFuncs ) {\r\n\r\n\t\tcase \"undefined\":\r\n\t\t\treturn undefined;\r\n\t\tcase \"string\":\r\n\t\t\tfunc = new Function( 't', 'a', 'b', 'return ' + func );\r\n\t\tcase \"function\":\r\n\t\t\ttry {\r\n\r\n\t\t\t\tconst res = func( t, a, b );\r\n\t\t\t\tif ( res === undefined )\r\n\t\t\t\t\tthrow 'function returns ' + res;\r\n\t\t\t\treturn res;\r\n\r\n\t\t\t} catch( e ) {\r\n\r\n\t\t\t\tconsole.error( e );\r\n\t\t\t\tthrow e;\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\tcase \"number\":\r\n\t\t\treturn func;\r\n\t\tcase \"object\":\r\n\t\t\tif ( Array.isArray( func ) ) {\r\n\r\n\t\t\t\tif ( func.length === 0 ) {\r\n\r\n\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array is empty' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst a = func,\r\n\t\t\t\t\tl = func.length - 1,\r\n\t\t\t\t\tmax = options.playerOptions.max === null ? Infinity : options.playerOptions.max,\r\n\t\t\t\t\tmin = options.playerOptions.min,\r\n\t\t\t\t\ttStep = ( max - min ) / l;\r\n\t\t\t\tvar tStart = min, tStop = max,\r\n\t\t\t\t\tiStart = 0, iStop = l;\r\n\t\t\t\tfor ( var i = 0; i < func.length; i++ ) {\r\n\r\n\t\t\t\t\tif ( tStep * i + min < t ) {\r\n\r\n\t\t\t\t\t\tiStart = i;\r\n\t\t\t\t\t\tiStop = i + 1;\r\n\t\t\t\t\t\ttStart = tStep * iStart + min;\r\n\t\t\t\t\t\ttStop = tStep * iStop + min;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfunction execW( i ) {\r\n\r\n\t\t\t\t\tif ( typeof a[i] === \"function\" )\r\n\t\t\t\t\t\treturn a[i]( t, a, b );\r\n\t\t\t\t\tif ( a[i] instanceof THREE.Color )\r\n\t\t\t\t\t\treturn a[i];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( typeof a[iStart] !== \"number\" ) {\r\n\r\n\t\t\t\t\tif ( axisName === 'w' ) {\r\n\r\n\t\t\t\t\t\treturn execW( iStart );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( typeof a[iStart] === \"object\" ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < func.length; i++ ){\r\n\r\n\t\t\t\t\t\t\tif ( i === ( func.length - 1 ) ) return a[i].v;\r\n\r\n\t\t\t\t\t\t\tiStart = i; iStop = i + 1;\r\n\t\t\t\t\t\t\ttStart = a[iStart].t; tStop = a[iStop].t;\r\n\t\t\t\t\t\t\tif ( ( tStart <= t ) && ( tStop > t ) ) {\r\n\r\n\t\t\t\t\t\t\t\tvar x = ( a[iStop].v - a[iStart].v ) / ( tStop - tStart ),\r\n\t\t\t\t\t\t\t\t\ty = a[iStart].v - x * tStart;\r\n\t\t\t\t\t\t\t\treturn x * t + y;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: value is not detected' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array item ' + iStart + ' typeof = ' + ( typeof a[iStart] ) + ' is not number' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( iStop >= func.length ) iStop = iStart;\r\n\t\t\t\tif ( typeof a[iStop] !== \"number\" ) {\r\n\r\n\t\t\t\t\tif ( axisName === 'w' )\r\n\t\t\t\t\t\treturn execW( iStop );\r\n\t\t\t\t\tif ( typeof a[iStop] !== \"object\" ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array item ' + iStop + ' typeof = ' + ( typeof a[iStop] ) + ' is not number' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tvar x = ( a[iStop] - a[iStart] ) / ( tStop - tStart ),\r\n\t\t\t\t\ty = a[iStart] - x * tStart;\r\n\t\t\t\tif ( isNaN( x ) || isNaN( y ) ) console.error( 'Player.execFunc: invalid x = ' + x + ' or y = ' + y );\r\n\t\t\t\treturn x * t + y;\r\n\r\n\t\t\t}\r\n\t\t\tif ( func.func )\r\n\t\t\t\treturn func.func instanceof Function ? func.func( t, a, b ) : func.func;\r\n\t\t\tif ( axisName !== 'w' )\r\n\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] object is not array' );\r\n\t\t\treturn func;\r\n\t\tdefault:\r\n\t\t\tconsole.error( 'Player.execFunc: Invalud typeof funcs[\"' + axisName + '\"]: ' + typeofFuncs );\r\n\t}\r\n\treturn;\r\n\r\n}\r\n/*\r\nfunction palette() {\r\n\r\n\tvar paletteDefault;\r\n\tthis.get = function() {\r\n\r\n\t\tif ( _options && _options.palette )\r\n\t\t\treturn _options.palette;\r\n\t\t\t\r\n\t\tif ( !paletteDefault )\r\n\t\t\tpaletteDefault = new ColorPicker.palette();\r\n\t\treturn paletteDefault;\r\n\r\n\t}\r\n\r\n}\r\npalette = new palette();\r\n*/\r\n\r\n/** @namespace\r\n * @description Select a scene for playing of the mesh\r\n * @param {THREE.Mesh} mesh [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} for playing.\r\n * @param {Object} [settings={}] the following settings are available\r\n * @param {number} [settings.t=0] time\r\n * @param {Object} [settings.options={ dat: false }] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n * @param {boolean} [settings.options.boPlayer] true - is not select play scene for mesh.userData.boFrustumPoints = true. Default is false.\r\n * @param {object} [settings.options.playerOptions] The <b>settings.options.playerOptions</b> parameter of the <a href=\"./module-Player-Player.html\" target=\"_blank\">Player</a> .\r\n * @param {number} [settings.options.a] multiplier. Second parameter of the arrayFuncs item function. Default is 1.\r\n * @param {number} [settings.options.b] addendum. Third parameter of the arrayFuncs item function. Default is 0.\r\n * @param {object} [settings.options.scales] axes scales.\r\n * See <b>options.scales</b> of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> for details.\r\n * @param {object} [settings.options.palette=new ColorPicker.palette();//palette: ColorPicker.paletteIndexes.BGYW] See <a href=\"../../colorPicker/jsdoc/module-ColorPicker.html#~Palette\" target=\"_blank\">ColorPicker.palette</a>.\r\n * @param {object} [settings.options.point={}] point settings. Applies to points with ShaderMaterial.\r\n * <pre>\r\n * See [ShaderMaterial]{@link https://threejs.org/docs/index.html#api/en/materials/ShaderMaterial} for details.\r\n * The size of the point seems constant and does not depend on the distance to the camera.\r\n * </pre>\r\n * @param {number} [settings.options.point.size=0.02] The apparent angular size of a point in radians.\r\n*/\r\nPlayer.selectMeshPlayScene = function ( mesh, settings = {} ) {\r\n\r\n\tassign();\r\n\r\n\tvar t = settings.t, options = settings.options || { dat: false };//, index = settings.index\r\n\r\n//\toptions = options || {};\r\n//\tif ( !options ) options = { dat: false };//не надо создавать еще одну версию new dat.GUI();\r\n//\toptions = new Options( options );\r\n//\tsetOptions.setPlayerOptions( options );\r\n//\toptions.setPlayerOptions();\r\n\tif ( t === undefined ) t = options.playerOptions.min;\r\n//\tindex = index || 0;\r\n//\tsetOptions.setScales( options );\r\n//\toptions.setScales();\r\n\toptions.scales.setW();\r\n\tif (\r\n\r\n\t\t!mesh.userData.player ||\r\n\t\t( options && options.boPlayer && mesh.userData.boFrustumPoints )\r\n\r\n\t)\r\n\t\treturn;\r\n\r\n\t//Эти строки нужны что бы появлялся текст возле точки, если на нее наведена мышка\r\n\t//при условии, что до этого точка была передвинута с помошью проигрывателя.\r\n\tif ( mesh.geometry ) {//scene do not have geometry\r\n\r\n\t\tdelete mesh.geometry.boundingSphere;\r\n\t\tmesh.geometry.boundingSphere = null;\r\n\r\n\t}\r\n\r\n\tif ( mesh.userData.player.selectPlayScene ) {\r\n\r\n\t\tmesh.userData.player.selectPlayScene( t );\r\n\r\n\t\t//если не приводить угол поворота в диапазон 0 - 360 градусов,\r\n\t\t//то угол поворота будет равен нулю или Math.PI * 2\r\n\t\t//когда пользователь выберет mesh в guiSelectPoint.js\r\n\t\t//потому что в органе управления угла поворота угол поворота ограничен 0 - 360 градусов,\r\n\t\t//смотри строку\r\n\t\t//cRotations[name] = fRotation.add( new THREE.Vector3(), name, 0, Math.PI * 2, 1 / 360 ).\r\n\t\t//в guiSelectPoint\r\n\t\tfunction setRotation( axisName ) {\r\n\r\n\t\t\twhile ( mesh.rotation[axisName] < 0 ) mesh.rotation[axisName] += Math.PI * 2;\r\n\t\t\twhile ( mesh.rotation[axisName] > Math.PI * 2 ) mesh.rotation[axisName] -= Math.PI * 2;\r\n\r\n\t\t}\r\n\t\tsetRotation( 'x' );\r\n\t\tsetRotation( 'y' );\r\n\t\tsetRotation( 'z' );\r\n\t\t\r\n\t}\r\n\r\n\tfunction setAttributes( a, b ) {\r\n\r\n\t\tif ( !mesh.geometry )\r\n\t\t\treturn;\r\n\t\t\t\r\n\t\tconst attributes = mesh.geometry.attributes,\r\n\t\t\tarrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\tif ( arrayFuncs === undefined )\r\n\t\t\treturn;\r\n\t\tif ( t === undefined )\r\n\t\t\tconsole.error( 'setPosition: t = ' + t );\r\n\r\n\t\tvar min, max;\r\n\t\tif ( options && ( options.scales.w !== undefined ) ) {\r\n\r\n\t\t\tmin = options.scales.w.min; max = options.scales.w.max;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmax = value;\r\n\t\t\tmin = max - 1;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\t\tvar funcs = arrayFuncs[i], needsUpdate = false;\r\n\t\t\tfunction setPosition( axisName, fnName ) {\r\n\r\n\t\t\t\tvar value = Player.execFunc( funcs, axisName, t, options );// a, b );\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\tattributes.position[fnName]( i, value );\r\n\t\t\t\t\tneedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tsetPosition( 'x', 'setX' );\r\n\t\t\tsetPosition( 'y', 'setY' );\r\n\t\t\tsetPosition( 'z', 'setZ' );\r\n\r\n\t\t\t//если тут поставить var то цвет точки, которая определена как THREE.Vector3 будет равет цвету предыдущей точки\r\n\t\t\t//потому что перемнные типа var видны снаружи блока {}\r\n\t\t\tlet color;\r\n\r\n\t\t\tfunction getColor() {\r\n\r\n\t\t\t\tif ( mesh.userData.player.palette )\r\n\t\t\t\t\tcolor = mesh.userData.player.palette.toColor( value, min, max );\r\n\t\t\t\telse if ( options.palette )\r\n\t\t\t\t\tcolor = options.palette.toColor( value, min, max );\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tconst c = { r: 255, g: 255, b: 255 };\r\n\t\t\t\t\tcolor = new THREE.Color( \"rgb(\" + c.r + \", \" + c.g + \", \" + c.b + \")\" );\r\n\t\t\t\t\treturn color;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( typeof funcs.w === \"function\" ) {\r\n\r\n\t\t\t\tvar value = funcs.w( t, a, b );\r\n\t\t\t\tif ( options.scales.w ) {\r\n\r\n\t\t\t\t\tmin = options.scales.w.min;\r\n\t\t\t\t\tmax = options.scales.w.max;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'Player.selectMeshPlayScene: Кажется эти экстремумы заданы неверно' );\r\n\t\t\t\t\tmin = 0;\r\n\t\t\t\t\tmax = 100;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( attributes.position.itemSize >= 4 )\r\n\t\t\t\t\tattributes.position.setW( i, value );\r\n\t\t\t\tneedsUpdate = true;\r\n\r\n\t\t\t\tgetColor();\r\n\r\n\t\t\t} else if ( typeof funcs.w === \"object\" ) {\r\n\r\n\t\t\t\tif ( funcs.w instanceof THREE.Color )\r\n\t\t\t\t\tcolor = funcs.w;\r\n\t\t\t\telse {\r\n\r\n//\t\t\t\t\tvar value = funcs.w.func( t, a, b );\r\n\t\t\t\t\tvar value = Player.execFunc( funcs, 'w', t, options );\r\n\t\t\t\t\tif ( funcs.w.min !== undefined ) min = funcs.w.min;\r\n\t\t\t\t\tif ( funcs.w.max !== undefined ) max = funcs.w.max;\r\n\t\t\t\t\tgetColor();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( ( typeof funcs.w === \"number\" ) && options.palette )\r\n\t\t\t\tcolor = options.palette.toColor( funcs.w, min, max );\r\n\t\t\tif ( color ) {\r\n\r\n\t\t\t\tif ( !mesh.material instanceof THREE.ShaderMaterial && mesh.material.vertexColors !== THREE.VertexColors )\r\n\t\t\t\t\tconsole.error( 'Player.selectMeshPlayScene: Please set the vertexColors parameter of the THREE.PointsMaterial of your points to THREE.VertexColors. Example: vertexColors: THREE.VertexColors' );\r\n\t\t\t\tif ( !Player.setColorAttribute( attributes, i, color ) && funcs instanceof THREE.Vector4 ) {\r\n\r\n\t\t\t\t\tmesh.geometry.setAttribute( 'color',\r\n\t\t\t\t\t\tnew THREE.Float32BufferAttribute( Player.getColors( arrayFuncs,\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tpositions: mesh.geometry.attributes.position,\r\n\t\t\t\t\t\t\t\toptions: options,\r\n/*\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tscale: { min: min, max: max },\r\n\t\t\t\t\t\t\t\tpalette: options.palette,\r\n*/\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t} ), 4 ) );\r\n\t\t\t\t\tif ( !Player.setColorAttribute( attributes, i, color ) )\r\n\t\t\t\t\t\tconsole.error( 'Player.selectMeshPlayScene: the color attribute is not exists. Please use THREE.Vector3 instead THREE.Vector4 in the arrayFuncs or add \"color\" attribute' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tif ( needsUpdate )\r\n\t\t\t\tattributes.position.needsUpdate = true;\r\n\r\n\t\t\tif ( funcs.line && funcs.line.addPoint )\r\n\t\t\t\tfuncs.line.addPoint( mesh, i, color );\r\n\t\t\tif ( funcs.cameraTarget && ( funcs.cameraTarget.boLook === true ) )\r\n\t\t\t\toptions.playerOptions.cameraTarget.changeTarget( mesh, i );\r\n//\t\t\t\tPlayer.cameraTarget.changeTarget( mesh, i );\r\n\r\n\t\t};\r\n\r\n\t}\r\n\tsetAttributes( options ? options.a : 1, options ? options.b : 0 );\r\n\tconst message = 'Player.selectMeshPlayScene: invalid mesh.scale.';\r\n\tif ( mesh.scale.x <= 0 ) console.error( message + 'x = ' + mesh.scale.x );\r\n\tif ( mesh.scale.y <= 0 ) console.error( message + 'y = ' + mesh.scale.y );\r\n\tif ( mesh.scale.z <= 0 ) console.error( message + 'z = ' + mesh.scale.z );\r\n\r\n\tif ( !options || !options.guiSelectPoint )\r\n\t\treturn;\r\n\r\n\toptions.guiSelectPoint.setMesh();\r\n\r\n\tvar selectedPointIndex = options.guiSelectPoint.getSelectedPointIndex();\r\n\tif ( ( selectedPointIndex !== -1 ) && options.guiSelectPoint.isSelectedMesh( mesh ) ) {\r\n\r\n\t\toptions.guiSelectPoint.setPosition( /*getObjectPosition( mesh, selectedPointIndex ), */{\r\n\r\n\t\t\tobject: mesh,\r\n\t\t\tindex: selectedPointIndex,\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/** @namespace\r\n * @description set color attribute\r\n * @param {Object} attributes [geometry.attributes]{@link https://threejs.org/docs/index.html?q=geometry#api/en/core/BufferGeometry.attributes} of the mesh\r\n * @param {number} i index of the color in the color attribute array.\r\n * @param {THREE.Color} color color.\r\n * @returns true - success\r\n * <p>false - colorAttribute was not detected.</p>\r\n */\r\nPlayer.setColorAttribute = function ( attributes, i, color ) {\r\n\r\n\tif ( typeof color === \"string\" )\r\n\t\tcolor = new THREE.Color( color );\r\n\tconst colorAttribute = attributes.color || attributes.ca;\r\n\tif ( colorAttribute === undefined )\r\n\t\treturn false;\r\n\tcolorAttribute.setX( i, color.r );\r\n\tcolorAttribute.setY( i, color.g );\r\n\tcolorAttribute.setZ( i, color.b );\r\n\tcolorAttribute.needsUpdate = true;\r\n\treturn true;\r\n\r\n}\r\n\r\n/** @namespace\r\n * @description Get array of THREE.Vector4 points.\r\n * @param {THREE.Vector4|THREE.Vector3|THREE.Vector2|object|array} arrayFuncs <b>points.geometry.attributes.position</b> array\r\n * <pre>\r\n * THREE.Vector4: 4D point.\r\n * THREE.Vector3: 3D point. w = 1. Default is white color\r\n * THREE.Vector2: 2D point. w = 1, z = 0. Default is white color\r\n * Vector's x, y, z, w is position of the point.\r\n * Can be as:\r\n * <ul>\r\n * <li>float - position of the point.</li>\r\n * Example: 0.5\r\n * <li>[float] - array of positions of the point.</li>\r\n * Example 1: [0.6, 0, -0.5]\r\n * 0.6 is positon for t = min is start time of the playing.\r\n * 0 is position for t = ( max - min ) / 2\r\n * -0.5 is positon for t = max is stop time of the playing.\r\n * If stop time of the playing is infinity, then position is equal to the first item of the array or 0.6 in the example 1.\r\n * \r\n * Example 2: [{ t: 0, v: 0.6 }, { t: 1, v: -0.6 }]\r\n * Every item of array is object with:\r\n * t is time\r\n * v is position for current t.\r\n * <li>[Function]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} - position of the point is function of the t.\r\n * Example: new Function( 't', 'a', 'b', 'return Math.sin(t*a*2*Math.PI)*0.5+b' )</li>\r\n * <li>string - text of the function.\r\n * Example: 'Math.sin(t*a*2*Math.PI)*0.5+b' )</li>\r\n * </ul>\r\n * <b>Vector.w</b> is index of the [palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * Default range of the <b>Vector.w</b> is from 0 to 1. You can change range by use an object:\r\n * {\r\n *   func: Vector.w\r\n *   max: new max value of tne Vector.w\r\n *   min: new min value of tne Vector.w\r\n * }\r\n * Example:\r\n * {\r\n *\r\n *   func: new Function( 't', 'return 1-2*t' ),\r\n *   min: -1,\r\n *   max: 1,\r\n *\r\n * }\r\n * <b>Vector.w</b> can be as [THREE.Color]{@link https://threejs.org/docs/index.html?q=colo#api/en/math/Color}. Example: new THREE.Color( \"rgb(255, 127, 0)\" )\r\n *\r\n * object: {\r\n *   vector: THREE.Vector4|THREE.Vector3|THREE.Vector2 - point position\r\n *   [name]: point name. Default is undefined.\r\n *   [trace]: true - displays the trace of the point movement. Default is undefined.\r\n *   \r\n *   //You can set the camera to look at a point. Use <b>cameraTarget</b> key for it.\r\n *   //ATTENTION!!! Only one point can have <b>cameraTarget</b> key!\r\n *   //   You will receive the \r\n *   \r\n *   //      Player.getPoints: duplicate cameraTarget\r\n *   \r\n *   //   console warning if two or more points have <b>cameraTarget</b> key.\r\n *   //   Then only last point with <b>cameraTarget</b> key will be have an effect.\r\n *   [cameraTarget]: {\r\n *\r\n *      camera: [camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera},\r\n *      \r\n *      //rotation camera around point specified by an axis and an angle. Default is undefined - no rotation\r\n *      [rotation]: {\r\n *      \r\n *         [angle]: number|function|array. Angle of rotation in radians.\r\n *            number. Example: Math.PI / 2 rotate to 90 degrees.\r\n *            function. Example: new Function( 't', 'return 5*t' ).\r\n *            array. Example 1: [0, Math.PI]\r\n *                  0 is angle for t = min is start time of the playing.\r\n *                  Math.PI is rotate to 180 degrees for t = max is time of the stopping of the playing.\r\n *                  If max time is infinity, then angle is for t = min.\r\n *               Example 2: [{ t: 0, v: 0 }, { t: 1, v: Math.PI / 2 }\r\n *                  t is time,\r\n *                  v is angle for current t.\r\n *            \r\n *            Default is 0\r\n *\r\n *         [axis]: THREE.Vector3. Axis of rotattion. Example: new THREE.Vector3( 1, 0, 0 ) - rotate around x axis.\r\n *            Default is new THREE.Vector3( 0, 1, 0 );//Rotate around y axis\r\n *            \r\n *      },\r\n *      \r\n *      [distanceToCamera]: <b>THREE.Vector3</b>. Distance from point to camera.\r\n *         You can set the distance to the camera depending on the time.\r\n *         Example 1: new THREE.Vector3( 0, 0, new Function( 't', 'return 2+t' ) )\r\n *         Example 2: new THREE.Vector3( 0, 0, [{ t: 0, v: 5 }, { t: 1, v: 2 }, { t: 10, v: 2 }, { t: 11, v: 5 }] )\r\n *         Default is camera.position.\r\n *      [orbitControls]: [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}. Change the <b>OrbitControl</b> setting during playing.\r\n *      [orbitControlsGui]: <a href=\"../../OrbitControls/jsdoc/index.html\" target=\"_blank\">OrbitControlsGui</a> instance;\r\n *\r\n *   },\r\n *\r\n * }\r\n * or\r\n * object: {\r\n *   x: x axis. Defauilt is 0.\r\n *   y: y axis. Defauilt is 0.\r\n *   z: z axis. Defauilt is 0.\r\n *   w: w axis. Defauilt is 0.\r\n * }\r\n *\r\n * array: [\r\n *   0: x axis. Defauilt is 0.\r\n *   1: y axis. Defauilt is 0.\r\n *   2: z axis. Defauilt is 0.\r\n *   3: w axis. Defauilt is 0.\r\n * ]\r\n * </pre>\r\n * @param {object} [optionsPoints] followed optionsPoints is available\r\n * @param {THREE.Group} [optionsPoints.group] {@link https://threejs.org/docs/index.html#api/en/objects/Group|Group}\r\n * or {@link https://threejs.org/docs/index.html#api/en/scenes/Scene|Scene}.\r\n * Use only if you want trace lines during playing. See <b>trace</b> of the <b>arrayFuncs</b> param above.\r\n * @param {number} [optionsPoints.t=0] first parameter of the <b>arrayFuncs</b> item function. Start time of animation.\r\n * @param {object} [optionsPoints.options] the following options are available\r\n * @param {number} [optionsPoints.options.a=1] multiplier. Second parameter of the <b>arrayFuncs</b> item function.\r\n * @param {number} [optionsPoints.options.b=0] addendum. Third parameter of the <b>arrayFuncs</b> item function.\r\n * @param {object} [optionsPoints.options.playerOptions] See <b>settings.options.playerOptions</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a> class.\r\n * @returns array of <b>THREE.Vector4</b> points.\r\n */\r\nPlayer.getPoints = function ( arrayFuncs, optionsPoints ) {\r\n\r\n\tassign();\r\n\t\r\n\tif ( !Array.isArray( arrayFuncs ) ) arrayFuncs = [ arrayFuncs ];\r\n\t\r\n\toptionsPoints = optionsPoints || {};\r\n\tif ( optionsPoints.t === undefined ) optionsPoints.t = optionsPoints.options && optionsPoints.options.player ? optionsPoints.options.player.getSettings().options.playerOptions.min : 0;\r\n\tconst options = optionsPoints.options || new Options(),\r\n\t\toptionsDefault = { palette: options.palette };\r\n/*\t\t\r\n\tif ( !options.boOptions ) {\r\n\r\n\t\tconsole.error( 'Player.getPoints: call options = new Options( options ) first' );\r\n\t\treturn;\r\n\r\n\t}\r\n*/\t\r\n\toptions.setW( optionsDefault );\r\n//\tsetOptions.setW( optionsDefault );\r\n\tconst wDefault = optionsDefault.scales.w.max;//new THREE.Vector4().w;//1;//цвет точки по умолчанию равен цвету палитры для максимального значения value,\r\n\t\t\t\t\t\t//которе по умолчанияю равно 1 и определяется в Options class.\r\n\t\t\t\t\t\t//Палитра по умолчанию ColorPicker.paletteIndexes.BGYW\r\n\t\t\t\t\t\t//у которой цвет максимального значения value белый.\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar item = arrayFuncs[i];\r\n\t\tif ( Array.isArray( item ) )\r\n\t\t\tarrayFuncs[i] = new THREE.Vector4(\r\n\r\n\t\t\t\titem[0] === undefined ? 0 : item[0],\r\n\t\t\t\titem[1] === undefined ? 0 : item[1],\r\n\t\t\t\titem[2] === undefined ? 0 : item[2],\r\n\t\t\t\titem[3] === undefined ? wDefault : item[3]\r\n\r\n\t\t\t);\r\n\t\telse if (\r\n\r\n\t\t\t( typeof item === \"object\" )\r\n\t\t\t&& ( item instanceof THREE.Vector2 === false )\r\n\t\t\t&& ( item instanceof THREE.Vector3 === false )\r\n\t\t\t&& ( item instanceof THREE.Vector4 === false )\r\n\r\n\t\t) {\r\n\r\n\t\t\tif ( ( item.vector === undefined ) )\r\n\t\t\t\tarrayFuncs[i] = new THREE.Vector4(\r\n\r\n\t\t\t\t\titem.x === undefined ? 0 : item.x,\r\n\t\t\t\t\titem.y === undefined ? 0 : item.y,\r\n\t\t\t\t\titem.z === undefined ? 0 : item.z,\r\n\t\t\t\t\titem.w === undefined ? 0 : item.w\r\n\r\n\t\t\t\t);\r\n\t\t\telse if (\r\n\r\n\t\t\t\t( item.vector instanceof THREE.Vector2 === true )\r\n\t\t\t\t|| ( item.vector instanceof THREE.Vector3 === true )\r\n\t\t\t\t|| ( item.vector instanceof THREE.Vector4 === true )\r\n\r\n\t\t\t) {\r\n\r\n\t\t\t\tif ( item.vector instanceof THREE.Vector2 === true )\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector3(\r\n\r\n\t\t\t\t\t\titem.vector.x === undefined ? 0 : item.vector.x,\r\n\t\t\t\t\t\titem.vector.y === undefined ? 0 : item.vector.y,\r\n\t\t\t\t\t\titem.vector.z === undefined ? 0 : item.vector.z,\r\n\r\n\t\t\t\t\t);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( item.vector.length === 4 )\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector4(\r\n\r\n\t\t\t\t\t\titem.vector[0] === undefined ? 0 : item.vector[0],\r\n\t\t\t\t\t\titem.vector[1] === undefined ? 0 : item.vector[1],\r\n\t\t\t\t\t\titem.vector[2] === undefined ? 0 : item.vector[2],\r\n\t\t\t\t\t\titem.vector[3] === undefined ? 0 : item.vector[3]\r\n\r\n\t\t\t\t\t);\r\n\t\t\t\telse if ( item.vector.length === 3 )\r\n\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector3(\r\n\r\n\t\t\t\t\t\titem.vector[0] === undefined ? 0 : item.vector[0],\r\n\t\t\t\t\t\titem.vector[1] === undefined ? 0 : item.vector[1],\r\n\t\t\t\t\t\titem.vector[2] === undefined ? 0 : item.vector[2],\r\n\r\n\t\t\t\t\t);\r\n\t\t\t\telse console.error( 'Player.getPoints(...) falied! item.vector.length = ' + item.vector.length );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\tconst points = [];\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar funcs = arrayFuncs[i];\r\n\t\tfunction getAxis( axisName ) {\r\n\r\n\t\t\tif ( typeof funcs === \"number\" )\r\n\t\t\t\tfuncs = new THREE.Vector4( funcs, 0, 0, 0 );\r\n\t\t\tif ( ( funcs instanceof THREE.Vector2 ) || ( funcs instanceof THREE.Vector3 ) || ( funcs instanceof THREE.Vector4 ) ) {\r\n\r\n\t\t\t\tconst value = Player.execFunc( funcs, axisName, optionsPoints.t, options );\r\n\t\t\t\treturn value;\r\n\r\n\t\t\t}\r\n\t\t\tif ( funcs.vector === undefined ) {\r\n\r\n\t\t\t\tconsole.error( 'Player.getAxis().getPoints(): funcs.vector = ' + funcs.vector );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tif ( funcs.name !== undefined )\r\n\t\t\t\tfuncs.vector.name = funcs.name;\r\n\t\t\tif ( funcs.trace && options.player ) funcs.vector.line = new Player.traceLine( options );\r\n\t\t\tif ( funcs.cameraTarget ) {\r\n\r\n\t\t\t\tfuncs.vector.cameraTarget = funcs.cameraTarget;\r\n\t\t\t\tdelete funcs.cameraTarget;\r\n\r\n\t\t\t}\r\n\t\t\tarrayFuncs[i] = funcs.vector;\r\n\t\t\tfuncs = funcs.vector;\r\n\t\t\treturn Player.execFunc( funcs, axisName, optionsPoints.t, options );\r\n\r\n\r\n\t\t}\r\n\t\tconst point = funcs.vector instanceof THREE.Vector3 === true ?\r\n\t\t\tnew THREE.Vector3( getAxis( 'x' ), getAxis( 'y' ), getAxis( 'z' ) ) :\r\n\t\t\tnew THREE.Vector4( getAxis( 'x' ), getAxis( 'y' ), getAxis( 'z' ), getAxis( 'w' ) );\r\n\r\n\t\tif ( funcs.cameraTarget ) {\r\n\r\n\t\t\tfuncs.cameraTarget.bodefault = false;\r\n\t\t\tif ( funcs.cameraTarget.boLook === undefined ) funcs.cameraTarget.boLook = true;\r\n\r\n/*\r\n\t\t\tif ( options.playerOptions.cameraTarget ) console.error( 'Player.getPoints: options.playerOptions.cameraTarget = ' + options.playerOptions.cameraTarget );\r\n\t\t\telse options.playerOptions.cameraTarget = new Player.cameraTarget();\r\n*/\t\t\t\r\n\t\t\toptions.playerOptions.cameraTarget.init( funcs.cameraTarget, options );\r\n//\t\t\tPlayer.cameraTarget.init( funcs.cameraTarget, options );\r\n\r\n\t\t}\r\n\t\tpoints.push( point );\r\n\r\n\t}\r\n\treturn points;\r\n\r\n}\r\nvar boColorWarning = true;\r\n/** @namespace\r\n * @description Get array of mesh colors.\r\n * @param {THREE.Vector4|THREE.Vector3|THREE.Vector2|object|array} arrayFuncs points.geometry.attributes.position array\r\n * <pre>\r\n * THREE.Vector4: 4D point.\r\n * THREE.Vector3: 3D point. w = 1. Default is white color\r\n * THREE.Vector2: 2D point. w = 1, z = 0. Default is white color\r\n * Vector's x, y, z, w is position of the point.\r\n * Can be as:\r\n * float - position of the point.\r\n * [float] - array of positions of the point.\r\n * [Function]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} - position of the point is function of the t.\r\n * Example: new Function( 't', 'a', 'b', 'return Math.sin(t*a*2*Math.PI)*0.5+b' )\r\n *\r\n * Vector.w is index of the [palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * Default range of the Vector.w is from 0 to 1. You can change range by use an object:\r\n * {\r\n *   func: Vector.w\r\n *   max: new max value of tne Vector.w\r\n *   min: new min value of tne Vector.w\r\n * }\r\n * Example:\r\n * {\r\n *\r\n *   func: new Function( 't', 'return 1-2*t' ),\r\n *   min: -1,\r\n *   max: 1,\r\n *\r\n * }\r\n * Vector.w can be as THREE.Color. Example: new THREE.Color( \"rgb(255, 127, 0)\" )\r\n *\r\n * object: {\r\n *   vector: THREE.Vector4|THREE.Vector3|THREE.Vector2 - point position\r\n *   [name]: point name. Default is undefined.\r\n *   [trace]: true - displays the trace of the point movement. Default is undefined.\r\n * }\r\n * or\r\n * object: {\r\n *   x: x axis. Defauilt is 0.\r\n *   y: y axis. Defauilt is 0.\r\n *   z: z axis. Defauilt is 0.\r\n *   w: w axis. Defauilt is 0.\r\n * }\r\n *\r\n * array: [\r\n *   0: x axis. Defauilt is 0.\r\n *   1: y axis. Defauilt is 0.\r\n *   2: z axis. Defauilt is 0.\r\n *   3: w axis. Defauilt is 0.\r\n * ]\r\n * </pre>\r\n * @param {object} [optionsColor] the following options are available:\r\n * @param {object} [optionsColor.options] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n * @param {THREE.BufferAttribute} [optionsColor.positions] geometry.attributes.position of the new mesh.\r\n * @param {array} [optionsColor.colors=[]] array for mesh colors.\r\n * @param {boolean} [optionsColor.opacity] if true then opacity of the point is depend from distance to all  meshes points from the group with defined mesh.userData.cloud.\r\n * @returns array of mesh colors.\r\n */\r\nPlayer.getColors = function ( arrayFuncs, optionsColor ) {\r\n\r\n\tassign();\r\n\t\r\n\tif ( !Array.isArray( arrayFuncs ) ) arrayFuncs = [ arrayFuncs ];\r\n\r\n\toptionsColor = optionsColor || {};\r\n\toptionsColor.options = optionsColor.options || {};\r\n\t\r\n\tif (\r\n\t\t( optionsColor.positions !== undefined ) &&\r\n\t\tArray.isArray( arrayFuncs ) &&\r\n\t\t( arrayFuncs.length !== optionsColor.positions.count )\r\n\t) {\r\n\r\n\t\tconsole.error( 'getColors failed! arrayFuncs.length: ' + arrayFuncs.length + ' != positions.count: ' + optionsColor.positions.count );\r\n\t\treturn optionsColor.colors;\r\n\r\n\t}\r\n\r\n\t//не надо убирать const length. Иначе переполнится память\r\n\tconst length = Array.isArray( arrayFuncs ) ? arrayFuncs.length : optionsColor.positions.count;\r\n\r\n\toptionsColor.colors = optionsColor.colors || [];\r\n\tif ( !optionsColor.options.palette )\r\n\t\toptionsColor.options.setPalette();\r\n//\t\tsetOptions.setPalette( optionsColor.options );\r\n\r\n\tfor ( var i = 0; i < length; i++ ) {\r\n\r\n\t\tconst funcs = Array.isArray( arrayFuncs ) ? arrayFuncs[i] : undefined;\r\n\t\tvar vector;\r\n\t\tif (\r\n\t\t\t( funcs instanceof THREE.Vector4 ) ||//w of the funcs is color of the point\r\n\t\t\t( optionsColor.positions && ( optionsColor.positions.itemSize === 4 ) )//w position of the positions is color of the point\r\n\t\t\t) {\r\n\r\n\t\t\tlet min, max;\r\n\t\t\tvar w = funcs.w;\r\n\t\t\tif ( funcs.w instanceof Object && funcs.w.func ) {\r\n\r\n\t\t\t\tif ( funcs.w.max ) max = funcs.w.max;\r\n\t\t\t\tif ( funcs.w.min ) min = funcs.w.min;\r\n\t\t\t\tw = funcs.w.func;\r\n\r\n\t\t\t} else {\r\n\r\n//\t\t\t\tsetOptions.setW( optionsColor.options );\r\n\t\t\t\toptionsColor.options.setW();\r\n\t\t\t\tmin = optionsColor.options.scales.w.min; max = optionsColor.options.scales.w.max;\r\n\r\n\t\t\t}\r\n\t\t\tif ( w instanceof Function && !optionsColor.options.player && boColorWarning ) {\r\n/*\r\n\t\t\t\tconsole.warn( 'Player.getColors: remove all functions from all THREE.Vector4.w items of the arrayFuncs.' );\r\n\t\t\t\tconsole.warn( '\tOr call Player(...) https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html' );\r\n\t\t\t\tconsole.warn( '\tIf you use MyPoints for create of the points, please add Player: Player into settings parameter of the MyPoints function after creating of the Player.' );\r\n\t\t\t\tconsole.warn( '\tIf you are using MyThree to create the scene, add the player key to the options parameter of the MyThree constructor. See https://raw.githack.com/anhr/commonNodeJS/master/myThree/jsdoc/module-MyThree-MyThree.html' );\r\n*/\t\t\t\t\r\n//\t\t\t\tsetOptions.setPlayerOptions( optionsColor.options );\r\n//\t\t\t\toptionsColor.options.setPlayerOptions();\r\n\t\t\t\tboColorWarning = false;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tvar color = optionsColor.options.palette.toColor(\r\n\t\t\t\tfuncs === undefined ?\r\n\t\t\t\t\tnew THREE.Vector4().fromBufferAttribute( optionsColor.positions, i ).w :\r\n\t\t\t\t\tw instanceof Function ?\r\n//\t\t\t\t\t\tw( _timeSettings ? _timeSettings.min : 0 ) :\r\n//\t\t\t\t\t\tw( _options.playerOptions ? _options.playerOptions.min : 0 ) :\r\n\t\t\t\t\t\tw( optionsColor.options.playerOptions ? optionsColor.options.playerOptions.min : 0 ) :\r\n\t\t\t\t\t\tw,\r\n\t\t\t\tmin, max );\r\n\t\t\toptionsColor.colors.push( color.r, color.g, color.b );\r\n\r\n\t\t} else if ( optionsColor.colors instanceof THREE.Float32BufferAttribute )\r\n\t\t\tvector = new THREE.Vector3( 1, 1, 1 );\r\n\t\telse optionsColor.colors.push( 1, 1, 1 );//white\r\n\r\n\t\t//opacity\r\n\t\tif ( optionsColor.opacity !== undefined ) {\r\n\r\n\t\t\tvar opacity = 0,\r\n\t\t\t\tstandardNormalDistributionZero = getStandardNormalDistribution( 0 );\r\n\t\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\t\tif ( !mesh.userData.cloud )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tfor ( var iMesh = 0; iMesh < mesh.geometry.attributes.position.count; iMesh++ ) {\r\n\r\n\t\t\t\t\tvar position = getObjectPosition( mesh, iMesh );\r\n\t\t\t\t\topacity += getStandardNormalDistribution(\r\n\t\t\t\t\t\tgetWorldPosition(\r\n\t\t\t\t\t\t\tcamera, new THREE.Vector3().fromBufferAttribute( optionsColor.positions, i )\r\n\t\t\t\t\t\t).distanceTo( position ) * 5\r\n\t\t\t\t\t) / standardNormalDistributionZero;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tif ( debug.opacity !== undefined )\r\n\t\t\t\topacity = debug.opacity;\r\n\r\n\t\t\tif ( optionsColor.colors instanceof THREE.Float32BufferAttribute ) {\r\n\r\n\t\t\t\toptionsColor.colors.setXYZW( i, vector.x, vector.y, vector.z, opacity );\r\n\r\n\t\t\t}\r\n\t\t\telse optionsColor.colors.push( opacity );\r\n\r\n\t\t} else optionsColor.colors.push( 1 );\r\n\r\n\t}\r\n\treturn optionsColor.colors;\r\n\r\n}\r\n\r\n/** @class */\r\nPlayer.traceLine = class traceLine\r\n{\r\n\r\n\r\n\t/**\r\n\t * trace line of moving of the point during playing\r\n\t * @param {object} options the following options are available\r\n\t * @param {object} options.player See <a href=\"../../player/jsdoc/module-Player.html\" target=\"_blank\">Player</a>.\r\n\t */\r\n\tconstructor( options ) {\r\n\r\n\t\tvar line;\r\n\t\tconst arrayLines = [];//сюда добавляются линии когда max: Infinity,\r\n\r\n\t\tassign();\r\n\r\n//\t\tif ( !Player.isCreated() )\r\n\t\tif ( !options.player ) {\r\n\r\n/*\r\n\t\t\tconsole.warn( 'Player.traceLine: Remove all trace: true from arrayFunc parameter of the MyPoints or getShaderMaterialPoints method.' );\r\n\t\t\tconsole.warn( '\tOr call ne Player(...) https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html' );\r\n\t\t\tconsole.warn( '\tIf you use getShaderMaterialPoints or MyPoints for create of the points, please add Player: Player into settings parameter of the getShaderMaterialPoints or MyPoints method after creating of the Player.' );\r\n\t\t\tconsole.warn( '\tIf you are using MyThree to create the scene, add the player key to the options parameter of the MyThree constructor. See https://raw.githack.com/anhr/commonNodeJS/master/myThree/jsdoc/module-MyThree-MyThree.html' );\r\n*/\t\t\t\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Is trace line visible?\r\n\t\t * @returns true - trace line is visible.\r\n\t\t * <p>false - trace line is not visible.</p>\r\n\t\t */\r\n\t\tthis.isVisible = function () {\r\n\r\n//\t\t\tif ( !Player.isCreated() )\r\n\t\t\tif ( !options.player )\r\n\t\t\t\treturn false;//не запущен Player(...)\r\n\r\n\t\t\tif ( line ) return line.visible;\r\n\t\t\tif ( arrayLines.length === 0 ) return false;\r\n\t\t\t//сюда попадает когда t max is Infinity ( options.playerOptions.max === null ) и когда пользователь выбрал точку в guiSelectPoint у которой установлена трассировка\r\n\t\t\treturn arrayLines[0].visible;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Show or hide trace line.\r\n\t\t * @param {boolean} visible true - show trace line.\r\n\t\t * <p>false - hide trace line.</p>\r\n\t\t */\r\n\t\tthis.visible = function ( visible ) {\r\n\r\n//\t\t\tif ( !Player.isCreated() )\r\n\t\t\tif ( !options.player )\r\n\t\t\t\treturn false;//не запущен Player(...)\r\n\r\n\t\t\tif ( line ) {\r\n\r\n\t\t\t\tline.visible = visible;\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\t//сюда попадает когда t max is Infinity (options.playerOptions.max === null) и когда пользователь в выбранной в guiSelectPoint  точке изменил галочку трассировки\r\n\t\t\tarrayLines.forEach( function ( line ) {\r\n\r\n\t\t\t\tline.visible = visible;\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * add point into trace line.\r\n\t\t * @param {THREE.Mesh} mesh. See [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} for tracing.\r\n\t\t * @param {number} index of the point for tracing.\r\n\t\t * @param {THREE.Color} color. Line color. See [Color]{@link https://threejs.org/docs/index.html#api/en/math/Color}.\r\n\t\t */\r\n\t\tthis.addPoint = function ( mesh, index, color ) {\r\n\r\n\t\t\tconst attributesPosition = mesh.geometry.attributes.position;\r\n\t\t\tvar point = attributesPosition.itemSize >= 4 ? new THREE.Vector4( 0, 0, 0, 0 ) : new THREE.Vector3();\r\n\t\t\tpoint.fromArray( attributesPosition.array, index * attributesPosition.itemSize );\r\n//\t\t\tconst sceneIndex = Player.getSelectSceneIndex();\r\n\r\n\t\t\t//нельзя ставить const потому что привыполнении npm run build будет ошибка\r\n\t\t\t// (babel plugin) SyntaxError: D:/My documents/MyProjects/webgl/three.js/GitHub/commonNodeJS/master/player/player.js: \"sceneIndex\" is read-only\r\n\t\t\tvar sceneIndex = options.player ? options.player.getSelectSceneIndex() : 0;\r\n\r\n\t\t\tif ( options.playerOptions.max === null ) {\r\n\r\n\t\t\t\tsceneIndex = Math.abs( sceneIndex );\r\n\t\t\t\tif ( sceneIndex < ( arrayLines.length - 1 ) ) {\r\n\r\n\t\t\t\t\twhile ( sceneIndex < ( arrayLines.length - 1 ) ) {\r\n\r\n\t\t\t\t\t\tmesh.remove( arrayLines[arrayLines.length - 1] );\r\n\t\t\t\t\t\tarrayLines.pop();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// geometry\r\n\t\t\t\tconst geometry = new THREE.BufferGeometry(), MAX_POINTS = 2;\r\n\r\n\t\t\t\t// attributes\r\n\t\t\t\tconst positions = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\t\tgeometry.setAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\t\t\t\tconst colors = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\t\tgeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\t\t\tconst line = new THREE.Line( geometry, new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } ) );\r\n\t\t\t\t//\t\t\tgroup.add( line );\r\n\t\t\t\tmesh.add( line );\r\n\r\n\t\t\t\t//на случай когда пользователь изменил флажок трассировки\r\n\t\t\t\t//первая линия arrayLines[0] всегда имеет visible = true потому что сюда попадат только если установлена трассировка по умолчанию\r\n\t\t\t\t//или пользователь установил флаг трассировки\r\n\t\t\t\tif ( arrayLines[0] ) line.visible = arrayLines[0].visible;\r\n\r\n\t\t\t\t//point position\r\n\t\t\t\tpoint = new THREE.Vector3().copy( point );\r\n\t\t\t\tconst itemSize = line.geometry.attributes.position.itemSize;\r\n\t\t\t\tpoint.toArray( line.geometry.attributes.position.array, 1 * itemSize );\r\n\t\t\t\tconst point0 = arrayLines.length === 0 ? point :\r\n\t\t\t\t\tnew THREE.Vector3().fromArray( arrayLines[arrayLines.length - 1].geometry.attributes.position.array, 1 * itemSize );\r\n\t\t\t\tpoint0.toArray( line.geometry.attributes.position.array, 0 * itemSize );\r\n\t\t\t\tline.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t\t//point color\r\n\t\t\t\tif ( color === undefined )\r\n\t\t\t\t\tcolor = new THREE.Color( 1, 1, 1 );//White\r\n\t\t\t\tPlayer.setColorAttribute( line.geometry.attributes, 0, arrayLines.length === 0 ? color :\r\n\t\t\t\t\tnew THREE.Color().fromArray( arrayLines[arrayLines.length - 1].geometry.attributes.color.array, 1 * itemSize ) );\r\n\t\t\t\tPlayer.setColorAttribute( line.geometry.attributes, 1, color );\r\n\r\n\t\t\t\tarrayLines.push( line );\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tif ( line === undefined ) {\r\n\r\n\t\t\t\t// geometry\r\n\t\t\t\tconst geometry = new THREE.BufferGeometry();\r\n\r\n\t\t\t\t//Thanks to https://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically/31411794#31411794\r\n\t\t\t\tvar MAX_POINTS;\r\n//\t\t\t\tif ( _timeSettings.max !== null )\r\n\t\t\t\tif ( options.playerOptions.max !== null ) {\r\n\r\n\t\t\t\t\tif ( options.playerOptions && options.playerOptions.marks )\r\n\t\t\t\t\t\tMAX_POINTS = options.playerOptions.marks;\r\n\t\t\t\t\telse if ( options.player && options.player.marks )\r\n\t\t\t\t\t\tMAX_POINTS = options.player.marks;\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Player.traceLine: MAX_POINTS = ' + MAX_POINTS + '. Create Player first or remove all trace = true from all items of the arrayFuncs' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else MAX_POINTS = sceneIndex + 1;\r\n\r\n\t\t\t\t// attributes\r\n\t\t\t\tconst positions = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\t\tgeometry.setAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\t\t\t\tconst colors = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\t\tgeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\t\t\t// draw range\r\n\t\t\t\tgeometry.setDrawRange( sceneIndex, sceneIndex );\r\n\r\n\t\t\t\tline = new THREE.Line( geometry, new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } ) );\r\n\t\t\t\tline.visible = true;\r\n\t\t\t\tmesh.add( line );\r\n\r\n\t\t\t}\r\n\t\t\t//Если не удалять boundingSphere\r\n\t\t\t//и если двигается камера от проигрывания или ее перемещает пользователь\r\n\t\t\t//то в некоторых случаях линию не будет видно даже если она не выходит из поля видимости\r\n\t\t\t//потому что она выходит за рамки frustupoints\r\n\t\t\tif ( line.geometry ) {//scene do not have geometry\r\n\r\n\t\t\t\tdelete line.geometry.boundingSphere;\r\n\t\t\t\tline.geometry.boundingSphere = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//point position\r\n\t\t\tpoint = new THREE.Vector3().copy( point );\r\n\t\t\tpoint.toArray( line.geometry.attributes.position.array, sceneIndex * line.geometry.attributes.position.itemSize );\r\n\t\t\tline.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t//point color\r\n\t\t\tif ( color === undefined )\r\n\t\t\t\tcolor = new THREE.Color( 1, 1, 1 );//White\r\n\t\t\tPlayer.setColorAttribute( line.geometry.attributes, sceneIndex, color );\r\n\r\n\t\t\t//set draw range\r\n\t\t\tvar start = line.geometry.drawRange.start, count = sceneIndex + 1 - start;\r\n\t\t\tif ( start > sceneIndex ) {\r\n\r\n\t\t\t\tvar stop = start + line.geometry.drawRange.count;\r\n\t\t\t\tstart = sceneIndex;\r\n\t\t\t\tcount = stop - start;\r\n\r\n\t\t\t}\r\n\t\t\tline.geometry.setDrawRange( start, count );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Remove trace line.\r\n\t\t */\r\n\t\tthis.remove = function () {\r\n\r\n\t\t\tif ( line === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tline.geometry.dispose();\r\n\t\t\tline.material.dispose();\r\n\t\t\tline.parent.remove( line );\r\n\t\t\t//\t\tgroup.remove( line );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/* * @namespace\r\n * @returns selected scene index.\r\n */\r\n/*\r\nPlayer.getSelectSceneIndex = function () {\r\n\r\n\tif ( Player.player )\r\n\t\treturn Player.player.getSelectSceneIndex();\r\n\treturn 0;\r\n\r\n}\r\n*/\r\n/* * @namespace\r\n * @returns current time of the player.\r\n */\r\n/*\r\nPlayer.getTime = function () {\r\n\r\n\tif ( Player.player )\r\n\t\treturn Player.player.getTime();\r\n\treturn 0;\r\n\r\n}\r\n*/\r\n\r\n/** @namespace\r\n * @description get item size of the attribute of the mesh geometry\r\n * @param {array} arrayFuncs points.geometry.attributes.position array.\r\n * See arrayFuncs parametr of the <a href=\"../../player/jsdoc/module-Player-Player.getPoints.html\" target=\"_blank\">Player.getPoints(...)</a> for details.\r\n */\r\nPlayer.getItemSize = function ( arrayFuncs ) {\r\n\r\n\tassign();\r\n\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar func = arrayFuncs[i];\r\n\t\tif ( func instanceof THREE.Vector4 )\r\n\t\t\treturn 4;\r\n\r\n\t}\r\n\treturn 3;\r\n\r\n}\r\n/** @namespace\r\n * @description Select a scene for playing\r\n * @param {THREE.Group} group [THREE.Group]{@link https://threejs.org/docs/index.html#api/en/objects/Group}\r\n * @param {Object} [settings={}] the following settings are available.\r\n * @param {number} [settings.t=0] time\r\n * @param {number} [settings.index] index of the time.\r\n * @param {Object} [settings.options={}] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n */\r\nPlayer.selectPlayScene = function ( group, settings = {} ) {\r\n\r\n\t//Эта строка нужна в случае если в 3D объекте не утанвавливатся аттрибут color.\r\n\t//Другими словами если не вызывается Player.getColors\r\n//\tColorPicker.palette.setTHREE( THREE );\r\n//\tsettings = settings || {};\r\n\tconst t = settings.t !== undefined ? settings.t : 0,\r\n\t\tindex = settings.index !== undefined ? settings.index : undefined,\r\n\t\toptions = settings.options || new Options();\r\n\tgroup.userData.t = t;\r\n//\tPlayer.selectMeshPlayScene( group, t, index, options );\r\n\tPlayer.selectMeshPlayScene( group, { t: t, options: options } );\r\n\tgroup.children.forEach( function ( mesh ) {\r\n\r\n//\t\tPlayer.selectMeshPlayScene( mesh, t, index, options );\r\n\t\tPlayer.selectMeshPlayScene( mesh, { t: t, options: options } );\r\n\r\n\t} );\r\n/*\t\r\n\tPlayer.cameraTarget.setCameraTarget( options );\r\n\tconst cameraTarget = Player.cameraTarget.get();\r\n*/\t\r\n\toptions.playerOptions.cameraTarget.setCameraTarget( options );\r\n\tconst cameraTarget = options.playerOptions.cameraTarget.get();\r\n\r\n\t//если index === undefined значит пользователь нажал кнопку 'Default' для восстановления положения камеры.\r\n\t//Значит надо вызвать camera.userData.default.setDefault()\r\n\t//\r\n\t//если index !== undefined значит проигрыватель вызывает очередной кадр и не нужно перемещать камеру в исходное положение\r\n\t//приуслвии что не выбрана ни одна точка как cameraTarget\r\n\tif ( cameraTarget && cameraTarget.setCameraPosition ) cameraTarget.setCameraPosition( index === undefined );\r\n\r\n}\r\nvar THREE;\r\n/* * @namespace\r\n * @description assign some THREE methods\r\n */\r\nfunction assign( ) {\r\n\r\n\tif ( !three.isThree() ) {\r\n\r\n\t\tconsole.warn( 'Player: can not assign. Set THREE first.' )\r\n\t\treturn;\r\n\r\n\t}\r\n\tTHREE = three.THREE;\r\n\tObject.assign( THREE.BufferGeometry.prototype, {\r\n\r\n\t\tsetFromPoints: function ( points, itemSize ) {\r\n\r\n\t\t\titemSize = itemSize || 3;\r\n\t\t\tvar position = [];\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i++ ) {\r\n\r\n\t\t\t\tvar point = points[i];\r\n\t\t\t\tposition.push( point.x, point.y, point.z || 0 );\r\n\t\t\t\tif ( itemSize >= 4 )\r\n\t\t\t\t\tposition.push( point.w || 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setAttribute( 'position', new THREE.Float32BufferAttribute( position, itemSize ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\r\n\t//three.js\\dev\\src\\math\\Vector4.js\r\n\tObject.assign( THREE.Vector4.prototype, {\r\n\r\n\t\tmultiply: function ( v ) {\r\n\r\n\t\t\tthis.x *= v.x;\r\n\t\t\tthis.y *= v.y;\r\n\t\t\tthis.z *= v.z;\r\n\t\t\t//\t\tthis.w *= v.w || 1;\r\n\t\t\tif ( v.w !== undefined )\r\n\t\t\t\tthis.w *= v.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\t//three.js\\dev\\src\\math\\Vector4.js\r\n\tObject.assign( THREE.Vector4.prototype, {\r\n\r\n\t\tadd: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\t\tthis.z += v.z;\r\n\t\t\tif ( v.w !== undefined )\r\n\t\t\t\tthis.w += v.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\t//three.js\\dev\\src\\objects\\Points.js\r\n\tObject.assign( THREE.Points.prototype, {\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tconst _inverseMatrix = new THREE.Matrix4();\r\n\t\t\tconst _ray = new THREE.Ray();\r\n\t\t\tconst _sphere = new THREE.Sphere();\r\n\t\t\tconst _position = new THREE.Vector3();\r\n\t\t\tfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\r\n\r\n\t\t\t\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\r\n\r\n\t\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\r\n\t\t\t\t\tconst intersectPoint = new THREE.Vector3();\r\n\r\n\t\t\t\t\t_ray.closestPointToPoint( point, intersectPoint );\r\n\t\t\t\t\tintersectPoint.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\t\t\tpoint: intersectPoint,\r\n\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tobject: object\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst geometry = this.geometry;\r\n\t\t\tconst matrixWorld = this.matrixWorld;\r\n\t\t\tconst threshold = raycaster.params.Points.threshold;\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\t_sphere.copy( geometry.boundingSphere );\r\n\t\t\t_sphere.applyMatrix4( matrixWorld );\r\n\t\t\t_sphere.radius += threshold;\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\r\n\r\n\t\t\t//\r\n\r\n\t\t\t_inverseMatrix.copy( matrixWorld ).invert();\r\n\t\t\t\r\n\t\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\r\n\r\n\t\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\t\tconst localThresholdSq = localThreshold * localThreshold;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tconst index = geometry.index;\r\n\t\t\t\tconst attributes = geometry.attributes;\r\n\t\t\t\tconst positions = attributes.position.array;\r\n\t\t\t\tconst itemSize = attributes.position.itemSize;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tconst indices = index.array;\r\n\r\n\t\t\t\t\tfor ( let i = 0, il = indices.length; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\tconst a = indices[i];\r\n\r\n\t\t\t\t\t\t_position.fromArray( positions, a * itemSize );\r\n\r\n\t\t\t\t\t\ttestPoint( _position, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = positions.length / itemSize; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\t_position.fromArray( positions, i * itemSize );\r\n\r\n\t\t\t\t\t\ttestPoint( _position, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst vertices = geometry.vertices;\r\n\r\n\t\t\t\tfor ( let i = 0, l = vertices.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\ttestPoint( vertices[i], i, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\r\n}\r\n//assign();\r\n/**\r\n * @namespace\r\n * @description assign some THREE methods\r\n * */\r\nPlayer.assign = function () { assign(); }\r\n\r\nexport default Player;\r\n"],"names":["___$insertStyle","css","window","style","document","createElement","setAttribute","innerHTML","head","appendChild","colorToString","color","forceCSSHex","colorFormat","__state","conversionName","toString","r","Math","round","g","b","a","h","s","toFixed","v","str","hex","length","ARR_EACH","Array","prototype","forEach","ARR_SLICE","slice","Common","extend","target","each","call","arguments","obj","keys","isObject","Object","key","isUndefined","bind","defaults","compose","toCall","args","i","apply","itr","scope","l","BREAK","_key","defer","fnc","debounce","func","threshold","callImmediately","timeout","delayed","callNow","setTimeout","toArray","undefined","isNull","_isNaN","isNaN","_x","isArray","constructor","isNumber","isString","isBoolean","isFunction","INTERPRETATIONS","read","original","test","match","parseInt","parseFloat","write","result","toReturn","interpret","family","litmus","conversions","conversion","tmpComponent","ColorMath","hsv_to_rgb","hi","floor","f","p","q","t","c","rgb_to_hsv","min","max","delta","NaN","rgb_to_hex","hex_with_component","component_from_hex","componentIndex","value","_typeof","Symbol","babelHelpers.typeof","iterator","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","getter","inherits","subClass","superClass","create","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","Color","Error","toHexString","toOriginal","defineRGBComponent","component","componentHexIndex","get$$1","space","recalculateRGB","set$$1","defineHSVComponent","recalculateHSV","COMPONENTS","Controller","initialValue","domElement","__onChange","__onFinishChange","onChange","onFinishChange","setValue","newValue","updateDisplay","getValue","isModified","EVENT_MAP","EVENT_MAP_INV","k","e","CSS_VALUE_PIXELS","cssValueToPixels","val","dom","makeSelectable","elem","selectable","onselectstart","MozUserSelect","KhtmlUserSelect","unselectable","makeFullscreen","hor","vert","vertical","horizontal","position","left","right","top","bottom","fakeEvent","eventType","pars","aux","params","className","evt","createEvent","clientX","x","clientY","y","initMouseEvent","bubbles","cancelable","clickCount","init","initKeyboardEvent","initKeyEvent","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode","initEvent","dispatchEvent","event","newBool","bool","addEventListener","attachEvent","unbind","removeEventListener","detachEvent","addClass","classes","split","indexOf","push","join","replace","removeClass","removeAttribute","index","splice","hasClass","RegExp","getWidth","getComputedStyle","width","getHeight","height","getOffset","el","offset","offsetParent","offsetLeft","offsetTop","isActive","activeElement","type","href","BooleanController","_Controller","_this2","_this","__prev","__checkbox","checked","OptionController","opts","options","__select","map","element","opt","desiredValue","selectedIndex","StringController","__input","onBlur","blur","numDecimals","NumberController","_params","__min","__max","__step","step","__impliedStep","pow","log","abs","LN10","__precision","_v","minValue","maxValue","stepValue","roundToDecimal","decimals","tenTo","NumberControllerBox","_NumberController","__truncationSuspended","prevY","attempted","onFinish","onMouseDrag","diff","onMouseUp","onMouseDown","i1","i2","o1","o2","NumberControllerSlider","__background","__foreground","onTouchStart","preventDefault","bgRect","getBoundingClientRect","touches","onTouchMove","onTouchEnd","pct","FunctionController","text","__button","fire","ColorController","__color","__temp","__selector","__saturation_field","__field_knob","__field_knob_border","__hue_knob","__hue_field","__input_textShadow","valueField","fieldDown","fieldDownH","setSV","fieldUpSV","setH","fieldUpH","fieldRect","_ref","_ref2","mismatch","flip","_flip","marginTop","vendors","linearGradient","background","vendor","cssText","hueGradient","ControllerFactory","CustomController","newController","_controller","load","url","indoc","doc","link","rel","getElementsByTagName","inject","cssContent","injected","saveDialogContents","requestAnimationFrame","callback","requestAnimationFrame$1","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","CenteredDiv","backgroundElement","body","hide","show","display","opacity","webkitTransform","layout","innerWidth","innerHeight","styleSheet","CSS_NAMESPACE","HIDE_KEY_CODE","CLOSE_BUTTON_HEIGHT","DEFAULT_DEFAULT_PRESET_NAME","SUPPORTS_LOCAL_STORAGE","localStorage","SAVE_DIALOGUE","autoPlaceVirgin","autoPlaceContainer","hideableGuis","GUI","__ul","__folders","__controllers","__rememberedObjects","__rememberedObjectIndecesToControllers","__listening","DEFAULT_WIDTH","autoPlace","preset","hideable","resizable","scrollable","useLocalStorage","getItem","getLocalStorageHash","saveToLocalStorage","titleRow","closeOnTop","getRoot","revert","name","closed","CLASS_CLOSED","onResize","__closeButton","TEXT_OPEN","TEXT_CLOSED","setItem","CLASS_MAIN","savedGui","JSON","parse","CLASS_CLOSE_BUTTON","CLASS_CLOSE_TOP","insertBefore","childNodes","CLASS_CLOSE_BOTTOM","titleRowName","createTextNode","addRow","onClickTitle","CLASS_AUTO_PLACE_CONTAINER","CLASS_AUTO_PLACE","__resizeHandler","onResizeDebounced","stringify","getSaveObject","saveToLocalStorageIfPossible","resetWidth","root","toggleHide","gui","CLASS_CONTROLLER_ROW","CLASS_TOO_TALL","CLASS_DRAG","_keydownHandler","which","add","_add","addColor","remove","controller","removeChild","__li","destroy","subfolder","removeFolder","addFolder","newGuiParams","folders","li","folder","parentElement","open","close","node","__save_row","__resize_handle","offsetHeight","remember","remembered","getCurrentPreset","save","saveAs","presetName","listen","newDom","liBefore","removeListeners","markPresetModified","modified","__preset_select","augmentController","__gui","_options","nextSibling","nextElementSibling","_nextSibling","_name","firstElementChild","box","method","pc","pb","returned","oldName","wasListening","stopPropagation","borderLeftColor","recallSavedValue","matchedIndex","controllerMap","presetMap","customObject","factoryArgs","concat","before","propertyName","container","location","addPresetOption","setSelected","showHideExplain","explain","addSaveMenu","div","firstChild","gears","button","button2","button3","select","getElementById","localStorageCheckBox","saveLocally","newConstructorTextArea","focus","prompt","addResizeHandle","pmouseX","drag","dragStop","dragStart","setWidth","w","useInitialValues","savedValues","setPresetSelectIndex","updateDisplays","controllerArray","controllers","UpDownController","title","onclick","cursor","onwheel","onWheel","deltaY","detail","wheelDelta","margin","_THREE","_dat","Three","THREE","is","console","error","dat","three","__myThree__","isThree","ScaleController","settings","zoomMultiplier","customController","lang","_languageCode","getLanguageCode","zoom","in","out","wheelZoom","languageCode","buttons","addButton","zoomLabel","PositionController","onclickController","subtract","wheelPosition","Label","shift","getObjectLocalPosition","attributesPosition","geometry","attributes","itemSize","Vector4","Vector3","fromArray","array","getWorldPosition","pos","clone","getPosition","positionAngle","multiply","scale","copy","applyEuler","rotation","z","getObjectPosition","WEBGL","canvas","WebGLRenderingContext","getContext","WebGL2RenderingContext","getErrorMessage","version","names","contexts","message","id","fontFamily","fontSize","fontWeight","textAlign","padding","myRequest","loadXMLDoc","req","XMLHttpRequest","ActiveXObject","NewActiveXObject","XMLHttpRequestStart","onreadystatechange","async","XMLHttpRequestStop","onerror","XMLHttpRequestReStart","getUrl","ontimeout","timeout_id_SendReq","send","abort","ProcessReqChange","processStatus200","readyState","status","processStatus200Error","GetElementText","tagName","noDisplayErrorMessage","xmlhttp","responseXML","ErrorMessage","responseText","textContent","data","navigator","appName","appVersion","sync","onload","response","request","src","appendTo","isScriptExists","optionsItem","tag","item","script","loadFileSync","loadScriptBase","isrc","srcAsync","next","_onload","attribute","elParent","scripts","querySelectorAll","child","loadScript","optionsStyle","getCurrentScript","currentScript","stack","getCurrentScriptPath","path","substring","lastIndexOf","currentScriptPath","SVGAngle","implementation","hasFeature","svgNS","uniqID","ColorPicker","paletteIndexes","CreateSVGElement","attrs","children","createElementNS","len","elSliderWrapper","orientation","isHorizontal","direction","onError","HTMLElement","classList","palette","slide","getSlideHeight","getSlideWidth","clientWidth","slideIndicator","hsv2rgb","percent","sliderIndicator","pointerEvents","positionIndicators","offsetWidth","getPalette","fill","mouseMove","mouse","size","slideListener","mouseout","mousePosition","contentOverflow","offsetX","offsetY","wrapper","parentNode","layerX","layerY","listener","enableDragging","ctx","rect","srcElement","mouseup","mousemove","paletteitem","BGYW","getPaletteIndex","arrayPalette","monochrome","bidirectional","rainbow","unshift","Number","toUpperCase","stringPercent","lastPalette","lastItem","itemPrev","percentPrev","prev","percentItem","percentD","toColor","OrbitControls","EventDispatcher","MOUSE","Quaternion","Spherical","TOUCH","Vector2","warn","enabled","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ROTATE","MIDDLE","DOLLY","PAN","ONE","TWO","DOLLY_PAN","target0","position0","zoom0","_domElementKeyEvents","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","listenToKeyEvents","onKeyDown","saveState","reset","updateProjectionMatrix","changeEvent","update","STATE","NONE","quat","setFromUnitVectors","up","quatInverse","invert","lastPosition","lastQuaternion","twoPI","sub","applyQuaternion","setFromVector3","state","getAutoRotationAngle","sphericalDelta","isFinite","makeSafe","radius","addScaledVector","panOffset","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","onContextMenu","onPointerDown","onMouseWheel","ownerDocument","onPointerMove","onPointerUp","startEvent","endEvent","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","rotateLeft","angle","rotateUp","panLeft","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","matrix","isOrthographicCamera","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","subVectors","handleMouseMoveDolly","handleMouseMovePan","handleMouseWheel","handleKeyDown","needsUpdate","handleTouchStartRotate","pageX","pageY","handleTouchStartPan","handleTouchStartDolly","dx","dy","sqrt","handleTouchStartDollyPan","handleTouchStartDollyRotate","handleTouchMoveRotate","handleTouchMovePan","handleTouchMoveDolly","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","pointerType","mouseAction","onMouseMove","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","DOLLY_ROTATE","TOUCH_DOLLY_ROTATE","MapControls","createEventDispatcher","isEnabled","cookieEnabled","cookie_date","Date","setTime","getTime","cookie","toGMTString","setObject","defaultValue","results","unescape","getObject","optionsDefault","defaultCookie","copyObject","objectDefault","consoleCookieEnabled","option","isTrue","setCookie","getCookie","_getLocale","languages","language","browserLanguage","systemLanguage","userLanguage","toLowerCase","CreateFullScreenSettings","renderer","camera","fullScreen","canvasMenu","stereoEffect","setSize","isFullScreen","setStereoEffect","_stereoEffect","setFullScreen","fs","getSize","sizeOriginal","onFullScreenToggle","aspect","setFullScreenButton","RendererSetSize","spatialMultiplex","StereoEffect","spatialMultiplexsIndexs","Mono","setSizeOld","updateStyle","elCanvas","elContainer","SpriteText","sprite","Sprite","SpriteMaterial","Texture","sizeAttenuation","material","minFilter","LinearFilter","context","userData","optionsUpdate","updateOptions","group","textHeight","fontFace","bold","italic","fontProperties","fontColor","center","getCenter","displayRect","borderThickness","font","linesCount","lines","line","lineWidth","measureText","textWidth","roundRect","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","stroke","fillStyle","backgroundColor","strokeStyle","borderColor","borderRadius","textBaseline","fillText","image","th","updateText","_text","optionsSpriteText","worldToScreen","widthHalf","heightHalf","project","screenPos","updateSpriteTextGroup","spriteItem","Options","boOptions","mouseenter","stereo","StereoCamera","stereoAspect","far","PerspectiveCamera","distanceTo","zeroParallax","eyeSep","setEyeSeparation","getRendererSize","raycaster","EventListeners","fullScreenSettings","spatialMultiplexCur","render","scene","rememberSize","_canvasMenu","getFullScreenSettings","updateMatrixWorld","autoClear","clear","setScissorTest","xL","yL","widthL","heightL","xR","yR","widthR","heightR","parallax","setMultiplex","setControllerSpatialMultiplex","setSpatialMultiplex","setScissor","setViewport","SbS","_width","TaB","cameraL","cameraR","getLang","_lang","stereoEffects","spatialMultiplexName","spatialMultiplexTitle","spatialMultiplexs","eyeSeparationName","eyeSeparationTitle","focusTitle","zeroParallaxName","zeroParallaxTitle","defaultButton","defaultTitle","guiParams","stereoEffectsGui","getCookieName","freeze","displayControllers","_controllerCameraFocus","_fStereoEffects","_controllerSpatialMultiplex","onChangeMode","menuItemStereoEffect","controllerNameAndTitle","_fEyeSeparation","folderNameAndTitle","_controllerEyeSep","controllerZeroStep","_minMax","_controllerZeroParallax","_controllerDefaultF","saveToCookie","createCanvasMenuItem","items","elName","menu","assign","Raycaster","raycasterEvents","setFromCamera","onDocumentMouseMove","onDocumentMouseDown","effect","mouseL","mouseR","particles","getMousePosition","vectorName","getIntersects","intersectObjects","intersectObject","intersectedObject","intersection","optionsIntersection","isIntersection","intersects","onIntersection","onIntersectionOut","mouseCur","intersect","particle","includes","isAddedToParticles","newParticles","particlesCur","mesh","pointName","getTextIntersection","spriteText","findSpriteTextIntersection","spriteOptions","scales","isArrayFuncs","player","arrayFuncs","funcs","Player","execFunc","boXYZ","spriteTextIntersectionName","getHexString","ca","isWebGLAvailable","getWebGLErrorMessage","setW","optionsCur","axisName","setPalette","boCreateScale","setScale","point","sizePointsMaterial","createOrbitControls","orbitControls","restoreSceneController","scenePosition","cameraPosition","playerOptions","marks","dt","repeat","interval","cameraTarget","Dat","boDat","cookieName","guiSelectPoint","cameraGui","guiCount","Cookie","frustumPoints","axesHelper","pointLight","eventListeners","addParticle","spriteTextIntersection","isInfo","divide","detected","exposePosition","Points","boFrustumPoints","getOptions","boPlayer","onSelectScene","selectPlayScene","setIndex","updateCloudPoints","selectSceneIndex","selectScene","pushController","playRate","playing","time","timeNext","RenamePlayButtons","onRenamePlayButtons","play","pause","isRepeat","playNext","play3DObject","timestamp","onChangeRepeat","getSettings","getSelectSceneIndex","playerTitle","dtTitle","marksTitle","intervalTitle","localization","prevSymbolTitle","playTitle","nextSymbolTitle","pauseTitle","repeatOn","repeatOff","controllerTitle","mono","sideBySide","topAndBottom","PlayController","playController","_getGroup","_selectScene","_renamePlayButtons","_renameRepeatButtons","colorOff","colorOn","buttonPlay","buttonPrev","prevSymbol","playSymbol","RenameRepeatButtons","buttonRepeat","buttonNext","nextSymbol","controler","playerGui","setDT","setSettings","onChangeScaleT","setMax","axesDefault","fPlayer","axes","scaleControllers","action","scaleController","positionController","elSlider","getSliderElement","marksName","elMenuButtonPlay","querySelector","addSlider","addSliderEvents","onchange","oninput","pointerdown","onChangeScale","cameraTargetDefault","boLook","distanceToCameraCur","distanceToCamera","boTarget","boCameraTargetLook","_cameraTarget","setCameraTarget","boErrorMessage","bodefault","axis","boMaual","changeTarget","setCameraPosition","equals","applyAxisAngle","orbitControlsGui","setTarget","_listeners","change","typeofFuncs","res","execW","tStep","tStart","tStop","iStart","iStop","selectMeshPlayScene","boundingSphere","setRotation","setAttributes","setPosition","fnName","getColor","ShaderMaterial","vertexColors","VertexColors","setColorAttribute","Float32BufferAttribute","getColors","addPoint","setMesh","selectedPointIndex","getSelectedPointIndex","isSelectedMesh","colorAttribute","setX","setY","setZ","getPoints","optionsPoints","wDefault","vector","points","getAxis","trace","traceLine","boColorWarning","optionsColor","positions","count","colors","fromBufferAttribute","standardNormalDistributionZero","getStandardNormalDistribution","cloud","iMesh","debug","setXYZW","arrayLines","isVisible","visible","sceneIndex","pop","BufferGeometry","MAX_POINTS","Float32Array","BufferAttribute","Line","LineBasicMaterial","point0","setDrawRange","start","drawRange","stop","getItemSize","addVectors","_inverseMatrix","Matrix4","_ray","Ray","_sphere","Sphere","_position","testPoint","localThresholdSq","matrixWorld","rayPointDistanceSq","distanceSqToPoint","intersectPoint","closestPointToPoint","applyMatrix4","ray","origin","near","computeBoundingSphere","intersectsSphere","localThreshold","isBufferGeometry","indices","il","vertices"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAaA,SAASA,eAAT,CAAyBC,GAAzB,EAA8B;MACxB,CAACA,GAAL,EAAU;;;MAGN,OAAOC,MAAP,KAAkB,WAAtB,EAAmC;;;MAI/BC,QAAQC,SAASC,aAAT,CAAuB,OAAvB,CAAZ;QAEMC,YAAN,CAAmB,MAAnB,EAA2B,UAA3B;QACMC,SAAN,GAAkBN,GAAlB;WACSO,IAAT,CAAcC,WAAd,CAA0BN,KAA1B;SAEOF,GAAP;;AAGF,SAASS,aAAT,CAAwBC,KAAxB,EAA+BC,WAA/B,EAA4C;MACtCC,cAAcF,MAAMG,OAAN,CAAcC,cAAd,CAA6BC,QAA7B,EAAlB;MACIC,IAAIC,KAAKC,KAAL,CAAWR,MAAMM,CAAjB,CAAR;MACIG,IAAIF,KAAKC,KAAL,CAAWR,MAAMS,CAAjB,CAAR;MACIC,IAAIH,KAAKC,KAAL,CAAWR,MAAMU,CAAjB,CAAR;MACIC,IAAIX,MAAMW,CAAd;MACIC,IAAIL,KAAKC,KAAL,CAAWR,MAAMY,CAAjB,CAAR;MACIC,IAAIb,MAAMa,CAAN,CAAQC,OAAR,CAAgB,CAAhB,CAAR;MACIC,IAAIf,MAAMe,CAAN,CAAQD,OAAR,CAAgB,CAAhB,CAAR;MACIb,eAAeC,gBAAgB,gBAA/B,IAAmDA,gBAAgB,cAAvE,EAAuF;QACjFc,MAAMhB,MAAMiB,GAAN,CAAUZ,QAAV,CAAmB,EAAnB,CAAV;WACOW,IAAIE,MAAJ,GAAa,CAApB,EAAuB;YACf,MAAMF,GAAZ;;WAEK,MAAMA,GAAb;GALF,MAMO,IAAId,gBAAgB,SAApB,EAA+B;WAC7B,SAASI,CAAT,GAAa,GAAb,GAAmBG,CAAnB,GAAuB,GAAvB,GAA6BC,CAA7B,GAAiC,GAAxC;GADK,MAEA,IAAIR,gBAAgB,UAApB,EAAgC;WAC9B,UAAUI,CAAV,GAAc,GAAd,GAAoBG,CAApB,GAAwB,GAAxB,GAA8BC,CAA9B,GAAkC,GAAlC,GAAwCC,CAAxC,GAA4C,GAAnD;GADK,MAEA,IAAIT,gBAAgB,KAApB,EAA2B;WACzB,OAAOF,MAAMiB,GAAN,CAAUZ,QAAV,CAAmB,EAAnB,CAAd;GADK,MAEA,IAAIH,gBAAgB,WAApB,EAAiC;WAC/B,MAAMI,CAAN,GAAU,GAAV,GAAgBG,CAAhB,GAAoB,GAApB,GAA0BC,CAA1B,GAA8B,GAArC;GADK,MAEA,IAAIR,gBAAgB,YAApB,EAAkC;WAChC,MAAMI,CAAN,GAAU,GAAV,GAAgBG,CAAhB,GAAoB,GAApB,GAA0BC,CAA1B,GAA8B,GAA9B,GAAoCC,CAApC,GAAwC,GAA/C;GADK,MAEA,IAAIT,gBAAgB,SAApB,EAA+B;WAC7B,QAAQI,CAAR,GAAY,KAAZ,GAAoBG,CAApB,GAAwB,KAAxB,GAAgCC,CAAhC,GAAoC,GAA3C;GADK,MAEA,IAAIR,gBAAgB,UAApB,EAAgC;WAC9B,QAAQI,CAAR,GAAY,KAAZ,GAAoBG,CAApB,GAAwB,KAAxB,GAAgCC,CAAhC,GAAoC,KAApC,GAA4CC,CAA5C,GAAgD,GAAvD;GADK,MAEA,IAAIT,gBAAgB,SAApB,EAA+B;WAC7B,QAAQU,CAAR,GAAY,KAAZ,GAAoBC,CAApB,GAAwB,KAAxB,GAAgCE,CAAhC,GAAoC,GAA3C;GADK,MAEA,IAAIb,gBAAgB,UAApB,EAAgC;WAC9B,QAAQU,CAAR,GAAY,KAAZ,GAAoBC,CAApB,GAAwB,KAAxB,GAAgCE,CAAhC,GAAoC,KAApC,GAA4CJ,CAA5C,GAAgD,GAAvD;;SAEK,gBAAP;;AAGF,IAAIQ,WAAWC,MAAMC,SAAN,CAAgBC,OAA/B;AACA,IAAIC,YAAYH,MAAMC,SAAN,CAAgBG,KAAhC;AACA,IAAIC,SAAS;SACJ,EADI;UAEH,SAASC,MAAT,CAAgBC,MAAhB,EAAwB;SACzBC,IAAL,CAAUL,UAAUM,IAAV,CAAeC,SAAf,EAA0B,CAA1B,CAAV,EAAwC,UAAUC,GAAV,EAAe;UACjDC,OAAO,KAAKC,QAAL,CAAcF,GAAd,IAAqBG,OAAOF,IAAP,CAAYD,GAAZ,CAArB,GAAwC,EAAnD;WACKT,OAAL,CAAa,UAAUa,GAAV,EAAe;YACtB,CAAC,KAAKC,WAAL,CAAiBL,IAAII,GAAJ,CAAjB,CAAL,EAAiC;iBACxBA,GAAP,IAAcJ,IAAII,GAAJ,CAAd;;OAFS,CAIXE,IAJW,CAIN,IAJM,CAAb;KAFF,EAOG,IAPH;WAQOV,MAAP;GAXS;YAaD,SAASW,WAAT,CAAkBX,MAAlB,EAA0B;SAC7BC,IAAL,CAAUL,UAAUM,IAAV,CAAeC,SAAf,EAA0B,CAA1B,CAAV,EAAwC,UAAUC,GAAV,EAAe;UACjDC,OAAO,KAAKC,QAAL,CAAcF,GAAd,IAAqBG,OAAOF,IAAP,CAAYD,GAAZ,CAArB,GAAwC,EAAnD;WACKT,OAAL,CAAa,UAAUa,GAAV,EAAe;YACtB,KAAKC,WAAL,CAAiBT,OAAOQ,GAAP,CAAjB,CAAJ,EAAmC;iBAC1BA,GAAP,IAAcJ,IAAII,GAAJ,CAAd;;OAFS,CAIXE,IAJW,CAIN,IAJM,CAAb;KAFF,EAOG,IAPH;WAQOV,MAAP;GAtBS;WAwBF,SAASY,OAAT,GAAmB;QACtBC,SAASjB,UAAUM,IAAV,CAAeC,SAAf,CAAb;WACO,YAAY;UACbW,OAAOlB,UAAUM,IAAV,CAAeC,SAAf,CAAX;WACK,IAAIY,IAAIF,OAAOtB,MAAP,GAAgB,CAA7B,EAAgCwB,KAAK,CAArC,EAAwCA,GAAxC,EAA6C;eACpC,CAACF,OAAOE,CAAP,EAAUC,KAAV,CAAgB,IAAhB,EAAsBF,IAAtB,CAAD,CAAP;;aAEKA,KAAK,CAAL,CAAP;KALF;GA1BS;QAkCL,SAASb,IAAT,CAAcG,GAAd,EAAmBa,GAAnB,EAAwBC,KAAxB,EAA+B;QAC/B,CAACd,GAAL,EAAU;;;QAGNZ,YAAYY,IAAIT,OAAhB,IAA2BS,IAAIT,OAAJ,KAAgBH,QAA/C,EAAyD;UACnDG,OAAJ,CAAYsB,GAAZ,EAAiBC,KAAjB;KADF,MAEO,IAAId,IAAIb,MAAJ,KAAea,IAAIb,MAAJ,GAAa,CAAhC,EAAmC;UACpCiB,MAAM,KAAK,CAAf;UACIW,IAAI,KAAK,CAAb;WACKX,MAAM,CAAN,EAASW,IAAIf,IAAIb,MAAtB,EAA8BiB,MAAMW,CAApC,EAAuCX,KAAvC,EAA8C;YACxCA,OAAOJ,GAAP,IAAca,IAAIf,IAAJ,CAASgB,KAAT,EAAgBd,IAAII,GAAJ,CAAhB,EAA0BA,GAA1B,MAAmC,KAAKY,KAA1D,EAAiE;;;;KAJ9D,MAQA;WACA,IAAIC,IAAT,IAAiBjB,GAAjB,EAAsB;YAChBa,IAAIf,IAAJ,CAASgB,KAAT,EAAgBd,IAAIiB,IAAJ,CAAhB,EAA2BA,IAA3B,MAAqC,KAAKD,KAA9C,EAAqD;;;;;GAlDhD;SAwDJ,SAASE,KAAT,CAAeC,GAAf,EAAoB;eACdA,GAAX,EAAgB,CAAhB;GAzDS;YA2DD,SAASC,QAAT,CAAkBC,IAAlB,EAAwBC,SAAxB,EAAmCC,eAAnC,EAAoD;QACxDC,UAAU,KAAK,CAAnB;WACO,YAAY;UACbxB,MAAM,IAAV;UACIU,OAAOX,SAAX;eACS0B,OAAT,GAAmB;kBACP,IAAV;YACI,CAACF,eAAL,EAAsBF,KAAKT,KAAL,CAAWZ,GAAX,EAAgBU,IAAhB;;UAEpBgB,UAAUH,mBAAmB,CAACC,OAAlC;mBACaA,OAAb;gBACUG,WAAWF,OAAX,EAAoBH,SAApB,CAAV;UACII,OAAJ,EAAa;aACNd,KAAL,CAAWZ,GAAX,EAAgBU,IAAhB;;KAXJ;GA7DS;WA4EF,SAASkB,UAAT,CAAiB5B,GAAjB,EAAsB;QACzBA,IAAI4B,OAAR,EAAiB,OAAO5B,IAAI4B,OAAJ,EAAP;WACVpC,UAAUM,IAAV,CAAeE,GAAf,CAAP;GA9ES;eAgFE,SAASK,WAAT,CAAqBL,GAArB,EAA0B;WAC9BA,QAAQ6B,SAAf;GAjFS;UAmFH,SAASC,MAAT,CAAgB9B,GAAhB,EAAqB;WACpBA,QAAQ,IAAf;GApFS;SAsFJ,UAAU+B,MAAV,EAAkB;aACdC,KAAT,CAAeC,EAAf,EAAmB;aACVF,OAAOnB,KAAP,CAAa,IAAb,EAAmBb,SAAnB,CAAP;;UAEIzB,QAAN,GAAiB,YAAY;aACpByD,OAAOzD,QAAP,EAAP;KADF;WAGO0D,KAAP;GAPK,CAQL,UAAUhC,GAAV,EAAe;WACRgC,MAAMhC,GAAN,CAAP;GATK,CAtFI;WAiGFX,MAAM6C,OAAN,IAAiB,UAAUlC,GAAV,EAAe;WAChCA,IAAImC,WAAJ,KAAoB9C,KAA3B;GAlGS;YAoGD,SAASa,QAAT,CAAkBF,GAAlB,EAAuB;WACxBA,QAAQG,OAAOH,GAAP,CAAf;GArGS;YAuGD,SAASoC,QAAT,CAAkBpC,GAAlB,EAAuB;WACxBA,QAAQA,MAAM,CAArB;GAxGS;YA0GD,SAASqC,QAAT,CAAkBrC,GAAlB,EAAuB;WACxBA,QAAQA,MAAM,EAArB;GA3GS;aA6GA,SAASsC,SAAT,CAAmBtC,GAAnB,EAAwB;WAC1BA,QAAQ,KAAR,IAAiBA,QAAQ,IAAhC;GA9GS;cAgHC,SAASuC,UAAT,CAAoBvC,GAApB,EAAyB;WAC5BG,OAAOb,SAAP,CAAiBhB,QAAjB,CAA0BwB,IAA1B,CAA+BE,GAA/B,MAAwC,mBAA/C;;CAjHJ;AAqHA,IAAIwC,kBAAkB,CACtB;UACU9C,OAAO2C,QADjB;eAEe;oBACK;YACR,SAASI,IAAT,CAAcC,QAAd,EAAwB;YACxBC,OAAOD,SAASE,KAAT,CAAe,oCAAf,CAAX;YACID,SAAS,IAAb,EAAmB;iBACV,KAAP;;eAEK;iBACE,KADF;eAEAE,SAAS,OAAOF,KAAK,CAAL,EAAQrE,QAAR,EAAP,GAA4BqE,KAAK,CAAL,EAAQrE,QAAR,EAA5B,GAAiDqE,KAAK,CAAL,EAAQrE,QAAR,EAAjD,GAAsEqE,KAAK,CAAL,EAAQrE,QAAR,EAAtE,GAA2FqE,KAAK,CAAL,EAAQrE,QAAR,EAA3F,GAAgHqE,KAAK,CAAL,EAAQrE,QAAR,EAAzH,EAA6I,CAA7I;SAFP;OANY;aAWPN;KAZE;kBAcG;YACN,SAASyE,IAAT,CAAcC,QAAd,EAAwB;YACxBC,OAAOD,SAASE,KAAT,CAAe,mBAAf,CAAX;YACID,SAAS,IAAb,EAAmB;iBACV,KAAP;;eAEK;iBACE,KADF;eAEAE,SAAS,OAAOF,KAAK,CAAL,EAAQrE,QAAR,EAAhB,EAAoC,CAApC;SAFP;OANU;aAWLN;KAzBE;aA2BF;YACD,SAASyE,IAAT,CAAcC,QAAd,EAAwB;YACxBC,OAAOD,SAASE,KAAT,CAAe,0CAAf,CAAX;YACID,SAAS,IAAb,EAAmB;iBACV,KAAP;;eAEK;iBACE,KADF;aAEFG,WAAWH,KAAK,CAAL,CAAX,CAFE;aAGFG,WAAWH,KAAK,CAAL,CAAX,CAHE;aAIFG,WAAWH,KAAK,CAAL,CAAX;SAJL;OANK;aAaA3E;KAxCE;cA0CD;YACF,SAASyE,IAAT,CAAcC,QAAd,EAAwB;YACxBC,OAAOD,SAASE,KAAT,CAAe,sDAAf,CAAX;YACID,SAAS,IAAb,EAAmB;iBACV,KAAP;;eAEK;iBACE,KADF;aAEFG,WAAWH,KAAK,CAAL,CAAX,CAFE;aAGFG,WAAWH,KAAK,CAAL,CAAX,CAHE;aAIFG,WAAWH,KAAK,CAAL,CAAX,CAJE;aAKFG,WAAWH,KAAK,CAAL,CAAX;SALL;OANM;aAcD3E;;;CA3DS,EA+DtB;UACU0B,OAAO0C,QADjB;eAEe;SACN;YACG,SAASK,IAAT,CAAcC,QAAd,EAAwB;eACrB;iBACE,KADF;eAEAA,QAFA;0BAGW;SAHlB;OAFC;aAQI,SAASK,KAAT,CAAe9E,KAAf,EAAsB;eACpBA,MAAMiB,GAAb;;;;CA3Ec,EAgFtB;UACUQ,OAAOwC,OADjB;eAEe;eACA;YACH,SAASO,IAAT,CAAcC,QAAd,EAAwB;YACxBA,SAASvD,MAAT,KAAoB,CAAxB,EAA2B;iBAClB,KAAP;;eAEK;iBACE,KADF;aAEFuD,SAAS,CAAT,CAFE;aAGFA,SAAS,CAAT,CAHE;aAIFA,SAAS,CAAT;SAJL;OALO;aAYF,SAASK,KAAT,CAAe9E,KAAf,EAAsB;eACpB,CAACA,MAAMM,CAAP,EAAUN,MAAMS,CAAhB,EAAmBT,MAAMU,CAAzB,CAAP;;KAdO;gBAiBC;YACJ,SAAS8D,IAAT,CAAcC,QAAd,EAAwB;YACxBA,SAASvD,MAAT,KAAoB,CAAxB,EAA2B,OAAO,KAAP;eACpB;iBACE,KADF;aAEFuD,SAAS,CAAT,CAFE;aAGFA,SAAS,CAAT,CAHE;aAIFA,SAAS,CAAT,CAJE;aAKFA,SAAS,CAAT;SALL;OAHQ;aAWH,SAASK,KAAT,CAAe9E,KAAf,EAAsB;eACpB,CAACA,MAAMM,CAAP,EAAUN,MAAMS,CAAhB,EAAmBT,MAAMU,CAAzB,EAA4BV,MAAMW,CAAlC,CAAP;;;;CA/Gc,EAoHtB;UACUc,OAAOQ,QADjB;eAEe;cACD;YACF,SAASuC,IAAT,CAAcC,QAAd,EAAwB;YACxBhD,OAAO0C,QAAP,CAAgBM,SAASnE,CAAzB,KAA+BmB,OAAO0C,QAAP,CAAgBM,SAAShE,CAAzB,CAA/B,IAA8DgB,OAAO0C,QAAP,CAAgBM,SAAS/D,CAAzB,CAA9D,IAA6Fe,OAAO0C,QAAP,CAAgBM,SAAS9D,CAAzB,CAAjG,EAA8H;iBACrH;mBACE,KADF;eAEF8D,SAASnE,CAFP;eAGFmE,SAAShE,CAHP;eAIFgE,SAAS/D,CAJP;eAKF+D,SAAS9D;WALd;;eAQK,KAAP;OAXM;aAaD,SAASmE,KAAT,CAAe9E,KAAf,EAAsB;eACpB;aACFA,MAAMM,CADJ;aAEFN,MAAMS,CAFJ;aAGFT,MAAMU,CAHJ;aAIFV,MAAMW;SAJX;;KAfO;aAuBF;YACD,SAAS6D,IAAT,CAAcC,QAAd,EAAwB;YACxBhD,OAAO0C,QAAP,CAAgBM,SAASnE,CAAzB,KAA+BmB,OAAO0C,QAAP,CAAgBM,SAAShE,CAAzB,CAA/B,IAA8DgB,OAAO0C,QAAP,CAAgBM,SAAS/D,CAAzB,CAAlE,EAA+F;iBACtF;mBACE,KADF;eAEF+D,SAASnE,CAFP;eAGFmE,SAAShE,CAHP;eAIFgE,SAAS/D;WAJd;;eAOK,KAAP;OAVK;aAYA,SAASoE,KAAT,CAAe9E,KAAf,EAAsB;eACpB;aACFA,MAAMM,CADJ;aAEFN,MAAMS,CAFJ;aAGFT,MAAMU;SAHX;;KApCO;cA2CD;YACF,SAAS8D,IAAT,CAAcC,QAAd,EAAwB;YACxBhD,OAAO0C,QAAP,CAAgBM,SAAS7D,CAAzB,KAA+Ba,OAAO0C,QAAP,CAAgBM,SAAS5D,CAAzB,CAA/B,IAA8DY,OAAO0C,QAAP,CAAgBM,SAAS1D,CAAzB,CAA9D,IAA6FU,OAAO0C,QAAP,CAAgBM,SAAS9D,CAAzB,CAAjG,EAA8H;iBACrH;mBACE,KADF;eAEF8D,SAAS7D,CAFP;eAGF6D,SAAS5D,CAHP;eAIF4D,SAAS1D,CAJP;eAKF0D,SAAS9D;WALd;;eAQK,KAAP;OAXM;aAaD,SAASmE,KAAT,CAAe9E,KAAf,EAAsB;eACpB;aACFA,MAAMY,CADJ;aAEFZ,MAAMa,CAFJ;aAGFb,MAAMe,CAHJ;aAIFf,MAAMW;SAJX;;KAzDO;aAiEF;YACD,SAAS6D,IAAT,CAAcC,QAAd,EAAwB;YACxBhD,OAAO0C,QAAP,CAAgBM,SAAS7D,CAAzB,KAA+Ba,OAAO0C,QAAP,CAAgBM,SAAS5D,CAAzB,CAA/B,IAA8DY,OAAO0C,QAAP,CAAgBM,SAAS1D,CAAzB,CAAlE,EAA+F;iBACtF;mBACE,KADF;eAEF0D,SAAS7D,CAFP;eAGF6D,SAAS5D,CAHP;eAIF4D,SAAS1D;WAJd;;eAOK,KAAP;OAVK;aAYA,SAAS+D,KAAT,CAAe9E,KAAf,EAAsB;eACpB;aACFA,MAAMY,CADJ;aAEFZ,MAAMa,CAFJ;aAGFb,MAAMe;SAHX;;;;CApMc,CAAtB;AA6MA,IAAIgE,SAAS,KAAK,CAAlB;AACA,IAAIC,WAAW,KAAK,CAApB;AACA,IAAIC,YAAY,SAASA,SAAT,GAAqB;aACxB,KAAX;MACIR,WAAW3C,UAAUZ,MAAV,GAAmB,CAAnB,GAAuBO,OAAOkC,OAAP,CAAe7B,SAAf,CAAvB,GAAmDA,UAAU,CAAV,CAAlE;SACOF,IAAP,CAAY2C,eAAZ,EAA6B,UAAUW,MAAV,EAAkB;QACzCA,OAAOC,MAAP,CAAcV,QAAd,CAAJ,EAA6B;aACpB7C,IAAP,CAAYsD,OAAOE,WAAnB,EAAgC,UAAUC,UAAV,EAAsBjF,cAAtB,EAAsC;iBAC3DiF,WAAWb,IAAX,CAAgBC,QAAhB,CAAT;YACIO,aAAa,KAAb,IAAsBD,WAAW,KAArC,EAA4C;qBAC/BA,MAAX;iBACO3E,cAAP,GAAwBA,cAAxB;iBACOiF,UAAP,GAAoBA,UAApB;iBACO5D,OAAOsB,KAAd;;OANJ;aASOtB,OAAOsB,KAAd;;GAXJ;SAcOiC,QAAP;CAjBF;AAoBA,IAAIM,eAAe,KAAK,CAAxB;AACA,IAAIC,YAAY;cACF,SAASC,UAAT,CAAoB5E,CAApB,EAAuBC,CAAvB,EAA0BE,CAA1B,EAA6B;QACnC0E,KAAKlF,KAAKmF,KAAL,CAAW9E,IAAI,EAAf,IAAqB,CAA9B;QACI+E,IAAI/E,IAAI,EAAJ,GAASL,KAAKmF,KAAL,CAAW9E,IAAI,EAAf,CAAjB;QACIgF,IAAI7E,KAAK,MAAMF,CAAX,CAAR;QACIgF,IAAI9E,KAAK,MAAM4E,IAAI9E,CAAf,CAAR;QACIiF,IAAI/E,KAAK,MAAM,CAAC,MAAM4E,CAAP,IAAY9E,CAAvB,CAAR;QACIkF,IAAI,CAAC,CAAChF,CAAD,EAAI+E,CAAJ,EAAOF,CAAP,CAAD,EAAY,CAACC,CAAD,EAAI9E,CAAJ,EAAO6E,CAAP,CAAZ,EAAuB,CAACA,CAAD,EAAI7E,CAAJ,EAAO+E,CAAP,CAAvB,EAAkC,CAACF,CAAD,EAAIC,CAAJ,EAAO9E,CAAP,CAAlC,EAA6C,CAAC+E,CAAD,EAAIF,CAAJ,EAAO7E,CAAP,CAA7C,EAAwD,CAACA,CAAD,EAAI6E,CAAJ,EAAOC,CAAP,CAAxD,EAAmEJ,EAAnE,CAAR;WACO;SACFM,EAAE,CAAF,IAAO,GADL;SAEFA,EAAE,CAAF,IAAO,GAFL;SAGFA,EAAE,CAAF,IAAO;KAHZ;GARY;cAcF,SAASC,UAAT,CAAoB1F,CAApB,EAAuBG,CAAvB,EAA0BC,CAA1B,EAA6B;QACnCuF,MAAM1F,KAAK0F,GAAL,CAAS3F,CAAT,EAAYG,CAAZ,EAAeC,CAAf,CAAV;QACIwF,MAAM3F,KAAK2F,GAAL,CAAS5F,CAAT,EAAYG,CAAZ,EAAeC,CAAf,CAAV;QACIyF,QAAQD,MAAMD,GAAlB;QACIrF,IAAI,KAAK,CAAb;QACIC,IAAI,KAAK,CAAb;QACIqF,QAAQ,CAAZ,EAAe;UACTC,QAAQD,GAAZ;KADF,MAEO;aACE;WACFE,GADE;WAEF,CAFE;WAGF;OAHL;;QAME9F,MAAM4F,GAAV,EAAe;UACT,CAACzF,IAAIC,CAAL,IAAUyF,KAAd;KADF,MAEO,IAAI1F,MAAMyF,GAAV,EAAe;UAChB,IAAI,CAACxF,IAAIJ,CAAL,IAAU6F,KAAlB;KADK,MAEA;UACD,IAAI,CAAC7F,IAAIG,CAAL,IAAU0F,KAAlB;;SAEG,CAAL;QACIvF,IAAI,CAAR,EAAW;WACJ,CAAL;;WAEK;SACFA,IAAI,GADF;SAEFC,CAFE;SAGFqF,MAAM;KAHX;GAxCY;cA8CF,SAASG,UAAT,CAAoB/F,CAApB,EAAuBG,CAAvB,EAA0BC,CAA1B,EAA6B;QACnCO,MAAM,KAAKqF,kBAAL,CAAwB,CAAxB,EAA2B,CAA3B,EAA8BhG,CAA9B,CAAV;UACM,KAAKgG,kBAAL,CAAwBrF,GAAxB,EAA6B,CAA7B,EAAgCR,CAAhC,CAAN;UACM,KAAK6F,kBAAL,CAAwBrF,GAAxB,EAA6B,CAA7B,EAAgCP,CAAhC,CAAN;WACOO,GAAP;GAlDY;sBAoDM,SAASsF,kBAAT,CAA4BtF,GAA5B,EAAiCuF,cAAjC,EAAiD;WAC5DvF,OAAOuF,iBAAiB,CAAxB,GAA4B,IAAnC;GArDY;sBAuDM,SAASF,kBAAT,CAA4BrF,GAA5B,EAAiCuF,cAAjC,EAAiDC,KAAjD,EAAwD;WACnEA,UAAUnB,eAAekB,iBAAiB,CAA1C,IAA+CvF,MAAM,EAAE,QAAQqE,YAAV,CAA5D;;CAxDJ;AA4DA,IAAIoB,YAAU,OAAOC,MAAP,KAAkB,UAAlB,IAAgCC,QAAOD,OAAOE,QAAd,MAA2B,QAA3D,GAAsE,UAAU9E,GAAV,EAAe;gBACnFA,GAAd,yCAAcA,GAAd;CADY,GAEV,UAAUA,GAAV,EAAe;SACVA,OAAO,OAAO4E,MAAP,KAAkB,UAAzB,IAAuC5E,IAAImC,WAAJ,KAAoByC,MAA3D,IAAqE5E,QAAQ4E,OAAOtF,SAApF,GAAgG,QAAhG,UAAkHU,GAAlH,yCAAkHA,GAAlH,CAAP;CAHF;AAgBA,IAAI+E,mBAAiB,SAAjBA,iBAAiB,CAAUC,QAAV,EAAoBC,WAApB,EAAiC;MAChD,EAAED,oBAAoBC,WAAtB,CAAJ,EAAwC;UAChC,IAAIC,SAAJ,CAAc,mCAAd,CAAN;;CAFJ;AAMA,IAAIC,gBAAc,YAAY;WACnBC,gBAAT,CAA0BxF,MAA1B,EAAkCyF,KAAlC,EAAyC;SAClC,IAAI1E,IAAI,CAAb,EAAgBA,IAAI0E,MAAMlG,MAA1B,EAAkCwB,GAAlC,EAAuC;UACjC2E,aAAaD,MAAM1E,CAAN,CAAjB;iBACW4E,UAAX,GAAwBD,WAAWC,UAAX,IAAyB,KAAjD;iBACWC,YAAX,GAA0B,IAA1B;UACI,WAAWF,UAAf,EAA2BA,WAAWG,QAAX,GAAsB,IAAtB;aACpBC,cAAP,CAAsB9F,MAAtB,EAA8B0F,WAAWlF,GAAzC,EAA8CkF,UAA9C;;;SAIG,UAAUL,WAAV,EAAuBU,UAAvB,EAAmCC,WAAnC,EAAgD;QACjDD,UAAJ,EAAgBP,iBAAiBH,YAAY3F,SAA7B,EAAwCqG,UAAxC;QACZC,WAAJ,EAAiBR,iBAAiBH,WAAjB,EAA8BW,WAA9B;WACVX,WAAP;GAHF;CAXgB,EAAlB;AAwBA,IAAIY,QAAM,SAASA,MAAT,CAAaC,MAAb,EAAqBC,QAArB,EAA+BC,QAA/B,EAAyC;MAC7CF,WAAW,IAAf,EAAqBA,SAASG,SAAS3G,SAAlB;MACjB4G,OAAO/F,OAAOgG,wBAAP,CAAgCL,MAAhC,EAAwCC,QAAxC,CAAX;MAEIG,SAASrE,SAAb,EAAwB;QAClBuE,SAASjG,OAAOkG,cAAP,CAAsBP,MAAtB,CAAb;QAEIM,WAAW,IAAf,EAAqB;aACZvE,SAAP;KADF,MAEO;aACEgE,OAAIO,MAAJ,EAAYL,QAAZ,EAAsBC,QAAtB,CAAP;;GANJ,MAQO,IAAI,WAAWE,IAAf,EAAqB;WACnBA,KAAKxB,KAAZ;GADK,MAEA;QACD4B,SAASJ,KAAKL,GAAlB;QAEIS,WAAWzE,SAAf,EAA0B;aACjBA,SAAP;;WAGKyE,OAAOxG,IAAP,CAAYkG,QAAZ,CAAP;;CArBJ;AAyBA,IAAIO,aAAW,SAAXA,WAAW,CAAUC,QAAV,EAAoBC,UAApB,EAAgC;MACzC,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,eAAe,IAAvD,EAA6D;UACrD,IAAIvB,SAAJ,CAAc,qEAAoEuB,UAApE,yCAAoEA,UAApE,EAAd,CAAN;;WAGOnH,SAAT,GAAqBa,OAAOuG,MAAP,CAAcD,cAAcA,WAAWnH,SAAvC,EAAkD;iBACxD;aACJkH,QADI;kBAEC,KAFD;gBAGD,IAHC;oBAIG;;GALG,CAArB;MAQIC,UAAJ,EAAgBtG,OAAOwG,cAAP,GAAwBxG,OAAOwG,cAAP,CAAsBH,QAAtB,EAAgCC,UAAhC,CAAxB,GAAsED,SAASI,SAAT,GAAqBH,UAA3F;CAblB;AA0BA,IAAII,8BAA4B,SAA5BA,4BAA4B,CAAUC,IAAV,EAAgBhH,IAAhB,EAAsB;MAChD,CAACgH,IAAL,EAAW;UACH,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;;SAGKjH,SAAS,QAAOA,IAAP,yCAAOA,IAAP,OAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAArD,IAAmEA,IAAnE,GAA0EgH,IAAjF;CALF;AAQA,IAAIE,QAAQ,YAAY;WACbA,KAAT,GAAiB;qBACA,IAAf,EAAqBA,KAArB;SACK5I,OAAL,GAAe8E,UAAUtC,KAAV,CAAgB,IAAhB,EAAsBb,SAAtB,CAAf;QACI,KAAK3B,OAAL,KAAiB,KAArB,EAA4B;YACpB,IAAI6I,KAAJ,CAAU,qCAAV,CAAN;;SAEG7I,OAAL,CAAaQ,CAAb,GAAiB,KAAKR,OAAL,CAAaQ,CAAb,IAAkB,CAAnC;;gBAEUoI,KAAZ,EAAmB,CAAC;SACb,UADa;WAEX,SAAS1I,QAAT,GAAoB;aAClBN,cAAc,IAAd,CAAP;;GAHe,EAKhB;SACI,aADJ;WAEM,SAASkJ,WAAT,GAAuB;aACrBlJ,cAAc,IAAd,EAAoB,IAApB,CAAP;;GARe,EAUhB;SACI,YADJ;WAEM,SAASmJ,UAAT,GAAsB;aACpB,KAAK/I,OAAL,CAAakF,UAAb,CAAwBP,KAAxB,CAA8B,IAA9B,CAAP;;GAbe,CAAnB;SAgBOiE,KAAP;CAzBU,EAAZ;AA2BA,SAASI,kBAAT,CAA4BxH,MAA5B,EAAoCyH,SAApC,EAA+CC,iBAA/C,EAAkE;SACzD5B,cAAP,CAAsB9F,MAAtB,EAA8ByH,SAA9B,EAAyC;SAClC,SAASE,MAAT,GAAkB;UACjB,KAAKnJ,OAAL,CAAaoJ,KAAb,KAAuB,KAA3B,EAAkC;eACzB,KAAKpJ,OAAL,CAAaiJ,SAAb,CAAP;;YAEII,cAAN,CAAqB,IAArB,EAA2BJ,SAA3B,EAAsCC,iBAAtC;aACO,KAAKlJ,OAAL,CAAaiJ,SAAb,CAAP;KANqC;SAQlC,SAASK,MAAT,CAAgB1I,CAAhB,EAAmB;UAClB,KAAKZ,OAAL,CAAaoJ,KAAb,KAAuB,KAA3B,EAAkC;cAC1BC,cAAN,CAAqB,IAArB,EAA2BJ,SAA3B,EAAsCC,iBAAtC;aACKlJ,OAAL,CAAaoJ,KAAb,GAAqB,KAArB;;WAEGpJ,OAAL,CAAaiJ,SAAb,IAA0BrI,CAA1B;;GAbJ;;AAiBF,SAAS2I,kBAAT,CAA4B/H,MAA5B,EAAoCyH,SAApC,EAA+C;SACtC3B,cAAP,CAAsB9F,MAAtB,EAA8ByH,SAA9B,EAAyC;SAClC,SAASE,MAAT,GAAkB;UACjB,KAAKnJ,OAAL,CAAaoJ,KAAb,KAAuB,KAA3B,EAAkC;eACzB,KAAKpJ,OAAL,CAAaiJ,SAAb,CAAP;;YAEIO,cAAN,CAAqB,IAArB;aACO,KAAKxJ,OAAL,CAAaiJ,SAAb,CAAP;KANqC;SAQlC,SAASK,MAAT,CAAgB1I,CAAhB,EAAmB;UAClB,KAAKZ,OAAL,CAAaoJ,KAAb,KAAuB,KAA3B,EAAkC;cAC1BI,cAAN,CAAqB,IAArB;aACKxJ,OAAL,CAAaoJ,KAAb,GAAqB,KAArB;;WAEGpJ,OAAL,CAAaiJ,SAAb,IAA0BrI,CAA1B;;GAbJ;;AAiBFgI,MAAMS,cAAN,GAAuB,UAAUxJ,KAAV,EAAiBoJ,SAAjB,EAA4BC,iBAA5B,EAA+C;MAChErJ,MAAMG,OAAN,CAAcoJ,KAAd,KAAwB,KAA5B,EAAmC;UAC3BpJ,OAAN,CAAciJ,SAAd,IAA2B7D,UAAUgB,kBAAV,CAA6BvG,MAAMG,OAAN,CAAcc,GAA3C,EAAgDoI,iBAAhD,CAA3B;GADF,MAEO,IAAIrJ,MAAMG,OAAN,CAAcoJ,KAAd,KAAwB,KAA5B,EAAmC;WACjC7H,MAAP,CAAc1B,MAAMG,OAApB,EAA6BoF,UAAUC,UAAV,CAAqBxF,MAAMG,OAAN,CAAcS,CAAnC,EAAsCZ,MAAMG,OAAN,CAAcU,CAApD,EAAuDb,MAAMG,OAAN,CAAcY,CAArE,CAA7B;GADK,MAEA;UACC,IAAIiI,KAAJ,CAAU,uBAAV,CAAN;;CANJ;AASAD,MAAMY,cAAN,GAAuB,UAAU3J,KAAV,EAAiB;MAClC+E,SAASQ,UAAUS,UAAV,CAAqBhG,MAAMM,CAA3B,EAA8BN,MAAMS,CAApC,EAAuCT,MAAMU,CAA7C,CAAb;SACOgB,MAAP,CAAc1B,MAAMG,OAApB,EAA6B;OACxB4E,OAAOlE,CADiB;OAExBkE,OAAOhE;GAFZ;MAII,CAACU,OAAOsC,KAAP,CAAagB,OAAOnE,CAApB,CAAL,EAA6B;UACrBT,OAAN,CAAcS,CAAd,GAAkBmE,OAAOnE,CAAzB;GADF,MAEO,IAAIa,OAAOW,WAAP,CAAmBpC,MAAMG,OAAN,CAAcS,CAAjC,CAAJ,EAAyC;UACxCT,OAAN,CAAcS,CAAd,GAAkB,CAAlB;;CATJ;AAYAmI,MAAMa,UAAN,GAAmB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,EAA+B,KAA/B,EAAsC,GAAtC,CAAnB;AACAT,mBAAmBJ,MAAM1H,SAAzB,EAAoC,GAApC,EAAyC,CAAzC;AACA8H,mBAAmBJ,MAAM1H,SAAzB,EAAoC,GAApC,EAAyC,CAAzC;AACA8H,mBAAmBJ,MAAM1H,SAAzB,EAAoC,GAApC,EAAyC,CAAzC;AACAqI,mBAAmBX,MAAM1H,SAAzB,EAAoC,GAApC;AACAqI,mBAAmBX,MAAM1H,SAAzB,EAAoC,GAApC;AACAqI,mBAAmBX,MAAM1H,SAAzB,EAAoC,GAApC;AACAa,OAAOuF,cAAP,CAAsBsB,MAAM1H,SAA5B,EAAuC,GAAvC,EAA4C;OACrC,SAASiI,MAAT,GAAkB;WACd,KAAKnJ,OAAL,CAAaQ,CAApB;GAFwC;OAIrC,SAAS8I,MAAT,CAAgB1I,CAAhB,EAAmB;SACjBZ,OAAL,CAAaQ,CAAb,GAAiBI,CAAjB;;CALJ;AAQAmB,OAAOuF,cAAP,CAAsBsB,MAAM1H,SAA5B,EAAuC,KAAvC,EAA8C;OACvC,SAASiI,MAAT,GAAkB;QACjB,CAAC,KAAKnJ,OAAL,CAAaoJ,KAAd,KAAwB,KAA5B,EAAmC;WAC5BpJ,OAAL,CAAac,GAAb,GAAmBsE,UAAUc,UAAV,CAAqB,KAAK/F,CAA1B,EAA6B,KAAKG,CAAlC,EAAqC,KAAKC,CAA1C,CAAnB;;WAEK,KAAKP,OAAL,CAAac,GAApB;GAL0C;OAOvC,SAASwI,MAAT,CAAgB1I,CAAhB,EAAmB;SACjBZ,OAAL,CAAaoJ,KAAb,GAAqB,KAArB;SACKpJ,OAAL,CAAac,GAAb,GAAmBF,CAAnB;;CATJ;AAaA,IAAI8I,aAAa,YAAY;WAClBA,UAAT,CAAoBhC,MAApB,EAA4BC,QAA5B,EAAsC;qBACrB,IAAf,EAAqB+B,UAArB;SACKC,YAAL,GAAoBjC,OAAOC,QAAP,CAApB;SACKiC,UAAL,GAAkBtK,SAASC,aAAT,CAAuB,KAAvB,CAAlB;SACKmI,MAAL,GAAcA,MAAd;SACKC,QAAL,GAAgBA,QAAhB;SACKkC,UAAL,GAAkBpG,SAAlB;SACKqG,gBAAL,GAAwBrG,SAAxB;;gBAEUiG,UAAZ,EAAwB,CAAC;SAClB,UADkB;WAEhB,SAASK,QAAT,CAAkBhH,GAAlB,EAAuB;WACvB8G,UAAL,GAAkB9G,GAAlB;aACO,IAAP;;GAJoB,EAMrB;SACI,gBADJ;WAEM,SAASiH,cAAT,CAAwBjH,GAAxB,EAA6B;WAC7B+G,gBAAL,GAAwB/G,GAAxB;aACO,IAAP;;GAVoB,EAYrB;SACI,UADJ;WAEM,SAASkH,QAAT,CAAkBC,QAAlB,EAA4B;WAC5BxC,MAAL,CAAY,KAAKC,QAAjB,IAA6BuC,QAA7B;UACI,KAAKL,UAAT,EAAqB;aACdA,UAAL,CAAgBnI,IAAhB,CAAqB,IAArB,EAA2BwI,QAA3B;;WAEGC,aAAL;aACO,IAAP;;GApBoB,EAsBrB;SACI,UADJ;WAEM,SAASC,QAAT,GAAoB;aAClB,KAAK1C,MAAL,CAAY,KAAKC,QAAjB,CAAP;;GAzBoB,EA2BrB;SACI,eADJ;WAEM,SAASwC,aAAT,GAAyB;aACvB,IAAP;;GA9BoB,EAgCrB;SACI,YADJ;WAEM,SAASE,UAAT,GAAsB;aACpB,KAAKV,YAAL,KAAsB,KAAKS,QAAL,EAA7B;;GAnCoB,CAAxB;SAsCOV,UAAP;CAhDe,EAAjB;AAmDA,IAAIY,YAAY;cACF,CAAC,QAAD,CADE;eAED,CAAC,OAAD,EAAU,WAAV,EAAuB,WAAvB,EAAoC,SAApC,EAA+C,WAA/C,CAFC;kBAGE,CAAC,SAAD;CAHlB;AAKA,IAAIC,gBAAgB,EAApB;AACAjJ,OAAOG,IAAP,CAAY6I,SAAZ,EAAuB,UAAU1J,CAAV,EAAa4J,CAAb,EAAgB;SAC9B/I,IAAP,CAAYb,CAAZ,EAAe,UAAU6J,CAAV,EAAa;kBACZA,CAAd,IAAmBD,CAAnB;GADF;CADF;AAKA,IAAIE,mBAAmB,iBAAvB;AACA,SAASC,gBAAT,CAA0BC,GAA1B,EAA+B;MACzBA,QAAQ,GAAR,IAAetJ,OAAOW,WAAP,CAAmB2I,GAAnB,CAAnB,EAA4C;WACnC,CAAP;;MAEEpG,QAAQoG,IAAIpG,KAAJ,CAAUkG,gBAAV,CAAZ;MACI,CAACpJ,OAAOoC,MAAP,CAAcc,KAAd,CAAL,EAA2B;WAClBE,WAAWF,MAAM,CAAN,CAAX,CAAP;;SAEK,CAAP;;AAEF,IAAIqG,MAAM;kBACQ,SAASC,cAAT,CAAwBC,IAAxB,EAA8BC,UAA9B,EAA0C;QACpDD,SAAStH,SAAT,IAAsBsH,KAAK1L,KAAL,KAAeoE,SAAzC,EAAoD;SAC/CwH,aAAL,GAAqBD,aAAa,YAAY;aACrC,KAAP;KADmB,GAEjB,YAAY,EAFhB;SAGK3L,KAAL,CAAW6L,aAAX,GAA2BF,aAAa,MAAb,GAAsB,MAAjD;SACK3L,KAAL,CAAW8L,eAAX,GAA6BH,aAAa,MAAb,GAAsB,MAAnD;SACKI,YAAL,GAAoBJ,aAAa,IAAb,GAAoB,KAAxC;GARM;kBAUQ,SAASK,cAAT,CAAwBN,IAAxB,EAA8BO,GAA9B,EAAmCC,IAAnC,EAAyC;QACnDC,WAAWD,IAAf;QACIE,aAAaH,GAAjB;QACIhK,OAAOW,WAAP,CAAmBwJ,UAAnB,CAAJ,EAAoC;mBACrB,IAAb;;QAEEnK,OAAOW,WAAP,CAAmBuJ,QAAnB,CAAJ,EAAkC;iBACrB,IAAX;;SAEGnM,KAAL,CAAWqM,QAAX,GAAsB,UAAtB;QACID,UAAJ,EAAgB;WACTpM,KAAL,CAAWsM,IAAX,GAAkB,CAAlB;WACKtM,KAAL,CAAWuM,KAAX,GAAmB,CAAnB;;QAEEJ,QAAJ,EAAc;WACPnM,KAAL,CAAWwM,GAAX,GAAiB,CAAjB;WACKxM,KAAL,CAAWyM,MAAX,GAAoB,CAApB;;GA1BI;aA6BG,SAASC,SAAT,CAAmBhB,IAAnB,EAAyBiB,SAAzB,EAAoCC,IAApC,EAA0CC,GAA1C,EAA+C;QACpDC,SAASF,QAAQ,EAArB;QACIG,YAAY7B,cAAcyB,SAAd,CAAhB;QACI,CAACI,SAAL,EAAgB;YACR,IAAIvD,KAAJ,CAAU,gBAAgBmD,SAAhB,GAA4B,iBAAtC,CAAN;;QAEEK,MAAM/M,SAASgN,WAAT,CAAqBF,SAArB,CAAV;YACQA,SAAR;WACO,aAAL;;cAEQG,UAAUJ,OAAOK,CAAP,IAAYL,OAAOI,OAAnB,IAA8B,CAA5C;cACIE,UAAUN,OAAOO,CAAP,IAAYP,OAAOM,OAAnB,IAA8B,CAA5C;cACIE,cAAJ,CAAmBX,SAAnB,EAA8BG,OAAOS,OAAP,IAAkB,KAAhD,EAAuDT,OAAOU,UAAP,IAAqB,IAA5E,EAAkFzN,MAAlF,EAA0F+M,OAAOW,UAAP,IAAqB,CAA/G,EAAkH,CAAlH,EACA,CADA,EAEAP,OAFA,EAGAE,OAHA,EAIA,KAJA,EAIO,KAJP,EAIc,KAJd,EAIqB,KAJrB,EAI4B,CAJ5B,EAI+B,IAJ/B;;;WAOC,gBAAL;;cAEQM,OAAOV,IAAIW,iBAAJ,IAAyBX,IAAIY,YAAxC;iBACO9K,QAAP,CAAgBgK,MAAhB,EAAwB;wBACV,IADU;qBAEb,KAFa;oBAGd,KAHc;sBAIZ,KAJY;qBAKb,KALa;qBAMb1I,SANa;sBAOZA;WAPZ;eASKuI,SAAL,EAAgBG,OAAOS,OAAP,IAAkB,KAAlC,EAAyCT,OAAOU,UAAhD,EAA4DzN,MAA5D,EAAoE+M,OAAOe,OAA3E,EAAoFf,OAAOgB,MAA3F,EAAmGhB,OAAOiB,QAA1G,EAAoHjB,OAAOkB,OAA3H,EAAoIlB,OAAOmB,OAA3I,EAAoJnB,OAAOoB,QAA3J;;;;;cAKIC,SAAJ,CAAcxB,SAAd,EAAyBG,OAAOS,OAAP,IAAkB,KAA3C,EAAkDT,OAAOU,UAAP,IAAqB,IAAvE;;;;WAIC1K,QAAP,CAAgBkK,GAAhB,EAAqBH,GAArB;SACKuB,aAAL,CAAmBpB,GAAnB;GAtEM;QAwEF,SAASnK,IAAT,CAAc6I,IAAd,EAAoB2C,KAApB,EAA2BzK,IAA3B,EAAiC0K,OAAjC,EAA0C;QAC1CC,OAAOD,WAAW,KAAtB;QACI5C,KAAK8C,gBAAT,EAA2B;WACpBA,gBAAL,CAAsBH,KAAtB,EAA6BzK,IAA7B,EAAmC2K,IAAnC;KADF,MAEO,IAAI7C,KAAK+C,WAAT,EAAsB;WACtBA,WAAL,CAAiB,OAAOJ,KAAxB,EAA+BzK,IAA/B;;WAEK4H,GAAP;GA/EM;UAiFA,SAASkD,MAAT,CAAgBhD,IAAhB,EAAsB2C,KAAtB,EAA6BzK,IAA7B,EAAmC0K,OAAnC,EAA4C;QAC9CC,OAAOD,WAAW,KAAtB;QACI5C,KAAKiD,mBAAT,EAA8B;WACvBA,mBAAL,CAAyBN,KAAzB,EAAgCzK,IAAhC,EAAsC2K,IAAtC;KADF,MAEO,IAAI7C,KAAKkD,WAAT,EAAsB;WACtBA,WAAL,CAAiB,OAAOP,KAAxB,EAA+BzK,IAA/B;;WAEK4H,GAAP;GAxFM;YA0FE,SAASqD,QAAT,CAAkBnD,IAAlB,EAAwBqB,SAAxB,EAAmC;QACvCrB,KAAKqB,SAAL,KAAmB3I,SAAvB,EAAkC;WAC3B2I,SAAL,GAAiBA,SAAjB;KADF,MAEO,IAAIrB,KAAKqB,SAAL,KAAmBA,SAAvB,EAAkC;UACnC+B,UAAUpD,KAAKqB,SAAL,CAAegC,KAAf,CAAqB,IAArB,CAAd;UACID,QAAQE,OAAR,CAAgBjC,SAAhB,MAA+B,CAAC,CAApC,EAAuC;gBAC7BkC,IAAR,CAAalC,SAAb;aACKA,SAAL,GAAiB+B,QAAQI,IAAR,CAAa,GAAb,EAAkBC,OAAlB,CAA0B,MAA1B,EAAkC,EAAlC,EAAsCA,OAAtC,CAA8C,MAA9C,EAAsD,EAAtD,CAAjB;;;WAGG3D,GAAP;GApGM;eAsGK,SAAS4D,WAAT,CAAqB1D,IAArB,EAA2BqB,SAA3B,EAAsC;QAC7CA,SAAJ,EAAe;UACTrB,KAAKqB,SAAL,KAAmBA,SAAvB,EAAkC;aAC3BsC,eAAL,CAAqB,OAArB;OADF,MAEO;YACDP,UAAUpD,KAAKqB,SAAL,CAAegC,KAAf,CAAqB,IAArB,CAAd;YACIO,QAAQR,QAAQE,OAAR,CAAgBjC,SAAhB,CAAZ;YACIuC,UAAU,CAAC,CAAf,EAAkB;kBACRC,MAAR,CAAeD,KAAf,EAAsB,CAAtB;eACKvC,SAAL,GAAiB+B,QAAQI,IAAR,CAAa,GAAb,CAAjB;;;KARN,MAWO;WACAnC,SAAL,GAAiB3I,SAAjB;;WAEKoH,GAAP;GArHM;YAuHE,SAASgE,QAAT,CAAkB9D,IAAlB,EAAwBqB,SAAxB,EAAmC;WACpC,IAAI0C,MAAJ,CAAW,eAAe1C,SAAf,GAA2B,YAAtC,EAAoD7H,IAApD,CAAyDwG,KAAKqB,SAA9D,KAA4E,KAAnF;GAxHM;YA0HE,SAAS2C,QAAT,CAAkBhE,IAAlB,EAAwB;QAC5B1L,QAAQ2P,iBAAiBjE,IAAjB,CAAZ;WACOJ,iBAAiBtL,MAAM,mBAAN,CAAjB,IAA+CsL,iBAAiBtL,MAAM,oBAAN,CAAjB,CAA/C,GAA+FsL,iBAAiBtL,MAAM,cAAN,CAAjB,CAA/F,GAAyIsL,iBAAiBtL,MAAM,eAAN,CAAjB,CAAzI,GAAoLsL,iBAAiBtL,MAAM4P,KAAvB,CAA3L;GA5HM;aA8HG,SAASC,SAAT,CAAmBnE,IAAnB,EAAyB;QAC9B1L,QAAQ2P,iBAAiBjE,IAAjB,CAAZ;WACOJ,iBAAiBtL,MAAM,kBAAN,CAAjB,IAA8CsL,iBAAiBtL,MAAM,qBAAN,CAAjB,CAA9C,GAA+FsL,iBAAiBtL,MAAM,aAAN,CAAjB,CAA/F,GAAwIsL,iBAAiBtL,MAAM,gBAAN,CAAjB,CAAxI,GAAoLsL,iBAAiBtL,MAAM8P,MAAvB,CAA3L;GAhIM;aAkIG,SAASC,SAAT,CAAmBC,EAAnB,EAAuB;QAC5BtE,OAAOsE,EAAX;QACIC,SAAS,EAAE3D,MAAM,CAAR,EAAWE,KAAK,CAAhB,EAAb;QACId,KAAKwE,YAAT,EAAuB;SAClB;eACM5D,IAAP,IAAeZ,KAAKyE,UAApB;eACO3D,GAAP,IAAcd,KAAK0E,SAAnB;eACO1E,KAAKwE,YAAZ;OAHF,QAISxE,IAJT;;WAMKuE,MAAP;GA5IM;YA8IE,SAASI,QAAT,CAAkB3E,IAAlB,EAAwB;WACzBA,SAASzL,SAASqQ,aAAlB,KAAoC5E,KAAK6E,IAAL,IAAa7E,KAAK8E,IAAtD,CAAP;;CA/IJ;AAmJA,IAAIC,oBAAoB,UAAUC,WAAV,EAAuB;aACpCD,iBAAT,EAA4BC,WAA5B;WACSD,iBAAT,CAA2BpI,MAA3B,EAAmCC,QAAnC,EAA6C;qBAC5B,IAAf,EAAqBmI,iBAArB;QACIE,SAASvH,4BAA0B,IAA1B,EAAgC,CAACqH,kBAAkBtH,SAAlB,IAA+BzG,OAAOkG,cAAP,CAAsB6H,iBAAtB,CAAhC,EAA0EpO,IAA1E,CAA+E,IAA/E,EAAqFgG,MAArF,EAA6FC,QAA7F,CAAhC,CAAb;QACIsI,QAAQD,MAAZ;WACOE,MAAP,GAAgBF,OAAO5F,QAAP,EAAhB;WACO+F,UAAP,GAAoB7Q,SAASC,aAAT,CAAuB,OAAvB,CAApB;WACO4Q,UAAP,CAAkB3Q,YAAlB,CAA+B,MAA/B,EAAuC,UAAvC;aACSuK,QAAT,GAAoB;YACZE,QAAN,CAAe,CAACgG,MAAMC,MAAtB;;QAEEhO,IAAJ,CAAS8N,OAAOG,UAAhB,EAA4B,QAA5B,EAAsCpG,QAAtC,EAAgD,KAAhD;WACOH,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOG,UAArC;WACOhG,aAAP;WACO6F,MAAP;;gBAEUF,iBAAZ,EAA+B,CAAC;SACzB,UADyB;WAEvB,SAAS7F,QAAT,CAAkBrJ,CAAlB,EAAqB;UACtBiE,WAAW4C,MAAIqI,kBAAkB5O,SAAlB,CAA4BsH,SAA5B,IAAyCzG,OAAOkG,cAAP,CAAsB6H,kBAAkB5O,SAAxC,CAA7C,EAAiG,UAAjG,EAA6G,IAA7G,EAAmHQ,IAAnH,CAAwH,IAAxH,EAA8Hd,CAA9H,CAAf;UACI,KAAKkJ,gBAAT,EAA2B;aACpBA,gBAAL,CAAsBpI,IAAtB,CAA2B,IAA3B,EAAiC,KAAK0I,QAAL,EAAjC;;WAEG8F,MAAL,GAAc,KAAK9F,QAAL,EAAd;aACOvF,QAAP;;GAR2B,EAU5B;SACI,eADJ;WAEM,SAASsF,aAAT,GAAyB;UAC1B,KAAKC,QAAL,OAAoB,IAAxB,EAA8B;aACvB+F,UAAL,CAAgB3Q,YAAhB,CAA6B,SAA7B,EAAwC,SAAxC;aACK2Q,UAAL,CAAgBC,OAAhB,GAA0B,IAA1B;aACKF,MAAL,GAAc,IAAd;OAHF,MAIO;aACAC,UAAL,CAAgBC,OAAhB,GAA0B,KAA1B;aACKF,MAAL,GAAc,KAAd;;aAEKzI,MAAIqI,kBAAkB5O,SAAlB,CAA4BsH,SAA5B,IAAyCzG,OAAOkG,cAAP,CAAsB6H,kBAAkB5O,SAAxC,CAA7C,EAAiG,eAAjG,EAAkH,IAAlH,EAAwHQ,IAAxH,CAA6H,IAA7H,CAAP;;GArB2B,CAA/B;SAwBOoO,iBAAP;CAzCsB,CA0CtBpG,UA1CsB,CAAxB;AA4CA,IAAI2G,mBAAmB,UAAUN,WAAV,EAAuB;aACnCM,gBAAT,EAA2BN,WAA3B;WACSM,gBAAT,CAA0B3I,MAA1B,EAAkCC,QAAlC,EAA4C2I,IAA5C,EAAkD;qBACjC,IAAf,EAAqBD,gBAArB;QACIL,SAASvH,4BAA0B,IAA1B,EAAgC,CAAC4H,iBAAiB7H,SAAjB,IAA8BzG,OAAOkG,cAAP,CAAsBoI,gBAAtB,CAA/B,EAAwE3O,IAAxE,CAA6E,IAA7E,EAAmFgG,MAAnF,EAA2FC,QAA3F,CAAhC,CAAb;QACI4I,UAAUD,IAAd;QACIL,QAAQD,MAAZ;WACOQ,QAAP,GAAkBlR,SAASC,aAAT,CAAuB,QAAvB,CAAlB;QACI+B,OAAOwC,OAAP,CAAeyM,OAAf,CAAJ,EAA6B;UACvBE,MAAM,EAAV;aACOhP,IAAP,CAAY8O,OAAZ,EAAqB,UAAUG,OAAV,EAAmB;YAClCA,OAAJ,IAAeA,OAAf;OADF;gBAGUD,GAAV;;WAEKhP,IAAP,CAAY8O,OAAZ,EAAqB,UAAUjK,KAAV,EAAiBtE,GAAjB,EAAsB;UACrC2O,MAAMrR,SAASC,aAAT,CAAuB,QAAvB,CAAV;UACIE,SAAJ,GAAgBuC,GAAhB;UACIxC,YAAJ,CAAiB,OAAjB,EAA0B8G,KAA1B;YACMkK,QAAN,CAAe7Q,WAAf,CAA2BgR,GAA3B;KAJF;WAMOxG,aAAP;QACIjI,IAAJ,CAAS8N,OAAOQ,QAAhB,EAA0B,QAA1B,EAAoC,YAAY;UAC1CI,eAAe,KAAKL,OAAL,CAAa,KAAKM,aAAlB,EAAiCvK,KAApD;YACM2D,QAAN,CAAe2G,YAAf;KAFF;WAIOhH,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOQ,QAArC;WACOR,MAAP;;gBAEUK,gBAAZ,EAA8B,CAAC;SACxB,UADwB;WAEtB,SAASpG,QAAT,CAAkBrJ,CAAlB,EAAqB;UACtBiE,WAAW4C,MAAI4I,iBAAiBnP,SAAjB,CAA2BsH,SAA3B,IAAwCzG,OAAOkG,cAAP,CAAsBoI,iBAAiBnP,SAAvC,CAA5C,EAA+F,UAA/F,EAA2G,IAA3G,EAAiHQ,IAAjH,CAAsH,IAAtH,EAA4Hd,CAA5H,CAAf;UACI,KAAKkJ,gBAAT,EAA2B;aACpBA,gBAAL,CAAsBpI,IAAtB,CAA2B,IAA3B,EAAiC,KAAK0I,QAAL,EAAjC;;aAEKvF,QAAP;;GAP0B,EAS3B;SACI,eADJ;WAEM,SAASsF,aAAT,GAAyB;UAC1BU,IAAI6E,QAAJ,CAAa,KAAKc,QAAlB,CAAJ,EAAiC,OAAO,IAAP;WAC5BA,QAAL,CAAclK,KAAd,GAAsB,KAAK8D,QAAL,EAAtB;aACO3C,MAAI4I,iBAAiBnP,SAAjB,CAA2BsH,SAA3B,IAAwCzG,OAAOkG,cAAP,CAAsBoI,iBAAiBnP,SAAvC,CAA5C,EAA+F,eAA/F,EAAgH,IAAhH,EAAsHQ,IAAtH,CAA2H,IAA3H,CAAP;;GAd0B,CAA9B;SAiBO2O,gBAAP;CA9CqB,CA+CrB3G,UA/CqB,CAAvB;AAiDA,IAAIoH,mBAAmB,UAAUf,WAAV,EAAuB;aACnCe,gBAAT,EAA2Bf,WAA3B;WACSe,gBAAT,CAA0BpJ,MAA1B,EAAkCC,QAAlC,EAA4C;qBAC3B,IAAf,EAAqBmJ,gBAArB;QACId,SAASvH,4BAA0B,IAA1B,EAAgC,CAACqI,iBAAiBtI,SAAjB,IAA8BzG,OAAOkG,cAAP,CAAsB6I,gBAAtB,CAA/B,EAAwEpP,IAAxE,CAA6E,IAA7E,EAAmFgG,MAAnF,EAA2FC,QAA3F,CAAhC,CAAb;QACIsI,QAAQD,MAAZ;aACSjG,QAAT,GAAoB;YACZE,QAAN,CAAegG,MAAMc,OAAN,CAAczK,KAA7B;;aAEO0K,MAAT,GAAkB;UACZf,MAAMnG,gBAAV,EAA4B;cACpBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAM7F,QAAN,EAAnC;;;WAGG2G,OAAP,GAAiBzR,SAASC,aAAT,CAAuB,OAAvB,CAAjB;WACOwR,OAAP,CAAevR,YAAf,CAA4B,MAA5B,EAAoC,MAApC;QACI0C,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,OAAzB,EAAkChH,QAAlC;QACI7H,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,QAAzB,EAAmChH,QAAnC;QACI7H,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,MAAzB,EAAiCC,MAAjC;QACI9O,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,SAAzB,EAAoC,UAAUtG,CAAV,EAAa;UAC3CA,EAAE6C,OAAF,KAAc,EAAlB,EAAsB;aACf2D,IAAL;;KAFJ;WAKO9G,aAAP;WACOP,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOe,OAArC;WACOf,MAAP;;gBAEUc,gBAAZ,EAA8B,CAAC;SACxB,eADwB;WAEtB,SAAS3G,aAAT,GAAyB;UAC1B,CAACU,IAAI6E,QAAJ,CAAa,KAAKqB,OAAlB,CAAL,EAAiC;aAC1BA,OAAL,CAAazK,KAAb,GAAqB,KAAK8D,QAAL,EAArB;;aAEK3C,MAAIqJ,iBAAiB5P,SAAjB,CAA2BsH,SAA3B,IAAwCzG,OAAOkG,cAAP,CAAsB6I,iBAAiB5P,SAAvC,CAA5C,EAA+F,eAA/F,EAAgH,IAAhH,EAAsHQ,IAAtH,CAA2H,IAA3H,CAAP;;GAN0B,CAA9B;SASOoP,gBAAP;CArCqB,CAsCrBpH,UAtCqB,CAAvB;AAwCA,SAASwH,WAAT,CAAqB1E,CAArB,EAAwB;MAClB3I,KAAK2I,EAAEtM,QAAF,EAAT;MACI2D,GAAGwK,OAAH,CAAW,GAAX,IAAkB,CAAC,CAAvB,EAA0B;WACjBxK,GAAG9C,MAAH,GAAY8C,GAAGwK,OAAH,CAAW,GAAX,CAAZ,GAA8B,CAArC;;SAEK,CAAP;;AAEF,IAAI8C,mBAAmB,UAAUpB,WAAV,EAAuB;aACnCoB,gBAAT,EAA2BpB,WAA3B;WACSoB,gBAAT,CAA0BzJ,MAA1B,EAAkCC,QAAlC,EAA4CwE,MAA5C,EAAoD;qBACnC,IAAf,EAAqBgF,gBAArB;QACIlB,QAAQxH,4BAA0B,IAA1B,EAAgC,CAAC0I,iBAAiB3I,SAAjB,IAA8BzG,OAAOkG,cAAP,CAAsBkJ,gBAAtB,CAA/B,EAAwEzP,IAAxE,CAA6E,IAA7E,EAAmFgG,MAAnF,EAA2FC,QAA3F,CAAhC,CAAZ;QACIyJ,UAAUjF,UAAU,EAAxB;UACMkF,KAAN,GAAcD,QAAQtL,GAAtB;UACMwL,KAAN,GAAcF,QAAQrL,GAAtB;UACMwL,MAAN,GAAeH,QAAQI,IAAvB;QACIlQ,OAAOW,WAAP,CAAmBgO,MAAMsB,MAAzB,CAAJ,EAAsC;UAChCtB,MAAMtG,YAAN,KAAuB,CAA3B,EAA8B;cACtB8H,aAAN,GAAsB,CAAtB;OADF,MAEO;cACCA,aAAN,GAAsBrR,KAAKsR,GAAL,CAAS,EAAT,EAAatR,KAAKmF,KAAL,CAAWnF,KAAKuR,GAAL,CAASvR,KAAKwR,GAAL,CAAS3B,MAAMtG,YAAf,CAAT,IAAyCvJ,KAAKyR,IAAzD,CAAb,IAA+E,EAArG;;KAJJ,MAMO;YACCJ,aAAN,GAAsBxB,MAAMsB,MAA5B;;UAEIO,WAAN,GAAoBZ,YAAYjB,MAAMwB,aAAlB,CAApB;WACOxB,KAAP;;gBAEUkB,gBAAZ,EAA8B,CAAC;SACxB,UADwB;WAEtB,SAASlH,QAAT,CAAkBrJ,CAAlB,EAAqB;UACtBmR,KAAKnR,CAAT;UACI,KAAKyQ,KAAL,KAAe5N,SAAf,IAA4BsO,KAAK,KAAKV,KAA1C,EAAiD;aAC1C,KAAKA,KAAV;OADF,MAEO,IAAI,KAAKC,KAAL,KAAe7N,SAAf,IAA4BsO,KAAK,KAAKT,KAA1C,EAAiD;aACjD,KAAKA,KAAV;;UAEE,KAAKC,MAAL,KAAgB9N,SAAhB,IAA6BsO,KAAK,KAAKR,MAAV,KAAqB,CAAtD,EAAyD;aAClDnR,KAAKC,KAAL,CAAW0R,KAAK,KAAKR,MAArB,IAA+B,KAAKA,MAAzC;;aAEK9J,MAAI0J,iBAAiBjQ,SAAjB,CAA2BsH,SAA3B,IAAwCzG,OAAOkG,cAAP,CAAsBkJ,iBAAiBjQ,SAAvC,CAA5C,EAA+F,UAA/F,EAA2G,IAA3G,EAAiHQ,IAAjH,CAAsH,IAAtH,EAA4HqQ,EAA5H,CAAP;;GAZ0B,EAc3B;SACI,KADJ;WAEM,SAASjM,GAAT,CAAakM,QAAb,EAAuB;WACvBX,KAAL,GAAaW,QAAb;aACO,IAAP;;GAlB0B,EAoB3B;SACI,KADJ;WAEM,SAASjM,GAAT,CAAakM,QAAb,EAAuB;WACvBX,KAAL,GAAaW,QAAb;aACO,IAAP;;GAxB0B,EA0B3B;SACI,MADJ;WAEM,SAAST,IAAT,CAAcU,SAAd,EAAyB;WACzBX,MAAL,GAAcW,SAAd;WACKT,aAAL,GAAqBS,SAArB;WACKJ,WAAL,GAAmBZ,YAAYgB,SAAZ,CAAnB;aACO,IAAP;;GAhC0B,CAA9B;SAmCOf,gBAAP;CAxDqB,CAyDrBzH,UAzDqB,CAAvB;AA2DA,SAASyI,cAAT,CAAwB7L,KAAxB,EAA+B8L,QAA/B,EAAyC;MACnCC,QAAQjS,KAAKsR,GAAL,CAAS,EAAT,EAAaU,QAAb,CAAZ;SACOhS,KAAKC,KAAL,CAAWiG,QAAQ+L,KAAnB,IAA4BA,KAAnC;;AAEF,IAAIC,sBAAsB,UAAUC,iBAAV,EAA6B;aAC5CD,mBAAT,EAA8BC,iBAA9B;WACSD,mBAAT,CAA6B5K,MAA7B,EAAqCC,QAArC,EAA+CwE,MAA/C,EAAuD;qBACtC,IAAf,EAAqBmG,mBAArB;QACItC,SAASvH,4BAA0B,IAA1B,EAAgC,CAAC6J,oBAAoB9J,SAApB,IAAiCzG,OAAOkG,cAAP,CAAsBqK,mBAAtB,CAAlC,EAA8E5Q,IAA9E,CAAmF,IAAnF,EAAyFgG,MAAzF,EAAiGC,QAAjG,EAA2GwE,MAA3G,CAAhC,CAAb;WACOqG,qBAAP,GAA+B,KAA/B;QACIvC,QAAQD,MAAZ;QACIyC,QAAQ,KAAK,CAAjB;aACS1I,QAAT,GAAoB;UACd2I,YAAYhO,WAAWuL,MAAMc,OAAN,CAAczK,KAAzB,CAAhB;UACI,CAAChF,OAAOsC,KAAP,CAAa8O,SAAb,CAAL,EAA8B;cACtBzI,QAAN,CAAeyI,SAAf;;;aAGKC,QAAT,GAAoB;UACd1C,MAAMnG,gBAAV,EAA4B;cACpBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAM7F,QAAN,EAAnC;;;aAGK4G,MAAT,GAAkB;;;aAGT4B,WAAT,CAAqBnI,CAArB,EAAwB;UAClBoI,OAAOJ,QAAQhI,EAAEgC,OAArB;YACMxC,QAAN,CAAegG,MAAM7F,QAAN,KAAmByI,OAAO5C,MAAMwB,aAA/C;cACQhH,EAAEgC,OAAV;;aAEOqG,SAAT,GAAqB;UACf/E,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgCwT,WAAhC;UACI7E,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8B0T,SAA9B;;;aAGOC,WAAT,CAAqBtI,CAArB,EAAwB;UAClBvI,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8BwT,WAA9B;UACI1Q,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4B0T,SAA5B;cACQrI,EAAEgC,OAAV;;WAEKsE,OAAP,GAAiBzR,SAASC,aAAT,CAAuB,OAAvB,CAAjB;WACOwR,OAAP,CAAevR,YAAf,CAA4B,MAA5B,EAAoC,MAApC;QACI0C,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,QAAzB,EAAmChH,QAAnC;QACI7H,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,MAAzB,EAAiCC,MAAjC;QACI9O,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,WAAzB,EAAsCgC,WAAtC;QACI7Q,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,SAAzB,EAAoC,UAAUtG,CAAV,EAAa;UAC3CA,EAAE6C,OAAF,KAAc,EAAlB,EAAsB;cACdkF,qBAAN,GAA8B,IAA9B;aACKvB,IAAL;cACMuB,qBAAN,GAA8B,KAA9B;;;KAJJ;WAQOrI,aAAP;WACOP,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOe,OAArC;WACOf,MAAP;;gBAEUsC,mBAAZ,EAAiC,CAAC;SAC3B,eAD2B;WAEzB,SAASnI,aAAT,GAAyB;WACzB4G,OAAL,CAAazK,KAAb,GAAqB,KAAKkM,qBAAL,GAA6B,KAAKpI,QAAL,EAA7B,GAA+C+H,eAAe,KAAK/H,QAAL,EAAf,EAAgC,KAAK0H,WAArC,CAApE;aACOrK,MAAI6K,oBAAoBpR,SAApB,CAA8BsH,SAA9B,IAA2CzG,OAAOkG,cAAP,CAAsBqK,oBAAoBpR,SAA1C,CAA/C,EAAqG,eAArG,EAAsH,IAAtH,EAA4HQ,IAA5H,CAAiI,IAAjI,CAAP;;GAJ6B,CAAjC;SAOO4Q,mBAAP;CA7DwB,CA8DxBnB,gBA9DwB,CAA1B;AAgEA,SAASV,GAAT,CAAa7P,CAAb,EAAgBoS,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4BC,EAA5B,EAAgC;SACvBD,KAAK,CAACC,KAAKD,EAAN,KAAa,CAACtS,IAAIoS,EAAL,KAAYC,KAAKD,EAAjB,CAAb,CAAZ;;AAEF,IAAII,yBAAyB,UAAUb,iBAAV,EAA6B;aAC/Ca,sBAAT,EAAiCb,iBAAjC;WACSa,sBAAT,CAAgC1L,MAAhC,EAAwCC,QAAxC,EAAkD7B,GAAlD,EAAuDC,GAAvD,EAA4DyL,IAA5D,EAAkE;qBACjD,IAAf,EAAqB4B,sBAArB;QACIpD,SAASvH,4BAA0B,IAA1B,EAAgC,CAAC2K,uBAAuB5K,SAAvB,IAAoCzG,OAAOkG,cAAP,CAAsBmL,sBAAtB,CAArC,EAAoF1R,IAApF,CAAyF,IAAzF,EAA+FgG,MAA/F,EAAuGC,QAAvG,EAAiH,EAAE7B,KAAKA,GAAP,EAAYC,KAAKA,GAAjB,EAAsByL,MAAMA,IAA5B,EAAjH,CAAhC,CAAb;QACIvB,QAAQD,MAAZ;WACOqD,YAAP,GAAsB/T,SAASC,aAAT,CAAuB,KAAvB,CAAtB;WACO+T,YAAP,GAAsBhU,SAASC,aAAT,CAAuB,KAAvB,CAAtB;QACI2C,IAAJ,CAAS8N,OAAOqD,YAAhB,EAA8B,WAA9B,EAA2CN,WAA3C;QACI7Q,IAAJ,CAAS8N,OAAOqD,YAAhB,EAA8B,YAA9B,EAA4CE,YAA5C;QACIrF,QAAJ,CAAa8B,OAAOqD,YAApB,EAAkC,QAAlC;QACInF,QAAJ,CAAa8B,OAAOsD,YAApB,EAAkC,WAAlC;aACSP,WAAT,CAAqBtI,CAArB,EAAwB;eACbkF,aAAT,CAAuBsB,IAAvB;UACI/O,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8BwT,WAA9B;UACI1Q,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4B0T,SAA5B;kBACYrI,CAAZ;;aAEOmI,WAAT,CAAqBnI,CAArB,EAAwB;QACpB+I,cAAF;UACIC,SAASxD,MAAMoD,YAAN,CAAmBK,qBAAnB,EAAb;YACMzJ,QAAN,CAAewG,IAAIhG,EAAE8B,OAAN,EAAekH,OAAO9H,IAAtB,EAA4B8H,OAAO7H,KAAnC,EAA0CqE,MAAMoB,KAAhD,EAAuDpB,MAAMqB,KAA7D,CAAf;aACO,KAAP;;aAEOwB,SAAT,GAAqB;UACf/E,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgCwT,WAAhC;UACI7E,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8B0T,SAA9B;UACI7C,MAAMnG,gBAAV,EAA4B;cACpBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAM7F,QAAN,EAAnC;;;aAGKmJ,YAAT,CAAsB9I,CAAtB,EAAyB;UACnBA,EAAEkJ,OAAF,CAAU5S,MAAV,KAAqB,CAAzB,EAA4B;;;UAGxBmB,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8BwU,WAA9B;UACI1R,IAAJ,CAAS9C,MAAT,EAAiB,UAAjB,EAA6ByU,UAA7B;kBACYpJ,CAAZ;;aAEOmJ,WAAT,CAAqBnJ,CAArB,EAAwB;UAClB8B,UAAU9B,EAAEkJ,OAAF,CAAU,CAAV,EAAapH,OAA3B;UACIkH,SAASxD,MAAMoD,YAAN,CAAmBK,qBAAnB,EAAb;YACMzJ,QAAN,CAAewG,IAAIlE,OAAJ,EAAakH,OAAO9H,IAApB,EAA0B8H,OAAO7H,KAAjC,EAAwCqE,MAAMoB,KAA9C,EAAqDpB,MAAMqB,KAA3D,CAAf;;aAEOuC,UAAT,GAAsB;UAChB9F,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgCwU,WAAhC;UACI7F,MAAJ,CAAW3O,MAAX,EAAmB,UAAnB,EAA+ByU,UAA/B;UACI5D,MAAMnG,gBAAV,EAA4B;cACpBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAM7F,QAAN,EAAnC;;;WAGGD,aAAP;WACOkJ,YAAP,CAAoB1T,WAApB,CAAgCqQ,OAAOsD,YAAvC;WACO1J,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOqD,YAArC;WACOrD,MAAP;;gBAEUoD,sBAAZ,EAAoC,CAAC;SAC9B,eAD8B;WAE5B,SAASjJ,aAAT,GAAyB;UAC1B2J,MAAM,CAAC,KAAK1J,QAAL,KAAkB,KAAKiH,KAAxB,KAAkC,KAAKC,KAAL,GAAa,KAAKD,KAApD,CAAV;WACKiC,YAAL,CAAkBjU,KAAlB,CAAwB4P,KAAxB,GAAgC6E,MAAM,GAAN,GAAY,GAA5C;aACOrM,MAAI2L,uBAAuBlS,SAAvB,CAAiCsH,SAAjC,IAA8CzG,OAAOkG,cAAP,CAAsBmL,uBAAuBlS,SAA7C,CAAlD,EAA2G,eAA3G,EAA4H,IAA5H,EAAkIQ,IAAlI,CAAuI,IAAvI,CAAP;;GALgC,CAApC;SAQO0R,sBAAP;CAhE2B,CAiE3BjC,gBAjE2B,CAA7B;AAmEA,IAAI4C,qBAAqB,UAAUhE,WAAV,EAAuB;aACrCgE,kBAAT,EAA6BhE,WAA7B;WACSgE,kBAAT,CAA4BrM,MAA5B,EAAoCC,QAApC,EAA8CqM,IAA9C,EAAoD;qBACnC,IAAf,EAAqBD,kBAArB;QACI/D,SAASvH,4BAA0B,IAA1B,EAAgC,CAACsL,mBAAmBvL,SAAnB,IAAgCzG,OAAOkG,cAAP,CAAsB8L,kBAAtB,CAAjC,EAA4ErS,IAA5E,CAAiF,IAAjF,EAAuFgG,MAAvF,EAA+FC,QAA/F,CAAhC,CAAb;QACIsI,QAAQD,MAAZ;WACOiE,QAAP,GAAkB3U,SAASC,aAAT,CAAuB,KAAvB,CAAlB;WACO0U,QAAP,CAAgBxU,SAAhB,GAA4BuU,SAASvQ,SAAT,GAAqB,MAArB,GAA8BuQ,IAA1D;QACI9R,IAAJ,CAAS8N,OAAOiE,QAAhB,EAA0B,OAA1B,EAAmC,UAAUxJ,CAAV,EAAa;QAC5C+I,cAAF;YACMU,IAAN;aACO,KAAP;KAHF;QAKIhG,QAAJ,CAAa8B,OAAOiE,QAApB,EAA8B,QAA9B;WACOrK,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOiE,QAArC;WACOjE,MAAP;;gBAEU+D,kBAAZ,EAAgC,CAAC;SAC1B,MAD0B;WAExB,SAASG,IAAT,GAAgB;UACjB,KAAKrK,UAAT,EAAqB;aACdA,UAAL,CAAgBnI,IAAhB,CAAqB,IAArB;;WAEG0I,QAAL,GAAgB1I,IAAhB,CAAqB,KAAKgG,MAA1B;UACI,KAAKoC,gBAAT,EAA2B;aACpBA,gBAAL,CAAsBpI,IAAtB,CAA2B,IAA3B,EAAiC,KAAK0I,QAAL,EAAjC;;;GAR0B,CAAhC;SAYO2J,kBAAP;CA7BuB,CA8BvBrK,UA9BuB,CAAzB;AAgCA,IAAIyK,kBAAkB,UAAUpE,WAAV,EAAuB;aAChCoE,eAAT,EAA0BpE,WAA1B;WACSoE,eAAT,CAAyBzM,MAAzB,EAAiCC,QAAjC,EAA2C;qBACxB,IAAf,EAAqBwM,eAArB;QACInE,SAASvH,4BAA0B,IAA1B,EAAgC,CAAC0L,gBAAgB3L,SAAhB,IAA6BzG,OAAOkG,cAAP,CAAsBkM,eAAtB,CAA9B,EAAsEzS,IAAtE,CAA2E,IAA3E,EAAiFgG,MAAjF,EAAyFC,QAAzF,CAAhC,CAAb;WACOyM,OAAP,GAAiB,IAAIxL,KAAJ,CAAUoH,OAAO5F,QAAP,EAAV,CAAjB;WACOiK,MAAP,GAAgB,IAAIzL,KAAJ,CAAU,CAAV,CAAhB;QACIqH,QAAQD,MAAZ;WACOpG,UAAP,GAAoBtK,SAASC,aAAT,CAAuB,KAAvB,CAApB;QACIuL,cAAJ,CAAmBkF,OAAOpG,UAA1B,EAAsC,KAAtC;WACO0K,UAAP,GAAoBhV,SAASC,aAAT,CAAuB,KAAvB,CAApB;WACO+U,UAAP,CAAkBlI,SAAlB,GAA8B,UAA9B;WACOmI,kBAAP,GAA4BjV,SAASC,aAAT,CAAuB,KAAvB,CAA5B;WACOgV,kBAAP,CAA0BnI,SAA1B,GAAsC,kBAAtC;WACOoI,YAAP,GAAsBlV,SAASC,aAAT,CAAuB,KAAvB,CAAtB;WACOiV,YAAP,CAAoBpI,SAApB,GAAgC,YAAhC;WACOqI,mBAAP,GAA6B,YAA7B;WACOC,UAAP,GAAoBpV,SAASC,aAAT,CAAuB,KAAvB,CAApB;WACOmV,UAAP,CAAkBtI,SAAlB,GAA8B,UAA9B;WACOuI,WAAP,GAAqBrV,SAASC,aAAT,CAAuB,KAAvB,CAArB;WACOoV,WAAP,CAAmBvI,SAAnB,GAA+B,WAA/B;WACO2E,OAAP,GAAiBzR,SAASC,aAAT,CAAuB,OAAvB,CAAjB;WACOwR,OAAP,CAAenB,IAAf,GAAsB,MAAtB;WACOgF,kBAAP,GAA4B,YAA5B;QACI1S,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,SAAzB,EAAoC,UAAUtG,CAAV,EAAa;UACzCA,EAAE6C,OAAF,KAAc,EAAlB,EAAsB;eACX5L,IAAP,CAAY,IAAZ;;KAFR;QAKIQ,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,MAAzB,EAAiCC,MAAjC;QACI9O,IAAJ,CAAS8N,OAAOsE,UAAhB,EAA4B,WAA5B,EAAyC,YAAmB;UACpDpG,QAAJ,CAAa,IAAb,EAAmB,MAAnB,EAA2BhM,IAA3B,CAAgC9C,MAAhC,EAAwC,SAAxC,EAAmD,YAAmB;YAC9DqP,WAAJ,CAAgBwB,MAAMqE,UAAtB,EAAkC,MAAlC;OADJ;KADJ;QAKIpS,IAAJ,CAAS8N,OAAOsE,UAAhB,EAA4B,YAA5B,EAA0C,YAAmB;UACrDpG,QAAJ,CAAa,IAAb,EAAmB,MAAnB,EAA2BhM,IAA3B,CAAgC9C,MAAhC,EAAwC,UAAxC,EAAoD,YAAmB;YAC/DqP,WAAJ,CAAgBwB,MAAMqE,UAAtB,EAAkC,MAAlC;OADJ;KADJ;QAKIO,aAAavV,SAASC,aAAT,CAAuB,KAAvB,CAAjB;WACOgC,MAAP,CAAcyO,OAAOsE,UAAP,CAAkBjV,KAAhC,EAAuC;aAC5B,OAD4B;cAE3B,OAF2B;eAG1B,KAH0B;uBAIlB,MAJkB;iBAKxB;KALf;WAOOkC,MAAP,CAAcyO,OAAOwE,YAAP,CAAoBnV,KAAlC,EAAyC;gBAC3B,UAD2B;aAE9B,MAF8B;cAG7B,MAH6B;cAI7B2Q,OAAOyE,mBAAP,IAA8BzE,OAAOoE,OAAP,CAAexT,CAAf,GAAmB,GAAnB,GAAyB,MAAzB,GAAkC,MAAhE,CAJ6B;iBAK1B,6BAL0B;oBAMvB,MANuB;cAO7B;KAPZ;WASOW,MAAP,CAAcyO,OAAO0E,UAAP,CAAkBrV,KAAhC,EAAuC;gBACzB,UADyB;aAE5B,MAF4B;cAG3B,KAH2B;mBAItB,gBAJsB;cAK3B;KALZ;WAOOkC,MAAP,CAAcyO,OAAOuE,kBAAP,CAA0BlV,KAAxC,EAA+C;aACpC,OADoC;cAEnC,OAFmC;cAGnC,gBAHmC;mBAI9B,KAJ8B;eAKlC,cALkC;cAMnC;KANZ;WAQOkC,MAAP,CAAcsT,WAAWxV,KAAzB,EAAgC;aACrB,MADqB;cAEpB,MAFoB;kBAGhB;KAHhB;mBAKewV,UAAf,EAA2B,KAA3B,EAAkC,eAAlC,EAAmD,MAAnD;WACOtT,MAAP,CAAcyO,OAAO2E,WAAP,CAAmBtV,KAAjC,EAAwC;aAC7B,MAD6B;cAE5B,OAF4B;cAG5B,gBAH4B;cAI5B,WAJ4B;gBAK1B,UAL0B;WAM/B,KAN+B;aAO7B;KAPX;gBASY2Q,OAAO2E,WAAnB;WACOpT,MAAP,CAAcyO,OAAOe,OAAP,CAAe1R,KAA7B,EAAoC;eACvB,MADuB;iBAErB,QAFqB;aAGzB,MAHyB;cAIxB,CAJwB;kBAKpB,MALoB;kBAMpB2Q,OAAO4E,kBAAP,GAA4B;KAN5C;QAQI1S,IAAJ,CAAS8N,OAAOuE,kBAAhB,EAAoC,WAApC,EAAiDO,SAAjD;QACI5S,IAAJ,CAAS8N,OAAOuE,kBAAhB,EAAoC,YAApC,EAAkDO,SAAlD;QACI5S,IAAJ,CAAS8N,OAAOwE,YAAhB,EAA8B,WAA9B,EAA2CM,SAA3C;QACI5S,IAAJ,CAAS8N,OAAOwE,YAAhB,EAA8B,YAA9B,EAA4CM,SAA5C;QACI5S,IAAJ,CAAS8N,OAAO2E,WAAhB,EAA6B,WAA7B,EAA0CI,UAA1C;QACI7S,IAAJ,CAAS8N,OAAO2E,WAAhB,EAA6B,YAA7B,EAA2CI,UAA3C;aACSD,SAAT,CAAmBrK,CAAnB,EAAsB;YACZA,CAAN;UACIvI,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8B4V,KAA9B;UACI9S,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8B4V,KAA9B;UACI9S,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4B6V,SAA5B;UACI/S,IAAJ,CAAS9C,MAAT,EAAiB,UAAjB,EAA6B6V,SAA7B;;aAEKF,UAAT,CAAoBtK,CAApB,EAAuB;WACdA,CAAL;UACIvI,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8B8V,IAA9B;UACIhT,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8B8V,IAA9B;UACIhT,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4B+V,QAA5B;UACIjT,IAAJ,CAAS9C,MAAT,EAAiB,UAAjB,EAA6B+V,QAA7B;;aAEKF,SAAT,GAAqB;UACblH,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgC4V,KAAhC;UACIjH,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgC4V,KAAhC;UACIjH,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8B6V,SAA9B;UACIlH,MAAJ,CAAW3O,MAAX,EAAmB,UAAnB,EAA+B6V,SAA/B;;;aAGKE,QAAT,GAAoB;UACZpH,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgC8V,IAAhC;UACInH,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgC8V,IAAhC;UACInH,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8B+V,QAA9B;UACIpH,MAAJ,CAAW3O,MAAX,EAAmB,UAAnB,EAA+B+V,QAA/B;;;aAGKnE,MAAT,GAAkB;UACVzO,IAAIuC,UAAU,KAAKwB,KAAf,CAAR;UACI/D,MAAM,KAAV,EAAiB;cACP6R,OAAN,CAAcpU,OAAd,GAAwBuC,CAAxB;cACM0H,QAAN,CAAegG,MAAMmE,OAAN,CAAcrL,UAAd,EAAf;OAFJ,MAGO;aACEzC,KAAL,GAAa2J,MAAMmE,OAAN,CAAclU,QAAd,EAAb;;;aAGCyS,QAAT,GAAoB;UACZ1C,MAAMnG,gBAAV,EAA4B;cAClBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAMmE,OAAN,CAAcrL,UAAd,EAAnC;;;WAGDwL,kBAAP,CAA0B5U,WAA1B,CAAsCkV,UAAtC;WACOP,UAAP,CAAkB3U,WAAlB,CAA8BqQ,OAAOwE,YAArC;WACOF,UAAP,CAAkB3U,WAAlB,CAA8BqQ,OAAOuE,kBAArC;WACOD,UAAP,CAAkB3U,WAAlB,CAA8BqQ,OAAO2E,WAArC;WACOA,WAAP,CAAmBhV,WAAnB,CAA+BqQ,OAAO0E,UAAtC;WACO9K,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOe,OAArC;WACOnH,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOsE,UAArC;WACOnK,aAAP;aACS6K,KAAT,CAAevK,CAAf,EAAkB;UACVA,EAAEmF,IAAF,CAAOvB,OAAP,CAAe,OAAf,MAA4B,CAAC,CAAjC,EAAoC;UAC9BmF,cAAF;;UAEA4B,YAAYnF,MAAMsE,kBAAN,CAAyBb,qBAAzB,EAAhB;UACI2B,OAAO5K,EAAEkJ,OAAF,IAAalJ,EAAEkJ,OAAF,CAAU,CAAV,CAAb,IAA6BlJ,CAAxC;UACI8B,UAAU8I,KAAK9I,OADnB;UAEIE,UAAU4I,KAAK5I,OAFnB;UAGI/L,IAAI,CAAC6L,UAAU6I,UAAUzJ,IAArB,KAA8ByJ,UAAUxJ,KAAV,GAAkBwJ,UAAUzJ,IAA1D,CAAR;UACI/K,IAAI,IAAI,CAAC6L,UAAU2I,UAAUvJ,GAArB,KAA6BuJ,UAAUtJ,MAAV,GAAmBsJ,UAAUvJ,GAA1D,CAAZ;UACIjL,IAAI,CAAR,EAAW;YACH,CAAJ;OADJ,MAEO,IAAIA,IAAI,CAAR,EAAW;YACV,CAAJ;;UAEAF,IAAI,CAAR,EAAW;YACH,CAAJ;OADJ,MAEO,IAAIA,IAAI,CAAR,EAAW;YACV,CAAJ;;YAEE0T,OAAN,CAAcxT,CAAd,GAAkBA,CAAlB;YACMwT,OAAN,CAAc1T,CAAd,GAAkBA,CAAlB;YACMuJ,QAAN,CAAegG,MAAMmE,OAAN,CAAcrL,UAAd,EAAf;aACO,KAAP;;aAEKmM,IAAT,CAAczK,CAAd,EAAiB;UACTA,EAAEmF,IAAF,CAAOvB,OAAP,CAAe,OAAf,MAA4B,CAAC,CAAjC,EAAoC;UAC9BmF,cAAF;;UAEA4B,YAAYnF,MAAM0E,WAAN,CAAkBjB,qBAAlB,EAAhB;UACI4B,QAAQ7K,EAAEkJ,OAAF,IAAalJ,EAAEkJ,OAAF,CAAU,CAAV,CAAb,IAA6BlJ,CAAzC;UACIgC,UAAU6I,MAAM7I,OADpB;UAEIhM,IAAI,IAAI,CAACgM,UAAU2I,UAAUvJ,GAArB,KAA6BuJ,UAAUtJ,MAAV,GAAmBsJ,UAAUvJ,GAA1D,CAAZ;UACIpL,IAAI,CAAR,EAAW;YACH,CAAJ;OADJ,MAEO,IAAIA,IAAI,CAAR,EAAW;YACV,CAAJ;;YAEE2T,OAAN,CAAc3T,CAAd,GAAkBA,IAAI,GAAtB;YACMwJ,QAAN,CAAegG,MAAMmE,OAAN,CAAcrL,UAAd,EAAf;aACO,KAAP;;WAEGiH,MAAP;;gBAEQmE,eAAZ,EAA6B,CAAC;SACrB,eADqB;WAEnB,SAAShK,aAAT,GAAyB;UACxB5H,IAAIuC,UAAU,KAAKsF,QAAL,EAAV,CAAR;UACI7H,MAAM,KAAV,EAAiB;YACTgT,WAAW,KAAf;eACO9T,IAAP,CAAYmH,MAAMa,UAAlB,EAA8B,UAAUR,SAAV,EAAqB;cAC3C,CAAC3H,OAAOW,WAAP,CAAmBM,EAAE0G,SAAF,CAAnB,CAAD,IAAqC,CAAC3H,OAAOW,WAAP,CAAmB,KAAKmS,OAAL,CAAapU,OAAb,CAAqBiJ,SAArB,CAAnB,CAAtC,IAA6F1G,EAAE0G,SAAF,MAAiB,KAAKmL,OAAL,CAAapU,OAAb,CAAqBiJ,SAArB,CAAlH,EAAmJ;uBACpI,IAAX;mBACO,EAAP;;SAHR,EAKG,IALH;YAMIsM,QAAJ,EAAc;iBACHhU,MAAP,CAAc,KAAK6S,OAAL,CAAapU,OAA3B,EAAoCuC,CAApC;;;aAGDhB,MAAP,CAAc,KAAK8S,MAAL,CAAYrU,OAA1B,EAAmC,KAAKoU,OAAL,CAAapU,OAAhD;WACKqU,MAAL,CAAY7T,CAAZ,GAAgB,CAAhB;UACIgV,OAAO,KAAKpB,OAAL,CAAaxT,CAAb,GAAiB,GAAjB,IAAwB,KAAKwT,OAAL,CAAa1T,CAAb,GAAiB,GAAzC,GAA+C,GAA/C,GAAqD,CAAhE;UACI+U,QAAQ,MAAMD,IAAlB;aACOjU,MAAP,CAAc,KAAKiT,YAAL,CAAkBnV,KAAhC,EAAuC;oBACvB,MAAM,KAAK+U,OAAL,CAAa1T,CAAnB,GAAuB,CAAvB,GAA2B,IADJ;mBAExB,OAAO,IAAI,KAAK0T,OAAL,CAAaxT,CAAxB,IAA6B,CAA7B,GAAiC,IAFT;yBAGlB,KAAKyT,MAAL,CAAYvL,WAAZ,EAHkB;gBAI3B,KAAK2L,mBAAL,GAA2B,MAA3B,GAAoCe,IAApC,GAA2C,GAA3C,GAAiDA,IAAjD,GAAwD,GAAxD,GAA8DA,IAA9D,GAAqE;OAJjF;WAMKd,UAAL,CAAgBrV,KAAhB,CAAsBqW,SAAtB,GAAkC,CAAC,IAAI,KAAKtB,OAAL,CAAa3T,CAAb,GAAiB,GAAtB,IAA6B,GAA7B,GAAmC,IAArE;WACK4T,MAAL,CAAY3T,CAAZ,GAAgB,CAAhB;WACK2T,MAAL,CAAYzT,CAAZ,GAAgB,CAAhB;qBACe,KAAK2T,kBAApB,EAAwC,MAAxC,EAAgD,MAAhD,EAAwD,KAAKF,MAAL,CAAYvL,WAAZ,EAAxD;WACKiI,OAAL,CAAazK,KAAb,GAAqB,KAAK8N,OAAL,CAAalU,QAAb,EAArB;aACOqB,MAAP,CAAc,KAAKwP,OAAL,CAAa1R,KAA3B,EAAkC;yBACb,KAAK+U,OAAL,CAAatL,WAAb,EADa;eAEvB,SAAS0M,IAAT,GAAgB,GAAhB,GAAsBA,IAAtB,GAA6B,GAA7B,GAAmCA,IAAnC,GAA0C,GAFnB;oBAGlB,KAAKZ,kBAAL,GAA0B,OAA1B,GAAoCa,KAApC,GAA4C,GAA5C,GAAkDA,KAAlD,GAA0D,GAA1D,GAAgEA,KAAhE,GAAwE;OAHxF;;GA/BqB,CAA7B;SAsCOtB,eAAP;CA1OkB,CA2OpBzK,UA3OoB,CAAtB;AA4OA,IAAIiM,UAAU,CAAC,OAAD,EAAU,KAAV,EAAiB,UAAjB,EAA6B,MAA7B,EAAqC,EAArC,CAAd;AACA,SAASC,cAAT,CAAwB7K,IAAxB,EAA8ByB,CAA9B,EAAiChM,CAAjC,EAAoCD,CAApC,EAAuC;OAC9BlB,KAAL,CAAWwW,UAAX,GAAwB,EAAxB;SACOpU,IAAP,CAAYkU,OAAZ,EAAqB,UAAUG,MAAV,EAAkB;SAC9BzW,KAAL,CAAW0W,OAAX,IAAsB,iBAAiBD,MAAjB,GAA0B,kBAA1B,GAA+CtJ,CAA/C,GAAmD,IAAnD,GAA0DhM,CAA1D,GAA8D,OAA9D,GAAwED,CAAxE,GAA4E,UAAlG;GADJ;;AAIJ,SAASyV,WAAT,CAAqBjL,IAArB,EAA2B;OAClB1L,KAAL,CAAWwW,UAAX,GAAwB,EAAxB;OACKxW,KAAL,CAAW0W,OAAX,IAAsB,oIAAtB;OACK1W,KAAL,CAAW0W,OAAX,IAAsB,iIAAtB;OACK1W,KAAL,CAAW0W,OAAX,IAAsB,4HAAtB;OACK1W,KAAL,CAAW0W,OAAX,IAAsB,6HAAtB;OACK1W,KAAL,CAAW0W,OAAX,IAAsB,yHAAtB;;AAGJ,IAAIE,oBAAoB,SAASA,iBAAT,CAA2BvO,MAA3B,EAAmCC,QAAnC,EAA6C;MAC/DgC,eAAejC,OAAOC,QAAP,CAAnB;MACIrG,OAAOwC,OAAP,CAAenC,UAAU,CAAV,CAAf,KAAgCL,OAAOQ,QAAP,CAAgBH,UAAU,CAAV,CAAhB,CAApC,EAAmE;WAC1D,IAAI0O,gBAAJ,CAAqB3I,MAArB,EAA6BC,QAA7B,EAAuChG,UAAU,CAAV,CAAvC,CAAP;;MAEEL,OAAO0C,QAAP,CAAgB2F,YAAhB,CAAJ,EAAmC;QAC7BrI,OAAO0C,QAAP,CAAgBrC,UAAU,CAAV,CAAhB,KAAiCL,OAAO0C,QAAP,CAAgBrC,UAAU,CAAV,CAAhB,CAArC,EAAoE;UAC9DL,OAAO0C,QAAP,CAAgBrC,UAAU,CAAV,CAAhB,CAAJ,EAAmC;eAC1B,IAAIyR,sBAAJ,CAA2B1L,MAA3B,EAAmCC,QAAnC,EAA6ChG,UAAU,CAAV,CAA7C,EAA2DA,UAAU,CAAV,CAA3D,EAAyEA,UAAU,CAAV,CAAzE,CAAP;;aAEK,IAAIyR,sBAAJ,CAA2B1L,MAA3B,EAAmCC,QAAnC,EAA6ChG,UAAU,CAAV,CAA7C,EAA2DA,UAAU,CAAV,CAA3D,CAAP;;QAEEL,OAAO0C,QAAP,CAAgBrC,UAAU,CAAV,CAAhB,CAAJ,EAAmC;aAC1B,IAAI2Q,mBAAJ,CAAwB5K,MAAxB,EAAgCC,QAAhC,EAA0C,EAAE7B,KAAKnE,UAAU,CAAV,CAAP,EAAqBoE,KAAKpE,UAAU,CAAV,CAA1B,EAAwC6P,MAAM7P,UAAU,CAAV,CAA9C,EAA1C,CAAP;;WAEK,IAAI2Q,mBAAJ,CAAwB5K,MAAxB,EAAgCC,QAAhC,EAA0C,EAAE7B,KAAKnE,UAAU,CAAV,CAAP,EAAqBoE,KAAKpE,UAAU,CAAV,CAA1B,EAA1C,CAAP;;MAEEL,OAAO2C,QAAP,CAAgB0F,YAAhB,CAAJ,EAAmC;WAC1B,IAAImH,gBAAJ,CAAqBpJ,MAArB,EAA6BC,QAA7B,CAAP;;MAEErG,OAAO6C,UAAP,CAAkBwF,YAAlB,CAAJ,EAAqC;WAC5B,IAAIoK,kBAAJ,CAAuBrM,MAAvB,EAA+BC,QAA/B,EAAyC,EAAzC,CAAP;;MAEErG,OAAO4C,SAAP,CAAiByF,YAAjB,CAAJ,EAAoC;WAC3B,IAAImG,iBAAJ,CAAsBpI,MAAtB,EAA8BC,QAA9B,CAAP;;SAEK,IAAP;CA1BF;AA6BA,IAAIuO,mBAAmB,UAAUnG,WAAV,EAAuB;aACnCmG,gBAAT,EAA2BnG,WAA3B;WACSmG,gBAAT,CAA0BxO,MAA1B,EAAkCC,QAAlC,EAA4C;qBAC3B,IAAf,EAAqBuO,gBAArB;QACIjG,QAAQxH,4BAA0B,IAA1B,EAAgC,CAACyN,iBAAiB1N,SAAjB,IAA8BzG,OAAOkG,cAAP,CAAsBiO,gBAAtB,CAA/B,EAAwExU,IAAxE,CAA6E,IAA7E,EAAmFgG,MAAnF,EAA2FC,QAA3F,CAAhC,CAAZ;UACMhG,SAAN,GAAkB;cACR+F,MADQ,EACAC,UAAUA,QADV,EACoB2I,MAAMrP,MAAMC,SAAN,CAAgBG,KAAhB,CAAsBK,IAAtB,CAA2BC,SAA3B,EAAsC,CAAtC;KAD5C;QAGI+F,OAAOC,QAAX,EAAqBsI,MAAMtI,QAAN,GAAiBD,OAAOC,QAAP,CAAgBsI,KAAhB,CAAjB;WACdA,KAAP;;gBAEUiG,gBAAZ,EAA8B,CAAC;SACxB,YADwB;SAExB,SAAS5M,MAAT,CAAgB6M,aAAhB,EAA+B;WAC7BC,WAAL,GAAmBD,aAAnB;KAH2B;SAKxB,SAAShN,MAAT,GAAkB;aACd,KAAKiN,WAAZ;;GAN0B,CAA9B;SASOF,gBAAP;CApBqB,CAqBrBxM,UArBqB,CAAvB;AAuBA,IAAIvK,MAAM;QACF,SAASkX,IAAT,CAAcC,GAAd,EAAmBC,KAAnB,EAA0B;QAC1BC,MAAMD,SAASjX,QAAnB;QACImX,OAAOD,IAAIjX,aAAJ,CAAkB,MAAlB,CAAX;SACKqQ,IAAL,GAAY,UAAZ;SACK8G,GAAL,GAAW,YAAX;SACK7G,IAAL,GAAYyG,GAAZ;QACIK,oBAAJ,CAAyB,MAAzB,EAAiC,CAAjC,EAAoChX,WAApC,CAAgD8W,IAAhD;GAPM;UASA,SAASG,MAAT,CAAgBC,UAAhB,EAA4BN,KAA5B,EAAmC;QACrCC,MAAMD,SAASjX,QAAnB;QACIwX,WAAWxX,SAASC,aAAT,CAAuB,OAAvB,CAAf;aACSqQ,IAAT,GAAgB,UAAhB;aACSnQ,SAAT,GAAqBoX,UAArB;QACInX,OAAO8W,IAAIG,oBAAJ,CAAyB,MAAzB,EAAiC,CAAjC,CAAX;QACI;WACGhX,WAAL,CAAiBmX,QAAjB;KADF,CAEE,OAAOrM,CAAP,EAAU;;CAjBhB;AAsBA,IAAIsM,qBAAqB,sqBAAzB;AAEA,SAASC,qBAAT,CAA+BC,QAA/B,EAAyC;aAC5BA,QAAX,EAAqB,OAAO,EAA5B;;AAEF,IAAIC,0BAA0B9X,OAAO4X,qBAAP,IAAgC5X,OAAO+X,2BAAvC,IAAsE/X,OAAOgY,wBAA7E,IAAyGhY,OAAOiY,sBAAhH,IAA0IjY,OAAOkY,uBAAjJ,IAA4KN,qBAA1M;AAEA,IAAIO,cAAc,YAAY;WACnBA,WAAT,GAAuB;qBACN,IAAf,EAAqBA,WAArB;SACKC,iBAAL,GAAyBlY,SAASC,aAAT,CAAuB,KAAvB,CAAzB;WACOgC,MAAP,CAAc,KAAKiW,iBAAL,CAAuBnY,KAArC,EAA4C;uBACzB,iBADyB;WAErC,CAFqC;YAGpC,CAHoC;eAIjC,MAJiC;cAKlC,MALkC;eAMjC,CANiC;wBAOxB,qBAPwB;kBAQ9B;KARd;QAUIgM,cAAJ,CAAmB,KAAKmM,iBAAxB;SACKA,iBAAL,CAAuBnY,KAAvB,CAA6BqM,QAA7B,GAAwC,OAAxC;SACK9B,UAAL,GAAkBtK,SAASC,aAAT,CAAuB,KAAvB,CAAlB;WACOgC,MAAP,CAAc,KAAKqI,UAAL,CAAgBvK,KAA9B,EAAqC;gBACzB,OADyB;eAE1B,MAF0B;cAG3B,MAH2B;eAI1B,CAJ0B;wBAKjB,sDALiB;kBAMvB;KANd;aAQSoY,IAAT,CAAc9X,WAAd,CAA0B,KAAK6X,iBAA/B;aACSC,IAAT,CAAc9X,WAAd,CAA0B,KAAKiK,UAA/B;QACIqG,QAAQ,IAAZ;QACI/N,IAAJ,CAAS,KAAKsV,iBAAd,EAAiC,OAAjC,EAA0C,YAAY;YAC9CE,IAAN;KADF;;gBAIUH,WAAZ,EAAyB,CAAC;SACnB,MADmB;WAEjB,SAASI,IAAT,GAAgB;UACjB1H,QAAQ,IAAZ;WACKuH,iBAAL,CAAuBnY,KAAvB,CAA6BuY,OAA7B,GAAuC,OAAvC;WACKhO,UAAL,CAAgBvK,KAAhB,CAAsBuY,OAAtB,GAAgC,OAAhC;WACKhO,UAAL,CAAgBvK,KAAhB,CAAsBwY,OAAtB,GAAgC,CAAhC;WACKjO,UAAL,CAAgBvK,KAAhB,CAAsByY,eAAtB,GAAwC,YAAxC;WACKC,MAAL;aACOjV,KAAP,CAAa,YAAY;cACjB0U,iBAAN,CAAwBnY,KAAxB,CAA8BwY,OAA9B,GAAwC,CAAxC;cACMjO,UAAN,CAAiBvK,KAAjB,CAAuBwY,OAAvB,GAAiC,CAAjC;cACMjO,UAAN,CAAiBvK,KAAjB,CAAuByY,eAAvB,GAAyC,UAAzC;OAHF;;GATqB,EAetB;SACI,MADJ;WAEM,SAASJ,IAAT,GAAgB;UACjBzH,QAAQ,IAAZ;UACIyH,OAAO,SAASA,IAAT,GAAgB;cACnB9N,UAAN,CAAiBvK,KAAjB,CAAuBuY,OAAvB,GAAiC,MAAjC;cACMJ,iBAAN,CAAwBnY,KAAxB,CAA8BuY,OAA9B,GAAwC,MAAxC;YACI7J,MAAJ,CAAWkC,MAAMrG,UAAjB,EAA6B,qBAA7B,EAAoD8N,IAApD;YACI3J,MAAJ,CAAWkC,MAAMrG,UAAjB,EAA6B,eAA7B,EAA8C8N,IAA9C;YACI3J,MAAJ,CAAWkC,MAAMrG,UAAjB,EAA6B,gBAA7B,EAA+C8N,IAA/C;OALF;UAOIxV,IAAJ,CAAS,KAAK0H,UAAd,EAA0B,qBAA1B,EAAiD8N,IAAjD;UACIxV,IAAJ,CAAS,KAAK0H,UAAd,EAA0B,eAA1B,EAA2C8N,IAA3C;UACIxV,IAAJ,CAAS,KAAK0H,UAAd,EAA0B,gBAA1B,EAA4C8N,IAA5C;WACKF,iBAAL,CAAuBnY,KAAvB,CAA6BwY,OAA7B,GAAuC,CAAvC;WACKjO,UAAL,CAAgBvK,KAAhB,CAAsBwY,OAAtB,GAAgC,CAAhC;WACKjO,UAAL,CAAgBvK,KAAhB,CAAsByY,eAAtB,GAAwC,YAAxC;;GA/BqB,EAiCtB;SACI,QADJ;WAEM,SAASC,MAAT,GAAkB;WAClBnO,UAAL,CAAgBvK,KAAhB,CAAsBsM,IAAtB,GAA6BvM,OAAO4Y,UAAP,GAAoB,CAApB,GAAwBnN,IAAIkE,QAAJ,CAAa,KAAKnF,UAAlB,IAAgC,CAAxD,GAA4D,IAAzF;WACKA,UAAL,CAAgBvK,KAAhB,CAAsBwM,GAAtB,GAA4BzM,OAAO6Y,WAAP,GAAqB,CAArB,GAAyBpN,IAAIqE,SAAJ,CAAc,KAAKtF,UAAnB,IAAiC,CAA1D,GAA8D,IAA1F;;GArCqB,CAAzB;SAwCO2N,WAAP;CAxEgB,EAAlB;AA2EA,IAAIW,aAAahZ,gBAAgB,orLAAhB,CAAjB;AAEAC,IAAIyX,MAAJ,CAAWsB,UAAX;AACA,IAAIC,gBAAgB,IAApB;AACA,IAAIC,gBAAgB,EAApB;AACA,IAAIC,sBAAsB,EAA1B;AACA,IAAIC,8BAA8B,SAAlC;AACA,IAAIC,yBAAyB,YAAY;MACnC;WACK,CAAC,CAACnZ,OAAOoZ,YAAhB;GADF,CAEE,OAAO/N,CAAP,EAAU;WACH,KAAP;;CAJyB,EAA7B;AAOA,IAAIgO,gBAAgB,KAAK,CAAzB;AACA,IAAIC,kBAAkB,IAAtB;AACA,IAAIC,qBAAqB,KAAK,CAA9B;AACA,IAAIjB,OAAO,KAAX;AACA,IAAIkB,eAAe,EAAnB;AACA,IAAIC,MAAM,SAASA,GAAT,CAAa5M,IAAb,EAAmB;MACvBgE,QAAQ,IAAZ;MACI9D,SAASF,QAAQ,EAArB;OACKrC,UAAL,GAAkBtK,SAASC,aAAT,CAAuB,KAAvB,CAAlB;OACKuZ,IAAL,GAAYxZ,SAASC,aAAT,CAAuB,IAAvB,CAAZ;OACKqK,UAAL,CAAgBjK,WAAhB,CAA4B,KAAKmZ,IAAjC;MACI5K,QAAJ,CAAa,KAAKtE,UAAlB,EAA8BuO,aAA9B;OACKY,SAAL,GAAiB,EAAjB;OACKC,aAAL,GAAqB,EAArB;OACKC,mBAAL,GAA2B,EAA3B;OACKC,sCAAL,GAA8C,EAA9C;OACKC,WAAL,GAAmB,EAAnB;WACS7X,OAAOa,QAAP,CAAgBgK,MAAhB,EAAwB;gBACnB,KADmB;eAEpB,IAFoB;WAGxB0M,IAAIO;GAHJ,CAAT;WAKS9X,OAAOa,QAAP,CAAgBgK,MAAhB,EAAwB;eACpBA,OAAOkN,SADa;cAErBlN,OAAOkN;GAFV,CAAT;MAII,CAAC/X,OAAOW,WAAP,CAAmBkK,OAAOkK,IAA1B,CAAL,EAAsC;QAChClK,OAAOmN,MAAX,EAAmB;aACVjD,IAAP,CAAYiD,MAAZ,GAAqBnN,OAAOmN,MAA5B;;GAFJ,MAIO;WACEjD,IAAP,GAAc,EAAEiD,QAAQhB,2BAAV,EAAd;;MAEEhX,OAAOW,WAAP,CAAmBkK,OAAOnE,MAA1B,KAAqCmE,OAAOoN,QAAhD,EAA0D;iBAC3CjL,IAAb,CAAkB,IAAlB;;SAEKkL,SAAP,GAAmBlY,OAAOW,WAAP,CAAmBkK,OAAOnE,MAA1B,KAAqCmE,OAAOqN,SAA/D;MACIrN,OAAOkN,SAAP,IAAoB/X,OAAOW,WAAP,CAAmBkK,OAAOsN,UAA1B,CAAxB,EAA+D;WACtDA,UAAP,GAAoB,IAApB;;MAEEC,kBAAkBnB,0BAA0BC,aAAamB,OAAb,CAAqBC,oBAAoB,IAApB,EAA0B,SAA1B,CAArB,MAA+D,MAA/G;MACIC,qBAAqB,KAAK,CAA9B;MACIC,WAAW,KAAK,CAApB;SACO9S,gBAAP,CAAwB,IAAxB,EACA;YACU;WACD,SAASmC,MAAT,GAAkB;eACdgD,OAAOnE,MAAd;;KAHN;gBAMc;WACL,SAASmB,MAAT,GAAkB;eACdgD,OAAOsN,UAAd;;KARN;eAWa;WACJ,SAAStQ,MAAT,GAAkB;eACdgD,OAAOkN,SAAd;;KAbN;gBAgBc;WACL,SAASlQ,MAAT,GAAkB;eACdgD,OAAO4N,UAAd;;KAlBN;YAqBU;WACD,SAAS5Q,MAAT,GAAkB;YACjB8G,MAAMjI,MAAV,EAAkB;iBACTiI,MAAM+J,OAAN,GAAgBV,MAAvB;;eAEKnN,OAAOkK,IAAP,CAAYiD,MAAnB;OALI;WAOD,SAAShQ,MAAT,CAAgB1I,CAAhB,EAAmB;YAClBqP,MAAMjI,MAAV,EAAkB;gBACVgS,OAAN,GAAgBV,MAAhB,GAAyB1Y,CAAzB;SADF,MAEO;iBACEyV,IAAP,CAAYiD,MAAZ,GAAqB1Y,CAArB;;6BAEmB,IAArB;cACMqZ,MAAN;;KAnCN;WAsCS;WACA,SAAS9Q,MAAT,GAAkB;eACdgD,OAAO8C,KAAd;OAFG;WAIA,SAAS3F,MAAT,CAAgB1I,CAAhB,EAAmB;eACfqO,KAAP,GAAerO,CAAf;iBACSqP,KAAT,EAAgBrP,CAAhB;;KA5CN;UA+CQ;WACC,SAASuI,MAAT,GAAkB;eACdgD,OAAO+N,IAAd;OAFE;WAIC,SAAS5Q,MAAT,CAAgB1I,CAAhB,EAAmB;eACfsZ,IAAP,GAActZ,CAAd;YACIkZ,QAAJ,EAAc;mBACHra,SAAT,GAAqB0M,OAAO+N,IAA5B;;;KAtDR;YA0DU;WACD,SAAS/Q,MAAT,GAAkB;eACdgD,OAAOgO,MAAd;OAFI;WAID,SAAS7Q,MAAT,CAAgB1I,CAAhB,EAAmB;eACfuZ,MAAP,GAAgBvZ,CAAhB;YACIuL,OAAOgO,MAAX,EAAmB;cACbjM,QAAJ,CAAa+B,MAAM6I,IAAnB,EAAyBD,IAAIuB,YAA7B;SADF,MAEO;cACD3L,WAAJ,CAAgBwB,MAAM6I,IAAtB,EAA4BD,IAAIuB,YAAhC;;aAEGC,QAAL;YACIpK,MAAMqK,aAAV,EAAyB;gBACjBA,aAAN,CAAoB7a,SAApB,GAAgCmB,IAAIiY,IAAI0B,SAAR,GAAoB1B,IAAI2B,WAAxD;;;KAvER;UA2EQ;WACC,SAASrR,MAAT,GAAkB;eACdgD,OAAOkK,IAAd;;KA7EN;qBAgFmB;WACV,SAASlN,MAAT,GAAkB;eACduQ,eAAP;OAFa;WAIV,SAASpQ,MAAT,CAAgBsE,IAAhB,EAAsB;YACrB2K,sBAAJ,EAA4B;4BACR3K,IAAlB;cACIA,IAAJ,EAAU;gBACJ1L,IAAJ,CAAS9C,MAAT,EAAiB,QAAjB,EAA2Bya,kBAA3B;WADF,MAEO;gBACD9L,MAAJ,CAAW3O,MAAX,EAAmB,QAAnB,EAA6Bya,kBAA7B;;uBAEWY,OAAb,CAAqBb,oBAAoB3J,KAApB,EAA2B,SAA3B,CAArB,EAA4DrC,IAA5D;;;;GA7FR;MAkGItM,OAAOW,WAAP,CAAmBkK,OAAOnE,MAA1B,CAAJ,EAAuC;SAChCmS,MAAL,GAAchO,OAAOgO,MAAP,IAAiB,KAA/B;QACIjM,QAAJ,CAAa,KAAKtE,UAAlB,EAA8BiP,IAAI6B,UAAlC;QACI5P,cAAJ,CAAmB,KAAKlB,UAAxB,EAAoC,KAApC;QACI2O,sBAAJ,EAA4B;UACtBmB,eAAJ,EAAqB;cACbA,eAAN,GAAwB,IAAxB;YACIiB,WAAWnC,aAAamB,OAAb,CAAqBC,oBAAoB,IAApB,EAA0B,KAA1B,CAArB,CAAf;YACIe,QAAJ,EAAc;iBACLtE,IAAP,GAAcuE,KAAKC,KAAL,CAAWF,QAAX,CAAd;;;;SAIDL,aAAL,GAAqBhb,SAASC,aAAT,CAAuB,KAAvB,CAArB;SACK+a,aAAL,CAAmB7a,SAAnB,GAA+BoZ,IAAI2B,WAAnC;QACItM,QAAJ,CAAa,KAAKoM,aAAlB,EAAiCzB,IAAIiC,kBAArC;QACI3O,OAAO4N,UAAX,EAAuB;UACjB7L,QAAJ,CAAa,KAAKoM,aAAlB,EAAiCzB,IAAIkC,eAArC;WACKnR,UAAL,CAAgBoR,YAAhB,CAA6B,KAAKV,aAAlC,EAAiD,KAAK1Q,UAAL,CAAgBqR,UAAhB,CAA2B,CAA3B,CAAjD;KAFF,MAGO;UACD/M,QAAJ,CAAa,KAAKoM,aAAlB,EAAiCzB,IAAIqC,kBAArC;WACKtR,UAAL,CAAgBjK,WAAhB,CAA4B,KAAK2a,aAAjC;;QAEEpY,IAAJ,CAAS,KAAKoY,aAAd,EAA6B,OAA7B,EAAsC,YAAY;YAC1CH,MAAN,GAAe,CAAClK,MAAMkK,MAAtB;KADF;GAvBF,MA0BO;QACDhO,OAAOgO,MAAP,KAAkB1W,SAAtB,EAAiC;aACxB0W,MAAP,GAAgB,IAAhB;;QAEEgB,eAAe7b,SAAS8b,cAAT,CAAwBjP,OAAO+N,IAA/B,CAAnB;QACIhM,QAAJ,CAAaiN,YAAb,EAA2B,iBAA3B;eACWE,OAAOpL,KAAP,EAAckL,YAAd,CAAX;QACIG,eAAe,SAASA,YAAT,CAAsB7Q,CAAtB,EAAyB;QACxC+I,cAAF;YACM2G,MAAN,GAAe,CAAClK,MAAMkK,MAAtB;aACO,KAAP;KAHF;QAKIjM,QAAJ,CAAa,KAAK4K,IAAlB,EAAwBD,IAAIuB,YAA5B;QACIlM,QAAJ,CAAa4L,QAAb,EAAuB,OAAvB;QACI5X,IAAJ,CAAS4X,QAAT,EAAmB,OAAnB,EAA4BwB,YAA5B;QACI,CAACnP,OAAOgO,MAAZ,EAAoB;WACbA,MAAL,GAAc,KAAd;;;MAGAhO,OAAOkN,SAAX,EAAsB;QAChB/X,OAAOW,WAAP,CAAmBkK,OAAOnE,MAA1B,CAAJ,EAAuC;UACjC0Q,eAAJ,EAAqB;6BACEpZ,SAASC,aAAT,CAAuB,KAAvB,CAArB;YACI2O,QAAJ,CAAayK,kBAAb,EAAiCR,aAAjC;YACIjK,QAAJ,CAAayK,kBAAb,EAAiCE,IAAI0C,0BAArC;iBACS9D,IAAT,CAAc9X,WAAd,CAA0BgZ,kBAA1B;0BACkB,KAAlB;;yBAEiBhZ,WAAnB,CAA+B,KAAKiK,UAApC;UACIsE,QAAJ,CAAa,KAAKtE,UAAlB,EAA8BiP,IAAI2C,gBAAlC;;QAEE,CAAC,KAAKxT,MAAV,EAAkB;eACPiI,KAAT,EAAgB9D,OAAO8C,KAAvB;;;OAGCwM,eAAL,GAAuB,YAAY;UAC3BC,iBAAN;GADF;MAGIxZ,IAAJ,CAAS9C,MAAT,EAAiB,QAAjB,EAA2B,KAAKqc,eAAhC;MACIvZ,IAAJ,CAAS,KAAK4W,IAAd,EAAoB,qBAApB,EAA2C,KAAK2C,eAAhD;MACIvZ,IAAJ,CAAS,KAAK4W,IAAd,EAAoB,eAApB,EAAqC,KAAK2C,eAA1C;MACIvZ,IAAJ,CAAS,KAAK4W,IAAd,EAAoB,gBAApB,EAAsC,KAAK2C,eAA3C;OACKpB,QAAL;MACIlO,OAAOqN,SAAX,EAAsB;oBACJ,IAAhB;;uBAEmB,SAASK,kBAAT,GAA8B;QAC7CtB,0BAA0BC,aAAamB,OAAb,CAAqBC,oBAAoB3J,KAApB,EAA2B,SAA3B,CAArB,MAAgE,MAA9F,EAAsG;mBACvFwK,OAAb,CAAqBb,oBAAoB3J,KAApB,EAA2B,KAA3B,CAArB,EAAwD2K,KAAKe,SAAL,CAAe1L,MAAM2L,aAAN,EAAf,CAAxD;;GAFJ;OAKKC,4BAAL,GAAoChC,kBAApC;WACSiC,UAAT,GAAsB;QAChBC,OAAO9L,MAAM+J,OAAN,EAAX;SACK/K,KAAL,IAAc,CAAd;WACOnM,KAAP,CAAa,YAAY;WAClBmM,KAAL,IAAc,CAAd;KADF;;MAIE,CAAC9C,OAAOnE,MAAZ,EAAoB;;;CA7NtB;AAiOA6Q,IAAImD,UAAJ,GAAiB,YAAY;SACpB,CAACtE,IAAR;SACOjW,IAAP,CAAYmX,YAAZ,EAA0B,UAAUqD,GAAV,EAAe;QACnCrS,UAAJ,CAAevK,KAAf,CAAqBuY,OAArB,GAA+BF,OAAO,MAAP,GAAgB,EAA/C;GADF;CAFF;AAMAmB,IAAI2C,gBAAJ,GAAuB,GAAvB;AACA3C,IAAI0C,0BAAJ,GAAiC,IAAjC;AACA1C,IAAI6B,UAAJ,GAAiB,MAAjB;AACA7B,IAAIqD,oBAAJ,GAA2B,IAA3B;AACArD,IAAIsD,cAAJ,GAAqB,oBAArB;AACAtD,IAAIuB,YAAJ,GAAmB,QAAnB;AACAvB,IAAIiC,kBAAJ,GAAyB,cAAzB;AACAjC,IAAIkC,eAAJ,GAAsB,WAAtB;AACAlC,IAAIqC,kBAAJ,GAAyB,cAAzB;AACArC,IAAIuD,UAAJ,GAAiB,MAAjB;AACAvD,IAAIO,aAAJ,GAAoB,GAApB;AACAP,IAAI2B,WAAJ,GAAkB,gBAAlB;AACA3B,IAAI0B,SAAJ,GAAgB,eAAhB;AACA1B,IAAIwD,eAAJ,GAAsB,UAAU5R,CAAV,EAAa;MAC7BnL,SAASqQ,aAAT,CAAuBC,IAAvB,KAAgC,MAAhC,KAA2CnF,EAAE6R,KAAF,KAAYlE,aAAZ,IAA6B3N,EAAE6C,OAAF,KAAc8K,aAAtF,CAAJ,EAA0G;QACpG4D,UAAJ;;CAFJ;AAKAnR,IAAI3I,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4ByZ,IAAIwD,eAAhC,EAAiD,KAAjD;AACA/a,OAAOC,MAAP,CAAcsX,IAAI3X,SAAlB,EACA;OACO,SAASqb,GAAT,CAAa7U,MAAb,EAAqBC,QAArB,EAA+B;WAC3B6U,KAAK,IAAL,EAAW9U,MAAX,EAAmBC,QAAnB,EAA6B;mBACrB1G,MAAMC,SAAN,CAAgBG,KAAhB,CAAsBK,IAAtB,CAA2BC,SAA3B,EAAsC,CAAtC;KADR,CAAP;GAFJ;YAMY,SAAS8a,QAAT,CAAkB/U,MAAlB,EAA0BC,QAA1B,EAAoC;WACrC6U,KAAK,IAAL,EAAW9U,MAAX,EAAmBC,QAAnB,EAA6B;aAC3B;KADF,CAAP;GAPJ;UAWU,SAAS+U,MAAT,CAAgBC,UAAhB,EAA4B;SAC7B7D,IAAL,CAAU8D,WAAV,CAAsBD,WAAWE,IAAjC;SACK7D,aAAL,CAAmBpK,MAAnB,CAA0B,KAAKoK,aAAL,CAAmB3K,OAAnB,CAA2BsO,UAA3B,CAA1B,EAAkE,CAAlE;QACI1M,QAAQ,IAAZ;WACOnN,KAAP,CAAa,YAAY;YACjBuX,QAAN;KADF;GAfJ;WAmBW,SAASyC,OAAT,GAAmB;QACtB,KAAK9U,MAAT,EAAiB;YACT,IAAIa,KAAJ,CAAU,0DAA0D,uDAApE,CAAN;;QAEE,KAAKwQ,SAAT,EAAoB;yBACCuD,WAAnB,CAA+B,KAAKhT,UAApC;;QAEEqG,QAAQ,IAAZ;WACOxO,IAAP,CAAY,KAAKsX,SAAjB,EAA4B,UAAUgE,SAAV,EAAqB;YACzCC,YAAN,CAAmBD,SAAnB;KADF;QAGIhP,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8ByZ,IAAIwD,eAAlC,EAAmD,KAAnD;oBACgB,IAAhB;GA/BJ;aAiCa,SAASY,SAAT,CAAmB/C,IAAnB,EAAyB;QAC9B,KAAKnB,SAAL,CAAemB,IAAf,MAAyBzW,SAA7B,EAAwC;YAChC,IAAIoF,KAAJ,CAAU,iDAAiD,SAAjD,GAA6DqR,IAA7D,GAAoE,GAA9E,CAAN;;QAEEgD,eAAe,EAAEhD,MAAMA,IAAR,EAAclS,QAAQ,IAAtB,EAAnB;iBACaqR,SAAb,GAAyB,KAAKA,SAA9B;QACI,KAAKhD,IAAL,IACJ,KAAKA,IAAL,CAAU8G,OADN,IAEJ,KAAK9G,IAAL,CAAU8G,OAAV,CAAkBjD,IAAlB,CAFA,EAEyB;mBACVC,MAAb,GAAsB,KAAK9D,IAAL,CAAU8G,OAAV,CAAkBjD,IAAlB,EAAwBC,MAA9C;mBACa9D,IAAb,GAAoB,KAAKA,IAAL,CAAU8G,OAAV,CAAkBjD,IAAlB,CAApB;;QAEE+B,MAAM,IAAIpD,GAAJ,CAAQqE,YAAR,CAAV;SACKnE,SAAL,CAAemB,IAAf,IAAuB+B,GAAvB;QACImB,KAAK/B,OAAO,IAAP,EAAaY,IAAIrS,UAAjB,CAAT;QACIsE,QAAJ,CAAakP,EAAb,EAAiB,QAAjB;WACOnB,GAAP;GAjDJ;gBAmDgB,SAASe,YAAT,CAAsBK,MAAtB,EAA8B;SACrCvE,IAAL,CAAU8D,WAAV,CAAsBS,OAAOzT,UAAP,CAAkB0T,aAAxC;WACO,KAAKvE,SAAL,CAAesE,OAAOnD,IAAtB,CAAP;QACI,KAAK7D,IAAL,IACJ,KAAKA,IAAL,CAAU8G,OADN,IAEJ,KAAK9G,IAAL,CAAU8G,OAAV,CAAkBE,OAAOnD,IAAzB,CAFA,EAEgC;aACvB,KAAK7D,IAAL,CAAU8G,OAAV,CAAkBE,OAAOnD,IAAzB,CAAP;;oBAEcmD,MAAhB;QACIpN,QAAQ,IAAZ;WACOxO,IAAP,CAAY4b,OAAOtE,SAAnB,EAA8B,UAAUgE,SAAV,EAAqB;aAC1CC,YAAP,CAAoBD,SAApB;KADF;WAGOja,KAAP,CAAa,YAAY;YACjBuX,QAAN;KADF;GAhEJ;QAoEQ,SAASkD,IAAT,GAAgB;SACfpD,MAAL,GAAc,KAAd;GArEJ;SAuES,SAASqD,KAAT,GAAiB;SACjBrD,MAAL,GAAc,IAAd;GAxEJ;QA0EQ,SAASzC,IAAT,GAAgB;SACf9N,UAAL,CAAgBvK,KAAhB,CAAsBuY,OAAtB,GAAgC,MAAhC;GA3EJ;QA6EQ,SAASD,IAAT,GAAgB;SACf/N,UAAL,CAAgBvK,KAAhB,CAAsBuY,OAAtB,GAAgC,EAAhC;GA9EJ;YAgFY,SAASyC,QAAT,GAAoB;QACxB0B,OAAO,KAAK/B,OAAL,EAAX;QACI+B,KAAKtC,UAAT,EAAqB;UACf5N,MAAMhB,IAAIuE,SAAJ,CAAc2M,KAAKjD,IAAnB,EAAyBjN,GAAnC;UACIpL,IAAI,CAAR;aACOgB,IAAP,CAAYsa,KAAKjD,IAAL,CAAUmC,UAAtB,EAAkC,UAAUwC,IAAV,EAAgB;YAC5C,EAAE1B,KAAK1C,SAAL,IAAkBoE,SAAS1B,KAAK2B,UAAlC,CAAJ,EAAmD;eAC5C7S,IAAIqE,SAAJ,CAAcuO,IAAd,CAAL;;OAFJ;UAKIre,OAAO6Y,WAAP,GAAqBpM,GAArB,GAA2BwM,mBAA3B,GAAiD5X,CAArD,EAAwD;YAClDyN,QAAJ,CAAa6N,KAAKnS,UAAlB,EAA8BiP,IAAIsD,cAAlC;aACKrD,IAAL,CAAUzZ,KAAV,CAAgB8P,MAAhB,GAAyB/P,OAAO6Y,WAAP,GAAqBpM,GAArB,GAA2BwM,mBAA3B,GAAiD,IAA1E;OAFF,MAGO;YACD5J,WAAJ,CAAgBsN,KAAKnS,UAArB,EAAiCiP,IAAIsD,cAArC;aACKrD,IAAL,CAAUzZ,KAAV,CAAgB8P,MAAhB,GAAyB,MAAzB;;;QAGA4M,KAAK4B,eAAT,EAA0B;aACjB7a,KAAP,CAAa,YAAY;aAClB6a,eAAL,CAAqBte,KAArB,CAA2B8P,MAA3B,GAAoC4M,KAAKjD,IAAL,CAAU8E,YAAV,GAAyB,IAA7D;OADF;;QAIE7B,KAAKzB,aAAT,EAAwB;WACjBA,aAAL,CAAmBjb,KAAnB,CAAyB4P,KAAzB,GAAiC8M,KAAK9M,KAAL,GAAa,IAA9C;;GAxGN;qBA2GqB3N,OAAO0B,QAAP,CAAgB,YAAY;SACxCqX,QAAL;GADiB,EAEhB,EAFgB,CA3GrB;YA8GY,SAASwD,QAAT,GAAoB;QACxBvc,OAAOW,WAAP,CAAmBwW,aAAnB,CAAJ,EAAuC;sBACrB,IAAIlB,WAAJ,EAAhB;oBACc3N,UAAd,CAAyBnK,SAAzB,GAAqCsX,kBAArC;;QAEE,KAAK/O,MAAT,EAAiB;YACT,IAAIa,KAAJ,CAAU,gDAAV,CAAN;;QAEEoH,QAAQ,IAAZ;WACOxO,IAAP,CAAYR,MAAMC,SAAN,CAAgBG,KAAhB,CAAsBK,IAAtB,CAA2BC,SAA3B,CAAZ,EAAmD,UAAU+F,MAAV,EAAkB;UAC/DuI,MAAMgJ,mBAAN,CAA0BlY,MAA1B,KAAqC,CAAzC,EAA4C;oBAC9BkP,KAAZ;;UAEEA,MAAMgJ,mBAAN,CAA0B5K,OAA1B,CAAkC3G,MAAlC,MAA8C,CAAC,CAAnD,EAAsD;cAC9CuR,mBAAN,CAA0B3K,IAA1B,CAA+B5G,MAA/B;;KALJ;QAQI,KAAK2R,SAAT,EAAoB;eACT,IAAT,EAAe,KAAKpK,KAApB;;GAhIN;WAmIW,SAAS+K,OAAT,GAAmB;QACtBiC,MAAM,IAAV;WACOA,IAAIjU,MAAX,EAAmB;YACXiU,IAAIjU,MAAV;;WAEKiU,GAAP;GAxIJ;iBA0IiB,SAASL,aAAT,GAAyB;QAClC/W,WAAW,KAAKwR,IAApB;aACS8D,MAAT,GAAkB,KAAKA,MAAvB;QACI,KAAKlB,mBAAL,CAAyBlY,MAAzB,GAAkC,CAAtC,EAAyC;eAC9BuY,MAAT,GAAkB,KAAKA,MAAvB;UACI,CAACzU,SAASiZ,UAAd,EAA0B;iBACfA,UAAT,GAAsB,EAAtB;;eAEOA,UAAT,CAAoB,KAAKxE,MAAzB,IAAmCyE,iBAAiB,IAAjB,CAAnC;;aAEOZ,OAAT,GAAmB,EAAnB;WACO1b,IAAP,CAAY,KAAKsX,SAAjB,EAA4B,UAAUrI,OAAV,EAAmB1O,GAAnB,EAAwB;eACzCmb,OAAT,CAAiBnb,GAAjB,IAAwB0O,QAAQkL,aAAR,EAAxB;KADF;WAGO/W,QAAP;GAxJJ;QA0JQ,SAASmZ,IAAT,GAAgB;QAChB,CAAC,KAAK3H,IAAL,CAAUyH,UAAf,EAA2B;WACpBzH,IAAL,CAAUyH,UAAV,GAAuB,EAAvB;;SAEGzH,IAAL,CAAUyH,UAAV,CAAqB,KAAKxE,MAA1B,IAAoCyE,iBAAiB,IAAjB,CAApC;uBACmB,IAAnB,EAAyB,KAAzB;SACKlC,4BAAL;GAhKJ;UAkKU,SAASoC,MAAT,CAAgBC,UAAhB,EAA4B;QAC9B,CAAC,KAAK7H,IAAL,CAAUyH,UAAf,EAA2B;WACpBzH,IAAL,CAAUyH,UAAV,GAAuB,EAAvB;WACKzH,IAAL,CAAUyH,UAAV,CAAqBxF,2BAArB,IAAoDyF,iBAAiB,IAAjB,EAAuB,IAAvB,CAApD;;SAEG1H,IAAL,CAAUyH,UAAV,CAAqBI,UAArB,IAAmCH,iBAAiB,IAAjB,CAAnC;SACKzE,MAAL,GAAc4E,UAAd;oBACgB,IAAhB,EAAsBA,UAAtB,EAAkC,IAAlC;SACKrC,4BAAL;GA1KJ;UA4KU,SAAS5B,MAAT,CAAgBgC,GAAhB,EAAqB;WACpBxa,IAAP,CAAY,KAAKuX,aAAjB,EAAgC,UAAU2D,UAAV,EAAsB;UAChD,CAAC,KAAK3C,OAAL,GAAe3D,IAAf,CAAoByH,UAAzB,EAAqC;mBACxB7T,QAAX,CAAoB0S,WAAWhT,YAA/B;OADF,MAEO;yBACYsS,OAAO,KAAKjC,OAAL,EAAxB,EAAwC2C,UAAxC;;UAEEA,WAAW7S,gBAAf,EAAiC;mBACpBA,gBAAX,CAA4BpI,IAA5B,CAAiCib,UAAjC,EAA6CA,WAAWvS,QAAX,EAA7C;;KAPJ,EASG,IATH;WAUO3I,IAAP,CAAY,KAAKsX,SAAjB,EAA4B,UAAUsE,MAAV,EAAkB;aACrCpD,MAAP,CAAcoD,MAAd;KADF;QAGI,CAACpB,GAAL,EAAU;yBACW,KAAKjC,OAAL,EAAnB,EAAmC,KAAnC;;GA3LN;UA8LU,SAASmE,MAAT,CAAgBxB,UAAhB,EAA4B;QAC9B5P,OAAO,KAAKoM,WAAL,CAAiBpY,MAAjB,KAA4B,CAAvC;SACKoY,WAAL,CAAiB7K,IAAjB,CAAsBqO,UAAtB;QACI5P,IAAJ,EAAU;qBACO,KAAKoM,WAApB;;GAlMN;iBAqMiB,SAAShP,aAAT,GAAyB;WAC/B1I,IAAP,CAAY,KAAKuX,aAAjB,EAAgC,UAAU2D,UAAV,EAAsB;iBACzCxS,aAAX;KADF;WAGO1I,IAAP,CAAY,KAAKsX,SAAjB,EAA4B,UAAUsE,MAAV,EAAkB;aACrClT,aAAP;KADF;;CA1MJ;AA+MA,SAASkR,MAAT,CAAgBY,GAAhB,EAAqBmC,MAArB,EAA6BC,QAA7B,EAAuC;MACjCjB,KAAK9d,SAASC,aAAT,CAAuB,IAAvB,CAAT;MACI6e,MAAJ,EAAY;OACPze,WAAH,CAAeye,MAAf;;MAEEC,QAAJ,EAAc;QACRvF,IAAJ,CAASkC,YAAT,CAAsBoC,EAAtB,EAA0BiB,QAA1B;GADF,MAEO;QACDvF,IAAJ,CAASnZ,WAAT,CAAqByd,EAArB;;MAEE/C,QAAJ;SACO+C,EAAP;;AAEF,SAASkB,eAAT,CAAyBrC,GAAzB,EAA8B;MACxBlO,MAAJ,CAAW3O,MAAX,EAAmB,QAAnB,EAA6B6c,IAAIR,eAAjC;MACIQ,IAAIJ,4BAAR,EAAsC;QAChC9N,MAAJ,CAAW3O,MAAX,EAAmB,QAAnB,EAA6B6c,IAAIJ,4BAAjC;;;AAGJ,SAAS0C,kBAAT,CAA4BtC,GAA5B,EAAiCuC,QAAjC,EAA2C;MACrC7N,MAAMsL,IAAIwC,eAAJ,CAAoBxC,IAAIwC,eAAJ,CAAoB5N,aAAxC,CAAV;MACI2N,QAAJ,EAAc;QACR/e,SAAJ,GAAgBkR,IAAIrK,KAAJ,GAAY,GAA5B;GADF,MAEO;QACD7G,SAAJ,GAAgBkR,IAAIrK,KAApB;;;AAGJ,SAASoY,iBAAT,CAA2BzC,GAA3B,EAAgCmB,EAAhC,EAAoCT,UAApC,EAAgD;aACnCE,IAAX,GAAkBO,EAAlB;aACWuB,KAAX,GAAmB1C,GAAnB;SACO1a,MAAP,CAAcob,UAAd,EAA4D;aACjD,SAASpM,OAAT,CAAiBqO,QAAjB,EAA2B;UAC9Bjd,UAAUZ,MAAV,GAAmB,CAAvB,EAA0B;YACpB8d,cAAclC,WAAWE,IAAX,CAAgBiC,kBAAlC;mBACWpC,MAAX;eACOF,KAAKP,GAAL,EAAUU,WAAWjV,MAArB,EAA6BiV,WAAWhV,QAAxC,EAAkD;kBAC/CkX,WAD+C;uBAE1C,CAACvd,OAAOkC,OAAP,CAAe7B,SAAf,CAAD;SAFR,CAAP;;UAKEL,OAAOwC,OAAP,CAAe8a,QAAf,KAA4Btd,OAAOQ,QAAP,CAAgB8c,QAAhB,CAAhC,EAA2D;YACrDG,eAAepC,WAAWE,IAAX,CAAgBiC,kBAAnC;mBACWpC,MAAX;eACOF,KAAKP,GAAL,EAAUU,WAAWjV,MAArB,EAA6BiV,WAAWhV,QAAxC,EAAkD;kBAC/CoX,YAD+C;uBAE1C,CAACH,QAAD;SAFR,CAAP;;KAbsD;UAmBpD,SAAS1E,IAAT,CAAc8E,KAAd,EAAqB;iBACdnC,IAAX,CAAgBoC,iBAAhB,CAAkCA,iBAAlC,CAAoDxf,SAApD,GAAgEuf,KAAhE;aACOrC,UAAP;KArBwD;YAuBlD,SAASwB,MAAT,GAAkB;iBACbQ,KAAX,CAAiBR,MAAjB,CAAwBxB,UAAxB;aACOA,UAAP;KAzBwD;YA2BlD,SAASD,MAAT,GAAkB;iBACbiC,KAAX,CAAiBjC,MAAjB,CAAwBC,UAAxB;aACOA,UAAP;;GA7BJ;MAgCIA,sBAAsBvJ,sBAA1B,EAAkD;QAC5C8L,MAAM,IAAI5M,mBAAJ,CAAwBqK,WAAWjV,MAAnC,EAA2CiV,WAAWhV,QAAtD,EAAgE,EAAE7B,KAAK6W,WAAWtL,KAAlB,EAAyBtL,KAAK4W,WAAWrL,KAAzC,EAAgDE,MAAMmL,WAAWpL,MAAjE,EAAhE,CAAV;WACO9P,IAAP,CAAY,CAAC,eAAD,EAAkB,UAAlB,EAA8B,gBAA9B,EAAgD,MAAhD,EAAwD,KAAxD,EAA+D,KAA/D,CAAZ,EAAmF,UAAU0d,MAAV,EAAkB;UAC/FC,KAAKzC,WAAWwC,MAAX,CAAT;UACIE,KAAKH,IAAIC,MAAJ,CAAT;iBACWA,MAAX,IAAqBD,IAAIC,MAAJ,IAAc,YAAY;YACzC7c,OAAOrB,MAAMC,SAAN,CAAgBG,KAAhB,CAAsBK,IAAtB,CAA2BC,SAA3B,CAAX;WACGa,KAAH,CAAS0c,GAAT,EAAc5c,IAAd;eACO8c,GAAG5c,KAAH,CAASma,UAAT,EAAqBra,IAArB,CAAP;OAHF;KAHF;QASI4L,QAAJ,CAAakP,EAAb,EAAiB,YAAjB;eACWxT,UAAX,CAAsBoR,YAAtB,CAAmCkE,IAAItV,UAAvC,EAAmD+S,WAAW/S,UAAX,CAAsBqV,iBAAzE;GAZF,MAaO,IAAItC,sBAAsBrK,mBAA1B,EAA+C;QAChDnS,IAAI,SAASA,CAAT,CAAWmf,QAAX,EAAqB;UACvBhe,OAAO0C,QAAP,CAAgB2Y,WAAWtL,KAA3B,KAAqC/P,OAAO0C,QAAP,CAAgB2Y,WAAWrL,KAA3B,CAAzC,EAA4E;YACtEiO,UAAU5C,WAAWE,IAAX,CAAgBoC,iBAAhB,CAAkCA,iBAAlC,CAAoDxf,SAAlE;YACI+f,eAAe7C,WAAWgC,KAAX,CAAiBxF,WAAjB,CAA6B9K,OAA7B,CAAqCsO,UAArC,IAAmD,CAAC,CAAvE;mBACWD,MAAX;YACIvG,gBAAgBqG,KAAKP,GAAL,EAAUU,WAAWjV,MAArB,EAA6BiV,WAAWhV,QAAxC,EAAkD;kBAC5DgV,WAAWE,IAAX,CAAgBiC,kBAD4C;uBAEvD,CAACnC,WAAWtL,KAAZ,EAAmBsL,WAAWrL,KAA9B,EAAqCqL,WAAWpL,MAAhD;SAFK,CAApB;sBAIc2I,IAAd,CAAmBqF,OAAnB;YACIC,YAAJ,EAAkBrJ,cAAcgI,MAAd;eACXhI,aAAP;;aAEKmJ,QAAP;KAbF;eAeWxZ,GAAX,GAAiBxE,OAAOc,OAAP,CAAejC,CAAf,EAAkBwc,WAAW7W,GAA7B,CAAjB;eACWC,GAAX,GAAiBzE,OAAOc,OAAP,CAAejC,CAAf,EAAkBwc,WAAW5W,GAA7B,CAAjB;GAjBK,MAkBA,IAAI4W,sBAAsB7M,iBAA1B,EAA6C;QAC9C5N,IAAJ,CAASkb,EAAT,EAAa,OAAb,EAAsB,YAAY;UAC5BrR,SAAJ,CAAc4Q,WAAWxM,UAAzB,EAAqC,OAArC;KADF;QAGIjO,IAAJ,CAASya,WAAWxM,UAApB,EAAgC,OAAhC,EAAyC,UAAU1F,CAAV,EAAa;QAClDgV,eAAF;KADF;GAJK,MAOA,IAAI9C,sBAAsB5I,kBAA1B,EAA8C;QAC/C7R,IAAJ,CAASkb,EAAT,EAAa,OAAb,EAAsB,YAAY;UAC5BrR,SAAJ,CAAc4Q,WAAW1I,QAAzB,EAAmC,OAAnC;KADF;QAGI/R,IAAJ,CAASkb,EAAT,EAAa,WAAb,EAA0B,YAAY;UAChClP,QAAJ,CAAayO,WAAW1I,QAAxB,EAAkC,OAAlC;KADF;QAGI/R,IAAJ,CAASkb,EAAT,EAAa,UAAb,EAAyB,YAAY;UAC/B3O,WAAJ,CAAgBkO,WAAW1I,QAA3B,EAAqC,OAArC;KADF;GAPK,MAUA,IAAI0I,sBAAsBxI,eAA1B,EAA2C;QAC5CjG,QAAJ,CAAakP,EAAb,EAAiB,OAAjB;eACWjT,aAAX,GAA2B7I,OAAOc,OAAP,CAAe,UAAUwI,GAAV,EAAe;SACpDvL,KAAH,CAASqgB,eAAT,GAA2B/C,WAAWvI,OAAX,CAAmBlU,QAAnB,EAA3B;aACO0K,GAAP;KAFyB,EAGxB+R,WAAWxS,aAHa,CAA3B;eAIWA,aAAX;;aAESF,QAAX,GAAsB3I,OAAOc,OAAP,CAAe,UAAUwI,GAAV,EAAe;QAC9CqR,IAAIjC,OAAJ,GAAcyE,eAAd,IAAiC9B,WAAWtS,UAAX,EAArC,EAA8D;yBACzC4R,IAAIjC,OAAJ,EAAnB,EAAkC,IAAlC;;WAEKpP,GAAP;GAJoB,EAKnB+R,WAAW1S,QALQ,CAAtB;;AAOF,SAAS0V,gBAAT,CAA0B1D,GAA1B,EAA+BU,UAA/B,EAA2C;MACrCZ,OAAOE,IAAIjC,OAAJ,EAAX;MACI4F,eAAe7D,KAAK9C,mBAAL,CAAyB5K,OAAzB,CAAiCsO,WAAWjV,MAA5C,CAAnB;MACIkY,iBAAiB,CAAC,CAAtB,EAAyB;QACnBC,gBAAgB9D,KAAK7C,sCAAL,CAA4C0G,YAA5C,CAApB;QACIC,kBAAkBpc,SAAtB,EAAiC;sBACf,EAAhB;WACKyV,sCAAL,CAA4C0G,YAA5C,IAA4DC,aAA5D;;kBAEYlD,WAAWhV,QAAzB,IAAqCgV,UAArC;QACIZ,KAAK1F,IAAL,IAAa0F,KAAK1F,IAAL,CAAUyH,UAA3B,EAAuC;UACjCgC,YAAY/D,KAAK1F,IAAL,CAAUyH,UAA1B;UACIxE,SAAS,KAAK,CAAlB;UACIwG,UAAU7D,IAAI3C,MAAd,CAAJ,EAA2B;iBAChBwG,UAAU7D,IAAI3C,MAAd,CAAT;OADF,MAEO,IAAIwG,UAAUxH,2BAAV,CAAJ,EAA4C;iBACxCwH,UAAUxH,2BAAV,CAAT;OADK,MAEA;;;UAGHgB,OAAOsG,YAAP,KAAwBtG,OAAOsG,YAAP,EAAqBjD,WAAWhV,QAAhC,MAA8ClE,SAA1E,EAAqF;YAC/E6C,QAAQgT,OAAOsG,YAAP,EAAqBjD,WAAWhV,QAAhC,CAAZ;mBACWgC,YAAX,GAA0BrD,KAA1B;mBACW2D,QAAX,CAAoB3D,KAApB;;;;;AAKR,SAASkW,IAAT,CAAcP,GAAd,EAAmBvU,MAAnB,EAA2BC,QAA3B,EAAqCwE,MAArC,EAA6C;MACvC4T,YAAJ;MACIrY,OAAO/F,SAAX,EAAsB;mBACL+F,MAAf;aACSqY,aAAape,SAAb,CAAuB+F,MAAhC;eACWqY,aAAape,SAAb,CAAuBgG,QAAlC;aACS;mBACMoY,aAAape,SAAb,CAAuB2O;KADtC;;MAIEyP,iBAAiBtc,SAAjB,IAA8BiE,OAAOC,QAAP,MAAqBlE,SAAvD,EAAkE;UAC1D,IAAIoF,KAAJ,CAAU,aAAanB,MAAb,GAAsB,qBAAtB,GAA8CC,QAA9C,GAAyD,GAAnE,CAAN;;MAEEgV,aAAa,KAAK,CAAtB;MACIxQ,OAAOtM,KAAX,EAAkB;iBACH,IAAIsU,eAAJ,CAAoBzM,MAApB,EAA4BC,QAA5B,CAAb;GADF,MAEO,IAAIoY,iBAAiBtc,SAAjB,IAA8B,OAAOsc,aAAapY,QAApB,KAAiC,QAAnE,EAA6E;iBACrEoY,YAAb;GADK,MAEA;QACDC,cAAc,CAACtY,MAAD,EAASC,QAAT,EAAmBsY,MAAnB,CAA0B9T,OAAO6T,WAAjC,CAAlB;iBACa/J,kBAAkBzT,KAAlB,CAAwByZ,GAAxB,EAA6B+D,WAA7B,CAAb;;MAEErD,eAAe,IAAnB,EAAyBA,aAAaoD,YAAb,CAAzB,KAAwD,IAAIA,iBAAiBtc,SAArB,EAAgCsc,aAAapD,UAAb,GAA0BA,UAA1B;MACpFxQ,OAAO+T,MAAP,YAAyBxW,UAA7B,EAAyC;WAChCwW,MAAP,GAAgB/T,OAAO+T,MAAP,CAAcrD,IAA9B;;mBAEeZ,GAAjB,EAAsBU,UAAtB;MACIzO,QAAJ,CAAayO,WAAW/S,UAAxB,EAAoC,GAApC;MACIsQ,OAAO5a,SAASC,aAAT,CAAuB,MAAvB,CAAX;MACI2O,QAAJ,CAAagM,IAAb,EAAmB,eAAnB;MACI6F,iBAAiBtc,SAAjB,IAA8B8C,UAAQwZ,aAAapY,QAArB,MAAmC,QAArE,EAA+E;SACxE,IAAIwY,YAAT,IAAyBJ,aAAapY,QAAtC,EAAgD;WACzChI,WAAL,CAAiBogB,aAAapY,QAAb,CAAsBwY,YAAtB,CAAjB;;GAFJ,MAIOjG,KAAKza,SAAL,GAAiBkd,WAAWhV,QAA5B;MACHyY,YAAY9gB,SAASC,aAAT,CAAuB,KAAvB,CAAhB;YACUI,WAAV,CAAsBua,IAAtB;YACUva,WAAV,CAAsBgd,WAAW/S,UAAjC;MACIwT,KAAK/B,OAAOY,GAAP,EAAYmE,SAAZ,EAAuBjU,OAAO+T,MAA9B,CAAT;MACIhS,QAAJ,CAAakP,EAAb,EAAiBvE,IAAIqD,oBAArB;MACIS,sBAAsBxI,eAA1B,EAA2C;QACrCjG,QAAJ,CAAakP,EAAb,EAAiB,OAAjB;GADF,MAEO;QACDlP,QAAJ,CAAakP,EAAb,EAAiB7W,UAAQoW,WAAWvS,QAAX,EAAR,CAAjB;;oBAEgB6R,GAAlB,EAAuBmB,EAAvB,EAA2BT,UAA3B;MACI3D,aAAJ,CAAkB1K,IAAlB,CAAuBqO,UAAvB;SACOA,UAAP;;AAEF,SAAS/C,mBAAT,CAA6BqC,GAA7B,EAAkCja,GAAlC,EAAuC;SAC9B1C,SAAS+gB,QAAT,CAAkBxQ,IAAlB,GAAyB,GAAzB,GAA+B7N,GAAtC;;AAEF,SAASse,eAAT,CAAyBrE,GAAzB,EAA8B/B,IAA9B,EAAoCqG,WAApC,EAAiD;MAC3C5P,MAAMrR,SAASC,aAAT,CAAuB,QAAvB,CAAV;MACIE,SAAJ,GAAgBya,IAAhB;MACI5T,KAAJ,GAAY4T,IAAZ;MACIuE,eAAJ,CAAoB9e,WAApB,CAAgCgR,GAAhC;MACI4P,WAAJ,EAAiB;QACX9B,eAAJ,CAAoB5N,aAApB,GAAoCoL,IAAIwC,eAAJ,CAAoB1d,MAApB,GAA6B,CAAjE;;;AAGJ,SAASyf,eAAT,CAAyBvE,GAAzB,EAA8BwE,OAA9B,EAAuC;UAC7BphB,KAAR,CAAcuY,OAAd,GAAwBqE,IAAIvC,eAAJ,GAAsB,OAAtB,GAAgC,MAAxD;;AAEF,SAASgH,WAAT,CAAqBzE,GAArB,EAA0B;MACpB0E,MAAM1E,IAAIyB,UAAJ,GAAiBpe,SAASC,aAAT,CAAuB,IAAvB,CAA3B;MACI2O,QAAJ,CAAa+N,IAAIrS,UAAjB,EAA6B,UAA7B;MACIkP,IAAJ,CAASkC,YAAT,CAAsB2F,GAAtB,EAA2B1E,IAAInD,IAAJ,CAAS8H,UAApC;MACI1S,QAAJ,CAAayS,GAAb,EAAkB,UAAlB;MACIE,QAAQvhB,SAASC,aAAT,CAAuB,MAAvB,CAAZ;QACME,SAAN,GAAkB,QAAlB;MACIyO,QAAJ,CAAa2S,KAAb,EAAoB,cAApB;MACIC,SAASxhB,SAASC,aAAT,CAAuB,MAAvB,CAAb;SACOE,SAAP,GAAmB,MAAnB;MACIyO,QAAJ,CAAa4S,MAAb,EAAqB,QAArB;MACI5S,QAAJ,CAAa4S,MAAb,EAAqB,MAArB;MACIC,UAAUzhB,SAASC,aAAT,CAAuB,MAAvB,CAAd;UACQE,SAAR,GAAoB,KAApB;MACIyO,QAAJ,CAAa6S,OAAb,EAAsB,QAAtB;MACI7S,QAAJ,CAAa6S,OAAb,EAAsB,SAAtB;MACIC,UAAU1hB,SAASC,aAAT,CAAuB,MAAvB,CAAd;UACQE,SAAR,GAAoB,QAApB;MACIyO,QAAJ,CAAa8S,OAAb,EAAsB,QAAtB;MACI9S,QAAJ,CAAa8S,OAAb,EAAsB,QAAtB;MACIC,SAAShF,IAAIwC,eAAJ,GAAsBnf,SAASC,aAAT,CAAuB,QAAvB,CAAnC;MACI0c,IAAI5F,IAAJ,IAAY4F,IAAI5F,IAAJ,CAASyH,UAAzB,EAAqC;WAC5Brc,IAAP,CAAYwa,IAAI5F,IAAJ,CAASyH,UAArB,EAAiC,UAAUxX,KAAV,EAAiBtE,GAAjB,EAAsB;sBACrCia,GAAhB,EAAqBja,GAArB,EAA0BA,QAAQia,IAAI3C,MAAtC;KADF;GADF,MAIO;oBACW2C,GAAhB,EAAqB3D,2BAArB,EAAkD,KAAlD;;MAEEpW,IAAJ,CAAS+e,MAAT,EAAiB,QAAjB,EAA2B,YAAY;SAChC,IAAItS,QAAQ,CAAjB,EAAoBA,QAAQsN,IAAIwC,eAAJ,CAAoB1d,MAAhD,EAAwD4N,OAAxD,EAAiE;UAC3D8P,eAAJ,CAAoB9P,KAApB,EAA2BlP,SAA3B,GAAuCwc,IAAIwC,eAAJ,CAAoB9P,KAApB,EAA2BrI,KAAlE;;QAEEgT,MAAJ,GAAa,KAAKhT,KAAlB;GAJF;MAMI3G,WAAJ,CAAgBshB,MAAhB;MACIthB,WAAJ,CAAgBkhB,KAAhB;MACIlhB,WAAJ,CAAgBmhB,MAAhB;MACInhB,WAAJ,CAAgBohB,OAAhB;MACIphB,WAAJ,CAAgBqhB,OAAhB;MACIzI,sBAAJ,EAA4B;QACtBkI,UAAUnhB,SAAS4hB,cAAT,CAAwB,kBAAxB,CAAd;QACIC,uBAAuB7hB,SAAS4hB,cAAT,CAAwB,kBAAxB,CAA3B;QACIE,cAAc9hB,SAAS4hB,cAAT,CAAwB,iBAAxB,CAAlB;gBACY7hB,KAAZ,CAAkBuY,OAAlB,GAA4B,OAA5B;QACIY,aAAamB,OAAb,CAAqBC,oBAAoBqC,GAApB,EAAyB,SAAzB,CAArB,MAA8D,MAAlE,EAA0E;2BACnDzc,YAArB,CAAkC,SAAlC,EAA6C,SAA7C;;oBAEcyc,GAAhB,EAAqBwE,OAArB;QACIve,IAAJ,CAASif,oBAAT,EAA+B,QAA/B,EAAyC,YAAY;UAC/CzH,eAAJ,GAAsB,CAACuC,IAAIvC,eAA3B;sBACgBuC,GAAhB,EAAqBwE,OAArB;KAFF;;MAKEY,yBAAyB/hB,SAAS4hB,cAAT,CAAwB,oBAAxB,CAA7B;MACIhf,IAAJ,CAASmf,sBAAT,EAAiC,SAAjC,EAA4C,UAAU5W,CAAV,EAAa;QACnDA,EAAE4C,OAAF,KAAc5C,EAAE6R,KAAF,KAAY,EAAZ,IAAkB7R,EAAE6C,OAAF,KAAc,EAA9C,CAAJ,EAAuD;oBACvCoK,IAAd;;GAFJ;MAKIxV,IAAJ,CAAS2e,KAAT,EAAgB,OAAhB,EAAyB,YAAY;2BACZphB,SAAvB,GAAmCmb,KAAKe,SAAL,CAAeM,IAAIL,aAAJ,EAAf,EAAoCnY,SAApC,EAA+C,CAA/C,CAAnC;kBACckU,IAAd;2BACuB2J,KAAvB;2BACuBL,MAAvB;GAJF;MAMI/e,IAAJ,CAAS4e,MAAT,EAAiB,OAAjB,EAA0B,YAAY;QAChC9C,IAAJ;GADF;MAGI9b,IAAJ,CAAS6e,OAAT,EAAkB,OAAlB,EAA2B,YAAY;QACjC7C,aAAaqD,OAAO,0BAAP,CAAjB;QACIrD,UAAJ,EAAgB;UACVD,MAAJ,CAAWC,UAAX;;GAHJ;MAMIhc,IAAJ,CAAS8e,OAAT,EAAkB,OAAlB,EAA2B,YAAY;QACjC/G,MAAJ;GADF;;AAIF,SAASuH,eAAT,CAAyBvF,GAAzB,EAA8B;MACxBwF,UAAU,KAAK,CAAnB;MACI9D,eAAJ,GAAsBre,SAASC,aAAT,CAAuB,KAAvB,CAAtB;SACOgC,MAAP,CAAc0a,IAAI0B,eAAJ,CAAoBte,KAAlC,EAAyC;WAChC,KADgC;gBAE3B,MAF2B;YAG/B,OAH+B;YAI/B,WAJ+B;cAK7B;GALZ;WAOSqiB,IAAT,CAAcjX,CAAd,EAAiB;MACb+I,cAAF;QACIvE,KAAJ,IAAawS,UAAUhX,EAAE8B,OAAzB;QACI8N,QAAJ;cACU5P,EAAE8B,OAAZ;WACO,KAAP;;WAEOoV,QAAT,GAAoB;QACdlT,WAAJ,CAAgBwN,IAAI3B,aAApB,EAAmCzB,IAAIuD,UAAvC;QACIrO,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgCsiB,IAAhC;QACI3T,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8BuiB,QAA9B;;WAEOC,SAAT,CAAmBnX,CAAnB,EAAsB;MAClB+I,cAAF;cACU/I,EAAE8B,OAAZ;QACI2B,QAAJ,CAAa+N,IAAI3B,aAAjB,EAAgCzB,IAAIuD,UAApC;QACIla,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8BsiB,IAA9B;QACIxf,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4BuiB,QAA5B;WACO,KAAP;;MAEEzf,IAAJ,CAAS+Z,IAAI0B,eAAb,EAA8B,WAA9B,EAA2CiE,SAA3C;MACI1f,IAAJ,CAAS+Z,IAAI3B,aAAb,EAA4B,WAA5B,EAAyCsH,SAAzC;MACIhY,UAAJ,CAAeoR,YAAf,CAA4BiB,IAAI0B,eAAhC,EAAiD1B,IAAIrS,UAAJ,CAAeqV,iBAAhE;;AAEF,SAAS4C,QAAT,CAAkB5F,GAAlB,EAAuB6F,CAAvB,EAA0B;MACpBlY,UAAJ,CAAevK,KAAf,CAAqB4P,KAArB,GAA6B6S,IAAI,IAAjC;MACI7F,IAAIyB,UAAJ,IAAkBzB,IAAI5C,SAA1B,EAAqC;QAC/BqE,UAAJ,CAAere,KAAf,CAAqB4P,KAArB,GAA6B6S,IAAI,IAAjC;;MAEE7F,IAAI3B,aAAR,EAAuB;QACjBA,aAAJ,CAAkBjb,KAAlB,CAAwB4P,KAAxB,GAAgC6S,IAAI,IAApC;;;AAGJ,SAAS/D,gBAAT,CAA0B9B,GAA1B,EAA+B8F,gBAA/B,EAAiD;MAC3Cld,WAAW,EAAf;SACOpD,IAAP,CAAYwa,IAAIhD,mBAAhB,EAAqC,UAAUrO,GAAV,EAAe+D,KAAf,EAAsB;QACrDqT,cAAc,EAAlB;QACInC,gBAAgB5D,IAAI/C,sCAAJ,CAA2CvK,KAA3C,CAApB;WACOlN,IAAP,CAAYoe,aAAZ,EAA2B,UAAUlD,UAAV,EAAsBhV,QAAtB,EAAgC;kBAC7CA,QAAZ,IAAwBoa,mBAAmBpF,WAAWhT,YAA9B,GAA6CgT,WAAWvS,QAAX,EAArE;KADF;aAGSuE,KAAT,IAAkBqT,WAAlB;GANF;SAQOnd,QAAP;;AAEF,SAASod,oBAAT,CAA8BhG,GAA9B,EAAmC;OAC5B,IAAItN,QAAQ,CAAjB,EAAoBA,QAAQsN,IAAIwC,eAAJ,CAAoB1d,MAAhD,EAAwD4N,OAAxD,EAAiE;QAC3DsN,IAAIwC,eAAJ,CAAoB9P,KAApB,EAA2BrI,KAA3B,KAAqC2V,IAAI3C,MAA7C,EAAqD;UAC/CmF,eAAJ,CAAoB5N,aAApB,GAAoClC,KAApC;;;;AAIN,SAASuT,cAAT,CAAwBC,eAAxB,EAAyC;MACnCA,gBAAgBphB,MAAhB,KAA2B,CAA/B,EAAkC;4BACRW,IAAxB,CAA6BtC,MAA7B,EAAqC,YAAY;qBAChC+iB,eAAf;KADF;;SAIK1gB,IAAP,CAAY0gB,eAAZ,EAA6B,UAAUvc,CAAV,EAAa;MACtCuE,aAAF;GADF;;AAKF,AAKA,IAAIiY,cAAc;cACJ1Y,UADI;qBAEGoG,iBAFH;oBAGEO,gBAHF;oBAIES,gBAJF;oBAKEK,gBALF;uBAMKmB,mBANL;0BAOQc,sBAPR;sBAQIW,kBARJ;mBASCI,eATD;oBAUE+B;CAVpB;;ACz+EC;;;;;;;;;;;;;AAcD,IAAImM,mBAAmB;YAUX,mBAAW5iB,SAAX,EAAsB8Q,OAAtB,EAAgC;YAEhCA,WAAW,EAArB;MACIuQ,SAASxhB,SAASC,aAAT,CAAwB,MAAxB,CAAb;SACOE,SAAP,GAAmBA,SAAnB;MACK8Q,QAAQ+R,KAAR,KAAkB7e,SAAvB,EACCqd,OAAOwB,KAAP,GAAe/R,QAAQ+R,KAAvB;MACI/R,QAAQgS,OAAR,KAAoB9e,SAAzB,EAAqC;UAE7BpE,KAAP,CAAamjB,MAAb,GAAsB,SAAtB;UACOD,OAAP,GAAiBhS,QAAQgS,OAAzB;;MAGIhS,QAAQkS,OAAR,KAAoBhf,SAAzB,EAAqC;OAoB3Bif,OApB2B,GAoBpC,SAASA,OAAT,CAAkBjY,CAAlB,EAAsB;QACjBA,KAAKrL,OAAOsO,KAAhB;QAGI1H,QAAQyE,EAAEkY,MAAF,IAAYlY,EAAEmY,MAAd,IAAwBnY,EAAEoY,UAAtC;YACQJ,OAAR,CAAiBzc,KAAjB;IAzBmC;UAE7B3G,KAAP,CAAamjB,MAAb,GAAsB,UAAtB;OAGK1B,OAAOjT,gBAAZ,EAA+B;QACzB,aAAavO,QAAlB,EAA6B;YAErBuO,gBAAP,CAAyB,OAAzB,EAAkC6U,OAAlC;KAFD,MAGO,IAAK,kBAAkBpjB,QAAvB,EAAkC;YAEjCuO,gBAAP,CAAyB,YAAzB,EAAuC6U,OAAvC;KAFM,MAGA;YAEC7U,gBAAP,CAAyB,qBAAzB,EAAgD6U,OAAhD;;IATF,MAWO;WACC5U,WAAP,CAAoB,cAApB,EAAoC4U,OAApC;;;SAaKrjB,KAAP,CAAayjB,MAAb,GAAsB,SAAtB;SACOhC,MAAP;;CAtDF;;ACdA;;;;;;;;;;;;;AAyBA,IAAIiC,MAAJ;IAAYC,IAAZ;IAEMC;kBAKS;;;;;uBAIHC,OAAQ;OAEbH,MAAL,EAAc;QAER,CAAChhB,OAAOohB,EAAP,CAAWD,KAAX,EAAkBH,MAAlB,CAAN,EACCK,QAAQC,KAAR,CAAe,uEAAf;;;YAIOH,KAAT;;;yBAMW;OAENH,WAAWtf,SAAhB,EACC2f,QAAQC,KAAR,CAAe,6BAA6BN,MAA7B,GAAsC,mCAArD;UACMA,MAAP;;;;uBAMQO,KAAM;OAETN,IAAL,EAAY;QAEN,CAACjhB,OAAOohB,EAAP,CAAWG,GAAX,EAAgBN,IAAhB,CAAN,EACCI,QAAQC,KAAR,CAAe,mEAAf;;;UAIKC,GAAP;;;yBAMS;UAMFN,IAAP;;;;;AAMF,IAAIO,KAAJ;AACAnkB,OAAOokB,WAAP,GAAqBpkB,OAAOokB,WAAP,IAAsB,EAA3C;AACA,IAAKpkB,OAAOokB,WAAP,CAAmBD,KAAxB,EAAgC;SAIvBnkB,OAAOokB,WAAP,CAAmBD,KAA3B;CAJD,MAMO;SAEE,IAAIN,KAAJ,EAAR;OACMQ,OAAN,GAAgB,YAAU;SAASV,MAAP;EAA5B;QACOS,WAAP,CAAmBD,KAAnB,GAA2BA,KAA3B;;AAID,cAAeA,KAAf;;ACxGA;;;;;;;;;;;;;;;;;AAmBA,IAMMG;;0BAmCQnB,QAAb,EAAsBhS,OAAtB,EAAgC;;YAErBA,WAAW,EAArB;UACQoT,QAAR,GAAmBpT,QAAQoT,QAAR,IAAoB,EAAvC;UACQA,QAAR,CAAiBC,cAAjB,GAAkCrT,QAAQoT,QAAR,CAAiBC,cAAjB,IAAmC,GAArE;+HAEO;eAEMrT,QAAQoT,QAAR,CAAiBC,cAFvB;aAGI,kBAAWC,gBAAX,EAA8B;QAKnCC,OAAO;WAGJ,MAHI;SAIN,IAJM;UAKL,KALK;gBAMC;KANZ;QAUIC,gBAAgBxT,QAAQyT,eAAR,KAA4BvgB,SAA5B,GAAwC,IAAxC;MACjB8M,QAAQyT,eAAR,EADH;YAESD,aAAT;UAEM,IAAL;WAGME,IAAL,GAAY,UAAZ;WACKC,EAAL,GAAU,WAAV;WACKC,GAAL,GAAW,WAAX;WACKC,SAAL,GAAiB,iDAAjB;;;UAIO7T,QAAQuT,IAAR,KAAiBrgB,SAAnB,IAAoC8M,QAAQuT,IAAR,CAAaO,YAAb,IAA6BN,aAAtE,EACC;aAEMliB,IAAP,CAAa0O,QAAQuT,IAArB,EAA4B3iB,OAA5B,CAAqC,UAAWa,GAAX,EAAiB;WAEhD8hB,KAAK9hB,GAAL,MAAcyB,SAAnB,EACC;YACIzB,GAAL,IAAYuO,QAAQuT,IAAR,CAAa9hB,GAAb,CAAZ;OAJD;;QAYEsiB,UAAU,EAAd;QACCC,YAAYlC,iBAAiBkC,SAD9B;YAEQC,SAAR,GAAoBD,UAAWT,KAAKG,IAAhB,EAAsB;YAElCH,KAAKM,SAF6B;cAGhC,iBAAWpe,KAAX,EAAmB;eAElB6d,gBAAT,EAA2B,UAAWvd,KAAX,EAAkB2d,IAAlB,EAAyB;WAE9Cje,QAAQ,CAAb,EACCM,SAAS2d,IAAT,CADD,KAEK3d,SAAS2d,IAAT;cACE3d,KAAP;OALD;;KALkB,CAApB;YAiBQ4d,EAAR,GAAaK,UAAW,GAAX,EAAgB;YAErBT,KAAKI,EAFgB;cAGnB,mBAAY;eAEXL,gBAAT,EAA2B,UAAWvd,KAAX,EAAkB2d,IAAlB,EAAyB;gBAE1CA,IAAT;cACO3d,KAAP;OAHD;;KALW,CAAb;YAeQ6d,GAAR,GAAcI,UAAW,GAAX,EAAgB;YAEtBT,KAAKK,GAFiB;cAGpB,mBAAY;eAEXN,gBAAT,EAA2B,UAAWvd,KAAX,EAAkB2d,IAAlB,EAAyB;gBAE1CA,IAAT;cACO3d,KAAP;OAHD;;KALY,CAAd;WAeOge,OAAP;;GAtG6B,EA0G5B,YA1G4B,EA0Gd,GA1Gc,EA0GT,EA1GS,EA0GL,GA1GK;MA2G1B,MAAK3c,QAAL,KAAkBlE,SAAvB,EACC2f,QAAQC,KAAR,CAAe,oBAAoB,MAAK1b,QAAxC;;;;EA/I2Bya,YAAYlM;;ACzB1C;;;;;;;;;;;;;;;;AAkBA,IAGMuO;;gCAeQC,iBAAb,EAAgCnU,OAAhC,EAA0C;;kBAE/BA,WAAW,EAArB;gBACQoT,QAAR,GAAmBpT,QAAQoT,QAAR,IAAoB,EAAvC;YACIA,WAAWpT,QAAQoT,QAAvB;gBAEQ7d,GAAR,GAAcyK,QAAQzK,GAAR,IAAe,GAA7B;gBACQC,GAAR,GAAcwK,QAAQxK,GAAR,IAAe,EAA7B;iBAESuJ,MAAT,GAAkBqU,SAASrU,MAAT,IAAmB,GAArC;gBACQkC,IAAR,GAAejB,QAAQiB,IAAR,IAAgB,GAA/B;2IAEO;oBAEEmS,SAASrU,MAFX;sBAGI,kBAAWuU,gBAAX,EAA8B;oBAInCC,OAAO;4BAGF,QAHE;yBAIL,KAJK;8BAKA,UALA;mCAMK;iBANhB;oBAUIC,gBAAgBxT,QAAQyT,eAAR,KAA4BvgB,SAA5B,GAAwC,IAAxC;kBACjB8M,QAAQyT,eAAR,EADH;wBAESD,aAAT;yBAEM,IAAL;6BAGMzU,MAAL,GAAc,OAAd;6BACKiN,GAAL,GAAW,UAAX;6BACKoI,QAAL,GAAgB,SAAhB;6BACKC,aAAL,GAAqB,gDAArB;;;4BAIOrU,QAAQuT,IAAR,KAAiBrgB,SAAnB,IAAoC8M,QAAQuT,IAAR,CAAaO,YAAb,IAA6BN,aAAtE,EACC;+BAEMliB,IAAP,CAAa0O,QAAQuT,IAArB,EAA4B3iB,OAA5B,CAAqC,UAAWa,GAAX,EAAiB;gCAEhD8hB,KAAK9hB,GAAL,MAAcyB,SAAnB,EACC;iCACIzB,GAAL,IAAYuO,QAAQuT,IAAR,CAAa9hB,GAAb,CAAZ;yBAJD;;oBAYEsiB,UAAU,EAAd;oBAAkBC,YAAYlC,iBAAiBkC,SAA/C;wBACQM,KAAR,GAAgBN,UAAWT,KAAKxU,MAAhB,EAAwB;2BAEhCwU,KAAKc,aAF2B;6BAG9B,iBAAW5e,KAAX,EAAmB;4BAEvB8e,QAAQjB,iBAAiBlH,UAAjB,CAA4BvS,QAA5B,EAAZ;0CACmBpE,QAAQ,CAAR,GAAY8e,KAAZ,GAAoB,CAAEA,KAAzC;;iBANc,CAAhB;wBAWQZ,EAAR,GAAaK,UAAW,GAAX,EAAgB;2BAErBT,KAAKvH,GAFgB;6BAGnB,mBAAY;0CAEDsH,iBAAiBlH,UAAjB,CAA4BvS,QAA5B,EAAnB;;iBALW,CAAb;wBAUQ+Z,GAAR,GAAcI,UAAW,GAAX,EAAgB;2BAEtBT,KAAKa,QAFiB;6BAGpB,mBAAY;0CAED,CAAEd,iBAAiBlH,UAAjB,CAA4BvS,QAA5B,EAArB;;iBALY,CAAd;uBAUOka,OAAP;;SA1FuC,EA8FtC,QA9FsC,EA8F5B/T,QAAQzK,GA9FoB,EA8FfyK,QAAQxK,GA9FO,EA8FFwK,QAAQiB,IA9FN;YA+FpC,MAAK7J,QAAL,KAAkBlE,SAAvB,EACC2f,QAAQC,KAAR,CAAe,oBAAoB,MAAK1b,QAAxC;;;;EA/G8Bya,YAAYlM;;ACR7C,SAAShX,iBAAT,CAAyBC,GAAzB,EAA8B;MACxB,CAACA,GAAL,EAAU;;;MAGN,OAAOC,MAAP,KAAkB,WAAtB,EAAmC;;;MAI/BC,QAAQC,SAASC,aAAT,CAAuB,OAAvB,CAAZ;QAEMC,YAAN,CAAmB,MAAnB,EAA2B,UAA3B;QACMC,SAAN,GAAkBN,GAAlB;WACSO,IAAT,CAAcC,WAAd,CAA0BN,KAA1B;SAEOF,GAAP;;AAGF,SAASS,eAAT,CAAwBC,KAAxB,EAA+BC,WAA/B,EAA4C;MACtCC,cAAcF,MAAMG,OAAN,CAAcC,cAAd,CAA6BC,QAA7B,EAAlB;MACIC,IAAIC,KAAKC,KAAL,CAAWR,MAAMM,CAAjB,CAAR;MACIG,IAAIF,KAAKC,KAAL,CAAWR,MAAMS,CAAjB,CAAR;MACIC,IAAIH,KAAKC,KAAL,CAAWR,MAAMU,CAAjB,CAAR;MACIC,IAAIX,MAAMW,CAAd;MACIC,IAAIL,KAAKC,KAAL,CAAWR,MAAMY,CAAjB,CAAR;MACIC,IAAIb,MAAMa,CAAN,CAAQC,OAAR,CAAgB,CAAhB,CAAR;MACIC,IAAIf,MAAMe,CAAN,CAAQD,OAAR,CAAgB,CAAhB,CAAR;MACIb,eAAeC,gBAAgB,gBAA/B,IAAmDA,gBAAgB,cAAvE,EAAuF;QACjFc,MAAMhB,MAAMiB,GAAN,CAAUZ,QAAV,CAAmB,EAAnB,CAAV;WACOW,IAAIE,MAAJ,GAAa,CAApB,EAAuB;YACf,MAAMF,GAAZ;;WAEK,MAAMA,GAAb;GALF,MAMO,IAAId,gBAAgB,SAApB,EAA+B;WAC7B,SAASI,CAAT,GAAa,GAAb,GAAmBG,CAAnB,GAAuB,GAAvB,GAA6BC,CAA7B,GAAiC,GAAxC;GADK,MAEA,IAAIR,gBAAgB,UAApB,EAAgC;WAC9B,UAAUI,CAAV,GAAc,GAAd,GAAoBG,CAApB,GAAwB,GAAxB,GAA8BC,CAA9B,GAAkC,GAAlC,GAAwCC,CAAxC,GAA4C,GAAnD;GADK,MAEA,IAAIT,gBAAgB,KAApB,EAA2B;WACzB,OAAOF,MAAMiB,GAAN,CAAUZ,QAAV,CAAmB,EAAnB,CAAd;GADK,MAEA,IAAIH,gBAAgB,WAApB,EAAiC;WAC/B,MAAMI,CAAN,GAAU,GAAV,GAAgBG,CAAhB,GAAoB,GAApB,GAA0BC,CAA1B,GAA8B,GAArC;GADK,MAEA,IAAIR,gBAAgB,YAApB,EAAkC;WAChC,MAAMI,CAAN,GAAU,GAAV,GAAgBG,CAAhB,GAAoB,GAApB,GAA0BC,CAA1B,GAA8B,GAA9B,GAAoCC,CAApC,GAAwC,GAA/C;GADK,MAEA,IAAIT,gBAAgB,SAApB,EAA+B;WAC7B,QAAQI,CAAR,GAAY,KAAZ,GAAoBG,CAApB,GAAwB,KAAxB,GAAgCC,CAAhC,GAAoC,GAA3C;GADK,MAEA,IAAIR,gBAAgB,UAApB,EAAgC;WAC9B,QAAQI,CAAR,GAAY,KAAZ,GAAoBG,CAApB,GAAwB,KAAxB,GAAgCC,CAAhC,GAAoC,KAApC,GAA4CC,CAA5C,GAAgD,GAAvD;GADK,MAEA,IAAIT,gBAAgB,SAApB,EAA+B;WAC7B,QAAQU,CAAR,GAAY,KAAZ,GAAoBC,CAApB,GAAwB,KAAxB,GAAgCE,CAAhC,GAAoC,GAA3C;GADK,MAEA,IAAIb,gBAAgB,UAApB,EAAgC;WAC9B,QAAQU,CAAR,GAAY,KAAZ,GAAoBC,CAApB,GAAwB,KAAxB,GAAgCE,CAAhC,GAAoC,KAApC,GAA4CJ,CAA5C,GAAgD,GAAvD;;SAEK,gBAAP;;AAGF,IAAIQ,aAAWC,MAAMC,SAAN,CAAgBC,OAA/B;AACA,IAAIC,cAAYH,MAAMC,SAAN,CAAgBG,KAAhC;AACA,IAAIC,WAAS;SACJ,EADI;UAEH,SAASC,MAAT,CAAgBC,MAAhB,EAAwB;SACzBC,IAAL,CAAUL,YAAUM,IAAV,CAAeC,SAAf,EAA0B,CAA1B,CAAV,EAAwC,UAAUC,GAAV,EAAe;UACjDC,OAAO,KAAKC,QAAL,CAAcF,GAAd,IAAqBG,OAAOF,IAAP,CAAYD,GAAZ,CAArB,GAAwC,EAAnD;WACKT,OAAL,CAAa,UAAUa,GAAV,EAAe;YACtB,CAAC,KAAKC,WAAL,CAAiBL,IAAII,GAAJ,CAAjB,CAAL,EAAiC;iBACxBA,GAAP,IAAcJ,IAAII,GAAJ,CAAd;;OAFS,CAIXE,IAJW,CAIN,IAJM,CAAb;KAFF,EAOG,IAPH;WAQOV,MAAP;GAXS;YAaD,SAASW,WAAT,CAAkBX,MAAlB,EAA0B;SAC7BC,IAAL,CAAUL,YAAUM,IAAV,CAAeC,SAAf,EAA0B,CAA1B,CAAV,EAAwC,UAAUC,GAAV,EAAe;UACjDC,OAAO,KAAKC,QAAL,CAAcF,GAAd,IAAqBG,OAAOF,IAAP,CAAYD,GAAZ,CAArB,GAAwC,EAAnD;WACKT,OAAL,CAAa,UAAUa,GAAV,EAAe;YACtB,KAAKC,WAAL,CAAiBT,OAAOQ,GAAP,CAAjB,CAAJ,EAAmC;iBAC1BA,GAAP,IAAcJ,IAAII,GAAJ,CAAd;;OAFS,CAIXE,IAJW,CAIN,IAJM,CAAb;KAFF,EAOG,IAPH;WAQOV,MAAP;GAtBS;WAwBF,SAASY,OAAT,GAAmB;QACtBC,SAASjB,YAAUM,IAAV,CAAeC,SAAf,CAAb;WACO,YAAY;UACbW,OAAOlB,YAAUM,IAAV,CAAeC,SAAf,CAAX;WACK,IAAIY,IAAIF,OAAOtB,MAAP,GAAgB,CAA7B,EAAgCwB,KAAK,CAArC,EAAwCA,GAAxC,EAA6C;eACpC,CAACF,OAAOE,CAAP,EAAUC,KAAV,CAAgB,IAAhB,EAAsBF,IAAtB,CAAD,CAAP;;aAEKA,KAAK,CAAL,CAAP;KALF;GA1BS;QAkCL,SAASb,IAAT,CAAcG,GAAd,EAAmBa,GAAnB,EAAwBC,KAAxB,EAA+B;QAC/B,CAACd,GAAL,EAAU;;;QAGNZ,cAAYY,IAAIT,OAAhB,IAA2BS,IAAIT,OAAJ,KAAgBH,UAA/C,EAAyD;UACnDG,OAAJ,CAAYsB,GAAZ,EAAiBC,KAAjB;KADF,MAEO,IAAId,IAAIb,MAAJ,KAAea,IAAIb,MAAJ,GAAa,CAAhC,EAAmC;UACpCiB,MAAM,KAAK,CAAf;UACIW,IAAI,KAAK,CAAb;WACKX,MAAM,CAAN,EAASW,IAAIf,IAAIb,MAAtB,EAA8BiB,MAAMW,CAApC,EAAuCX,KAAvC,EAA8C;YACxCA,OAAOJ,GAAP,IAAca,IAAIf,IAAJ,CAASgB,KAAT,EAAgBd,IAAII,GAAJ,CAAhB,EAA0BA,GAA1B,MAAmC,KAAKY,KAA1D,EAAiE;;;;KAJ9D,MAQA;WACA,IAAIC,IAAT,IAAiBjB,GAAjB,EAAsB;YAChBa,IAAIf,IAAJ,CAASgB,KAAT,EAAgBd,IAAIiB,IAAJ,CAAhB,EAA2BA,IAA3B,MAAqC,KAAKD,KAA9C,EAAqD;;;;;GAlDhD;SAwDJ,SAASE,KAAT,CAAeC,GAAf,EAAoB;eACdA,GAAX,EAAgB,CAAhB;GAzDS;YA2DD,SAASC,QAAT,CAAkBC,IAAlB,EAAwBC,SAAxB,EAAmCC,eAAnC,EAAoD;QACxDC,UAAU,KAAK,CAAnB;WACO,YAAY;UACbxB,MAAM,IAAV;UACIU,OAAOX,SAAX;eACS0B,OAAT,GAAmB;kBACP,IAAV;YACI,CAACF,eAAL,EAAsBF,KAAKT,KAAL,CAAWZ,GAAX,EAAgBU,IAAhB;;UAEpBgB,UAAUH,mBAAmB,CAACC,OAAlC;mBACaA,OAAb;gBACUG,WAAWF,OAAX,EAAoBH,SAApB,CAAV;UACII,OAAJ,EAAa;aACNd,KAAL,CAAWZ,GAAX,EAAgBU,IAAhB;;KAXJ;GA7DS;WA4EF,SAASkB,UAAT,CAAiB5B,GAAjB,EAAsB;QACzBA,IAAI4B,OAAR,EAAiB,OAAO5B,IAAI4B,OAAJ,EAAP;WACVpC,YAAUM,IAAV,CAAeE,GAAf,CAAP;GA9ES;eAgFE,SAASK,WAAT,CAAqBL,GAArB,EAA0B;WAC9BA,QAAQ6B,SAAf;GAjFS;UAmFH,SAASC,MAAT,CAAgB9B,GAAhB,EAAqB;WACpBA,QAAQ,IAAf;GApFS;SAsFJ,UAAU+B,MAAV,EAAkB;aACdC,KAAT,CAAeC,EAAf,EAAmB;aACVF,OAAOnB,KAAP,CAAa,IAAb,EAAmBb,SAAnB,CAAP;;UAEIzB,QAAN,GAAiB,YAAY;aACpByD,OAAOzD,QAAP,EAAP;KADF;WAGO0D,KAAP;GAPK,CAQL,UAAUhC,GAAV,EAAe;WACRgC,MAAMhC,GAAN,CAAP;GATK,CAtFI;WAiGFX,MAAM6C,OAAN,IAAiB,UAAUlC,GAAV,EAAe;WAChCA,IAAImC,WAAJ,KAAoB9C,KAA3B;GAlGS;YAoGD,SAASa,QAAT,CAAkBF,GAAlB,EAAuB;WACxBA,QAAQG,OAAOH,GAAP,CAAf;GArGS;YAuGD,SAASoC,QAAT,CAAkBpC,GAAlB,EAAuB;WACxBA,QAAQA,MAAM,CAArB;GAxGS;YA0GD,SAASqC,QAAT,CAAkBrC,GAAlB,EAAuB;WACxBA,QAAQA,MAAM,EAArB;GA3GS;aA6GA,SAASsC,SAAT,CAAmBtC,GAAnB,EAAwB;WAC1BA,QAAQ,KAAR,IAAiBA,QAAQ,IAAhC;GA9GS;cAgHC,SAASuC,UAAT,CAAoBvC,GAApB,EAAyB;WAC5BG,OAAOb,SAAP,CAAiBhB,QAAjB,CAA0BwB,IAA1B,CAA+BE,GAA/B,MAAwC,mBAA/C;;CAjHJ;AAqHA,IAAIwC,oBAAkB,CACtB;UACU9C,SAAO2C,QADjB;eAEe;oBACK;YACR,SAASI,IAAT,CAAcC,QAAd,EAAwB;YACxBC,OAAOD,SAASE,KAAT,CAAe,oCAAf,CAAX;YACID,SAAS,IAAb,EAAmB;iBACV,KAAP;;eAEK;iBACE,KADF;eAEAE,SAAS,OAAOF,KAAK,CAAL,EAAQrE,QAAR,EAAP,GAA4BqE,KAAK,CAAL,EAAQrE,QAAR,EAA5B,GAAiDqE,KAAK,CAAL,EAAQrE,QAAR,EAAjD,GAAsEqE,KAAK,CAAL,EAAQrE,QAAR,EAAtE,GAA2FqE,KAAK,CAAL,EAAQrE,QAAR,EAA3F,GAAgHqE,KAAK,CAAL,EAAQrE,QAAR,EAAzH,EAA6I,CAA7I;SAFP;OANY;aAWPN;KAZE;kBAcG;YACN,SAASyE,IAAT,CAAcC,QAAd,EAAwB;YACxBC,OAAOD,SAASE,KAAT,CAAe,mBAAf,CAAX;YACID,SAAS,IAAb,EAAmB;iBACV,KAAP;;eAEK;iBACE,KADF;eAEAE,SAAS,OAAOF,KAAK,CAAL,EAAQrE,QAAR,EAAhB,EAAoC,CAApC;SAFP;OANU;aAWLN;KAzBE;aA2BF;YACD,SAASyE,IAAT,CAAcC,QAAd,EAAwB;YACxBC,OAAOD,SAASE,KAAT,CAAe,0CAAf,CAAX;YACID,SAAS,IAAb,EAAmB;iBACV,KAAP;;eAEK;iBACE,KADF;aAEFG,WAAWH,KAAK,CAAL,CAAX,CAFE;aAGFG,WAAWH,KAAK,CAAL,CAAX,CAHE;aAIFG,WAAWH,KAAK,CAAL,CAAX;SAJL;OANK;aAaA3E;KAxCE;cA0CD;YACF,SAASyE,IAAT,CAAcC,QAAd,EAAwB;YACxBC,OAAOD,SAASE,KAAT,CAAe,sDAAf,CAAX;YACID,SAAS,IAAb,EAAmB;iBACV,KAAP;;eAEK;iBACE,KADF;aAEFG,WAAWH,KAAK,CAAL,CAAX,CAFE;aAGFG,WAAWH,KAAK,CAAL,CAAX,CAHE;aAIFG,WAAWH,KAAK,CAAL,CAAX,CAJE;aAKFG,WAAWH,KAAK,CAAL,CAAX;SALL;OANM;aAcD3E;;;CA3DS,EA+DtB;UACU0B,SAAO0C,QADjB;eAEe;SACN;YACG,SAASK,IAAT,CAAcC,QAAd,EAAwB;eACrB;iBACE,KADF;eAEAA,QAFA;0BAGW;SAHlB;OAFC;aAQI,SAASK,KAAT,CAAe9E,KAAf,EAAsB;eACpBA,MAAMiB,GAAb;;;;CA3Ec,EAgFtB;UACUQ,SAAOwC,OADjB;eAEe;eACA;YACH,SAASO,IAAT,CAAcC,QAAd,EAAwB;YACxBA,SAASvD,MAAT,KAAoB,CAAxB,EAA2B;iBAClB,KAAP;;eAEK;iBACE,KADF;aAEFuD,SAAS,CAAT,CAFE;aAGFA,SAAS,CAAT,CAHE;aAIFA,SAAS,CAAT;SAJL;OALO;aAYF,SAASK,KAAT,CAAe9E,KAAf,EAAsB;eACpB,CAACA,MAAMM,CAAP,EAAUN,MAAMS,CAAhB,EAAmBT,MAAMU,CAAzB,CAAP;;KAdO;gBAiBC;YACJ,SAAS8D,IAAT,CAAcC,QAAd,EAAwB;YACxBA,SAASvD,MAAT,KAAoB,CAAxB,EAA2B,OAAO,KAAP;eACpB;iBACE,KADF;aAEFuD,SAAS,CAAT,CAFE;aAGFA,SAAS,CAAT,CAHE;aAIFA,SAAS,CAAT,CAJE;aAKFA,SAAS,CAAT;SALL;OAHQ;aAWH,SAASK,KAAT,CAAe9E,KAAf,EAAsB;eACpB,CAACA,MAAMM,CAAP,EAAUN,MAAMS,CAAhB,EAAmBT,MAAMU,CAAzB,EAA4BV,MAAMW,CAAlC,CAAP;;;;CA/Gc,EAoHtB;UACUc,SAAOQ,QADjB;eAEe;cACD;YACF,SAASuC,IAAT,CAAcC,QAAd,EAAwB;YACxBhD,SAAO0C,QAAP,CAAgBM,SAASnE,CAAzB,KAA+BmB,SAAO0C,QAAP,CAAgBM,SAAShE,CAAzB,CAA/B,IAA8DgB,SAAO0C,QAAP,CAAgBM,SAAS/D,CAAzB,CAA9D,IAA6Fe,SAAO0C,QAAP,CAAgBM,SAAS9D,CAAzB,CAAjG,EAA8H;iBACrH;mBACE,KADF;eAEF8D,SAASnE,CAFP;eAGFmE,SAAShE,CAHP;eAIFgE,SAAS/D,CAJP;eAKF+D,SAAS9D;WALd;;eAQK,KAAP;OAXM;aAaD,SAASmE,KAAT,CAAe9E,KAAf,EAAsB;eACpB;aACFA,MAAMM,CADJ;aAEFN,MAAMS,CAFJ;aAGFT,MAAMU,CAHJ;aAIFV,MAAMW;SAJX;;KAfO;aAuBF;YACD,SAAS6D,IAAT,CAAcC,QAAd,EAAwB;YACxBhD,SAAO0C,QAAP,CAAgBM,SAASnE,CAAzB,KAA+BmB,SAAO0C,QAAP,CAAgBM,SAAShE,CAAzB,CAA/B,IAA8DgB,SAAO0C,QAAP,CAAgBM,SAAS/D,CAAzB,CAAlE,EAA+F;iBACtF;mBACE,KADF;eAEF+D,SAASnE,CAFP;eAGFmE,SAAShE,CAHP;eAIFgE,SAAS/D;WAJd;;eAOK,KAAP;OAVK;aAYA,SAASoE,KAAT,CAAe9E,KAAf,EAAsB;eACpB;aACFA,MAAMM,CADJ;aAEFN,MAAMS,CAFJ;aAGFT,MAAMU;SAHX;;KApCO;cA2CD;YACF,SAAS8D,IAAT,CAAcC,QAAd,EAAwB;YACxBhD,SAAO0C,QAAP,CAAgBM,SAAS7D,CAAzB,KAA+Ba,SAAO0C,QAAP,CAAgBM,SAAS5D,CAAzB,CAA/B,IAA8DY,SAAO0C,QAAP,CAAgBM,SAAS1D,CAAzB,CAA9D,IAA6FU,SAAO0C,QAAP,CAAgBM,SAAS9D,CAAzB,CAAjG,EAA8H;iBACrH;mBACE,KADF;eAEF8D,SAAS7D,CAFP;eAGF6D,SAAS5D,CAHP;eAIF4D,SAAS1D,CAJP;eAKF0D,SAAS9D;WALd;;eAQK,KAAP;OAXM;aAaD,SAASmE,KAAT,CAAe9E,KAAf,EAAsB;eACpB;aACFA,MAAMY,CADJ;aAEFZ,MAAMa,CAFJ;aAGFb,MAAMe,CAHJ;aAIFf,MAAMW;SAJX;;KAzDO;aAiEF;YACD,SAAS6D,IAAT,CAAcC,QAAd,EAAwB;YACxBhD,SAAO0C,QAAP,CAAgBM,SAAS7D,CAAzB,KAA+Ba,SAAO0C,QAAP,CAAgBM,SAAS5D,CAAzB,CAA/B,IAA8DY,SAAO0C,QAAP,CAAgBM,SAAS1D,CAAzB,CAAlE,EAA+F;iBACtF;mBACE,KADF;eAEF0D,SAAS7D,CAFP;eAGF6D,SAAS5D,CAHP;eAIF4D,SAAS1D;WAJd;;eAOK,KAAP;OAVK;aAYA,SAAS+D,KAAT,CAAe9E,KAAf,EAAsB;eACpB;aACFA,MAAMY,CADJ;aAEFZ,MAAMa,CAFJ;aAGFb,MAAMe;SAHX;;;;CApMc,CAAtB;AA6MA,IAAIgE,WAAS,KAAK,CAAlB;AACA,IAAIC,aAAW,KAAK,CAApB;AACA,IAAIC,cAAY,SAASA,SAAT,GAAqB;eACxB,KAAX;MACIR,WAAW3C,UAAUZ,MAAV,GAAmB,CAAnB,GAAuBO,SAAOkC,OAAP,CAAe7B,SAAf,CAAvB,GAAmDA,UAAU,CAAV,CAAlE;WACOF,IAAP,CAAY2C,iBAAZ,EAA6B,UAAUW,MAAV,EAAkB;QACzCA,OAAOC,MAAP,CAAcV,QAAd,CAAJ,EAA6B;eACpB7C,IAAP,CAAYsD,OAAOE,WAAnB,EAAgC,UAAUC,UAAV,EAAsBjF,cAAtB,EAAsC;mBAC3DiF,WAAWb,IAAX,CAAgBC,QAAhB,CAAT;YACIO,eAAa,KAAb,IAAsBD,aAAW,KAArC,EAA4C;uBAC/BA,QAAX;mBACO3E,cAAP,GAAwBA,cAAxB;mBACOiF,UAAP,GAAoBA,UAApB;iBACO5D,SAAOsB,KAAd;;OANJ;aASOtB,SAAOsB,KAAd;;GAXJ;SAcOiC,UAAP;CAjBF;AAoBA,IAAIM,iBAAe,KAAK,CAAxB;AACA,IAAIC,cAAY;cACF,SAASC,UAAT,CAAoB5E,CAApB,EAAuBC,CAAvB,EAA0BE,CAA1B,EAA6B;QACnC0E,KAAKlF,KAAKmF,KAAL,CAAW9E,IAAI,EAAf,IAAqB,CAA9B;QACI+E,IAAI/E,IAAI,EAAJ,GAASL,KAAKmF,KAAL,CAAW9E,IAAI,EAAf,CAAjB;QACIgF,IAAI7E,KAAK,MAAMF,CAAX,CAAR;QACIgF,IAAI9E,KAAK,MAAM4E,IAAI9E,CAAf,CAAR;QACIiF,IAAI/E,KAAK,MAAM,CAAC,MAAM4E,CAAP,IAAY9E,CAAvB,CAAR;QACIkF,IAAI,CAAC,CAAChF,CAAD,EAAI+E,CAAJ,EAAOF,CAAP,CAAD,EAAY,CAACC,CAAD,EAAI9E,CAAJ,EAAO6E,CAAP,CAAZ,EAAuB,CAACA,CAAD,EAAI7E,CAAJ,EAAO+E,CAAP,CAAvB,EAAkC,CAACF,CAAD,EAAIC,CAAJ,EAAO9E,CAAP,CAAlC,EAA6C,CAAC+E,CAAD,EAAIF,CAAJ,EAAO7E,CAAP,CAA7C,EAAwD,CAACA,CAAD,EAAI6E,CAAJ,EAAOC,CAAP,CAAxD,EAAmEJ,EAAnE,CAAR;WACO;SACFM,EAAE,CAAF,IAAO,GADL;SAEFA,EAAE,CAAF,IAAO,GAFL;SAGFA,EAAE,CAAF,IAAO;KAHZ;GARY;cAcF,SAASC,UAAT,CAAoB1F,CAApB,EAAuBG,CAAvB,EAA0BC,CAA1B,EAA6B;QACnCuF,MAAM1F,KAAK0F,GAAL,CAAS3F,CAAT,EAAYG,CAAZ,EAAeC,CAAf,CAAV;QACIwF,MAAM3F,KAAK2F,GAAL,CAAS5F,CAAT,EAAYG,CAAZ,EAAeC,CAAf,CAAV;QACIyF,QAAQD,MAAMD,GAAlB;QACIrF,IAAI,KAAK,CAAb;QACIC,IAAI,KAAK,CAAb;QACIqF,QAAQ,CAAZ,EAAe;UACTC,QAAQD,GAAZ;KADF,MAEO;aACE;WACFE,GADE;WAEF,CAFE;WAGF;OAHL;;QAME9F,MAAM4F,GAAV,EAAe;UACT,CAACzF,IAAIC,CAAL,IAAUyF,KAAd;KADF,MAEO,IAAI1F,MAAMyF,GAAV,EAAe;UAChB,IAAI,CAACxF,IAAIJ,CAAL,IAAU6F,KAAlB;KADK,MAEA;UACD,IAAI,CAAC7F,IAAIG,CAAL,IAAU0F,KAAlB;;SAEG,CAAL;QACIvF,IAAI,CAAR,EAAW;WACJ,CAAL;;WAEK;SACFA,IAAI,GADF;SAEFC,CAFE;SAGFqF,MAAM;KAHX;GAxCY;cA8CF,SAASG,UAAT,CAAoB/F,CAApB,EAAuBG,CAAvB,EAA0BC,CAA1B,EAA6B;QACnCO,MAAM,KAAKqF,kBAAL,CAAwB,CAAxB,EAA2B,CAA3B,EAA8BhG,CAA9B,CAAV;UACM,KAAKgG,kBAAL,CAAwBrF,GAAxB,EAA6B,CAA7B,EAAgCR,CAAhC,CAAN;UACM,KAAK6F,kBAAL,CAAwBrF,GAAxB,EAA6B,CAA7B,EAAgCP,CAAhC,CAAN;WACOO,GAAP;GAlDY;sBAoDM,SAASsF,kBAAT,CAA4BtF,GAA5B,EAAiCuF,cAAjC,EAAiD;WAC5DvF,OAAOuF,iBAAiB,CAAxB,GAA4B,IAAnC;GArDY;sBAuDM,SAASF,kBAAT,CAA4BrF,GAA5B,EAAiCuF,cAAjC,EAAiDC,KAAjD,EAAwD;WACnEA,UAAUnB,iBAAekB,iBAAiB,CAA1C,IAA+CvF,MAAM,EAAE,QAAQqE,cAAV,CAA5D;;CAxDJ;AA4DA,IAAIoB,YAAU,OAAOC,MAAP,KAAkB,UAAlB,IAAgCC,QAAOD,OAAOE,QAAd,MAA2B,QAA3D,GAAsE,UAAU9E,GAAV,EAAe;gBACnFA,GAAd,yCAAcA,GAAd;CADY,GAEV,UAAUA,GAAV,EAAe;SACVA,OAAO,OAAO4E,MAAP,KAAkB,UAAzB,IAAuC5E,IAAImC,WAAJ,KAAoByC,MAA3D,IAAqE5E,QAAQ4E,OAAOtF,SAApF,GAAgG,QAAhG,UAAkHU,GAAlH,yCAAkHA,GAAlH,CAAP;CAHF;AAgBA,IAAI+E,mBAAiB,SAAjBA,iBAAiB,CAAUC,QAAV,EAAoBC,WAApB,EAAiC;MAChD,EAAED,oBAAoBC,WAAtB,CAAJ,EAAwC;UAChC,IAAIC,SAAJ,CAAc,mCAAd,CAAN;;CAFJ;AAMA,IAAIC,gBAAc,YAAY;WACnBC,gBAAT,CAA0BxF,MAA1B,EAAkCyF,KAAlC,EAAyC;SAClC,IAAI1E,IAAI,CAAb,EAAgBA,IAAI0E,MAAMlG,MAA1B,EAAkCwB,GAAlC,EAAuC;UACjC2E,aAAaD,MAAM1E,CAAN,CAAjB;iBACW4E,UAAX,GAAwBD,WAAWC,UAAX,IAAyB,KAAjD;iBACWC,YAAX,GAA0B,IAA1B;UACI,WAAWF,UAAf,EAA2BA,WAAWG,QAAX,GAAsB,IAAtB;aACpBC,cAAP,CAAsB9F,MAAtB,EAA8B0F,WAAWlF,GAAzC,EAA8CkF,UAA9C;;;SAIG,UAAUL,WAAV,EAAuBU,UAAvB,EAAmCC,WAAnC,EAAgD;QACjDD,UAAJ,EAAgBP,iBAAiBH,YAAY3F,SAA7B,EAAwCqG,UAAxC;QACZC,WAAJ,EAAiBR,iBAAiBH,WAAjB,EAA8BW,WAA9B;WACVX,WAAP;GAHF;CAXgB,EAAlB;AAwBA,IAAIY,QAAM,SAASA,MAAT,CAAaC,MAAb,EAAqBC,QAArB,EAA+BC,QAA/B,EAAyC;MAC7CF,WAAW,IAAf,EAAqBA,SAASG,SAAS3G,SAAlB;MACjB4G,OAAO/F,OAAOgG,wBAAP,CAAgCL,MAAhC,EAAwCC,QAAxC,CAAX;MAEIG,SAASrE,SAAb,EAAwB;QAClBuE,SAASjG,OAAOkG,cAAP,CAAsBP,MAAtB,CAAb;QAEIM,WAAW,IAAf,EAAqB;aACZvE,SAAP;KADF,MAEO;aACEgE,OAAIO,MAAJ,EAAYL,QAAZ,EAAsBC,QAAtB,CAAP;;GANJ,MAQO,IAAI,WAAWE,IAAf,EAAqB;WACnBA,KAAKxB,KAAZ;GADK,MAEA;QACD4B,SAASJ,KAAKL,GAAlB;QAEIS,WAAWzE,SAAf,EAA0B;aACjBA,SAAP;;WAGKyE,OAAOxG,IAAP,CAAYkG,QAAZ,CAAP;;CArBJ;AAyBA,IAAIO,aAAW,SAAXA,WAAW,CAAUC,QAAV,EAAoBC,UAApB,EAAgC;MACzC,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,eAAe,IAAvD,EAA6D;UACrD,IAAIvB,SAAJ,CAAc,qEAAoEuB,UAApE,yCAAoEA,UAApE,EAAd,CAAN;;WAGOnH,SAAT,GAAqBa,OAAOuG,MAAP,CAAcD,cAAcA,WAAWnH,SAAvC,EAAkD;iBACxD;aACJkH,QADI;kBAEC,KAFD;gBAGD,IAHC;oBAIG;;GALG,CAArB;MAQIC,UAAJ,EAAgBtG,OAAOwG,cAAP,GAAwBxG,OAAOwG,cAAP,CAAsBH,QAAtB,EAAgCC,UAAhC,CAAxB,GAAsED,SAASI,SAAT,GAAqBH,UAA3F;CAblB;AA0BA,IAAII,8BAA4B,SAA5BA,4BAA4B,CAAUC,IAAV,EAAgBhH,IAAhB,EAAsB;MAChD,CAACgH,IAAL,EAAW;UACH,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;;SAGKjH,SAAS,QAAOA,IAAP,yCAAOA,IAAP,OAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAArD,IAAmEA,IAAnE,GAA0EgH,IAAjF;CALF;AAQA,IAAIE,UAAQ,YAAY;WACbA,KAAT,GAAiB;qBACA,IAAf,EAAqBA,KAArB;SACK5I,OAAL,GAAe8E,YAAUtC,KAAV,CAAgB,IAAhB,EAAsBb,SAAtB,CAAf;QACI,KAAK3B,OAAL,KAAiB,KAArB,EAA4B;YACpB,IAAI6I,KAAJ,CAAU,qCAAV,CAAN;;SAEG7I,OAAL,CAAaQ,CAAb,GAAiB,KAAKR,OAAL,CAAaQ,CAAb,IAAkB,CAAnC;;gBAEUoI,KAAZ,EAAmB,CAAC;SACb,UADa;WAEX,SAAS1I,QAAT,GAAoB;aAClBN,gBAAc,IAAd,CAAP;;GAHe,EAKhB;SACI,aADJ;WAEM,SAASkJ,WAAT,GAAuB;aACrBlJ,gBAAc,IAAd,EAAoB,IAApB,CAAP;;GARe,EAUhB;SACI,YADJ;WAEM,SAASmJ,UAAT,GAAsB;aACpB,KAAK/I,OAAL,CAAakF,UAAb,CAAwBP,KAAxB,CAA8B,IAA9B,CAAP;;GAbe,CAAnB;SAgBOiE,KAAP;CAzBU,EAAZ;AA2BA,SAASI,oBAAT,CAA4BxH,MAA5B,EAAoCyH,SAApC,EAA+CC,iBAA/C,EAAkE;SACzD5B,cAAP,CAAsB9F,MAAtB,EAA8ByH,SAA9B,EAAyC;SAClC,SAASE,MAAT,GAAkB;UACjB,KAAKnJ,OAAL,CAAaoJ,KAAb,KAAuB,KAA3B,EAAkC;eACzB,KAAKpJ,OAAL,CAAaiJ,SAAb,CAAP;;cAEII,cAAN,CAAqB,IAArB,EAA2BJ,SAA3B,EAAsCC,iBAAtC;aACO,KAAKlJ,OAAL,CAAaiJ,SAAb,CAAP;KANqC;SAQlC,SAASK,MAAT,CAAgB1I,CAAhB,EAAmB;UAClB,KAAKZ,OAAL,CAAaoJ,KAAb,KAAuB,KAA3B,EAAkC;gBAC1BC,cAAN,CAAqB,IAArB,EAA2BJ,SAA3B,EAAsCC,iBAAtC;aACKlJ,OAAL,CAAaoJ,KAAb,GAAqB,KAArB;;WAEGpJ,OAAL,CAAaiJ,SAAb,IAA0BrI,CAA1B;;GAbJ;;AAiBF,SAAS2I,oBAAT,CAA4B/H,MAA5B,EAAoCyH,SAApC,EAA+C;SACtC3B,cAAP,CAAsB9F,MAAtB,EAA8ByH,SAA9B,EAAyC;SAClC,SAASE,MAAT,GAAkB;UACjB,KAAKnJ,OAAL,CAAaoJ,KAAb,KAAuB,KAA3B,EAAkC;eACzB,KAAKpJ,OAAL,CAAaiJ,SAAb,CAAP;;cAEIO,cAAN,CAAqB,IAArB;aACO,KAAKxJ,OAAL,CAAaiJ,SAAb,CAAP;KANqC;SAQlC,SAASK,MAAT,CAAgB1I,CAAhB,EAAmB;UAClB,KAAKZ,OAAL,CAAaoJ,KAAb,KAAuB,KAA3B,EAAkC;gBAC1BI,cAAN,CAAqB,IAArB;aACKxJ,OAAL,CAAaoJ,KAAb,GAAqB,KAArB;;WAEGpJ,OAAL,CAAaiJ,SAAb,IAA0BrI,CAA1B;;GAbJ;;AAiBFgI,QAAMS,cAAN,GAAuB,UAAUxJ,KAAV,EAAiBoJ,SAAjB,EAA4BC,iBAA5B,EAA+C;MAChErJ,MAAMG,OAAN,CAAcoJ,KAAd,KAAwB,KAA5B,EAAmC;UAC3BpJ,OAAN,CAAciJ,SAAd,IAA2B7D,YAAUgB,kBAAV,CAA6BvG,MAAMG,OAAN,CAAcc,GAA3C,EAAgDoI,iBAAhD,CAA3B;GADF,MAEO,IAAIrJ,MAAMG,OAAN,CAAcoJ,KAAd,KAAwB,KAA5B,EAAmC;aACjC7H,MAAP,CAAc1B,MAAMG,OAApB,EAA6BoF,YAAUC,UAAV,CAAqBxF,MAAMG,OAAN,CAAcS,CAAnC,EAAsCZ,MAAMG,OAAN,CAAcU,CAApD,EAAuDb,MAAMG,OAAN,CAAcY,CAArE,CAA7B;GADK,MAEA;UACC,IAAIiI,KAAJ,CAAU,uBAAV,CAAN;;CANJ;AASAD,QAAMY,cAAN,GAAuB,UAAU3J,KAAV,EAAiB;MAClC+E,SAASQ,YAAUS,UAAV,CAAqBhG,MAAMM,CAA3B,EAA8BN,MAAMS,CAApC,EAAuCT,MAAMU,CAA7C,CAAb;WACOgB,MAAP,CAAc1B,MAAMG,OAApB,EAA6B;OACxB4E,OAAOlE,CADiB;OAExBkE,OAAOhE;GAFZ;MAII,CAACU,SAAOsC,KAAP,CAAagB,OAAOnE,CAApB,CAAL,EAA6B;UACrBT,OAAN,CAAcS,CAAd,GAAkBmE,OAAOnE,CAAzB;GADF,MAEO,IAAIa,SAAOW,WAAP,CAAmBpC,MAAMG,OAAN,CAAcS,CAAjC,CAAJ,EAAyC;UACxCT,OAAN,CAAcS,CAAd,GAAkB,CAAlB;;CATJ;AAYAmI,QAAMa,UAAN,GAAmB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,EAA+B,KAA/B,EAAsC,GAAtC,CAAnB;AACAT,qBAAmBJ,QAAM1H,SAAzB,EAAoC,GAApC,EAAyC,CAAzC;AACA8H,qBAAmBJ,QAAM1H,SAAzB,EAAoC,GAApC,EAAyC,CAAzC;AACA8H,qBAAmBJ,QAAM1H,SAAzB,EAAoC,GAApC,EAAyC,CAAzC;AACAqI,qBAAmBX,QAAM1H,SAAzB,EAAoC,GAApC;AACAqI,qBAAmBX,QAAM1H,SAAzB,EAAoC,GAApC;AACAqI,qBAAmBX,QAAM1H,SAAzB,EAAoC,GAApC;AACAa,OAAOuF,cAAP,CAAsBsB,QAAM1H,SAA5B,EAAuC,GAAvC,EAA4C;OACrC,SAASiI,MAAT,GAAkB;WACd,KAAKnJ,OAAL,CAAaQ,CAApB;GAFwC;OAIrC,SAAS8I,MAAT,CAAgB1I,CAAhB,EAAmB;SACjBZ,OAAL,CAAaQ,CAAb,GAAiBI,CAAjB;;CALJ;AAQAmB,OAAOuF,cAAP,CAAsBsB,QAAM1H,SAA5B,EAAuC,KAAvC,EAA8C;OACvC,SAASiI,MAAT,GAAkB;QACjB,CAAC,KAAKnJ,OAAL,CAAaoJ,KAAd,KAAwB,KAA5B,EAAmC;WAC5BpJ,OAAL,CAAac,GAAb,GAAmBsE,YAAUc,UAAV,CAAqB,KAAK/F,CAA1B,EAA6B,KAAKG,CAAlC,EAAqC,KAAKC,CAA1C,CAAnB;;WAEK,KAAKP,OAAL,CAAac,GAApB;GAL0C;OAOvC,SAASwI,MAAT,CAAgB1I,CAAhB,EAAmB;SACjBZ,OAAL,CAAaoJ,KAAb,GAAqB,KAArB;SACKpJ,OAAL,CAAac,GAAb,GAAmBF,CAAnB;;CATJ;AAaA,IAAI8I,eAAa,YAAY;WAClBA,UAAT,CAAoBhC,MAApB,EAA4BC,QAA5B,EAAsC;qBACrB,IAAf,EAAqB+B,UAArB;SACKC,YAAL,GAAoBjC,OAAOC,QAAP,CAApB;SACKiC,UAAL,GAAkBtK,SAASC,aAAT,CAAuB,KAAvB,CAAlB;SACKmI,MAAL,GAAcA,MAAd;SACKC,QAAL,GAAgBA,QAAhB;SACKkC,UAAL,GAAkBpG,SAAlB;SACKqG,gBAAL,GAAwBrG,SAAxB;;gBAEUiG,UAAZ,EAAwB,CAAC;SAClB,UADkB;WAEhB,SAASK,QAAT,CAAkBhH,GAAlB,EAAuB;WACvB8G,UAAL,GAAkB9G,GAAlB;aACO,IAAP;;GAJoB,EAMrB;SACI,gBADJ;WAEM,SAASiH,cAAT,CAAwBjH,GAAxB,EAA6B;WAC7B+G,gBAAL,GAAwB/G,GAAxB;aACO,IAAP;;GAVoB,EAYrB;SACI,UADJ;WAEM,SAASkH,QAAT,CAAkBC,QAAlB,EAA4B;WAC5BxC,MAAL,CAAY,KAAKC,QAAjB,IAA6BuC,QAA7B;UACI,KAAKL,UAAT,EAAqB;aACdA,UAAL,CAAgBnI,IAAhB,CAAqB,IAArB,EAA2BwI,QAA3B;;WAEGC,aAAL;aACO,IAAP;;GApBoB,EAsBrB;SACI,UADJ;WAEM,SAASC,QAAT,GAAoB;aAClB,KAAK1C,MAAL,CAAY,KAAKC,QAAjB,CAAP;;GAzBoB,EA2BrB;SACI,eADJ;WAEM,SAASwC,aAAT,GAAyB;aACvB,IAAP;;GA9BoB,EAgCrB;SACI,YADJ;WAEM,SAASE,UAAT,GAAsB;aACpB,KAAKV,YAAL,KAAsB,KAAKS,QAAL,EAA7B;;GAnCoB,CAAxB;SAsCOV,UAAP;CAhDe,EAAjB;AAmDA,IAAIY,cAAY;cACF,CAAC,QAAD,CADE;eAED,CAAC,OAAD,EAAU,WAAV,EAAuB,WAAvB,EAAoC,SAApC,EAA+C,WAA/C,CAFC;kBAGE,CAAC,SAAD;CAHlB;AAKA,IAAIC,kBAAgB,EAApB;AACAjJ,SAAOG,IAAP,CAAY6I,WAAZ,EAAuB,UAAU1J,CAAV,EAAa4J,CAAb,EAAgB;WAC9B/I,IAAP,CAAYb,CAAZ,EAAe,UAAU6J,CAAV,EAAa;oBACZA,CAAd,IAAmBD,CAAnB;GADF;CADF;AAKA,IAAIE,qBAAmB,iBAAvB;AACA,SAASC,kBAAT,CAA0BC,GAA1B,EAA+B;MACzBA,QAAQ,GAAR,IAAetJ,SAAOW,WAAP,CAAmB2I,GAAnB,CAAnB,EAA4C;WACnC,CAAP;;MAEEpG,QAAQoG,IAAIpG,KAAJ,CAAUkG,kBAAV,CAAZ;MACI,CAACpJ,SAAOoC,MAAP,CAAcc,KAAd,CAAL,EAA2B;WAClBE,WAAWF,MAAM,CAAN,CAAX,CAAP;;SAEK,CAAP;;AAEF,IAAIqG,UAAM;kBACQ,SAASC,cAAT,CAAwBC,IAAxB,EAA8BC,UAA9B,EAA0C;QACpDD,SAAStH,SAAT,IAAsBsH,KAAK1L,KAAL,KAAeoE,SAAzC,EAAoD;SAC/CwH,aAAL,GAAqBD,aAAa,YAAY;aACrC,KAAP;KADmB,GAEjB,YAAY,EAFhB;SAGK3L,KAAL,CAAW6L,aAAX,GAA2BF,aAAa,MAAb,GAAsB,MAAjD;SACK3L,KAAL,CAAW8L,eAAX,GAA6BH,aAAa,MAAb,GAAsB,MAAnD;SACKI,YAAL,GAAoBJ,aAAa,IAAb,GAAoB,KAAxC;GARM;kBAUQ,SAASK,cAAT,CAAwBN,IAAxB,EAA8BO,GAA9B,EAAmCC,IAAnC,EAAyC;QACnDC,WAAWD,IAAf;QACIE,aAAaH,GAAjB;QACIhK,SAAOW,WAAP,CAAmBwJ,UAAnB,CAAJ,EAAoC;mBACrB,IAAb;;QAEEnK,SAAOW,WAAP,CAAmBuJ,QAAnB,CAAJ,EAAkC;iBACrB,IAAX;;SAEGnM,KAAL,CAAWqM,QAAX,GAAsB,UAAtB;QACID,UAAJ,EAAgB;WACTpM,KAAL,CAAWsM,IAAX,GAAkB,CAAlB;WACKtM,KAAL,CAAWuM,KAAX,GAAmB,CAAnB;;QAEEJ,QAAJ,EAAc;WACPnM,KAAL,CAAWwM,GAAX,GAAiB,CAAjB;WACKxM,KAAL,CAAWyM,MAAX,GAAoB,CAApB;;GA1BI;aA6BG,SAASC,SAAT,CAAmBhB,IAAnB,EAAyBiB,SAAzB,EAAoCC,IAApC,EAA0CC,GAA1C,EAA+C;QACpDC,SAASF,QAAQ,EAArB;QACIG,YAAY7B,gBAAcyB,SAAd,CAAhB;QACI,CAACI,SAAL,EAAgB;YACR,IAAIvD,KAAJ,CAAU,gBAAgBmD,SAAhB,GAA4B,iBAAtC,CAAN;;QAEEK,MAAM/M,SAASgN,WAAT,CAAqBF,SAArB,CAAV;YACQA,SAAR;WACO,aAAL;;cAEQG,UAAUJ,OAAOK,CAAP,IAAYL,OAAOI,OAAnB,IAA8B,CAA5C;cACIE,UAAUN,OAAOO,CAAP,IAAYP,OAAOM,OAAnB,IAA8B,CAA5C;cACIE,cAAJ,CAAmBX,SAAnB,EAA8BG,OAAOS,OAAP,IAAkB,KAAhD,EAAuDT,OAAOU,UAAP,IAAqB,IAA5E,EAAkFzN,MAAlF,EAA0F+M,OAAOW,UAAP,IAAqB,CAA/G,EAAkH,CAAlH,EACA,CADA,EAEAP,OAFA,EAGAE,OAHA,EAIA,KAJA,EAIO,KAJP,EAIc,KAJd,EAIqB,KAJrB,EAI4B,CAJ5B,EAI+B,IAJ/B;;;WAOC,gBAAL;;cAEQM,OAAOV,IAAIW,iBAAJ,IAAyBX,IAAIY,YAAxC;mBACO9K,QAAP,CAAgBgK,MAAhB,EAAwB;wBACV,IADU;qBAEb,KAFa;oBAGd,KAHc;sBAIZ,KAJY;qBAKb,KALa;qBAMb1I,SANa;sBAOZA;WAPZ;eASKuI,SAAL,EAAgBG,OAAOS,OAAP,IAAkB,KAAlC,EAAyCT,OAAOU,UAAhD,EAA4DzN,MAA5D,EAAoE+M,OAAOe,OAA3E,EAAoFf,OAAOgB,MAA3F,EAAmGhB,OAAOiB,QAA1G,EAAoHjB,OAAOkB,OAA3H,EAAoIlB,OAAOmB,OAA3I,EAAoJnB,OAAOoB,QAA3J;;;;;cAKIC,SAAJ,CAAcxB,SAAd,EAAyBG,OAAOS,OAAP,IAAkB,KAA3C,EAAkDT,OAAOU,UAAP,IAAqB,IAAvE;;;;aAIC1K,QAAP,CAAgBkK,GAAhB,EAAqBH,GAArB;SACKuB,aAAL,CAAmBpB,GAAnB;GAtEM;QAwEF,SAASnK,IAAT,CAAc6I,IAAd,EAAoB2C,KAApB,EAA2BzK,IAA3B,EAAiC0K,OAAjC,EAA0C;QAC1CC,OAAOD,WAAW,KAAtB;QACI5C,KAAK8C,gBAAT,EAA2B;WACpBA,gBAAL,CAAsBH,KAAtB,EAA6BzK,IAA7B,EAAmC2K,IAAnC;KADF,MAEO,IAAI7C,KAAK+C,WAAT,EAAsB;WACtBA,WAAL,CAAiB,OAAOJ,KAAxB,EAA+BzK,IAA/B;;WAEK4H,OAAP;GA/EM;UAiFA,SAASkD,MAAT,CAAgBhD,IAAhB,EAAsB2C,KAAtB,EAA6BzK,IAA7B,EAAmC0K,OAAnC,EAA4C;QAC9CC,OAAOD,WAAW,KAAtB;QACI5C,KAAKiD,mBAAT,EAA8B;WACvBA,mBAAL,CAAyBN,KAAzB,EAAgCzK,IAAhC,EAAsC2K,IAAtC;KADF,MAEO,IAAI7C,KAAKkD,WAAT,EAAsB;WACtBA,WAAL,CAAiB,OAAOP,KAAxB,EAA+BzK,IAA/B;;WAEK4H,OAAP;GAxFM;YA0FE,SAASqD,QAAT,CAAkBnD,IAAlB,EAAwBqB,SAAxB,EAAmC;QACvCrB,KAAKqB,SAAL,KAAmB3I,SAAvB,EAAkC;WAC3B2I,SAAL,GAAiBA,SAAjB;KADF,MAEO,IAAIrB,KAAKqB,SAAL,KAAmBA,SAAvB,EAAkC;UACnC+B,UAAUpD,KAAKqB,SAAL,CAAegC,KAAf,CAAqB,IAArB,CAAd;UACID,QAAQE,OAAR,CAAgBjC,SAAhB,MAA+B,CAAC,CAApC,EAAuC;gBAC7BkC,IAAR,CAAalC,SAAb;aACKA,SAAL,GAAiB+B,QAAQI,IAAR,CAAa,GAAb,EAAkBC,OAAlB,CAA0B,MAA1B,EAAkC,EAAlC,EAAsCA,OAAtC,CAA8C,MAA9C,EAAsD,EAAtD,CAAjB;;;WAGG3D,OAAP;GApGM;eAsGK,SAAS4D,WAAT,CAAqB1D,IAArB,EAA2BqB,SAA3B,EAAsC;QAC7CA,SAAJ,EAAe;UACTrB,KAAKqB,SAAL,KAAmBA,SAAvB,EAAkC;aAC3BsC,eAAL,CAAqB,OAArB;OADF,MAEO;YACDP,UAAUpD,KAAKqB,SAAL,CAAegC,KAAf,CAAqB,IAArB,CAAd;YACIO,QAAQR,QAAQE,OAAR,CAAgBjC,SAAhB,CAAZ;YACIuC,UAAU,CAAC,CAAf,EAAkB;kBACRC,MAAR,CAAeD,KAAf,EAAsB,CAAtB;eACKvC,SAAL,GAAiB+B,QAAQI,IAAR,CAAa,GAAb,CAAjB;;;KARN,MAWO;WACAnC,SAAL,GAAiB3I,SAAjB;;WAEKoH,OAAP;GArHM;YAuHE,SAASgE,QAAT,CAAkB9D,IAAlB,EAAwBqB,SAAxB,EAAmC;WACpC,IAAI0C,MAAJ,CAAW,eAAe1C,SAAf,GAA2B,YAAtC,EAAoD7H,IAApD,CAAyDwG,KAAKqB,SAA9D,KAA4E,KAAnF;GAxHM;YA0HE,SAAS2C,QAAT,CAAkBhE,IAAlB,EAAwB;QAC5B1L,QAAQ2P,iBAAiBjE,IAAjB,CAAZ;WACOJ,mBAAiBtL,MAAM,mBAAN,CAAjB,IAA+CsL,mBAAiBtL,MAAM,oBAAN,CAAjB,CAA/C,GAA+FsL,mBAAiBtL,MAAM,cAAN,CAAjB,CAA/F,GAAyIsL,mBAAiBtL,MAAM,eAAN,CAAjB,CAAzI,GAAoLsL,mBAAiBtL,MAAM4P,KAAvB,CAA3L;GA5HM;aA8HG,SAASC,SAAT,CAAmBnE,IAAnB,EAAyB;QAC9B1L,QAAQ2P,iBAAiBjE,IAAjB,CAAZ;WACOJ,mBAAiBtL,MAAM,kBAAN,CAAjB,IAA8CsL,mBAAiBtL,MAAM,qBAAN,CAAjB,CAA9C,GAA+FsL,mBAAiBtL,MAAM,aAAN,CAAjB,CAA/F,GAAwIsL,mBAAiBtL,MAAM,gBAAN,CAAjB,CAAxI,GAAoLsL,mBAAiBtL,MAAM8P,MAAvB,CAA3L;GAhIM;aAkIG,SAASC,SAAT,CAAmBC,EAAnB,EAAuB;QAC5BtE,OAAOsE,EAAX;QACIC,SAAS,EAAE3D,MAAM,CAAR,EAAWE,KAAK,CAAhB,EAAb;QACId,KAAKwE,YAAT,EAAuB;SAClB;eACM5D,IAAP,IAAeZ,KAAKyE,UAApB;eACO3D,GAAP,IAAcd,KAAK0E,SAAnB;eACO1E,KAAKwE,YAAZ;OAHF,QAISxE,IAJT;;WAMKuE,MAAP;GA5IM;YA8IE,SAASI,QAAT,CAAkB3E,IAAlB,EAAwB;WACzBA,SAASzL,SAASqQ,aAAlB,KAAoC5E,KAAK6E,IAAL,IAAa7E,KAAK8E,IAAtD,CAAP;;CA/IJ;AAmJA,IAAIC,sBAAoB,UAAUC,WAAV,EAAuB;aACpCD,iBAAT,EAA4BC,WAA5B;WACSD,iBAAT,CAA2BpI,MAA3B,EAAmCC,QAAnC,EAA6C;qBAC5B,IAAf,EAAqBmI,iBAArB;QACIE,SAASvH,4BAA0B,IAA1B,EAAgC,CAACqH,kBAAkBtH,SAAlB,IAA+BzG,OAAOkG,cAAP,CAAsB6H,iBAAtB,CAAhC,EAA0EpO,IAA1E,CAA+E,IAA/E,EAAqFgG,MAArF,EAA6FC,QAA7F,CAAhC,CAAb;QACIsI,QAAQD,MAAZ;WACOE,MAAP,GAAgBF,OAAO5F,QAAP,EAAhB;WACO+F,UAAP,GAAoB7Q,SAASC,aAAT,CAAuB,OAAvB,CAApB;WACO4Q,UAAP,CAAkB3Q,YAAlB,CAA+B,MAA/B,EAAuC,UAAvC;aACSuK,QAAT,GAAoB;YACZE,QAAN,CAAe,CAACgG,MAAMC,MAAtB;;YAEEhO,IAAJ,CAAS8N,OAAOG,UAAhB,EAA4B,QAA5B,EAAsCpG,QAAtC,EAAgD,KAAhD;WACOH,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOG,UAArC;WACOhG,aAAP;WACO6F,MAAP;;gBAEUF,iBAAZ,EAA+B,CAAC;SACzB,UADyB;WAEvB,SAAS7F,QAAT,CAAkBrJ,CAAlB,EAAqB;UACtBiE,WAAW4C,MAAIqI,kBAAkB5O,SAAlB,CAA4BsH,SAA5B,IAAyCzG,OAAOkG,cAAP,CAAsB6H,kBAAkB5O,SAAxC,CAA7C,EAAiG,UAAjG,EAA6G,IAA7G,EAAmHQ,IAAnH,CAAwH,IAAxH,EAA8Hd,CAA9H,CAAf;UACI,KAAKkJ,gBAAT,EAA2B;aACpBA,gBAAL,CAAsBpI,IAAtB,CAA2B,IAA3B,EAAiC,KAAK0I,QAAL,EAAjC;;WAEG8F,MAAL,GAAc,KAAK9F,QAAL,EAAd;aACOvF,QAAP;;GAR2B,EAU5B;SACI,eADJ;WAEM,SAASsF,aAAT,GAAyB;UAC1B,KAAKC,QAAL,OAAoB,IAAxB,EAA8B;aACvB+F,UAAL,CAAgB3Q,YAAhB,CAA6B,SAA7B,EAAwC,SAAxC;aACK2Q,UAAL,CAAgBC,OAAhB,GAA0B,IAA1B;aACKF,MAAL,GAAc,IAAd;OAHF,MAIO;aACAC,UAAL,CAAgBC,OAAhB,GAA0B,KAA1B;aACKF,MAAL,GAAc,KAAd;;aAEKzI,MAAIqI,kBAAkB5O,SAAlB,CAA4BsH,SAA5B,IAAyCzG,OAAOkG,cAAP,CAAsB6H,kBAAkB5O,SAAxC,CAA7C,EAAiG,eAAjG,EAAkH,IAAlH,EAAwHQ,IAAxH,CAA6H,IAA7H,CAAP;;GArB2B,CAA/B;SAwBOoO,iBAAP;CAzCsB,CA0CtBpG,YA1CsB,CAAxB;AA4CA,IAAI2G,qBAAmB,UAAUN,WAAV,EAAuB;aACnCM,gBAAT,EAA2BN,WAA3B;WACSM,gBAAT,CAA0B3I,MAA1B,EAAkCC,QAAlC,EAA4C2I,IAA5C,EAAkD;qBACjC,IAAf,EAAqBD,gBAArB;QACIL,SAASvH,4BAA0B,IAA1B,EAAgC,CAAC4H,iBAAiB7H,SAAjB,IAA8BzG,OAAOkG,cAAP,CAAsBoI,gBAAtB,CAA/B,EAAwE3O,IAAxE,CAA6E,IAA7E,EAAmFgG,MAAnF,EAA2FC,QAA3F,CAAhC,CAAb;QACI4I,UAAUD,IAAd;QACIL,QAAQD,MAAZ;WACOQ,QAAP,GAAkBlR,SAASC,aAAT,CAAuB,QAAvB,CAAlB;QACI+B,SAAOwC,OAAP,CAAeyM,OAAf,CAAJ,EAA6B;UACvBE,MAAM,EAAV;eACOhP,IAAP,CAAY8O,OAAZ,EAAqB,UAAUG,OAAV,EAAmB;YAClCA,OAAJ,IAAeA,OAAf;OADF;gBAGUD,GAAV;;aAEKhP,IAAP,CAAY8O,OAAZ,EAAqB,UAAUjK,KAAV,EAAiBtE,GAAjB,EAAsB;UACrC2O,MAAMrR,SAASC,aAAT,CAAuB,QAAvB,CAAV;UACIE,SAAJ,GAAgBuC,GAAhB;UACIxC,YAAJ,CAAiB,OAAjB,EAA0B8G,KAA1B;YACMkK,QAAN,CAAe7Q,WAAf,CAA2BgR,GAA3B;KAJF;WAMOxG,aAAP;YACIjI,IAAJ,CAAS8N,OAAOQ,QAAhB,EAA0B,QAA1B,EAAoC,YAAY;UAC1CI,eAAe,KAAKL,OAAL,CAAa,KAAKM,aAAlB,EAAiCvK,KAApD;YACM2D,QAAN,CAAe2G,YAAf;KAFF;WAIOhH,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOQ,QAArC;WACOR,MAAP;;gBAEUK,gBAAZ,EAA8B,CAAC;SACxB,UADwB;WAEtB,SAASpG,QAAT,CAAkBrJ,CAAlB,EAAqB;UACtBiE,WAAW4C,MAAI4I,iBAAiBnP,SAAjB,CAA2BsH,SAA3B,IAAwCzG,OAAOkG,cAAP,CAAsBoI,iBAAiBnP,SAAvC,CAA5C,EAA+F,UAA/F,EAA2G,IAA3G,EAAiHQ,IAAjH,CAAsH,IAAtH,EAA4Hd,CAA5H,CAAf;UACI,KAAKkJ,gBAAT,EAA2B;aACpBA,gBAAL,CAAsBpI,IAAtB,CAA2B,IAA3B,EAAiC,KAAK0I,QAAL,EAAjC;;aAEKvF,QAAP;;GAP0B,EAS3B;SACI,eADJ;WAEM,SAASsF,aAAT,GAAyB;UAC1BU,QAAI6E,QAAJ,CAAa,KAAKc,QAAlB,CAAJ,EAAiC,OAAO,IAAP;WAC5BA,QAAL,CAAclK,KAAd,GAAsB,KAAK8D,QAAL,EAAtB;aACO3C,MAAI4I,iBAAiBnP,SAAjB,CAA2BsH,SAA3B,IAAwCzG,OAAOkG,cAAP,CAAsBoI,iBAAiBnP,SAAvC,CAA5C,EAA+F,eAA/F,EAAgH,IAAhH,EAAsHQ,IAAtH,CAA2H,IAA3H,CAAP;;GAd0B,CAA9B;SAiBO2O,gBAAP;CA9CqB,CA+CrB3G,YA/CqB,CAAvB;AAiDA,IAAIoH,qBAAmB,UAAUf,WAAV,EAAuB;aACnCe,gBAAT,EAA2Bf,WAA3B;WACSe,gBAAT,CAA0BpJ,MAA1B,EAAkCC,QAAlC,EAA4C;qBAC3B,IAAf,EAAqBmJ,gBAArB;QACId,SAASvH,4BAA0B,IAA1B,EAAgC,CAACqI,iBAAiBtI,SAAjB,IAA8BzG,OAAOkG,cAAP,CAAsB6I,gBAAtB,CAA/B,EAAwEpP,IAAxE,CAA6E,IAA7E,EAAmFgG,MAAnF,EAA2FC,QAA3F,CAAhC,CAAb;QACIsI,QAAQD,MAAZ;aACSjG,QAAT,GAAoB;YACZE,QAAN,CAAegG,MAAMc,OAAN,CAAczK,KAA7B;;aAEO0K,MAAT,GAAkB;UACZf,MAAMnG,gBAAV,EAA4B;cACpBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAM7F,QAAN,EAAnC;;;WAGG2G,OAAP,GAAiBzR,SAASC,aAAT,CAAuB,OAAvB,CAAjB;WACOwR,OAAP,CAAevR,YAAf,CAA4B,MAA5B,EAAoC,MAApC;YACI0C,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,OAAzB,EAAkChH,QAAlC;YACI7H,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,QAAzB,EAAmChH,QAAnC;YACI7H,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,MAAzB,EAAiCC,MAAjC;YACI9O,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,SAAzB,EAAoC,UAAUtG,CAAV,EAAa;UAC3CA,EAAE6C,OAAF,KAAc,EAAlB,EAAsB;aACf2D,IAAL;;KAFJ;WAKO9G,aAAP;WACOP,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOe,OAArC;WACOf,MAAP;;gBAEUc,gBAAZ,EAA8B,CAAC;SACxB,eADwB;WAEtB,SAAS3G,aAAT,GAAyB;UAC1B,CAACU,QAAI6E,QAAJ,CAAa,KAAKqB,OAAlB,CAAL,EAAiC;aAC1BA,OAAL,CAAazK,KAAb,GAAqB,KAAK8D,QAAL,EAArB;;aAEK3C,MAAIqJ,iBAAiB5P,SAAjB,CAA2BsH,SAA3B,IAAwCzG,OAAOkG,cAAP,CAAsB6I,iBAAiB5P,SAAvC,CAA5C,EAA+F,eAA/F,EAAgH,IAAhH,EAAsHQ,IAAtH,CAA2H,IAA3H,CAAP;;GAN0B,CAA9B;SASOoP,gBAAP;CArCqB,CAsCrBpH,YAtCqB,CAAvB;AAwCA,SAASwH,aAAT,CAAqB1E,CAArB,EAAwB;MAClB3I,KAAK2I,EAAEtM,QAAF,EAAT;MACI2D,GAAGwK,OAAH,CAAW,GAAX,IAAkB,CAAC,CAAvB,EAA0B;WACjBxK,GAAG9C,MAAH,GAAY8C,GAAGwK,OAAH,CAAW,GAAX,CAAZ,GAA8B,CAArC;;SAEK,CAAP;;AAEF,IAAI8C,qBAAmB,UAAUpB,WAAV,EAAuB;aACnCoB,gBAAT,EAA2BpB,WAA3B;WACSoB,gBAAT,CAA0BzJ,MAA1B,EAAkCC,QAAlC,EAA4CwE,MAA5C,EAAoD;qBACnC,IAAf,EAAqBgF,gBAArB;QACIlB,QAAQxH,4BAA0B,IAA1B,EAAgC,CAAC0I,iBAAiB3I,SAAjB,IAA8BzG,OAAOkG,cAAP,CAAsBkJ,gBAAtB,CAA/B,EAAwEzP,IAAxE,CAA6E,IAA7E,EAAmFgG,MAAnF,EAA2FC,QAA3F,CAAhC,CAAZ;QACIyJ,UAAUjF,UAAU,EAAxB;UACMkF,KAAN,GAAcD,QAAQtL,GAAtB;UACMwL,KAAN,GAAcF,QAAQrL,GAAtB;UACMwL,MAAN,GAAeH,QAAQI,IAAvB;QACIlQ,SAAOW,WAAP,CAAmBgO,MAAMsB,MAAzB,CAAJ,EAAsC;UAChCtB,MAAMtG,YAAN,KAAuB,CAA3B,EAA8B;cACtB8H,aAAN,GAAsB,CAAtB;OADF,MAEO;cACCA,aAAN,GAAsBrR,KAAKsR,GAAL,CAAS,EAAT,EAAatR,KAAKmF,KAAL,CAAWnF,KAAKuR,GAAL,CAASvR,KAAKwR,GAAL,CAAS3B,MAAMtG,YAAf,CAAT,IAAyCvJ,KAAKyR,IAAzD,CAAb,IAA+E,EAArG;;KAJJ,MAMO;YACCJ,aAAN,GAAsBxB,MAAMsB,MAA5B;;UAEIO,WAAN,GAAoBZ,cAAYjB,MAAMwB,aAAlB,CAApB;WACOxB,KAAP;;gBAEUkB,gBAAZ,EAA8B,CAAC;SACxB,UADwB;WAEtB,SAASlH,QAAT,CAAkBrJ,CAAlB,EAAqB;UACtBmR,KAAKnR,CAAT;UACI,KAAKyQ,KAAL,KAAe5N,SAAf,IAA4BsO,KAAK,KAAKV,KAA1C,EAAiD;aAC1C,KAAKA,KAAV;OADF,MAEO,IAAI,KAAKC,KAAL,KAAe7N,SAAf,IAA4BsO,KAAK,KAAKT,KAA1C,EAAiD;aACjD,KAAKA,KAAV;;UAEE,KAAKC,MAAL,KAAgB9N,SAAhB,IAA6BsO,KAAK,KAAKR,MAAV,KAAqB,CAAtD,EAAyD;aAClDnR,KAAKC,KAAL,CAAW0R,KAAK,KAAKR,MAArB,IAA+B,KAAKA,MAAzC;;aAEK9J,MAAI0J,iBAAiBjQ,SAAjB,CAA2BsH,SAA3B,IAAwCzG,OAAOkG,cAAP,CAAsBkJ,iBAAiBjQ,SAAvC,CAA5C,EAA+F,UAA/F,EAA2G,IAA3G,EAAiHQ,IAAjH,CAAsH,IAAtH,EAA4HqQ,EAA5H,CAAP;;GAZ0B,EAc3B;SACI,KADJ;WAEM,SAASjM,GAAT,CAAakM,QAAb,EAAuB;WACvBX,KAAL,GAAaW,QAAb;aACO,IAAP;;GAlB0B,EAoB3B;SACI,KADJ;WAEM,SAASjM,GAAT,CAAakM,QAAb,EAAuB;WACvBX,KAAL,GAAaW,QAAb;aACO,IAAP;;GAxB0B,EA0B3B;SACI,MADJ;WAEM,SAAST,IAAT,CAAcU,SAAd,EAAyB;WACzBX,MAAL,GAAcW,SAAd;WACKT,aAAL,GAAqBS,SAArB;WACKJ,WAAL,GAAmBZ,cAAYgB,SAAZ,CAAnB;aACO,IAAP;;GAhC0B,CAA9B;SAmCOf,gBAAP;CAxDqB,CAyDrBzH,YAzDqB,CAAvB;AA2DA,SAASyI,gBAAT,CAAwB7L,KAAxB,EAA+B8L,QAA/B,EAAyC;MACnCC,QAAQjS,KAAKsR,GAAL,CAAS,EAAT,EAAaU,QAAb,CAAZ;SACOhS,KAAKC,KAAL,CAAWiG,QAAQ+L,KAAnB,IAA4BA,KAAnC;;AAEF,IAAIC,wBAAsB,UAAUC,iBAAV,EAA6B;aAC5CD,mBAAT,EAA8BC,iBAA9B;WACSD,mBAAT,CAA6B5K,MAA7B,EAAqCC,QAArC,EAA+CwE,MAA/C,EAAuD;qBACtC,IAAf,EAAqBmG,mBAArB;QACItC,SAASvH,4BAA0B,IAA1B,EAAgC,CAAC6J,oBAAoB9J,SAApB,IAAiCzG,OAAOkG,cAAP,CAAsBqK,mBAAtB,CAAlC,EAA8E5Q,IAA9E,CAAmF,IAAnF,EAAyFgG,MAAzF,EAAiGC,QAAjG,EAA2GwE,MAA3G,CAAhC,CAAb;WACOqG,qBAAP,GAA+B,KAA/B;QACIvC,QAAQD,MAAZ;QACIyC,QAAQ,KAAK,CAAjB;aACS1I,QAAT,GAAoB;UACd2I,YAAYhO,WAAWuL,MAAMc,OAAN,CAAczK,KAAzB,CAAhB;UACI,CAAChF,SAAOsC,KAAP,CAAa8O,SAAb,CAAL,EAA8B;cACtBzI,QAAN,CAAeyI,SAAf;;;aAGKC,QAAT,GAAoB;UACd1C,MAAMnG,gBAAV,EAA4B;cACpBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAM7F,QAAN,EAAnC;;;aAGK4G,MAAT,GAAkB;;;aAGT4B,WAAT,CAAqBnI,CAArB,EAAwB;UAClBoI,OAAOJ,QAAQhI,EAAEgC,OAArB;YACMxC,QAAN,CAAegG,MAAM7F,QAAN,KAAmByI,OAAO5C,MAAMwB,aAA/C;cACQhH,EAAEgC,OAAV;;aAEOqG,SAAT,GAAqB;cACf/E,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgCwT,WAAhC;cACI7E,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8B0T,SAA9B;;;aAGOC,WAAT,CAAqBtI,CAArB,EAAwB;cAClBvI,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8BwT,WAA9B;cACI1Q,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4B0T,SAA5B;cACQrI,EAAEgC,OAAV;;WAEKsE,OAAP,GAAiBzR,SAASC,aAAT,CAAuB,OAAvB,CAAjB;WACOwR,OAAP,CAAevR,YAAf,CAA4B,MAA5B,EAAoC,MAApC;YACI0C,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,QAAzB,EAAmChH,QAAnC;YACI7H,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,MAAzB,EAAiCC,MAAjC;YACI9O,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,WAAzB,EAAsCgC,WAAtC;YACI7Q,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,SAAzB,EAAoC,UAAUtG,CAAV,EAAa;UAC3CA,EAAE6C,OAAF,KAAc,EAAlB,EAAsB;cACdkF,qBAAN,GAA8B,IAA9B;aACKvB,IAAL;cACMuB,qBAAN,GAA8B,KAA9B;;;KAJJ;WAQOrI,aAAP;WACOP,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOe,OAArC;WACOf,MAAP;;gBAEUsC,mBAAZ,EAAiC,CAAC;SAC3B,eAD2B;WAEzB,SAASnI,aAAT,GAAyB;WACzB4G,OAAL,CAAazK,KAAb,GAAqB,KAAKkM,qBAAL,GAA6B,KAAKpI,QAAL,EAA7B,GAA+C+H,iBAAe,KAAK/H,QAAL,EAAf,EAAgC,KAAK0H,WAArC,CAApE;aACOrK,MAAI6K,oBAAoBpR,SAApB,CAA8BsH,SAA9B,IAA2CzG,OAAOkG,cAAP,CAAsBqK,oBAAoBpR,SAA1C,CAA/C,EAAqG,eAArG,EAAsH,IAAtH,EAA4HQ,IAA5H,CAAiI,IAAjI,CAAP;;GAJ6B,CAAjC;SAOO4Q,mBAAP;CA7DwB,CA8DxBnB,kBA9DwB,CAA1B;AAgEA,SAASV,KAAT,CAAa7P,CAAb,EAAgBoS,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4BC,EAA5B,EAAgC;SACvBD,KAAK,CAACC,KAAKD,EAAN,KAAa,CAACtS,IAAIoS,EAAL,KAAYC,KAAKD,EAAjB,CAAb,CAAZ;;AAEF,IAAII,2BAAyB,UAAUb,iBAAV,EAA6B;aAC/Ca,sBAAT,EAAiCb,iBAAjC;WACSa,sBAAT,CAAgC1L,MAAhC,EAAwCC,QAAxC,EAAkD7B,GAAlD,EAAuDC,GAAvD,EAA4DyL,IAA5D,EAAkE;qBACjD,IAAf,EAAqB4B,sBAArB;QACIpD,SAASvH,4BAA0B,IAA1B,EAAgC,CAAC2K,uBAAuB5K,SAAvB,IAAoCzG,OAAOkG,cAAP,CAAsBmL,sBAAtB,CAArC,EAAoF1R,IAApF,CAAyF,IAAzF,EAA+FgG,MAA/F,EAAuGC,QAAvG,EAAiH,EAAE7B,KAAKA,GAAP,EAAYC,KAAKA,GAAjB,EAAsByL,MAAMA,IAA5B,EAAjH,CAAhC,CAAb;QACIvB,QAAQD,MAAZ;WACOqD,YAAP,GAAsB/T,SAASC,aAAT,CAAuB,KAAvB,CAAtB;WACO+T,YAAP,GAAsBhU,SAASC,aAAT,CAAuB,KAAvB,CAAtB;YACI2C,IAAJ,CAAS8N,OAAOqD,YAAhB,EAA8B,WAA9B,EAA2CN,WAA3C;YACI7Q,IAAJ,CAAS8N,OAAOqD,YAAhB,EAA8B,YAA9B,EAA4CE,YAA5C;YACIrF,QAAJ,CAAa8B,OAAOqD,YAApB,EAAkC,QAAlC;YACInF,QAAJ,CAAa8B,OAAOsD,YAApB,EAAkC,WAAlC;aACSP,WAAT,CAAqBtI,CAArB,EAAwB;eACbkF,aAAT,CAAuBsB,IAAvB;cACI/O,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8BwT,WAA9B;cACI1Q,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4B0T,SAA5B;kBACYrI,CAAZ;;aAEOmI,WAAT,CAAqBnI,CAArB,EAAwB;QACpB+I,cAAF;UACIC,SAASxD,MAAMoD,YAAN,CAAmBK,qBAAnB,EAAb;YACMzJ,QAAN,CAAewG,MAAIhG,EAAE8B,OAAN,EAAekH,OAAO9H,IAAtB,EAA4B8H,OAAO7H,KAAnC,EAA0CqE,MAAMoB,KAAhD,EAAuDpB,MAAMqB,KAA7D,CAAf;aACO,KAAP;;aAEOwB,SAAT,GAAqB;cACf/E,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgCwT,WAAhC;cACI7E,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8B0T,SAA9B;UACI7C,MAAMnG,gBAAV,EAA4B;cACpBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAM7F,QAAN,EAAnC;;;aAGKmJ,YAAT,CAAsB9I,CAAtB,EAAyB;UACnBA,EAAEkJ,OAAF,CAAU5S,MAAV,KAAqB,CAAzB,EAA4B;;;cAGxBmB,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8BwU,WAA9B;cACI1R,IAAJ,CAAS9C,MAAT,EAAiB,UAAjB,EAA6ByU,UAA7B;kBACYpJ,CAAZ;;aAEOmJ,WAAT,CAAqBnJ,CAArB,EAAwB;UAClB8B,UAAU9B,EAAEkJ,OAAF,CAAU,CAAV,EAAapH,OAA3B;UACIkH,SAASxD,MAAMoD,YAAN,CAAmBK,qBAAnB,EAAb;YACMzJ,QAAN,CAAewG,MAAIlE,OAAJ,EAAakH,OAAO9H,IAApB,EAA0B8H,OAAO7H,KAAjC,EAAwCqE,MAAMoB,KAA9C,EAAqDpB,MAAMqB,KAA3D,CAAf;;aAEOuC,UAAT,GAAsB;cAChB9F,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgCwU,WAAhC;cACI7F,MAAJ,CAAW3O,MAAX,EAAmB,UAAnB,EAA+ByU,UAA/B;UACI5D,MAAMnG,gBAAV,EAA4B;cACpBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAM7F,QAAN,EAAnC;;;WAGGD,aAAP;WACOkJ,YAAP,CAAoB1T,WAApB,CAAgCqQ,OAAOsD,YAAvC;WACO1J,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOqD,YAArC;WACOrD,MAAP;;gBAEUoD,sBAAZ,EAAoC,CAAC;SAC9B,eAD8B;WAE5B,SAASjJ,aAAT,GAAyB;UAC1B2J,MAAM,CAAC,KAAK1J,QAAL,KAAkB,KAAKiH,KAAxB,KAAkC,KAAKC,KAAL,GAAa,KAAKD,KAApD,CAAV;WACKiC,YAAL,CAAkBjU,KAAlB,CAAwB4P,KAAxB,GAAgC6E,MAAM,GAAN,GAAY,GAA5C;aACOrM,MAAI2L,uBAAuBlS,SAAvB,CAAiCsH,SAAjC,IAA8CzG,OAAOkG,cAAP,CAAsBmL,uBAAuBlS,SAA7C,CAAlD,EAA2G,eAA3G,EAA4H,IAA5H,EAAkIQ,IAAlI,CAAuI,IAAvI,CAAP;;GALgC,CAApC;SAQO0R,sBAAP;CAhE2B,CAiE3BjC,kBAjE2B,CAA7B;AAmEA,IAAI4C,uBAAqB,UAAUhE,WAAV,EAAuB;aACrCgE,kBAAT,EAA6BhE,WAA7B;WACSgE,kBAAT,CAA4BrM,MAA5B,EAAoCC,QAApC,EAA8CqM,IAA9C,EAAoD;qBACnC,IAAf,EAAqBD,kBAArB;QACI/D,SAASvH,4BAA0B,IAA1B,EAAgC,CAACsL,mBAAmBvL,SAAnB,IAAgCzG,OAAOkG,cAAP,CAAsB8L,kBAAtB,CAAjC,EAA4ErS,IAA5E,CAAiF,IAAjF,EAAuFgG,MAAvF,EAA+FC,QAA/F,CAAhC,CAAb;QACIsI,QAAQD,MAAZ;WACOiE,QAAP,GAAkB3U,SAASC,aAAT,CAAuB,KAAvB,CAAlB;WACO0U,QAAP,CAAgBxU,SAAhB,GAA4BuU,SAASvQ,SAAT,GAAqB,MAArB,GAA8BuQ,IAA1D;YACI9R,IAAJ,CAAS8N,OAAOiE,QAAhB,EAA0B,OAA1B,EAAmC,UAAUxJ,CAAV,EAAa;QAC5C+I,cAAF;YACMU,IAAN;aACO,KAAP;KAHF;YAKIhG,QAAJ,CAAa8B,OAAOiE,QAApB,EAA8B,QAA9B;WACOrK,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOiE,QAArC;WACOjE,MAAP;;gBAEU+D,kBAAZ,EAAgC,CAAC;SAC1B,MAD0B;WAExB,SAASG,IAAT,GAAgB;UACjB,KAAKrK,UAAT,EAAqB;aACdA,UAAL,CAAgBnI,IAAhB,CAAqB,IAArB;;WAEG0I,QAAL,GAAgB1I,IAAhB,CAAqB,KAAKgG,MAA1B;UACI,KAAKoC,gBAAT,EAA2B;aACpBA,gBAAL,CAAsBpI,IAAtB,CAA2B,IAA3B,EAAiC,KAAK0I,QAAL,EAAjC;;;GAR0B,CAAhC;SAYO2J,kBAAP;CA7BuB,CA8BvBrK,YA9BuB,CAAzB;AAgCA,IAAIyK,oBAAkB,UAAUpE,WAAV,EAAuB;aAChCoE,eAAT,EAA0BpE,WAA1B;WACSoE,eAAT,CAAyBzM,MAAzB,EAAiCC,QAAjC,EAA2C;qBACxB,IAAf,EAAqBwM,eAArB;QACInE,SAASvH,4BAA0B,IAA1B,EAAgC,CAAC0L,gBAAgB3L,SAAhB,IAA6BzG,OAAOkG,cAAP,CAAsBkM,eAAtB,CAA9B,EAAsEzS,IAAtE,CAA2E,IAA3E,EAAiFgG,MAAjF,EAAyFC,QAAzF,CAAhC,CAAb;WACOyM,OAAP,GAAiB,IAAIxL,OAAJ,CAAUoH,OAAO5F,QAAP,EAAV,CAAjB;WACOiK,MAAP,GAAgB,IAAIzL,OAAJ,CAAU,CAAV,CAAhB;QACIqH,QAAQD,MAAZ;WACOpG,UAAP,GAAoBtK,SAASC,aAAT,CAAuB,KAAvB,CAApB;YACIuL,cAAJ,CAAmBkF,OAAOpG,UAA1B,EAAsC,KAAtC;WACO0K,UAAP,GAAoBhV,SAASC,aAAT,CAAuB,KAAvB,CAApB;WACO+U,UAAP,CAAkBlI,SAAlB,GAA8B,UAA9B;WACOmI,kBAAP,GAA4BjV,SAASC,aAAT,CAAuB,KAAvB,CAA5B;WACOgV,kBAAP,CAA0BnI,SAA1B,GAAsC,kBAAtC;WACOoI,YAAP,GAAsBlV,SAASC,aAAT,CAAuB,KAAvB,CAAtB;WACOiV,YAAP,CAAoBpI,SAApB,GAAgC,YAAhC;WACOqI,mBAAP,GAA6B,YAA7B;WACOC,UAAP,GAAoBpV,SAASC,aAAT,CAAuB,KAAvB,CAApB;WACOmV,UAAP,CAAkBtI,SAAlB,GAA8B,UAA9B;WACOuI,WAAP,GAAqBrV,SAASC,aAAT,CAAuB,KAAvB,CAArB;WACOoV,WAAP,CAAmBvI,SAAnB,GAA+B,WAA/B;WACO2E,OAAP,GAAiBzR,SAASC,aAAT,CAAuB,OAAvB,CAAjB;WACOwR,OAAP,CAAenB,IAAf,GAAsB,MAAtB;WACOgF,kBAAP,GAA4B,YAA5B;YACI1S,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,SAAzB,EAAoC,UAAUtG,CAAV,EAAa;UACzCA,EAAE6C,OAAF,KAAc,EAAlB,EAAsB;eACX5L,IAAP,CAAY,IAAZ;;KAFR;YAKIQ,IAAJ,CAAS8N,OAAOe,OAAhB,EAAyB,MAAzB,EAAiCC,MAAjC;YACI9O,IAAJ,CAAS8N,OAAOsE,UAAhB,EAA4B,WAA5B,EAAyC,YAAmB;cACpDpG,QAAJ,CAAa,IAAb,EAAmB,MAAnB,EAA2BhM,IAA3B,CAAgC9C,MAAhC,EAAwC,SAAxC,EAAmD,YAAmB;gBAC9DqP,WAAJ,CAAgBwB,MAAMqE,UAAtB,EAAkC,MAAlC;OADJ;KADJ;YAKIpS,IAAJ,CAAS8N,OAAOsE,UAAhB,EAA4B,YAA5B,EAA0C,YAAmB;cACrDpG,QAAJ,CAAa,IAAb,EAAmB,MAAnB,EAA2BhM,IAA3B,CAAgC9C,MAAhC,EAAwC,UAAxC,EAAoD,YAAmB;gBAC/DqP,WAAJ,CAAgBwB,MAAMqE,UAAtB,EAAkC,MAAlC;OADJ;KADJ;QAKIO,aAAavV,SAASC,aAAT,CAAuB,KAAvB,CAAjB;aACOgC,MAAP,CAAcyO,OAAOsE,UAAP,CAAkBjV,KAAhC,EAAuC;aAC5B,OAD4B;cAE3B,OAF2B;eAG1B,KAH0B;uBAIlB,MAJkB;iBAKxB;KALf;aAOOkC,MAAP,CAAcyO,OAAOwE,YAAP,CAAoBnV,KAAlC,EAAyC;gBAC3B,UAD2B;aAE9B,MAF8B;cAG7B,MAH6B;cAI7B2Q,OAAOyE,mBAAP,IAA8BzE,OAAOoE,OAAP,CAAexT,CAAf,GAAmB,GAAnB,GAAyB,MAAzB,GAAkC,MAAhE,CAJ6B;iBAK1B,6BAL0B;oBAMvB,MANuB;cAO7B;KAPZ;aASOW,MAAP,CAAcyO,OAAO0E,UAAP,CAAkBrV,KAAhC,EAAuC;gBACzB,UADyB;aAE5B,MAF4B;cAG3B,KAH2B;mBAItB,gBAJsB;cAK3B;KALZ;aAOOkC,MAAP,CAAcyO,OAAOuE,kBAAP,CAA0BlV,KAAxC,EAA+C;aACpC,OADoC;cAEnC,OAFmC;cAGnC,gBAHmC;mBAI9B,KAJ8B;eAKlC,cALkC;cAMnC;KANZ;aAQOkC,MAAP,CAAcsT,WAAWxV,KAAzB,EAAgC;aACrB,MADqB;cAEpB,MAFoB;kBAGhB;KAHhB;qBAKewV,UAAf,EAA2B,KAA3B,EAAkC,eAAlC,EAAmD,MAAnD;aACOtT,MAAP,CAAcyO,OAAO2E,WAAP,CAAmBtV,KAAjC,EAAwC;aAC7B,MAD6B;cAE5B,OAF4B;cAG5B,gBAH4B;cAI5B,WAJ4B;gBAK1B,UAL0B;WAM/B,KAN+B;aAO7B;KAPX;kBASY2Q,OAAO2E,WAAnB;aACOpT,MAAP,CAAcyO,OAAOe,OAAP,CAAe1R,KAA7B,EAAoC;eACvB,MADuB;iBAErB,QAFqB;aAGzB,MAHyB;cAIxB,CAJwB;kBAKpB,MALoB;kBAMpB2Q,OAAO4E,kBAAP,GAA4B;KAN5C;YAQI1S,IAAJ,CAAS8N,OAAOuE,kBAAhB,EAAoC,WAApC,EAAiDO,SAAjD;YACI5S,IAAJ,CAAS8N,OAAOuE,kBAAhB,EAAoC,YAApC,EAAkDO,SAAlD;YACI5S,IAAJ,CAAS8N,OAAOwE,YAAhB,EAA8B,WAA9B,EAA2CM,SAA3C;YACI5S,IAAJ,CAAS8N,OAAOwE,YAAhB,EAA8B,YAA9B,EAA4CM,SAA5C;YACI5S,IAAJ,CAAS8N,OAAO2E,WAAhB,EAA6B,WAA7B,EAA0CI,UAA1C;YACI7S,IAAJ,CAAS8N,OAAO2E,WAAhB,EAA6B,YAA7B,EAA2CI,UAA3C;aACSD,SAAT,CAAmBrK,CAAnB,EAAsB;YACZA,CAAN;cACIvI,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8B4V,KAA9B;cACI9S,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8B4V,KAA9B;cACI9S,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4B6V,SAA5B;cACI/S,IAAJ,CAAS9C,MAAT,EAAiB,UAAjB,EAA6B6V,SAA7B;;aAEKF,UAAT,CAAoBtK,CAApB,EAAuB;WACdA,CAAL;cACIvI,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8B8V,IAA9B;cACIhT,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8B8V,IAA9B;cACIhT,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4B+V,QAA5B;cACIjT,IAAJ,CAAS9C,MAAT,EAAiB,UAAjB,EAA6B+V,QAA7B;;aAEKF,SAAT,GAAqB;cACblH,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgC4V,KAAhC;cACIjH,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgC4V,KAAhC;cACIjH,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8B6V,SAA9B;cACIlH,MAAJ,CAAW3O,MAAX,EAAmB,UAAnB,EAA+B6V,SAA/B;;;aAGKE,QAAT,GAAoB;cACZpH,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgC8V,IAAhC;cACInH,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgC8V,IAAhC;cACInH,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8B+V,QAA9B;cACIpH,MAAJ,CAAW3O,MAAX,EAAmB,UAAnB,EAA+B+V,QAA/B;;;aAGKnE,MAAT,GAAkB;UACVzO,IAAIuC,YAAU,KAAKwB,KAAf,CAAR;UACI/D,MAAM,KAAV,EAAiB;cACP6R,OAAN,CAAcpU,OAAd,GAAwBuC,CAAxB;cACM0H,QAAN,CAAegG,MAAMmE,OAAN,CAAcrL,UAAd,EAAf;OAFJ,MAGO;aACEzC,KAAL,GAAa2J,MAAMmE,OAAN,CAAclU,QAAd,EAAb;;;aAGCyS,QAAT,GAAoB;UACZ1C,MAAMnG,gBAAV,EAA4B;cAClBA,gBAAN,CAAuBpI,IAAvB,CAA4BuO,KAA5B,EAAmCA,MAAMmE,OAAN,CAAcrL,UAAd,EAAnC;;;WAGDwL,kBAAP,CAA0B5U,WAA1B,CAAsCkV,UAAtC;WACOP,UAAP,CAAkB3U,WAAlB,CAA8BqQ,OAAOwE,YAArC;WACOF,UAAP,CAAkB3U,WAAlB,CAA8BqQ,OAAOuE,kBAArC;WACOD,UAAP,CAAkB3U,WAAlB,CAA8BqQ,OAAO2E,WAArC;WACOA,WAAP,CAAmBhV,WAAnB,CAA+BqQ,OAAO0E,UAAtC;WACO9K,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOe,OAArC;WACOnH,UAAP,CAAkBjK,WAAlB,CAA8BqQ,OAAOsE,UAArC;WACOnK,aAAP;aACS6K,KAAT,CAAevK,CAAf,EAAkB;UACVA,EAAEmF,IAAF,CAAOvB,OAAP,CAAe,OAAf,MAA4B,CAAC,CAAjC,EAAoC;UAC9BmF,cAAF;;UAEA4B,YAAYnF,MAAMsE,kBAAN,CAAyBb,qBAAzB,EAAhB;UACI2B,OAAO5K,EAAEkJ,OAAF,IAAalJ,EAAEkJ,OAAF,CAAU,CAAV,CAAb,IAA6BlJ,CAAxC;UACI8B,UAAU8I,KAAK9I,OADnB;UAEIE,UAAU4I,KAAK5I,OAFnB;UAGI/L,IAAI,CAAC6L,UAAU6I,UAAUzJ,IAArB,KAA8ByJ,UAAUxJ,KAAV,GAAkBwJ,UAAUzJ,IAA1D,CAAR;UACI/K,IAAI,IAAI,CAAC6L,UAAU2I,UAAUvJ,GAArB,KAA6BuJ,UAAUtJ,MAAV,GAAmBsJ,UAAUvJ,GAA1D,CAAZ;UACIjL,IAAI,CAAR,EAAW;YACH,CAAJ;OADJ,MAEO,IAAIA,IAAI,CAAR,EAAW;YACV,CAAJ;;UAEAF,IAAI,CAAR,EAAW;YACH,CAAJ;OADJ,MAEO,IAAIA,IAAI,CAAR,EAAW;YACV,CAAJ;;YAEE0T,OAAN,CAAcxT,CAAd,GAAkBA,CAAlB;YACMwT,OAAN,CAAc1T,CAAd,GAAkBA,CAAlB;YACMuJ,QAAN,CAAegG,MAAMmE,OAAN,CAAcrL,UAAd,EAAf;aACO,KAAP;;aAEKmM,IAAT,CAAczK,CAAd,EAAiB;UACTA,EAAEmF,IAAF,CAAOvB,OAAP,CAAe,OAAf,MAA4B,CAAC,CAAjC,EAAoC;UAC9BmF,cAAF;;UAEA4B,YAAYnF,MAAM0E,WAAN,CAAkBjB,qBAAlB,EAAhB;UACI4B,QAAQ7K,EAAEkJ,OAAF,IAAalJ,EAAEkJ,OAAF,CAAU,CAAV,CAAb,IAA6BlJ,CAAzC;UACIgC,UAAU6I,MAAM7I,OADpB;UAEIhM,IAAI,IAAI,CAACgM,UAAU2I,UAAUvJ,GAArB,KAA6BuJ,UAAUtJ,MAAV,GAAmBsJ,UAAUvJ,GAA1D,CAAZ;UACIpL,IAAI,CAAR,EAAW;YACH,CAAJ;OADJ,MAEO,IAAIA,IAAI,CAAR,EAAW;YACV,CAAJ;;YAEE2T,OAAN,CAAc3T,CAAd,GAAkBA,IAAI,GAAtB;YACMwJ,QAAN,CAAegG,MAAMmE,OAAN,CAAcrL,UAAd,EAAf;aACO,KAAP;;WAEGiH,MAAP;;gBAEQmE,eAAZ,EAA6B,CAAC;SACrB,eADqB;WAEnB,SAAShK,aAAT,GAAyB;UACxB5H,IAAIuC,YAAU,KAAKsF,QAAL,EAAV,CAAR;UACI7H,MAAM,KAAV,EAAiB;YACTgT,WAAW,KAAf;iBACO9T,IAAP,CAAYmH,QAAMa,UAAlB,EAA8B,UAAUR,SAAV,EAAqB;cAC3C,CAAC3H,SAAOW,WAAP,CAAmBM,EAAE0G,SAAF,CAAnB,CAAD,IAAqC,CAAC3H,SAAOW,WAAP,CAAmB,KAAKmS,OAAL,CAAapU,OAAb,CAAqBiJ,SAArB,CAAnB,CAAtC,IAA6F1G,EAAE0G,SAAF,MAAiB,KAAKmL,OAAL,CAAapU,OAAb,CAAqBiJ,SAArB,CAAlH,EAAmJ;uBACpI,IAAX;mBACO,EAAP;;SAHR,EAKG,IALH;YAMIsM,QAAJ,EAAc;mBACHhU,MAAP,CAAc,KAAK6S,OAAL,CAAapU,OAA3B,EAAoCuC,CAApC;;;eAGDhB,MAAP,CAAc,KAAK8S,MAAL,CAAYrU,OAA1B,EAAmC,KAAKoU,OAAL,CAAapU,OAAhD;WACKqU,MAAL,CAAY7T,CAAZ,GAAgB,CAAhB;UACIgV,OAAO,KAAKpB,OAAL,CAAaxT,CAAb,GAAiB,GAAjB,IAAwB,KAAKwT,OAAL,CAAa1T,CAAb,GAAiB,GAAzC,GAA+C,GAA/C,GAAqD,CAAhE;UACI+U,QAAQ,MAAMD,IAAlB;eACOjU,MAAP,CAAc,KAAKiT,YAAL,CAAkBnV,KAAhC,EAAuC;oBACvB,MAAM,KAAK+U,OAAL,CAAa1T,CAAnB,GAAuB,CAAvB,GAA2B,IADJ;mBAExB,OAAO,IAAI,KAAK0T,OAAL,CAAaxT,CAAxB,IAA6B,CAA7B,GAAiC,IAFT;yBAGlB,KAAKyT,MAAL,CAAYvL,WAAZ,EAHkB;gBAI3B,KAAK2L,mBAAL,GAA2B,MAA3B,GAAoCe,IAApC,GAA2C,GAA3C,GAAiDA,IAAjD,GAAwD,GAAxD,GAA8DA,IAA9D,GAAqE;OAJjF;WAMKd,UAAL,CAAgBrV,KAAhB,CAAsBqW,SAAtB,GAAkC,CAAC,IAAI,KAAKtB,OAAL,CAAa3T,CAAb,GAAiB,GAAtB,IAA6B,GAA7B,GAAmC,IAArE;WACK4T,MAAL,CAAY3T,CAAZ,GAAgB,CAAhB;WACK2T,MAAL,CAAYzT,CAAZ,GAAgB,CAAhB;uBACe,KAAK2T,kBAApB,EAAwC,MAAxC,EAAgD,MAAhD,EAAwD,KAAKF,MAAL,CAAYvL,WAAZ,EAAxD;WACKiI,OAAL,CAAazK,KAAb,GAAqB,KAAK8N,OAAL,CAAalU,QAAb,EAArB;eACOqB,MAAP,CAAc,KAAKwP,OAAL,CAAa1R,KAA3B,EAAkC;yBACb,KAAK+U,OAAL,CAAatL,WAAb,EADa;eAEvB,SAAS0M,IAAT,GAAgB,GAAhB,GAAsBA,IAAtB,GAA6B,GAA7B,GAAmCA,IAAnC,GAA0C,GAFnB;oBAGlB,KAAKZ,kBAAL,GAA0B,OAA1B,GAAoCa,KAApC,GAA4C,GAA5C,GAAkDA,KAAlD,GAA0D,GAA1D,GAAgEA,KAAhE,GAAwE;OAHxF;;GA/BqB,CAA7B;SAsCOtB,eAAP;CA1OkB,CA2OpBzK,YA3OoB,CAAtB;AA4OA,IAAIiM,YAAU,CAAC,OAAD,EAAU,KAAV,EAAiB,UAAjB,EAA6B,MAA7B,EAAqC,EAArC,CAAd;AACA,SAASC,gBAAT,CAAwB7K,IAAxB,EAA8ByB,CAA9B,EAAiChM,CAAjC,EAAoCD,CAApC,EAAuC;OAC9BlB,KAAL,CAAWwW,UAAX,GAAwB,EAAxB;WACOpU,IAAP,CAAYkU,SAAZ,EAAqB,UAAUG,MAAV,EAAkB;SAC9BzW,KAAL,CAAW0W,OAAX,IAAsB,iBAAiBD,MAAjB,GAA0B,kBAA1B,GAA+CtJ,CAA/C,GAAmD,IAAnD,GAA0DhM,CAA1D,GAA8D,OAA9D,GAAwED,CAAxE,GAA4E,UAAlG;GADJ;;AAIJ,SAASyV,aAAT,CAAqBjL,IAArB,EAA2B;OAClB1L,KAAL,CAAWwW,UAAX,GAAwB,EAAxB;OACKxW,KAAL,CAAW0W,OAAX,IAAsB,oIAAtB;OACK1W,KAAL,CAAW0W,OAAX,IAAsB,iIAAtB;OACK1W,KAAL,CAAW0W,OAAX,IAAsB,4HAAtB;OACK1W,KAAL,CAAW0W,OAAX,IAAsB,6HAAtB;OACK1W,KAAL,CAAW0W,OAAX,IAAsB,yHAAtB;;AAGJ,IAAIE,sBAAoB,SAASA,iBAAT,CAA2BvO,MAA3B,EAAmCC,QAAnC,EAA6C;MAC/DgC,eAAejC,OAAOC,QAAP,CAAnB;MACIrG,SAAOwC,OAAP,CAAenC,UAAU,CAAV,CAAf,KAAgCL,SAAOQ,QAAP,CAAgBH,UAAU,CAAV,CAAhB,CAApC,EAAmE;WAC1D,IAAI0O,kBAAJ,CAAqB3I,MAArB,EAA6BC,QAA7B,EAAuChG,UAAU,CAAV,CAAvC,CAAP;;MAEEL,SAAO0C,QAAP,CAAgB2F,YAAhB,CAAJ,EAAmC;QAC7BrI,SAAO0C,QAAP,CAAgBrC,UAAU,CAAV,CAAhB,KAAiCL,SAAO0C,QAAP,CAAgBrC,UAAU,CAAV,CAAhB,CAArC,EAAoE;UAC9DL,SAAO0C,QAAP,CAAgBrC,UAAU,CAAV,CAAhB,CAAJ,EAAmC;eAC1B,IAAIyR,wBAAJ,CAA2B1L,MAA3B,EAAmCC,QAAnC,EAA6ChG,UAAU,CAAV,CAA7C,EAA2DA,UAAU,CAAV,CAA3D,EAAyEA,UAAU,CAAV,CAAzE,CAAP;;aAEK,IAAIyR,wBAAJ,CAA2B1L,MAA3B,EAAmCC,QAAnC,EAA6ChG,UAAU,CAAV,CAA7C,EAA2DA,UAAU,CAAV,CAA3D,CAAP;;QAEEL,SAAO0C,QAAP,CAAgBrC,UAAU,CAAV,CAAhB,CAAJ,EAAmC;aAC1B,IAAI2Q,qBAAJ,CAAwB5K,MAAxB,EAAgCC,QAAhC,EAA0C,EAAE7B,KAAKnE,UAAU,CAAV,CAAP,EAAqBoE,KAAKpE,UAAU,CAAV,CAA1B,EAAwC6P,MAAM7P,UAAU,CAAV,CAA9C,EAA1C,CAAP;;WAEK,IAAI2Q,qBAAJ,CAAwB5K,MAAxB,EAAgCC,QAAhC,EAA0C,EAAE7B,KAAKnE,UAAU,CAAV,CAAP,EAAqBoE,KAAKpE,UAAU,CAAV,CAA1B,EAA1C,CAAP;;MAEEL,SAAO2C,QAAP,CAAgB0F,YAAhB,CAAJ,EAAmC;WAC1B,IAAImH,kBAAJ,CAAqBpJ,MAArB,EAA6BC,QAA7B,CAAP;;MAEErG,SAAO6C,UAAP,CAAkBwF,YAAlB,CAAJ,EAAqC;WAC5B,IAAIoK,oBAAJ,CAAuBrM,MAAvB,EAA+BC,QAA/B,EAAyC,EAAzC,CAAP;;MAEErG,SAAO4C,SAAP,CAAiByF,YAAjB,CAAJ,EAAoC;WAC3B,IAAImG,mBAAJ,CAAsBpI,MAAtB,EAA8BC,QAA9B,CAAP;;SAEK,IAAP;CA1BF;AA6BA,IAAIuO,qBAAmB,UAAUnG,WAAV,EAAuB;aACnCmG,gBAAT,EAA2BnG,WAA3B;WACSmG,gBAAT,CAA0BxO,MAA1B,EAAkCC,QAAlC,EAA4C;qBAC3B,IAAf,EAAqBuO,gBAArB;QACIjG,QAAQxH,4BAA0B,IAA1B,EAAgC,CAACyN,iBAAiB1N,SAAjB,IAA8BzG,OAAOkG,cAAP,CAAsBiO,gBAAtB,CAA/B,EAAwExU,IAAxE,CAA6E,IAA7E,EAAmFgG,MAAnF,EAA2FC,QAA3F,CAAhC,CAAZ;UACMhG,SAAN,GAAkB;cACR+F,MADQ,EACAC,UAAUA,QADV,EACoB2I,MAAMrP,MAAMC,SAAN,CAAgBG,KAAhB,CAAsBK,IAAtB,CAA2BC,SAA3B,EAAsC,CAAtC;KAD5C;QAGI+F,OAAOC,QAAX,EAAqBsI,MAAMtI,QAAN,GAAiBD,OAAOC,QAAP,CAAgBsI,KAAhB,CAAjB;WACdA,KAAP;;gBAEUiG,gBAAZ,EAA8B,CAAC;SACxB,YADwB;SAExB,SAAS5M,MAAT,CAAgB6M,aAAhB,EAA+B;WAC7BC,WAAL,GAAmBD,aAAnB;KAH2B;SAKxB,SAAShN,MAAT,GAAkB;aACd,KAAKiN,WAAZ;;GAN0B,CAA9B;SASOF,gBAAP;CApBqB,CAqBrBxM,YArBqB,CAAvB;AAuBA,IAAIvK,QAAM;QACF,SAASkX,IAAT,CAAcC,GAAd,EAAmBC,KAAnB,EAA0B;QAC1BC,MAAMD,SAASjX,QAAnB;QACImX,OAAOD,IAAIjX,aAAJ,CAAkB,MAAlB,CAAX;SACKqQ,IAAL,GAAY,UAAZ;SACK8G,GAAL,GAAW,YAAX;SACK7G,IAAL,GAAYyG,GAAZ;QACIK,oBAAJ,CAAyB,MAAzB,EAAiC,CAAjC,EAAoChX,WAApC,CAAgD8W,IAAhD;GAPM;UASA,SAASG,MAAT,CAAgBC,UAAhB,EAA4BN,KAA5B,EAAmC;QACrCC,MAAMD,SAASjX,QAAnB;QACIwX,WAAWxX,SAASC,aAAT,CAAuB,OAAvB,CAAf;aACSqQ,IAAT,GAAgB,UAAhB;aACSnQ,SAAT,GAAqBoX,UAArB;QACInX,OAAO8W,IAAIG,oBAAJ,CAAyB,MAAzB,EAAiC,CAAjC,CAAX;QACI;WACGhX,WAAL,CAAiBmX,QAAjB;KADF,CAEE,OAAOrM,CAAP,EAAU;;CAjBhB;AAsBA,IAAIsM,uBAAqB,sqBAAzB;AAEA,SAASC,yBAAT,CAA+BC,QAA/B,EAAyC;aAC5BA,QAAX,EAAqB,OAAO,EAA5B;;AAEF,IAAIC,4BAA0B9X,OAAO4X,qBAAP,IAAgC5X,OAAO+X,2BAAvC,IAAsE/X,OAAOgY,wBAA7E,IAAyGhY,OAAOiY,sBAAhH,IAA0IjY,OAAOkY,uBAAjJ,IAA4KN,yBAA1M;AAEA,IAAIO,gBAAc,YAAY;WACnBA,WAAT,GAAuB;qBACN,IAAf,EAAqBA,WAArB;SACKC,iBAAL,GAAyBlY,SAASC,aAAT,CAAuB,KAAvB,CAAzB;aACOgC,MAAP,CAAc,KAAKiW,iBAAL,CAAuBnY,KAArC,EAA4C;uBACzB,iBADyB;WAErC,CAFqC;YAGpC,CAHoC;eAIjC,MAJiC;cAKlC,MALkC;eAMjC,CANiC;wBAOxB,qBAPwB;kBAQ9B;KARd;YAUIgM,cAAJ,CAAmB,KAAKmM,iBAAxB;SACKA,iBAAL,CAAuBnY,KAAvB,CAA6BqM,QAA7B,GAAwC,OAAxC;SACK9B,UAAL,GAAkBtK,SAASC,aAAT,CAAuB,KAAvB,CAAlB;aACOgC,MAAP,CAAc,KAAKqI,UAAL,CAAgBvK,KAA9B,EAAqC;gBACzB,OADyB;eAE1B,MAF0B;cAG3B,MAH2B;eAI1B,CAJ0B;wBAKjB,sDALiB;kBAMvB;KANd;aAQSoY,IAAT,CAAc9X,WAAd,CAA0B,KAAK6X,iBAA/B;aACSC,IAAT,CAAc9X,WAAd,CAA0B,KAAKiK,UAA/B;QACIqG,QAAQ,IAAZ;YACI/N,IAAJ,CAAS,KAAKsV,iBAAd,EAAiC,OAAjC,EAA0C,YAAY;YAC9CE,IAAN;KADF;;gBAIUH,WAAZ,EAAyB,CAAC;SACnB,MADmB;WAEjB,SAASI,IAAT,GAAgB;UACjB1H,QAAQ,IAAZ;WACKuH,iBAAL,CAAuBnY,KAAvB,CAA6BuY,OAA7B,GAAuC,OAAvC;WACKhO,UAAL,CAAgBvK,KAAhB,CAAsBuY,OAAtB,GAAgC,OAAhC;WACKhO,UAAL,CAAgBvK,KAAhB,CAAsBwY,OAAtB,GAAgC,CAAhC;WACKjO,UAAL,CAAgBvK,KAAhB,CAAsByY,eAAtB,GAAwC,YAAxC;WACKC,MAAL;eACOjV,KAAP,CAAa,YAAY;cACjB0U,iBAAN,CAAwBnY,KAAxB,CAA8BwY,OAA9B,GAAwC,CAAxC;cACMjO,UAAN,CAAiBvK,KAAjB,CAAuBwY,OAAvB,GAAiC,CAAjC;cACMjO,UAAN,CAAiBvK,KAAjB,CAAuByY,eAAvB,GAAyC,UAAzC;OAHF;;GATqB,EAetB;SACI,MADJ;WAEM,SAASJ,IAAT,GAAgB;UACjBzH,QAAQ,IAAZ;UACIyH,OAAO,SAASA,IAAT,GAAgB;cACnB9N,UAAN,CAAiBvK,KAAjB,CAAuBuY,OAAvB,GAAiC,MAAjC;cACMJ,iBAAN,CAAwBnY,KAAxB,CAA8BuY,OAA9B,GAAwC,MAAxC;gBACI7J,MAAJ,CAAWkC,MAAMrG,UAAjB,EAA6B,qBAA7B,EAAoD8N,IAApD;gBACI3J,MAAJ,CAAWkC,MAAMrG,UAAjB,EAA6B,eAA7B,EAA8C8N,IAA9C;gBACI3J,MAAJ,CAAWkC,MAAMrG,UAAjB,EAA6B,gBAA7B,EAA+C8N,IAA/C;OALF;cAOIxV,IAAJ,CAAS,KAAK0H,UAAd,EAA0B,qBAA1B,EAAiD8N,IAAjD;cACIxV,IAAJ,CAAS,KAAK0H,UAAd,EAA0B,eAA1B,EAA2C8N,IAA3C;cACIxV,IAAJ,CAAS,KAAK0H,UAAd,EAA0B,gBAA1B,EAA4C8N,IAA5C;WACKF,iBAAL,CAAuBnY,KAAvB,CAA6BwY,OAA7B,GAAuC,CAAvC;WACKjO,UAAL,CAAgBvK,KAAhB,CAAsBwY,OAAtB,GAAgC,CAAhC;WACKjO,UAAL,CAAgBvK,KAAhB,CAAsByY,eAAtB,GAAwC,YAAxC;;GA/BqB,EAiCtB;SACI,QADJ;WAEM,SAASC,MAAT,GAAkB;WAClBnO,UAAL,CAAgBvK,KAAhB,CAAsBsM,IAAtB,GAA6BvM,OAAO4Y,UAAP,GAAoB,CAApB,GAAwBnN,QAAIkE,QAAJ,CAAa,KAAKnF,UAAlB,IAAgC,CAAxD,GAA4D,IAAzF;WACKA,UAAL,CAAgBvK,KAAhB,CAAsBwM,GAAtB,GAA4BzM,OAAO6Y,WAAP,GAAqB,CAArB,GAAyBpN,QAAIqE,SAAJ,CAAc,KAAKtF,UAAnB,IAAiC,CAA1D,GAA8D,IAA1F;;GArCqB,CAAzB;SAwCO2N,WAAP;CAxEgB,EAAlB;AA2EA,IAAIW,eAAahZ,kBAAgB,orLAAhB,CAAjB;AAEAC,MAAIyX,MAAJ,CAAWsB,YAAX;AACA,IAAIC,kBAAgB,IAApB;AACA,IAAIC,kBAAgB,EAApB;AACA,IAAIC,wBAAsB,EAA1B;AACA,IAAIC,gCAA8B,SAAlC;AACA,IAAIC,2BAAyB,YAAY;MACnC;WACK,CAAC,CAACnZ,OAAOoZ,YAAhB;GADF,CAEE,OAAO/N,CAAP,EAAU;WACH,KAAP;;CAJyB,EAA7B;AAOA,IAAIgO,kBAAgB,KAAK,CAAzB;AACA,IAAIC,oBAAkB,IAAtB;AACA,IAAIC,uBAAqB,KAAK,CAA9B;AACA,IAAIjB,SAAO,KAAX;AACA,IAAIkB,iBAAe,EAAnB;AACA,IAAIC,UAAM,SAASA,GAAT,CAAa5M,IAAb,EAAmB;MACvBgE,QAAQ,IAAZ;MACI9D,SAASF,QAAQ,EAArB;OACKrC,UAAL,GAAkBtK,SAASC,aAAT,CAAuB,KAAvB,CAAlB;OACKuZ,IAAL,GAAYxZ,SAASC,aAAT,CAAuB,IAAvB,CAAZ;OACKqK,UAAL,CAAgBjK,WAAhB,CAA4B,KAAKmZ,IAAjC;UACI5K,QAAJ,CAAa,KAAKtE,UAAlB,EAA8BuO,eAA9B;OACKY,SAAL,GAAiB,EAAjB;OACKC,aAAL,GAAqB,EAArB;OACKC,mBAAL,GAA2B,EAA3B;OACKC,sCAAL,GAA8C,EAA9C;OACKC,WAAL,GAAmB,EAAnB;WACS7X,SAAOa,QAAP,CAAgBgK,MAAhB,EAAwB;gBACnB,KADmB;eAEpB,IAFoB;WAGxB0M,IAAIO;GAHJ,CAAT;WAKS9X,SAAOa,QAAP,CAAgBgK,MAAhB,EAAwB;eACpBA,OAAOkN,SADa;cAErBlN,OAAOkN;GAFV,CAAT;MAII,CAAC/X,SAAOW,WAAP,CAAmBkK,OAAOkK,IAA1B,CAAL,EAAsC;QAChClK,OAAOmN,MAAX,EAAmB;aACVjD,IAAP,CAAYiD,MAAZ,GAAqBnN,OAAOmN,MAA5B;;GAFJ,MAIO;WACEjD,IAAP,GAAc,EAAEiD,QAAQhB,6BAAV,EAAd;;MAEEhX,SAAOW,WAAP,CAAmBkK,OAAOnE,MAA1B,KAAqCmE,OAAOoN,QAAhD,EAA0D;mBAC3CjL,IAAb,CAAkB,IAAlB;;SAEKkL,SAAP,GAAmBlY,SAAOW,WAAP,CAAmBkK,OAAOnE,MAA1B,KAAqCmE,OAAOqN,SAA/D;MACIrN,OAAOkN,SAAP,IAAoB/X,SAAOW,WAAP,CAAmBkK,OAAOsN,UAA1B,CAAxB,EAA+D;WACtDA,UAAP,GAAoB,IAApB;;MAEEC,kBAAkBnB,4BAA0BC,aAAamB,OAAb,CAAqBC,sBAAoB,IAApB,EAA0B,SAA1B,CAArB,MAA+D,MAA/G;MACIC,qBAAqB,KAAK,CAA9B;MACIC,WAAW,KAAK,CAApB;SACO9S,gBAAP,CAAwB,IAAxB,EACA;YACU;WACD,SAASmC,MAAT,GAAkB;eACdgD,OAAOnE,MAAd;;KAHN;gBAMc;WACL,SAASmB,MAAT,GAAkB;eACdgD,OAAOsN,UAAd;;KARN;eAWa;WACJ,SAAStQ,MAAT,GAAkB;eACdgD,OAAOkN,SAAd;;KAbN;gBAgBc;WACL,SAASlQ,MAAT,GAAkB;eACdgD,OAAO4N,UAAd;;KAlBN;YAqBU;WACD,SAAS5Q,MAAT,GAAkB;YACjB8G,MAAMjI,MAAV,EAAkB;iBACTiI,MAAM+J,OAAN,GAAgBV,MAAvB;;eAEKnN,OAAOkK,IAAP,CAAYiD,MAAnB;OALI;WAOD,SAAShQ,MAAT,CAAgB1I,CAAhB,EAAmB;YAClBqP,MAAMjI,MAAV,EAAkB;gBACVgS,OAAN,GAAgBV,MAAhB,GAAyB1Y,CAAzB;SADF,MAEO;iBACEyV,IAAP,CAAYiD,MAAZ,GAAqB1Y,CAArB;;+BAEmB,IAArB;cACMqZ,MAAN;;KAnCN;WAsCS;WACA,SAAS9Q,MAAT,GAAkB;eACdgD,OAAO8C,KAAd;OAFG;WAIA,SAAS3F,MAAT,CAAgB1I,CAAhB,EAAmB;eACfqO,KAAP,GAAerO,CAAf;mBACSqP,KAAT,EAAgBrP,CAAhB;;KA5CN;UA+CQ;WACC,SAASuI,MAAT,GAAkB;eACdgD,OAAO+N,IAAd;OAFE;WAIC,SAAS5Q,MAAT,CAAgB1I,CAAhB,EAAmB;eACfsZ,IAAP,GAActZ,CAAd;YACIkZ,QAAJ,EAAc;mBACHra,SAAT,GAAqB0M,OAAO+N,IAA5B;;;KAtDR;YA0DU;WACD,SAAS/Q,MAAT,GAAkB;eACdgD,OAAOgO,MAAd;OAFI;WAID,SAAS7Q,MAAT,CAAgB1I,CAAhB,EAAmB;eACfuZ,MAAP,GAAgBvZ,CAAhB;YACIuL,OAAOgO,MAAX,EAAmB;kBACbjM,QAAJ,CAAa+B,MAAM6I,IAAnB,EAAyBD,IAAIuB,YAA7B;SADF,MAEO;kBACD3L,WAAJ,CAAgBwB,MAAM6I,IAAtB,EAA4BD,IAAIuB,YAAhC;;aAEGC,QAAL;YACIpK,MAAMqK,aAAV,EAAyB;gBACjBA,aAAN,CAAoB7a,SAApB,GAAgCmB,IAAIiY,IAAI0B,SAAR,GAAoB1B,IAAI2B,WAAxD;;;KAvER;UA2EQ;WACC,SAASrR,MAAT,GAAkB;eACdgD,OAAOkK,IAAd;;KA7EN;qBAgFmB;WACV,SAASlN,MAAT,GAAkB;eACduQ,eAAP;OAFa;WAIV,SAASpQ,MAAT,CAAgBsE,IAAhB,EAAsB;YACrB2K,wBAAJ,EAA4B;4BACR3K,IAAlB;cACIA,IAAJ,EAAU;oBACJ1L,IAAJ,CAAS9C,MAAT,EAAiB,QAAjB,EAA2Bya,kBAA3B;WADF,MAEO;oBACD9L,MAAJ,CAAW3O,MAAX,EAAmB,QAAnB,EAA6Bya,kBAA7B;;uBAEWY,OAAb,CAAqBb,sBAAoB3J,KAApB,EAA2B,SAA3B,CAArB,EAA4DrC,IAA5D;;;;GA7FR;MAkGItM,SAAOW,WAAP,CAAmBkK,OAAOnE,MAA1B,CAAJ,EAAuC;SAChCmS,MAAL,GAAchO,OAAOgO,MAAP,IAAiB,KAA/B;YACIjM,QAAJ,CAAa,KAAKtE,UAAlB,EAA8BiP,IAAI6B,UAAlC;YACI5P,cAAJ,CAAmB,KAAKlB,UAAxB,EAAoC,KAApC;QACI2O,wBAAJ,EAA4B;UACtBmB,eAAJ,EAAqB;cACbA,eAAN,GAAwB,IAAxB;YACIiB,WAAWnC,aAAamB,OAAb,CAAqBC,sBAAoB,IAApB,EAA0B,KAA1B,CAArB,CAAf;YACIe,QAAJ,EAAc;iBACLtE,IAAP,GAAcuE,KAAKC,KAAL,CAAWF,QAAX,CAAd;;;;SAIDL,aAAL,GAAqBhb,SAASC,aAAT,CAAuB,KAAvB,CAArB;SACK+a,aAAL,CAAmB7a,SAAnB,GAA+BoZ,IAAI2B,WAAnC;YACItM,QAAJ,CAAa,KAAKoM,aAAlB,EAAiCzB,IAAIiC,kBAArC;QACI3O,OAAO4N,UAAX,EAAuB;cACjB7L,QAAJ,CAAa,KAAKoM,aAAlB,EAAiCzB,IAAIkC,eAArC;WACKnR,UAAL,CAAgBoR,YAAhB,CAA6B,KAAKV,aAAlC,EAAiD,KAAK1Q,UAAL,CAAgBqR,UAAhB,CAA2B,CAA3B,CAAjD;KAFF,MAGO;cACD/M,QAAJ,CAAa,KAAKoM,aAAlB,EAAiCzB,IAAIqC,kBAArC;WACKtR,UAAL,CAAgBjK,WAAhB,CAA4B,KAAK2a,aAAjC;;YAEEpY,IAAJ,CAAS,KAAKoY,aAAd,EAA6B,OAA7B,EAAsC,YAAY;YAC1CH,MAAN,GAAe,CAAClK,MAAMkK,MAAtB;KADF;GAvBF,MA0BO;QACDhO,OAAOgO,MAAP,KAAkB1W,SAAtB,EAAiC;aACxB0W,MAAP,GAAgB,IAAhB;;QAEEgB,eAAe7b,SAAS8b,cAAT,CAAwBjP,OAAO+N,IAA/B,CAAnB;YACIhM,QAAJ,CAAaiN,YAAb,EAA2B,iBAA3B;eACWE,SAAOpL,KAAP,EAAckL,YAAd,CAAX;QACIG,eAAe,SAASA,YAAT,CAAsB7Q,CAAtB,EAAyB;QACxC+I,cAAF;YACM2G,MAAN,GAAe,CAAClK,MAAMkK,MAAtB;aACO,KAAP;KAHF;YAKIjM,QAAJ,CAAa,KAAK4K,IAAlB,EAAwBD,IAAIuB,YAA5B;YACIlM,QAAJ,CAAa4L,QAAb,EAAuB,OAAvB;YACI5X,IAAJ,CAAS4X,QAAT,EAAmB,OAAnB,EAA4BwB,YAA5B;QACI,CAACnP,OAAOgO,MAAZ,EAAoB;WACbA,MAAL,GAAc,KAAd;;;MAGAhO,OAAOkN,SAAX,EAAsB;QAChB/X,SAAOW,WAAP,CAAmBkK,OAAOnE,MAA1B,CAAJ,EAAuC;UACjC0Q,iBAAJ,EAAqB;+BACEpZ,SAASC,aAAT,CAAuB,KAAvB,CAArB;gBACI2O,QAAJ,CAAayK,oBAAb,EAAiCR,eAAjC;gBACIjK,QAAJ,CAAayK,oBAAb,EAAiCE,IAAI0C,0BAArC;iBACS9D,IAAT,CAAc9X,WAAd,CAA0BgZ,oBAA1B;4BACkB,KAAlB;;2BAEiBhZ,WAAnB,CAA+B,KAAKiK,UAApC;cACIsE,QAAJ,CAAa,KAAKtE,UAAlB,EAA8BiP,IAAI2C,gBAAlC;;QAEE,CAAC,KAAKxT,MAAV,EAAkB;iBACPiI,KAAT,EAAgB9D,OAAO8C,KAAvB;;;OAGCwM,eAAL,GAAuB,YAAY;UAC3BC,iBAAN;GADF;UAGIxZ,IAAJ,CAAS9C,MAAT,EAAiB,QAAjB,EAA2B,KAAKqc,eAAhC;UACIvZ,IAAJ,CAAS,KAAK4W,IAAd,EAAoB,qBAApB,EAA2C,KAAK2C,eAAhD;UACIvZ,IAAJ,CAAS,KAAK4W,IAAd,EAAoB,eAApB,EAAqC,KAAK2C,eAA1C;UACIvZ,IAAJ,CAAS,KAAK4W,IAAd,EAAoB,gBAApB,EAAsC,KAAK2C,eAA3C;OACKpB,QAAL;MACIlO,OAAOqN,SAAX,EAAsB;sBACJ,IAAhB;;uBAEmB,SAASK,kBAAT,GAA8B;QAC7CtB,4BAA0BC,aAAamB,OAAb,CAAqBC,sBAAoB3J,KAApB,EAA2B,SAA3B,CAArB,MAAgE,MAA9F,EAAsG;mBACvFwK,OAAb,CAAqBb,sBAAoB3J,KAApB,EAA2B,KAA3B,CAArB,EAAwD2K,KAAKe,SAAL,CAAe1L,MAAM2L,aAAN,EAAf,CAAxD;;GAFJ;OAKKC,4BAAL,GAAoChC,kBAApC;WACSiC,UAAT,GAAsB;QAChBC,OAAO9L,MAAM+J,OAAN,EAAX;SACK/K,KAAL,IAAc,CAAd;aACOnM,KAAP,CAAa,YAAY;WAClBmM,KAAL,IAAc,CAAd;KADF;;MAIE,CAAC9C,OAAOnE,MAAZ,EAAoB;;;CA7NtB;AAiOA6Q,QAAImD,UAAJ,GAAiB,YAAY;WACpB,CAACtE,MAAR;WACOjW,IAAP,CAAYmX,cAAZ,EAA0B,UAAUqD,GAAV,EAAe;QACnCrS,UAAJ,CAAevK,KAAf,CAAqBuY,OAArB,GAA+BF,SAAO,MAAP,GAAgB,EAA/C;GADF;CAFF;AAMAmB,QAAI2C,gBAAJ,GAAuB,GAAvB;AACA3C,QAAI0C,0BAAJ,GAAiC,IAAjC;AACA1C,QAAI6B,UAAJ,GAAiB,MAAjB;AACA7B,QAAIqD,oBAAJ,GAA2B,IAA3B;AACArD,QAAIsD,cAAJ,GAAqB,oBAArB;AACAtD,QAAIuB,YAAJ,GAAmB,QAAnB;AACAvB,QAAIiC,kBAAJ,GAAyB,cAAzB;AACAjC,QAAIkC,eAAJ,GAAsB,WAAtB;AACAlC,QAAIqC,kBAAJ,GAAyB,cAAzB;AACArC,QAAIuD,UAAJ,GAAiB,MAAjB;AACAvD,QAAIO,aAAJ,GAAoB,GAApB;AACAP,QAAI2B,WAAJ,GAAkB,gBAAlB;AACA3B,QAAI0B,SAAJ,GAAgB,eAAhB;AACA1B,QAAIwD,eAAJ,GAAsB,UAAU5R,CAAV,EAAa;MAC7BnL,SAASqQ,aAAT,CAAuBC,IAAvB,KAAgC,MAAhC,KAA2CnF,EAAE6R,KAAF,KAAYlE,eAAZ,IAA6B3N,EAAE6C,OAAF,KAAc8K,eAAtF,CAAJ,EAA0G;YACpG4D,UAAJ;;CAFJ;AAKAnR,QAAI3I,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4ByZ,QAAIwD,eAAhC,EAAiD,KAAjD;AACA/a,SAAOC,MAAP,CAAcsX,QAAI3X,SAAlB,EACA;OACO,SAASqb,GAAT,CAAa7U,MAAb,EAAqBC,QAArB,EAA+B;WAC3B6U,OAAK,IAAL,EAAW9U,MAAX,EAAmBC,QAAnB,EAA6B;mBACrB1G,MAAMC,SAAN,CAAgBG,KAAhB,CAAsBK,IAAtB,CAA2BC,SAA3B,EAAsC,CAAtC;KADR,CAAP;GAFJ;YAMY,SAAS8a,QAAT,CAAkB/U,MAAlB,EAA0BC,QAA1B,EAAoC;WACrC6U,OAAK,IAAL,EAAW9U,MAAX,EAAmBC,QAAnB,EAA6B;aAC3B;KADF,CAAP;GAPJ;UAWU,SAAS+U,MAAT,CAAgBC,UAAhB,EAA4B;SAC7B7D,IAAL,CAAU8D,WAAV,CAAsBD,WAAWE,IAAjC;SACK7D,aAAL,CAAmBpK,MAAnB,CAA0B,KAAKoK,aAAL,CAAmB3K,OAAnB,CAA2BsO,UAA3B,CAA1B,EAAkE,CAAlE;QACI1M,QAAQ,IAAZ;aACOnN,KAAP,CAAa,YAAY;YACjBuX,QAAN;KADF;GAfJ;WAmBW,SAASyC,OAAT,GAAmB;QACtB,KAAK9U,MAAT,EAAiB;YACT,IAAIa,KAAJ,CAAU,0DAA0D,uDAApE,CAAN;;QAEE,KAAKwQ,SAAT,EAAoB;2BACCuD,WAAnB,CAA+B,KAAKhT,UAApC;;QAEEqG,QAAQ,IAAZ;aACOxO,IAAP,CAAY,KAAKsX,SAAjB,EAA4B,UAAUgE,SAAV,EAAqB;YACzCC,YAAN,CAAmBD,SAAnB;KADF;YAGIhP,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8ByZ,QAAIwD,eAAlC,EAAmD,KAAnD;sBACgB,IAAhB;GA/BJ;aAiCa,SAASY,SAAT,CAAmB/C,IAAnB,EAAyB;QAC9B,KAAKnB,SAAL,CAAemB,IAAf,MAAyBzW,SAA7B,EAAwC;YAChC,IAAIoF,KAAJ,CAAU,iDAAiD,SAAjD,GAA6DqR,IAA7D,GAAoE,GAA9E,CAAN;;QAEEgD,eAAe,EAAEhD,MAAMA,IAAR,EAAclS,QAAQ,IAAtB,EAAnB;iBACaqR,SAAb,GAAyB,KAAKA,SAA9B;QACI,KAAKhD,IAAL,IACJ,KAAKA,IAAL,CAAU8G,OADN,IAEJ,KAAK9G,IAAL,CAAU8G,OAAV,CAAkBjD,IAAlB,CAFA,EAEyB;mBACVC,MAAb,GAAsB,KAAK9D,IAAL,CAAU8G,OAAV,CAAkBjD,IAAlB,EAAwBC,MAA9C;mBACa9D,IAAb,GAAoB,KAAKA,IAAL,CAAU8G,OAAV,CAAkBjD,IAAlB,CAApB;;QAEE+B,MAAM,IAAIpD,OAAJ,CAAQqE,YAAR,CAAV;SACKnE,SAAL,CAAemB,IAAf,IAAuB+B,GAAvB;QACImB,KAAK/B,SAAO,IAAP,EAAaY,IAAIrS,UAAjB,CAAT;YACIsE,QAAJ,CAAakP,EAAb,EAAiB,QAAjB;WACOnB,GAAP;GAjDJ;gBAmDgB,SAASe,YAAT,CAAsBK,MAAtB,EAA8B;SACrCvE,IAAL,CAAU8D,WAAV,CAAsBS,OAAOzT,UAAP,CAAkB0T,aAAxC;WACO,KAAKvE,SAAL,CAAesE,OAAOnD,IAAtB,CAAP;QACI,KAAK7D,IAAL,IACJ,KAAKA,IAAL,CAAU8G,OADN,IAEJ,KAAK9G,IAAL,CAAU8G,OAAV,CAAkBE,OAAOnD,IAAzB,CAFA,EAEgC;aACvB,KAAK7D,IAAL,CAAU8G,OAAV,CAAkBE,OAAOnD,IAAzB,CAAP;;sBAEcmD,MAAhB;QACIpN,QAAQ,IAAZ;aACOxO,IAAP,CAAY4b,OAAOtE,SAAnB,EAA8B,UAAUgE,SAAV,EAAqB;aAC1CC,YAAP,CAAoBD,SAApB;KADF;aAGOja,KAAP,CAAa,YAAY;YACjBuX,QAAN;KADF;GAhEJ;QAoEQ,SAASkD,IAAT,GAAgB;SACfpD,MAAL,GAAc,KAAd;GArEJ;SAuES,SAASqD,KAAT,GAAiB;SACjBrD,MAAL,GAAc,IAAd;GAxEJ;QA0EQ,SAASzC,IAAT,GAAgB;SACf9N,UAAL,CAAgBvK,KAAhB,CAAsBuY,OAAtB,GAAgC,MAAhC;GA3EJ;QA6EQ,SAASD,IAAT,GAAgB;SACf/N,UAAL,CAAgBvK,KAAhB,CAAsBuY,OAAtB,GAAgC,EAAhC;GA9EJ;YAgFY,SAASyC,QAAT,GAAoB;QACxB0B,OAAO,KAAK/B,OAAL,EAAX;QACI+B,KAAKtC,UAAT,EAAqB;UACf5N,MAAMhB,QAAIuE,SAAJ,CAAc2M,KAAKjD,IAAnB,EAAyBjN,GAAnC;UACIpL,IAAI,CAAR;eACOgB,IAAP,CAAYsa,KAAKjD,IAAL,CAAUmC,UAAtB,EAAkC,UAAUwC,IAAV,EAAgB;YAC5C,EAAE1B,KAAK1C,SAAL,IAAkBoE,SAAS1B,KAAK2B,UAAlC,CAAJ,EAAmD;eAC5C7S,QAAIqE,SAAJ,CAAcuO,IAAd,CAAL;;OAFJ;UAKIre,OAAO6Y,WAAP,GAAqBpM,GAArB,GAA2BwM,qBAA3B,GAAiD5X,CAArD,EAAwD;gBAClDyN,QAAJ,CAAa6N,KAAKnS,UAAlB,EAA8BiP,QAAIsD,cAAlC;aACKrD,IAAL,CAAUzZ,KAAV,CAAgB8P,MAAhB,GAAyB/P,OAAO6Y,WAAP,GAAqBpM,GAArB,GAA2BwM,qBAA3B,GAAiD,IAA1E;OAFF,MAGO;gBACD5J,WAAJ,CAAgBsN,KAAKnS,UAArB,EAAiCiP,QAAIsD,cAArC;aACKrD,IAAL,CAAUzZ,KAAV,CAAgB8P,MAAhB,GAAyB,MAAzB;;;QAGA4M,KAAK4B,eAAT,EAA0B;eACjB7a,KAAP,CAAa,YAAY;aAClB6a,eAAL,CAAqBte,KAArB,CAA2B8P,MAA3B,GAAoC4M,KAAKjD,IAAL,CAAU8E,YAAV,GAAyB,IAA7D;OADF;;QAIE7B,KAAKzB,aAAT,EAAwB;WACjBA,aAAL,CAAmBjb,KAAnB,CAAyB4P,KAAzB,GAAiC8M,KAAK9M,KAAL,GAAa,IAA9C;;GAxGN;qBA2GqB3N,SAAO0B,QAAP,CAAgB,YAAY;SACxCqX,QAAL;GADiB,EAEhB,EAFgB,CA3GrB;YA8GY,SAASwD,QAAT,GAAoB;QACxBvc,SAAOW,WAAP,CAAmBwW,eAAnB,CAAJ,EAAuC;wBACrB,IAAIlB,aAAJ,EAAhB;sBACc3N,UAAd,CAAyBnK,SAAzB,GAAqCsX,oBAArC;;QAEE,KAAK/O,MAAT,EAAiB;YACT,IAAIa,KAAJ,CAAU,gDAAV,CAAN;;QAEEoH,QAAQ,IAAZ;aACOxO,IAAP,CAAYR,MAAMC,SAAN,CAAgBG,KAAhB,CAAsBK,IAAtB,CAA2BC,SAA3B,CAAZ,EAAmD,UAAU+F,MAAV,EAAkB;UAC/DuI,MAAMgJ,mBAAN,CAA0BlY,MAA1B,KAAqC,CAAzC,EAA4C;sBAC9BkP,KAAZ;;UAEEA,MAAMgJ,mBAAN,CAA0B5K,OAA1B,CAAkC3G,MAAlC,MAA8C,CAAC,CAAnD,EAAsD;cAC9CuR,mBAAN,CAA0B3K,IAA1B,CAA+B5G,MAA/B;;KALJ;QAQI,KAAK2R,SAAT,EAAoB;iBACT,IAAT,EAAe,KAAKpK,KAApB;;GAhIN;WAmIW,SAAS+K,OAAT,GAAmB;QACtBiC,MAAM,IAAV;WACOA,IAAIjU,MAAX,EAAmB;YACXiU,IAAIjU,MAAV;;WAEKiU,GAAP;GAxIJ;iBA0IiB,SAASL,aAAT,GAAyB;QAClC/W,WAAW,KAAKwR,IAApB;aACS8D,MAAT,GAAkB,KAAKA,MAAvB;QACI,KAAKlB,mBAAL,CAAyBlY,MAAzB,GAAkC,CAAtC,EAAyC;eAC9BuY,MAAT,GAAkB,KAAKA,MAAvB;UACI,CAACzU,SAASiZ,UAAd,EAA0B;iBACfA,UAAT,GAAsB,EAAtB;;eAEOA,UAAT,CAAoB,KAAKxE,MAAzB,IAAmCyE,mBAAiB,IAAjB,CAAnC;;aAEOZ,OAAT,GAAmB,EAAnB;aACO1b,IAAP,CAAY,KAAKsX,SAAjB,EAA4B,UAAUrI,OAAV,EAAmB1O,GAAnB,EAAwB;eACzCmb,OAAT,CAAiBnb,GAAjB,IAAwB0O,QAAQkL,aAAR,EAAxB;KADF;WAGO/W,QAAP;GAxJJ;QA0JQ,SAASmZ,IAAT,GAAgB;QAChB,CAAC,KAAK3H,IAAL,CAAUyH,UAAf,EAA2B;WACpBzH,IAAL,CAAUyH,UAAV,GAAuB,EAAvB;;SAEGzH,IAAL,CAAUyH,UAAV,CAAqB,KAAKxE,MAA1B,IAAoCyE,mBAAiB,IAAjB,CAApC;yBACmB,IAAnB,EAAyB,KAAzB;SACKlC,4BAAL;GAhKJ;UAkKU,SAASoC,MAAT,CAAgBC,UAAhB,EAA4B;QAC9B,CAAC,KAAK7H,IAAL,CAAUyH,UAAf,EAA2B;WACpBzH,IAAL,CAAUyH,UAAV,GAAuB,EAAvB;WACKzH,IAAL,CAAUyH,UAAV,CAAqBxF,6BAArB,IAAoDyF,mBAAiB,IAAjB,EAAuB,IAAvB,CAApD;;SAEG1H,IAAL,CAAUyH,UAAV,CAAqBI,UAArB,IAAmCH,mBAAiB,IAAjB,CAAnC;SACKzE,MAAL,GAAc4E,UAAd;sBACgB,IAAhB,EAAsBA,UAAtB,EAAkC,IAAlC;SACKrC,4BAAL;GA1KJ;UA4KU,SAAS5B,MAAT,CAAgBgC,GAAhB,EAAqB;aACpBxa,IAAP,CAAY,KAAKuX,aAAjB,EAAgC,UAAU2D,UAAV,EAAsB;UAChD,CAAC,KAAK3C,OAAL,GAAe3D,IAAf,CAAoByH,UAAzB,EAAqC;mBACxB7T,QAAX,CAAoB0S,WAAWhT,YAA/B;OADF,MAEO;2BACYsS,OAAO,KAAKjC,OAAL,EAAxB,EAAwC2C,UAAxC;;UAEEA,WAAW7S,gBAAf,EAAiC;mBACpBA,gBAAX,CAA4BpI,IAA5B,CAAiCib,UAAjC,EAA6CA,WAAWvS,QAAX,EAA7C;;KAPJ,EASG,IATH;aAUO3I,IAAP,CAAY,KAAKsX,SAAjB,EAA4B,UAAUsE,MAAV,EAAkB;aACrCpD,MAAP,CAAcoD,MAAd;KADF;QAGI,CAACpB,GAAL,EAAU;2BACW,KAAKjC,OAAL,EAAnB,EAAmC,KAAnC;;GA3LN;UA8LU,SAASmE,MAAT,CAAgBxB,UAAhB,EAA4B;QAC9B5P,OAAO,KAAKoM,WAAL,CAAiBpY,MAAjB,KAA4B,CAAvC;SACKoY,WAAL,CAAiB7K,IAAjB,CAAsBqO,UAAtB;QACI5P,IAAJ,EAAU;uBACO,KAAKoM,WAApB;;GAlMN;iBAqMiB,SAAShP,aAAT,GAAyB;aAC/B1I,IAAP,CAAY,KAAKuX,aAAjB,EAAgC,UAAU2D,UAAV,EAAsB;iBACzCxS,aAAX;KADF;aAGO1I,IAAP,CAAY,KAAKsX,SAAjB,EAA4B,UAAUsE,MAAV,EAAkB;aACrClT,aAAP;KADF;;CA1MJ;AA+MA,SAASkR,QAAT,CAAgBY,GAAhB,EAAqBmC,MAArB,EAA6BC,QAA7B,EAAuC;MACjCjB,KAAK9d,SAASC,aAAT,CAAuB,IAAvB,CAAT;MACI6e,MAAJ,EAAY;OACPze,WAAH,CAAeye,MAAf;;MAEEC,QAAJ,EAAc;QACRvF,IAAJ,CAASkC,YAAT,CAAsBoC,EAAtB,EAA0BiB,QAA1B;GADF,MAEO;QACDvF,IAAJ,CAASnZ,WAAT,CAAqByd,EAArB;;MAEE/C,QAAJ;SACO+C,EAAP;;AAEF,SAASkB,iBAAT,CAAyBrC,GAAzB,EAA8B;UACxBlO,MAAJ,CAAW3O,MAAX,EAAmB,QAAnB,EAA6B6c,IAAIR,eAAjC;MACIQ,IAAIJ,4BAAR,EAAsC;YAChC9N,MAAJ,CAAW3O,MAAX,EAAmB,QAAnB,EAA6B6c,IAAIJ,4BAAjC;;;AAGJ,SAAS0C,oBAAT,CAA4BtC,GAA5B,EAAiCuC,QAAjC,EAA2C;MACrC7N,MAAMsL,IAAIwC,eAAJ,CAAoBxC,IAAIwC,eAAJ,CAAoB5N,aAAxC,CAAV;MACI2N,QAAJ,EAAc;QACR/e,SAAJ,GAAgBkR,IAAIrK,KAAJ,GAAY,GAA5B;GADF,MAEO;QACD7G,SAAJ,GAAgBkR,IAAIrK,KAApB;;;AAGJ,SAASoY,mBAAT,CAA2BzC,GAA3B,EAAgCmB,EAAhC,EAAoCT,UAApC,EAAgD;aACnCE,IAAX,GAAkBO,EAAlB;aACWuB,KAAX,GAAmB1C,GAAnB;WACO1a,MAAP,CAAcob,UAAd,EAA4D;aACjD,SAASpM,OAAT,CAAiBqO,QAAjB,EAA2B;UAC9Bjd,UAAUZ,MAAV,GAAmB,CAAvB,EAA0B;YACpB8d,cAAclC,WAAWE,IAAX,CAAgBiC,kBAAlC;mBACWpC,MAAX;eACOF,OAAKP,GAAL,EAAUU,WAAWjV,MAArB,EAA6BiV,WAAWhV,QAAxC,EAAkD;kBAC/CkX,WAD+C;uBAE1C,CAACvd,SAAOkC,OAAP,CAAe7B,SAAf,CAAD;SAFR,CAAP;;UAKEL,SAAOwC,OAAP,CAAe8a,QAAf,KAA4Btd,SAAOQ,QAAP,CAAgB8c,QAAhB,CAAhC,EAA2D;YACrDG,eAAepC,WAAWE,IAAX,CAAgBiC,kBAAnC;mBACWpC,MAAX;eACOF,OAAKP,GAAL,EAAUU,WAAWjV,MAArB,EAA6BiV,WAAWhV,QAAxC,EAAkD;kBAC/CoX,YAD+C;uBAE1C,CAACH,QAAD;SAFR,CAAP;;KAbsD;UAmBpD,SAAS1E,IAAT,CAAc8E,KAAd,EAAqB;iBACdnC,IAAX,CAAgBoC,iBAAhB,CAAkCA,iBAAlC,CAAoDxf,SAApD,GAAgEuf,KAAhE;aACOrC,UAAP;KArBwD;YAuBlD,SAASwB,MAAT,GAAkB;iBACbQ,KAAX,CAAiBR,MAAjB,CAAwBxB,UAAxB;aACOA,UAAP;KAzBwD;YA2BlD,SAASD,MAAT,GAAkB;iBACbiC,KAAX,CAAiBjC,MAAjB,CAAwBC,UAAxB;aACOA,UAAP;;GA7BJ;MAgCIA,sBAAsBvJ,wBAA1B,EAAkD;QAC5C8L,MAAM,IAAI5M,qBAAJ,CAAwBqK,WAAWjV,MAAnC,EAA2CiV,WAAWhV,QAAtD,EAAgE,EAAE7B,KAAK6W,WAAWtL,KAAlB,EAAyBtL,KAAK4W,WAAWrL,KAAzC,EAAgDE,MAAMmL,WAAWpL,MAAjE,EAAhE,CAAV;aACO9P,IAAP,CAAY,CAAC,eAAD,EAAkB,UAAlB,EAA8B,gBAA9B,EAAgD,MAAhD,EAAwD,KAAxD,EAA+D,KAA/D,CAAZ,EAAmF,UAAU0d,MAAV,EAAkB;UAC/FC,KAAKzC,WAAWwC,MAAX,CAAT;UACIE,KAAKH,IAAIC,MAAJ,CAAT;iBACWA,MAAX,IAAqBD,IAAIC,MAAJ,IAAc,YAAY;YACzC7c,OAAOrB,MAAMC,SAAN,CAAgBG,KAAhB,CAAsBK,IAAtB,CAA2BC,SAA3B,CAAX;WACGa,KAAH,CAAS0c,GAAT,EAAc5c,IAAd;eACO8c,GAAG5c,KAAH,CAASma,UAAT,EAAqBra,IAArB,CAAP;OAHF;KAHF;YASI4L,QAAJ,CAAakP,EAAb,EAAiB,YAAjB;eACWxT,UAAX,CAAsBoR,YAAtB,CAAmCkE,IAAItV,UAAvC,EAAmD+S,WAAW/S,UAAX,CAAsBqV,iBAAzE;GAZF,MAaO,IAAItC,sBAAsBrK,qBAA1B,EAA+C;QAChDnS,IAAI,SAASA,CAAT,CAAWmf,QAAX,EAAqB;UACvBhe,SAAO0C,QAAP,CAAgB2Y,WAAWtL,KAA3B,KAAqC/P,SAAO0C,QAAP,CAAgB2Y,WAAWrL,KAA3B,CAAzC,EAA4E;YACtEiO,UAAU5C,WAAWE,IAAX,CAAgBoC,iBAAhB,CAAkCA,iBAAlC,CAAoDxf,SAAlE;YACI+f,eAAe7C,WAAWgC,KAAX,CAAiBxF,WAAjB,CAA6B9K,OAA7B,CAAqCsO,UAArC,IAAmD,CAAC,CAAvE;mBACWD,MAAX;YACIvG,gBAAgBqG,OAAKP,GAAL,EAAUU,WAAWjV,MAArB,EAA6BiV,WAAWhV,QAAxC,EAAkD;kBAC5DgV,WAAWE,IAAX,CAAgBiC,kBAD4C;uBAEvD,CAACnC,WAAWtL,KAAZ,EAAmBsL,WAAWrL,KAA9B,EAAqCqL,WAAWpL,MAAhD;SAFK,CAApB;sBAIc2I,IAAd,CAAmBqF,OAAnB;YACIC,YAAJ,EAAkBrJ,cAAcgI,MAAd;eACXhI,aAAP;;aAEKmJ,QAAP;KAbF;eAeWxZ,GAAX,GAAiBxE,SAAOc,OAAP,CAAejC,CAAf,EAAkBwc,WAAW7W,GAA7B,CAAjB;eACWC,GAAX,GAAiBzE,SAAOc,OAAP,CAAejC,CAAf,EAAkBwc,WAAW5W,GAA7B,CAAjB;GAjBK,MAkBA,IAAI4W,sBAAsB7M,mBAA1B,EAA6C;YAC9C5N,IAAJ,CAASkb,EAAT,EAAa,OAAb,EAAsB,YAAY;cAC5BrR,SAAJ,CAAc4Q,WAAWxM,UAAzB,EAAqC,OAArC;KADF;YAGIjO,IAAJ,CAASya,WAAWxM,UAApB,EAAgC,OAAhC,EAAyC,UAAU1F,CAAV,EAAa;QAClDgV,eAAF;KADF;GAJK,MAOA,IAAI9C,sBAAsB5I,oBAA1B,EAA8C;YAC/C7R,IAAJ,CAASkb,EAAT,EAAa,OAAb,EAAsB,YAAY;cAC5BrR,SAAJ,CAAc4Q,WAAW1I,QAAzB,EAAmC,OAAnC;KADF;YAGI/R,IAAJ,CAASkb,EAAT,EAAa,WAAb,EAA0B,YAAY;cAChClP,QAAJ,CAAayO,WAAW1I,QAAxB,EAAkC,OAAlC;KADF;YAGI/R,IAAJ,CAASkb,EAAT,EAAa,UAAb,EAAyB,YAAY;cAC/B3O,WAAJ,CAAgBkO,WAAW1I,QAA3B,EAAqC,OAArC;KADF;GAPK,MAUA,IAAI0I,sBAAsBxI,iBAA1B,EAA2C;YAC5CjG,QAAJ,CAAakP,EAAb,EAAiB,OAAjB;eACWjT,aAAX,GAA2B7I,SAAOc,OAAP,CAAe,UAAUwI,GAAV,EAAe;SACpDvL,KAAH,CAASqgB,eAAT,GAA2B/C,WAAWvI,OAAX,CAAmBlU,QAAnB,EAA3B;aACO0K,GAAP;KAFyB,EAGxB+R,WAAWxS,aAHa,CAA3B;eAIWA,aAAX;;aAESF,QAAX,GAAsB3I,SAAOc,OAAP,CAAe,UAAUwI,GAAV,EAAe;QAC9CqR,IAAIjC,OAAJ,GAAcyE,eAAd,IAAiC9B,WAAWtS,UAAX,EAArC,EAA8D;2BACzC4R,IAAIjC,OAAJ,EAAnB,EAAkC,IAAlC;;WAEKpP,GAAP;GAJoB,EAKnB+R,WAAW1S,QALQ,CAAtB;;AAOF,SAAS0V,kBAAT,CAA0B1D,GAA1B,EAA+BU,UAA/B,EAA2C;MACrCZ,OAAOE,IAAIjC,OAAJ,EAAX;MACI4F,eAAe7D,KAAK9C,mBAAL,CAAyB5K,OAAzB,CAAiCsO,WAAWjV,MAA5C,CAAnB;MACIkY,iBAAiB,CAAC,CAAtB,EAAyB;QACnBC,gBAAgB9D,KAAK7C,sCAAL,CAA4C0G,YAA5C,CAApB;QACIC,kBAAkBpc,SAAtB,EAAiC;sBACf,EAAhB;WACKyV,sCAAL,CAA4C0G,YAA5C,IAA4DC,aAA5D;;kBAEYlD,WAAWhV,QAAzB,IAAqCgV,UAArC;QACIZ,KAAK1F,IAAL,IAAa0F,KAAK1F,IAAL,CAAUyH,UAA3B,EAAuC;UACjCgC,YAAY/D,KAAK1F,IAAL,CAAUyH,UAA1B;UACIxE,SAAS,KAAK,CAAlB;UACIwG,UAAU7D,IAAI3C,MAAd,CAAJ,EAA2B;iBAChBwG,UAAU7D,IAAI3C,MAAd,CAAT;OADF,MAEO,IAAIwG,UAAUxH,6BAAV,CAAJ,EAA4C;iBACxCwH,UAAUxH,6BAAV,CAAT;OADK,MAEA;;;UAGHgB,OAAOsG,YAAP,KAAwBtG,OAAOsG,YAAP,EAAqBjD,WAAWhV,QAAhC,MAA8ClE,SAA1E,EAAqF;YAC/E6C,QAAQgT,OAAOsG,YAAP,EAAqBjD,WAAWhV,QAAhC,CAAZ;mBACWgC,YAAX,GAA0BrD,KAA1B;mBACW2D,QAAX,CAAoB3D,KAApB;;;;;AAKR,SAASkW,MAAT,CAAcP,GAAd,EAAmBvU,MAAnB,EAA2BC,QAA3B,EAAqCwE,MAArC,EAA6C;MACvC4T,YAAJ;MACIrY,OAAO/F,SAAX,EAAsB;mBACL+F,MAAf;aACSqY,aAAape,SAAb,CAAuB+F,MAAhC;eACWqY,aAAape,SAAb,CAAuBgG,QAAlC;aACS;mBACMoY,aAAape,SAAb,CAAuB2O;KADtC;;MAIEyP,iBAAiBtc,SAAjB,IAA8BiE,OAAOC,QAAP,MAAqBlE,SAAvD,EAAkE;UAC1D,IAAIoF,KAAJ,CAAU,aAAanB,MAAb,GAAsB,qBAAtB,GAA8CC,QAA9C,GAAyD,GAAnE,CAAN;;MAEEgV,aAAa,KAAK,CAAtB;MACIxQ,OAAOtM,KAAX,EAAkB;iBACH,IAAIsU,iBAAJ,CAAoBzM,MAApB,EAA4BC,QAA5B,CAAb;GADF,MAEO,IAAIoY,iBAAiBtc,SAAjB,IAA8B,OAAOsc,aAAapY,QAApB,KAAiC,QAAnE,EAA6E;iBACrEoY,YAAb;GADK,MAEA;QACDC,cAAc,CAACtY,MAAD,EAASC,QAAT,EAAmBsY,MAAnB,CAA0B9T,OAAO6T,WAAjC,CAAlB;iBACa/J,oBAAkBzT,KAAlB,CAAwByZ,GAAxB,EAA6B+D,WAA7B,CAAb;;MAEErD,eAAe,IAAnB,EAAyBA,aAAaoD,YAAb,CAAzB,KAAwD,IAAIA,iBAAiBtc,SAArB,EAAgCsc,aAAapD,UAAb,GAA0BA,UAA1B;MACpFxQ,OAAO+T,MAAP,YAAyBxW,YAA7B,EAAyC;WAChCwW,MAAP,GAAgB/T,OAAO+T,MAAP,CAAcrD,IAA9B;;qBAEeZ,GAAjB,EAAsBU,UAAtB;UACIzO,QAAJ,CAAayO,WAAW/S,UAAxB,EAAoC,GAApC;MACIsQ,OAAO5a,SAASC,aAAT,CAAuB,MAAvB,CAAX;UACI2O,QAAJ,CAAagM,IAAb,EAAmB,eAAnB;MACI6F,iBAAiBtc,SAAjB,IAA8B8C,UAAQwZ,aAAapY,QAArB,MAAmC,QAArE,EAA+E;SACxE,IAAIwY,YAAT,IAAyBJ,aAAapY,QAAtC,EAAgD;WACzChI,WAAL,CAAiBogB,aAAapY,QAAb,CAAsBwY,YAAtB,CAAjB;;GAFJ,MAIOjG,KAAKza,SAAL,GAAiBkd,WAAWhV,QAA5B;MACHyY,YAAY9gB,SAASC,aAAT,CAAuB,KAAvB,CAAhB;YACUI,WAAV,CAAsBua,IAAtB;YACUva,WAAV,CAAsBgd,WAAW/S,UAAjC;MACIwT,KAAK/B,SAAOY,GAAP,EAAYmE,SAAZ,EAAuBjU,OAAO+T,MAA9B,CAAT;UACIhS,QAAJ,CAAakP,EAAb,EAAiBvE,QAAIqD,oBAArB;MACIS,sBAAsBxI,iBAA1B,EAA2C;YACrCjG,QAAJ,CAAakP,EAAb,EAAiB,OAAjB;GADF,MAEO;YACDlP,QAAJ,CAAakP,EAAb,EAAiB7W,UAAQoW,WAAWvS,QAAX,EAAR,CAAjB;;sBAEgB6R,GAAlB,EAAuBmB,EAAvB,EAA2BT,UAA3B;MACI3D,aAAJ,CAAkB1K,IAAlB,CAAuBqO,UAAvB;SACOA,UAAP;;AAEF,SAAS/C,qBAAT,CAA6BqC,GAA7B,EAAkCja,GAAlC,EAAuC;SAC9B1C,SAAS+gB,QAAT,CAAkBxQ,IAAlB,GAAyB,GAAzB,GAA+B7N,GAAtC;;AAEF,SAASse,iBAAT,CAAyBrE,GAAzB,EAA8B/B,IAA9B,EAAoCqG,WAApC,EAAiD;MAC3C5P,MAAMrR,SAASC,aAAT,CAAuB,QAAvB,CAAV;MACIE,SAAJ,GAAgBya,IAAhB;MACI5T,KAAJ,GAAY4T,IAAZ;MACIuE,eAAJ,CAAoB9e,WAApB,CAAgCgR,GAAhC;MACI4P,WAAJ,EAAiB;QACX9B,eAAJ,CAAoB5N,aAApB,GAAoCoL,IAAIwC,eAAJ,CAAoB1d,MAApB,GAA6B,CAAjE;;;AAGJ,SAASyf,iBAAT,CAAyBvE,GAAzB,EAA8BwE,OAA9B,EAAuC;UAC7BphB,KAAR,CAAcuY,OAAd,GAAwBqE,IAAIvC,eAAJ,GAAsB,OAAtB,GAAgC,MAAxD;;AAEF,SAASgH,aAAT,CAAqBzE,GAArB,EAA0B;MACpB0E,MAAM1E,IAAIyB,UAAJ,GAAiBpe,SAASC,aAAT,CAAuB,IAAvB,CAA3B;UACI2O,QAAJ,CAAa+N,IAAIrS,UAAjB,EAA6B,UAA7B;MACIkP,IAAJ,CAASkC,YAAT,CAAsB2F,GAAtB,EAA2B1E,IAAInD,IAAJ,CAAS8H,UAApC;UACI1S,QAAJ,CAAayS,GAAb,EAAkB,UAAlB;MACIE,QAAQvhB,SAASC,aAAT,CAAuB,MAAvB,CAAZ;QACME,SAAN,GAAkB,QAAlB;UACIyO,QAAJ,CAAa2S,KAAb,EAAoB,cAApB;MACIC,SAASxhB,SAASC,aAAT,CAAuB,MAAvB,CAAb;SACOE,SAAP,GAAmB,MAAnB;UACIyO,QAAJ,CAAa4S,MAAb,EAAqB,QAArB;UACI5S,QAAJ,CAAa4S,MAAb,EAAqB,MAArB;MACIC,UAAUzhB,SAASC,aAAT,CAAuB,MAAvB,CAAd;UACQE,SAAR,GAAoB,KAApB;UACIyO,QAAJ,CAAa6S,OAAb,EAAsB,QAAtB;UACI7S,QAAJ,CAAa6S,OAAb,EAAsB,SAAtB;MACIC,UAAU1hB,SAASC,aAAT,CAAuB,MAAvB,CAAd;UACQE,SAAR,GAAoB,QAApB;UACIyO,QAAJ,CAAa8S,OAAb,EAAsB,QAAtB;UACI9S,QAAJ,CAAa8S,OAAb,EAAsB,QAAtB;MACIC,SAAShF,IAAIwC,eAAJ,GAAsBnf,SAASC,aAAT,CAAuB,QAAvB,CAAnC;MACI0c,IAAI5F,IAAJ,IAAY4F,IAAI5F,IAAJ,CAASyH,UAAzB,EAAqC;aAC5Brc,IAAP,CAAYwa,IAAI5F,IAAJ,CAASyH,UAArB,EAAiC,UAAUxX,KAAV,EAAiBtE,GAAjB,EAAsB;wBACrCia,GAAhB,EAAqBja,GAArB,EAA0BA,QAAQia,IAAI3C,MAAtC;KADF;GADF,MAIO;sBACW2C,GAAhB,EAAqB3D,6BAArB,EAAkD,KAAlD;;UAEEpW,IAAJ,CAAS+e,MAAT,EAAiB,QAAjB,EAA2B,YAAY;SAChC,IAAItS,QAAQ,CAAjB,EAAoBA,QAAQsN,IAAIwC,eAAJ,CAAoB1d,MAAhD,EAAwD4N,OAAxD,EAAiE;UAC3D8P,eAAJ,CAAoB9P,KAApB,EAA2BlP,SAA3B,GAAuCwc,IAAIwC,eAAJ,CAAoB9P,KAApB,EAA2BrI,KAAlE;;QAEEgT,MAAJ,GAAa,KAAKhT,KAAlB;GAJF;MAMI3G,WAAJ,CAAgBshB,MAAhB;MACIthB,WAAJ,CAAgBkhB,KAAhB;MACIlhB,WAAJ,CAAgBmhB,MAAhB;MACInhB,WAAJ,CAAgBohB,OAAhB;MACIphB,WAAJ,CAAgBqhB,OAAhB;MACIzI,wBAAJ,EAA4B;QACtBkI,UAAUnhB,SAAS4hB,cAAT,CAAwB,kBAAxB,CAAd;QACIC,uBAAuB7hB,SAAS4hB,cAAT,CAAwB,kBAAxB,CAA3B;QACIE,cAAc9hB,SAAS4hB,cAAT,CAAwB,iBAAxB,CAAlB;gBACY7hB,KAAZ,CAAkBuY,OAAlB,GAA4B,OAA5B;QACIY,aAAamB,OAAb,CAAqBC,sBAAoBqC,GAApB,EAAyB,SAAzB,CAArB,MAA8D,MAAlE,EAA0E;2BACnDzc,YAArB,CAAkC,SAAlC,EAA6C,SAA7C;;sBAEcyc,GAAhB,EAAqBwE,OAArB;YACIve,IAAJ,CAASif,oBAAT,EAA+B,QAA/B,EAAyC,YAAY;UAC/CzH,eAAJ,GAAsB,CAACuC,IAAIvC,eAA3B;wBACgBuC,GAAhB,EAAqBwE,OAArB;KAFF;;MAKEY,yBAAyB/hB,SAAS4hB,cAAT,CAAwB,oBAAxB,CAA7B;UACIhf,IAAJ,CAASmf,sBAAT,EAAiC,SAAjC,EAA4C,UAAU5W,CAAV,EAAa;QACnDA,EAAE4C,OAAF,KAAc5C,EAAE6R,KAAF,KAAY,EAAZ,IAAkB7R,EAAE6C,OAAF,KAAc,EAA9C,CAAJ,EAAuD;sBACvCoK,IAAd;;GAFJ;UAKIxV,IAAJ,CAAS2e,KAAT,EAAgB,OAAhB,EAAyB,YAAY;2BACZphB,SAAvB,GAAmCmb,KAAKe,SAAL,CAAeM,IAAIL,aAAJ,EAAf,EAAoCnY,SAApC,EAA+C,CAA/C,CAAnC;oBACckU,IAAd;2BACuB2J,KAAvB;2BACuBL,MAAvB;GAJF;UAMI/e,IAAJ,CAAS4e,MAAT,EAAiB,OAAjB,EAA0B,YAAY;QAChC9C,IAAJ;GADF;UAGI9b,IAAJ,CAAS6e,OAAT,EAAkB,OAAlB,EAA2B,YAAY;QACjC7C,aAAaqD,OAAO,0BAAP,CAAjB;QACIrD,UAAJ,EAAgB;UACVD,MAAJ,CAAWC,UAAX;;GAHJ;UAMIhc,IAAJ,CAAS8e,OAAT,EAAkB,OAAlB,EAA2B,YAAY;QACjC/G,MAAJ;GADF;;AAIF,SAASuH,iBAAT,CAAyBvF,GAAzB,EAA8B;MACxBwF,UAAU,KAAK,CAAnB;MACI9D,eAAJ,GAAsBre,SAASC,aAAT,CAAuB,KAAvB,CAAtB;WACOgC,MAAP,CAAc0a,IAAI0B,eAAJ,CAAoBte,KAAlC,EAAyC;WAChC,KADgC;gBAE3B,MAF2B;YAG/B,OAH+B;YAI/B,WAJ+B;cAK7B;GALZ;WAOSqiB,IAAT,CAAcjX,CAAd,EAAiB;MACb+I,cAAF;QACIvE,KAAJ,IAAawS,UAAUhX,EAAE8B,OAAzB;QACI8N,QAAJ;cACU5P,EAAE8B,OAAZ;WACO,KAAP;;WAEOoV,QAAT,GAAoB;YACdlT,WAAJ,CAAgBwN,IAAI3B,aAApB,EAAmCzB,QAAIuD,UAAvC;YACIrO,MAAJ,CAAW3O,MAAX,EAAmB,WAAnB,EAAgCsiB,IAAhC;YACI3T,MAAJ,CAAW3O,MAAX,EAAmB,SAAnB,EAA8BuiB,QAA9B;;WAEOC,SAAT,CAAmBnX,CAAnB,EAAsB;MAClB+I,cAAF;cACU/I,EAAE8B,OAAZ;YACI2B,QAAJ,CAAa+N,IAAI3B,aAAjB,EAAgCzB,QAAIuD,UAApC;YACIla,IAAJ,CAAS9C,MAAT,EAAiB,WAAjB,EAA8BsiB,IAA9B;YACIxf,IAAJ,CAAS9C,MAAT,EAAiB,SAAjB,EAA4BuiB,QAA5B;WACO,KAAP;;UAEEzf,IAAJ,CAAS+Z,IAAI0B,eAAb,EAA8B,WAA9B,EAA2CiE,SAA3C;UACI1f,IAAJ,CAAS+Z,IAAI3B,aAAb,EAA4B,WAA5B,EAAyCsH,SAAzC;MACIhY,UAAJ,CAAeoR,YAAf,CAA4BiB,IAAI0B,eAAhC,EAAiD1B,IAAIrS,UAAJ,CAAeqV,iBAAhE;;AAEF,SAAS4C,UAAT,CAAkB5F,GAAlB,EAAuB6F,CAAvB,EAA0B;MACpBlY,UAAJ,CAAevK,KAAf,CAAqB4P,KAArB,GAA6B6S,IAAI,IAAjC;MACI7F,IAAIyB,UAAJ,IAAkBzB,IAAI5C,SAA1B,EAAqC;QAC/BqE,UAAJ,CAAere,KAAf,CAAqB4P,KAArB,GAA6B6S,IAAI,IAAjC;;MAEE7F,IAAI3B,aAAR,EAAuB;QACjBA,aAAJ,CAAkBjb,KAAlB,CAAwB4P,KAAxB,GAAgC6S,IAAI,IAApC;;;AAGJ,SAAS/D,kBAAT,CAA0B9B,GAA1B,EAA+B8F,gBAA/B,EAAiD;MAC3Cld,WAAW,EAAf;WACOpD,IAAP,CAAYwa,IAAIhD,mBAAhB,EAAqC,UAAUrO,GAAV,EAAe+D,KAAf,EAAsB;QACrDqT,cAAc,EAAlB;QACInC,gBAAgB5D,IAAI/C,sCAAJ,CAA2CvK,KAA3C,CAApB;aACOlN,IAAP,CAAYoe,aAAZ,EAA2B,UAAUlD,UAAV,EAAsBhV,QAAtB,EAAgC;kBAC7CA,QAAZ,IAAwBoa,mBAAmBpF,WAAWhT,YAA9B,GAA6CgT,WAAWvS,QAAX,EAArE;KADF;aAGSuE,KAAT,IAAkBqT,WAAlB;GANF;SAQOnd,QAAP;;AAEF,SAASod,sBAAT,CAA8BhG,GAA9B,EAAmC;OAC5B,IAAItN,QAAQ,CAAjB,EAAoBA,QAAQsN,IAAIwC,eAAJ,CAAoB1d,MAAhD,EAAwD4N,OAAxD,EAAiE;QAC3DsN,IAAIwC,eAAJ,CAAoB9P,KAApB,EAA2BrI,KAA3B,KAAqC2V,IAAI3C,MAA7C,EAAqD;UAC/CmF,eAAJ,CAAoB5N,aAApB,GAAoClC,KAApC;;;;AAIN,SAASuT,gBAAT,CAAwBC,eAAxB,EAAyC;MACnCA,gBAAgBphB,MAAhB,KAA2B,CAA/B,EAAkC;8BACRW,IAAxB,CAA6BtC,MAA7B,EAAqC,YAAY;uBAChC+iB,eAAf;KADF;;WAIK1gB,IAAP,CAAY0gB,eAAZ,EAA6B,UAAUvc,CAAV,EAAa;MACtCuE,aAAF;GADF;;AAKF,AAKA,IAAIiY,gBAAc;cACJ1Y,YADI;qBAEGoG,mBAFH;oBAGEO,kBAHF;oBAIES,kBAJF;oBAKEK,kBALF;uBAMKmB,qBANL;0BAOQc,wBAPR;sBAQIW,oBARJ;mBASCI,iBATD;oBAUE+B;CAVpB;;ACz+EA;;;;;;;;;;;;;AAcA,AAQO,SAAS6O,sBAAT,CAAiCrd,MAAjC,EAAyCiH,KAAzC,EAAiD;KAEjDuU,QAAQK,QAAML,KAApB;KACM8B,qBAAqBtd,OAAOud,QAAP,CAAgBC,UAAhB,CAA2BxZ,QAAtD;KACCA,WAAWsZ,mBAAmBG,QAAnB,IAA+B,CAA/B,GAAmC,IAAIjC,MAAMkC,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,CAAnC,GAAqE,IAAIlC,MAAMmC,OAAV,EADjF;UAESC,SAAT,CAAoBN,mBAAmBO,KAAvC,EAA8C5W,QAAQqW,mBAAmBG,QAAzE;QACOzZ,QAAP;;AAUD,AAAO,SAAS8Z,gBAAT,CAA2B9d,MAA3B,EAAmC+d,GAAnC,EAAyC;KAEzCvC,QAAQK,QAAML,KAApB;KACIxX,WAAW+Z,IAAIC,KAAJ,EAAf;UAQSC,WAAT,CAAsBje,MAAtB,EAA8B+d,GAA9B,EAAoC;MAE/B/Z,WAAW,IAAIwX,MAAMmC,OAAV,EAAf;MACCO,gBAAgB,IAAI1C,MAAMmC,OAAV,EADjB;aAEWI,IAAIC,KAAJ,EAAX;WACSG,QAAT,CAAmBne,OAAOoe,KAA1B;gBAGcC,IAAd,CAAoBra,QAApB;gBACcsa,UAAd,CAA0Bte,OAAOue,QAAjC;WACSzZ,CAAT,GAAaoZ,cAAcpZ,CAA3B;WACSE,CAAT,GAAakZ,cAAclZ,CAA3B;WACSwZ,CAAT,GAAaN,cAAcM,CAA3B;WAES3J,GAAT,CAAc7U,OAAOgE,QAArB;SACOA,QAAP;;IAGE;aAESia,YAAaje,MAAb,EAAqBgE,QAArB,CAAX;WACShE,OAAOM,MAAhB;EAHD,QAKUN,UAAUA,OAAOM,MAL3B;QAMO0D,QAAP;;AAUD,AAAO,SAASya,mBAAT,CAA4Bze,MAA5B,EAAoCiH,KAApC,EAA4C;KAE7CA,UAAU,CAAC,CAAhB,EACC,OAAOlL,SAAP;KACIkL,UAAUlL,SAAf,EACC,OAAOiE,OAAOgE,QAAd;QACM8Z,iBAAkB9d,MAAlB,EAA0Bqd,uBAAwBrd,MAAxB,EAAgCiH,KAAhC,CAA1B,CAAP;;;ACzFD,IAAIyX,QAAQ;oBAEO,4BAAY;QAEzB;UAECC,SAAS/mB,SAASC,aAAT,CAAwB,QAAxB,CAAb;aACO,CAAC,EAAIH,OAAOknB,qBAAP,KAAkCD,OAAOE,UAAP,CAAmB,OAAnB,KAAgCF,OAAOE,UAAP,CAAmB,oBAAnB,CAAlE,CAAJ,CAAR;KAHD,CAKE,OAAQ9b,CAAR,EAAY;aAEN,KAAP;;GAXS;qBAiBQ,6BAAY;QAE1B;UAEC4b,SAAS/mB,SAASC,aAAT,CAAwB,QAAxB,CAAb;aACO,CAAC,EAAIH,OAAOonB,sBAAP,IAAiCH,OAAOE,UAAP,CAAmB,QAAnB,CAArC,CAAR;KAHD,CAKE,OAAQ9b,CAAR,EAAY;aAEN,KAAP;;GA1BS;wBAgCW,gCAAY;WAE1B,KAAKgc,eAAL,CAAsB,CAAtB,CAAP;GAlCU;yBAsCY,iCAAY;WAE3B,KAAKA,eAAL,CAAsB,CAAtB,CAAP;GAxCU;mBA4CM,yBAAWC,OAAX,EAAqB;QAEjCC,QAAQ;SACR,OADQ;SAER;KAFJ;QAKIC,WAAW;SACXxnB,OAAOknB,qBADI;SAEXlnB,OAAOonB;KAFX;QAKIK,UAAU,mIAAd;QAEInW,UAAUpR,SAASC,aAAT,CAAwB,KAAxB,CAAd;YACQunB,EAAR,GAAa,cAAb;YACQznB,KAAR,CAAc0nB,UAAd,GAA2B,WAA3B;YACQ1nB,KAAR,CAAc2nB,QAAd,GAAyB,MAAzB;YACQ3nB,KAAR,CAAc4nB,UAAd,GAA2B,QAA3B;YACQ5nB,KAAR,CAAc6nB,SAAd,GAA0B,QAA1B;YACQ7nB,KAAR,CAAcwW,UAAd,GAA2B,MAA3B;YACQxW,KAAR,CAAcQ,KAAd,GAAsB,MAAtB;YACQR,KAAR,CAAc8nB,OAAd,GAAwB,OAAxB;YACQ9nB,KAAR,CAAc4P,KAAd,GAAsB,OAAtB;YACQ5P,KAAR,CAAcyjB,MAAd,GAAuB,YAAvB;QAEK8D,SAAUF,OAAV,CAAL,EAA2B;gBAEhBG,QAAQrY,OAAR,CAAiB,IAAjB,EAAuB,eAAvB,CAAV;KAFD,MAIO;gBAEIqY,QAAQrY,OAAR,CAAiB,IAAjB,EAAuB,SAAvB,CAAV;;cAISqY,QAAQrY,OAAR,CAAiB,IAAjB,EAAuBmY,MAAOD,OAAP,CAAvB,CAAV;YAEQjnB,SAAR,GAAoBonB,OAApB;WAEOnW,OAAP;;CApFF;;ACAC;;;;;;;;;;;;AAcD,SAAS0W,SAAT,CAAoB7W,OAApB,EAA8B;MAExB8W,UAAL,GAAkB,YAAY;MACzBC,GAAJ;MAEKloB,OAAOmoB,cAAZ,EAA6B;SACtB,IAAIA,cAAJ,EAAN;OACK,CAACD,GAAN,EACC,MAAM,8BAAN;GAHF,MAKK,IAAKloB,OAAOooB,aAAZ,EAA4B;SAC1B,KAAKC,gBAAL,EAAN;OACK,CAACH,GAAN,EACC,MAAM,4BAAN;GAHG,MAKA,MAAM,mCAAN;SACEA,GAAP;EAdD;MAiBKG,gBAAL,GAAwB,YAAY;MAC/B;UAAS,IAAID,aAAJ,CAAmB,oBAAnB,CAAP;GAAN,CACA,OAAQ/c,CAAR,EAAY;MACR;UAAS,IAAI+c,aAAJ,CAAmB,oBAAnB,CAAP;GAAN,CACA,OAAQ/c,CAAR,EAAY;MACR;UAAS,IAAI+c,aAAJ,CAAmB,gBAAnB,CAAP;GAAN,CACA,OAAQ/c,CAAR,EAAY;MACR;UAAS,IAAI+c,aAAJ,CAAmB,mBAAnB,CAAP;GAAN,CACA,OAAQ/c,CAAR,EAAY;eACE,mZAAd;SACO,IAAP;EAVD;MAaKid,mBAAL,GAA2B,UAAWC,kBAAX,EAA+BC,KAA/B,EAAuC;OAE5DC,kBAAL,GAFiE;OAI5DP,GAAL,CAASK,kBAAT,GAA8BA,kBAA9B;MAGK,aAAa,KAAKL,GAAvB,EAA6B;QACvBA,GAAL,CAASQ,OAAT,GAAmB,UAAWpa,KAAX,EAAmB;iBACvB,gCAAgC,KAAK4I,GAAnD,EAAwD,KAAxD,EAA+D,KAA/D;IADD;;OAKIyR,qBAAL,CAA4BH,KAA5B;EAbD;MAgBKI,MAAL,GAAc,YAAY;MAClB,OAAO,KAAK1R,GAAZ,IAAmB,WAArB,IAAwC,KAAKA,GAAL,IAAY,IAAzD,EAAkE;QAC5DA,GAAL,GAAW,oBAAX;;SAEM,KAAKA,GAAL,IAAa,KAAKnK,MAAL,GAAc,KAAKA,MAAnB,GAA4B,EAAzC,CAAP;EAJD;MAOK4b,qBAAL,GAA6B,UAAWH,KAAX,EAAmB;MAC3C;OACE,OAAOA,KAAP,IAAgB,WAArB,EACCA,QAAQ,IAAR;QACIN,GAAL,CAAS/J,IAAT,CAAe,KAAf,EAAsB,KAAKyK,MAAL,EAAtB,EAAqCJ,KAArC;OACKA,KAAL,EAAa;QACRxkB,UAAU,CAAE,KAAK,EAAP,IAAc,IAA5B,CADY;QAEP,aAAa,KAAKkkB,GAAvB;UACMA,GAAL,CAASlkB,OAAT,GAAmBA,OAAnB;QACI,eAAe,KAAKkkB,GAAzB,EACC,KAAKA,GAAL,CAASW,SAAT,GAAqB,YAAY;kBAClB,wBAAd,EAAwC,KAAxC,EAA+C,KAA/C;KADD,CADD,KAIK;kBACU,KAAKC,kBAAnB;UACKA,kBAAL,GAA0B3kB,WAAY,YAAY;mBACnC,0BAAd,EAA0C,KAA1C,EAAiD,KAAjD;MADyB,EAGvBH,OAHuB,CAA1B;;;QAOGkkB,GAAL,CAASa,IAAT,CAAe,IAAf;GArBD,CAsBE,OAAQ1d,CAAR,EAAY;gBACCA,EAAEoc,OAAF,GAAY,QAAZ,GAAuB,KAAKvQ,GAA1C,EAA+C,KAA/C,EAAsD,KAAtD;;EAxBF;MA4BKuR,kBAAL,GAA0B,YAAY;MAEhC,KAAKP,GAAL,IAAY,IAAjB,EACC;OACIA,GAAL,CAASc,KAAT;EAJD;MAOKC,gBAAL,GAAwB,UAAWC,gBAAX,EAA8B;MACjDhB,MAAM,KAAKA,GAAf;UAOSA,IAAIiB,UAAb;QACM,CAAL;;SAEO,OAAOjB,IAAIkB,MAAX,IAAqB,SAA1B,EAAsC;mBACvB,2CAAd;aACO,IAAP;;SAGIlB,IAAIkB,MAAJ,IAAc,GAAnB;;oBAEe,KAAKN,kBAAnB;cACOI,iBAAkB,IAAlB,CAAP;OAHD;UAKK;oBACU,qCAAqChB,IAAIkB,MAAzC,GAAkD,QAAlD,GAA6D,KAAKlS,GAAhF;;;;QAIE,CAAL,CAlBD;QAmBM,CAAL,CAnBD;QAoBM,CAAL;;QAGK,CAAL,CAvBD;;UAyBQ,0CAA0CgR,IAAIiB,UAApD;;GAjCmD;SAoC9C,IAAP;EApCD;MAuCKE,qBAAL,GAA6B,YAAY;MACpCpF,QAAQ,KAAKqF,cAAL,CAAqB,OAArB,EAA8B,IAA9B,CAAZ;MACKrF,KAAL,EAAa;gBACEA,KAAd;UACO,IAAP;;SAEM,KAAP;EAND;MASKqF,cAAL,GAAsB,UAAWC,OAAX,EAAoBC,qBAApB,EAA4C;MAC7DC,UAAU,KAAKvB,GAAnB;MACK,CAACuB,QAAQC,WAAd,EAA4B;OACtBF,yBAAyB,IAA9B,EACCG,aAAc,gCAAgCJ,OAAhC,GAA0C,0DAA1C,GAAuGE,QAAQG,YAA7H;UACM,IAAP;;MAEGtY,UAAUmY,QAAQC,WAAR,CAAoBnS,oBAApB,CAA0CgS,OAA1C,CAAd;MAIKjY,QAAQ3P,MAAR,IAAkB,CAAvB,EAA2B;OACrB6nB,yBAAyB,IAA9B,EACCG,aAAc,iCAAiCJ,OAAjC,GAA2C,wBAA3C,GAAsEjY,QAAQ3P,MAA5F;UACM,EAAP;;MAEGiT,OAAO,EAAX;OACM,IAAIzR,IAAI,CAAd,EAAiBA,IAAImO,QAAQ3P,MAA7B,EAAqCwB,GAArC,EAA2C;OACrC,OAASmO,QAAQnO,CAAR,EAAW0mB,WAApB,IAAqC,WAA1C,EAAwD;QAClD,OAASvY,QAAQnO,CAAR,EAAWyR,IAApB,IAA8B,WAAnC,EAAiD;kBAClC,gCAAgC2U,OAAhC,GAA0C,aAA1C,GAA0DpmB,CAA1D,GAA8D,sBAA5E;YACO,EAAP;;QAEIyR,QAAQ,EAAb,EACCA,QAAQ,GAAR;YACOtD,QAAQnO,CAAR,EAAWyR,IAAnB,CAPuD;IAAxD,MASKA,QAAQtD,QAAQnO,CAAR,EAAW0mB,WAAnB,CAVqC;;SAYpCjV,IAAP;EA7BD;KAgCKzD,QAAQ2Y,IAAb,EAAoB;OACd5B,GAAL,GAAW/W,QAAQ2Y,IAAR,CAAa5B,GAAxB;OACKhR,GAAL,GAAW/F,QAAQ2Y,IAAR,CAAa5S,GAAxB;OACKnK,MAAL,GAAcoE,QAAQ2Y,IAAR,CAAa/c,MAA3B;EAHD,MAIO;MACF;QACEmb,GAAL,GAAW,KAAKD,UAAL,EAAX;GADD,CAEE,OAAQ5c,CAAR,EAAY;OACToc,OAAJ;OACK,OAAOpc,EAAEoc,OAAT,IAAoB,WAAzB,EACCA,UAAUpc,CAAV,CADD,KAEKoc,UAAUpc,EAAEoc,OAAZ;gBACS,qEACXznB,OAAO+pB,SAAP,CAAiBC,OADN,GACgB,GADhB,GACsBhqB,OAAO+pB,SAAP,CAAiBE,UADvC,GACoD,MADpD,GAC6DxC,OAD3E;;;;KAKG,CAAC,KAAKS,GAAX,EAAiB;eACF,4BAA4B,KAAKA,GAA/C;;;UAIQyB,YAAT,CAAuB1F,KAAvB,EAA+B;UAEtBA,KAAR,CAAeA,KAAf;UACQyE,OAAR,CAAiBzE,KAAjB;;;AAyCF,SAASiG,IAAT,CAAehT,GAAf,EAAoB/F,OAApB,EAA8B;WAEnBA,WAAW,EAArB;SACQgZ,MAAR,GAAiBhZ,QAAQgZ,MAAR,IAAkB,YAAY,EAA/C;SACQzB,OAAR,GAAkBvX,QAAQuX,OAAR,IAAmB,YAAY,EAAjD;KAEI0B,QAAJ;KACCC,UAAU,IAAIrC,SAAJ,CAAe7W,OAAf,CADX;SAEQ+F,GAAR,GAAcA,GAAd;SACQoR,mBAAR,CAEC,YAAY;UAEHW,gBAAR,CAA0B,UAAWjB,SAAX,EAAuB;OAE3CA,UAAUqB,qBAAV,EAAL,EACC;cACUrB,UAAUE,GAAV,CAAc0B,YAAzB;WAEQO,MAAR,CAAgBC,QAAhB,EAA0BlT,GAA1B;;GAND;EAJF,EAgBG,KAhBH;;QAoBOkT,QAAP;;;ACvRD;;;;;;;;;;;;;;;;AAkBA,AAoEA,SAASF,MAAT,CAAeI,GAAf,EAAoBnZ,OAApB,EAA8B;WAEnBA,WAAW,EAArB;SACQgZ,MAAR,GAAiBhZ,QAAQgZ,MAAR,IAAkB,YAAY,EAA/C;SACQzB,OAAR,GAAkBvX,QAAQuX,OAAR,IAAmB,YAAY,EAAjD;SACQ6B,QAAR,GAAmBpZ,QAAQoZ,QAAR,IAAoBrqB,SAASqX,oBAAT,CAA+B,MAA/B,EAAwC,CAAxC,CAAvC;KAEKiT,eAAgBrZ,QAAQoZ,QAAxB,EAAkCD,GAAlC,CAAL,EAA+C;UAGtCH,MAAR;;;KAKIG,eAAezoB,KAApB,EAA4B;MAEvBoiB,KAAJ;MACCwG,cAAc;aAEHtZ,QAAQoZ,QAFL;QAGRpZ,QAAQuZ,GAHA;WAIL,gBAAWN,QAAX,EAAqBlT,GAArB,EAA2B;YAE1B3E,GAAR,CAAa,6BAA6B2E,GAA1C;IANY;YASJ,iBAAWzV,GAAX,EAAiB;YAEjBinB,OAAR,CAAiBjnB,GAAjB;YACQA,GAAR;;GAbH;OAkBM,IAAI0B,IAAI,CAAd,EAAiBA,IAAImnB,IAAI3oB,MAAzB,EAAiCwB,GAAjC,EAAuC;OAElCwnB,OAAOL,IAAKnnB,CAAL,CAAX;kBACgB,UAAWynB,MAAX,EAAoB;WAE5BxqB,YAAP,CAAqB,IAArB,EAA2BuqB,IAA3B;WACOtqB,SAAP,GAAmBwqB,KAAcF,IAAd,EAAoBF,WAApB,CAAnB;IAHD,EAKGA,WALH;OAMKxG,UAAU5f,SAAf,EACC;;MAGG4f,UAAU5f,SAAf,EACC8M,QAAQgZ,MAAR;EAlCF,MAoCOW,eAAgB,UAAWF,MAAX,EAAoB;SAEnCxqB,YAAP,CAAqB,IAArB,EAA2BkqB,GAA3B;SACOjqB,SAAP,GAAmBwqB,KAAcP,GAAd,EAAmBnZ,OAAnB,CAAnB;EAHM,EAKJA,OALI;;AA+ER,SAASqX,KAAT,CAAgB8B,GAAhB,EAAqBnZ,OAArB,EAA+B;WAEpBA,WAAW,EAArB;SACQoZ,QAAR,GAAmBpZ,QAAQoZ,QAAR,IAAoBrqB,SAASqX,oBAAT,CAA+B,MAA/B,EAAyC,CAAzC,CAAvC;SACQ4S,MAAR,GAAiBhZ,QAAQgZ,MAAR,IAAkB,YAAY,EAA/C;KAEIY,IAAJ;UAESvC,KAAT,CAAgBwC,QAAhB,EAA2B;WAEjBC,IAAT,GAAgB;OAEVX,eAAezoB,KAAf,IAA0BkpB,OAAST,IAAI3oB,MAAJ,GAAa,CAArD,EAA6D;;UAGrD2oB,IAAIS,IAAJ,CAAP;IAHD,MAKO5Z,QAAQgZ,MAAR;;MAIHK,eAAgBrZ,QAAQoZ,QAAxB,EAAkCS,QAAlC,EAA4C7Z,QAAQgZ,MAApD,CAAL,EAAoE;;;;iBAOpD,UAAWS,MAAX,EAAoB;UAE5BxqB,YAAP,CAAqB,IAArB,EAA2B4qB,QAA3B;YAESE,OAAT,GAAmB;YAEV3Y,GAAR,CAAa,+BAA+ByY,QAA5C;QACK7Z,QAAQgZ,MAAR,KAAmB9lB,SAAxB,EAAoC;;;;OAgBhCumB,OAAOzB,UAAP,IAAqB,CAAEyB,OAAOT,MAAnC,EAA4C;WAGpC5B,kBAAP,GAA4B,YAAY;SAElCqC,OAAOzB,UAAP,IAAqB,UAA1B,EAAuC;UAGjChY,QAAQgZ,MAAR,KAAmB9lB,SAAxB,EAAoC8M,QAAQgZ,MAAR,GAHE;;SAOlCS,OAAOzB,UAAP,IAAqB,QAA1B,EAAqC;iBAExBhY,QAAQgZ,MAApB,EAA4B,CAA5B,EAFoC;WAK/B5B,kBAAL,GAA0B,IAA1B;;KAdF;IAHD,MAuBO;WAGC4B,MAAP,GAAgBe,OAAhB;WAEOxC,OAAP,GAAiB,UAAWrd,CAAX,EAAe;SAE3B5J,MAAM,kBAAkB,KAAK6oB,GAAvB,GAA6B,UAAvC;SACKnZ,QAAQuX,OAAR,KAAoBrkB,SAAzB,EACC8M,QAAQuX,OAAR,CAAiBjnB,GAAjB,EAAsB4J,CAAtB;aACO4Y,KAAR,CAAexiB,GAAf;KALD;;UAWM6oB,GAAP,GAAaU,QAAb;GA9DD,EAgEG7Z,OAhEH;;KAoEImZ,eAAezoB,KAApB,EAA4B;SAEpB,CAAP;QACOyoB,IAAKS,IAAL,CAAP;EAHD,MAKOvC,MAAO8B,GAAP;;AAIR,SAASQ,cAAT,CAAyBjT,QAAzB,EAAmC1G,OAAnC,EAA6C;SAEpCuZ,GAAR,GAAcvZ,QAAQuZ,GAAR,IAAe,EAA7B;KACK,OAAOvZ,QAAQuZ,GAAf,KAAuB,QAA5B,EAAuC;UAE7BvZ,QAAQuZ,GAAjB;QAEM,OAAL;YACSA,GAAR,GAAc;WAEP,OAFO;gBAGF;YAEJ,KAFI;aAGH;;KANT;;;YAYgBzG,KAAR,CAAe,0BAA0B9S,QAAQuZ,GAAjD;;;;SAMHA,GAAR,CAAY5P,IAAZ,GAAmB3J,QAAQuZ,GAAR,CAAY5P,IAAZ,IAAoB,QAAvC;KACI8P,SAAS1qB,SAASC,aAAT,CAAwBgR,QAAQuZ,GAAR,CAAY5P,IAApC,CAAb;SAEQ4P,GAAR,CAAYS,SAAZ,GAAwBha,QAAQuZ,GAAR,CAAYS,SAAZ,IAAyB,EAAjD;SACQT,GAAR,CAAYS,SAAZ,CAAsBrQ,IAAtB,GAA6B3J,QAAQuZ,GAAR,CAAYS,SAAZ,CAAsBrQ,IAAtB,IAA8B,MAA3D;SACQ4P,GAAR,CAAYS,SAAZ,CAAsBjkB,KAAtB,GAA8BiK,QAAQuZ,GAAR,CAAYS,SAAZ,CAAsBjkB,KAAtB,IAA+B,iBAA7D;QACO9G,YAAP,CAAqB+Q,QAAQuZ,GAAR,CAAYS,SAAZ,CAAsBrQ,IAA3C,EAAiD3J,QAAQuZ,GAAR,CAAYS,SAAZ,CAAsBjkB,KAAvE;UAEU0jB,MAAV;SACQL,QAAR,CAAiBhqB,WAAjB,CAA8BqqB,MAA9B;;AAID,SAASJ,cAAT,CAAyBY,QAAzB,EAAmCJ,QAAnC,EAA6Cb,MAA7C,EAAsD;KAEjDkB,UAAUD,SAASE,gBAAT,CAA2B,QAA3B,CAAd;MACM,IAAInoB,IAAI,CAAd,EAAiBA,IAAIkoB,QAAQ1pB,MAA7B,EAAqCwB,GAArC,EAA2C;MAEtCooB,QAAQF,QAAQloB,CAAR,CAAZ;MACKooB,MAAM7D,EAAN,KAAasD,QAAlB,EAA6B;UAMrB,IAAP;;;QAKK,KAAP;;;ACzWD,IAAIQ,aAAa;QAEVtB,MAFU;SAGT1B;CAHR;;AChBA;;;;;;;;;;;;;;;;AAkBA,AAMA,IAAMiD,eAAe;MAGf;CAHN,CASA,IAAMC,mBAAmB,SAAnBA,gBAAmB,GAAY;KAE/BxrB,SAASyrB,aAAT,IAA4BzrB,SAASyrB,aAAT,CAAuBrB,GAAvB,KAA+B,EAAhE,EACC,OAAOpqB,SAASyrB,aAAT,CAAuBrB,GAA9B;KACKe,UAAUnrB,SAASqX,oBAAT,CAA+B,QAA/B,CAAhB;KACC9V,MAAM4pB,QAAQA,QAAQ1pB,MAAR,GAAiB,CAAzB,EAA4B2oB,GADnC;KAEK7oB,QAAQ,EAAb,EACC,OAAO6oB,GAAP;QAEM,IAAI7gB,KAAJ,GAAYmiB,KAAZ,CAAkBxmB,KAAlB,CAAyB,gBAAzB,EAA4C,CAA5C,CAAP;CATD;AAaA,IAAMymB,uBAAuB,SAAvBA,oBAAuB,GAAY;KAClCjB,SAASc,kBAAf;KACCI,OAAOlB,OAAOmB,SAAP,CAAkB,CAAlB,EAAqBnB,OAAOoB,WAAP,CAAoB,GAApB,CAArB,CADR;QAEOF,IAAP;CAHD;AAMA,IAAMG,oBAAoBJ,sBAA1B;AAGAL,WAAWtB,IAAX,CAAiB+B,oBAAoB,kBAArC,EAAyDR,YAAzD;AAEA,IAAMjb,OAASxQ,OAAOksB,QAAP,IAAmBhsB,SAASisB,cAAT,CAAwBC,UAAxB,CAAoC,mDAApC,EAAyF,KAAzF,CAAnB,GAAsH,KAAtH,GAA8H,KAA7I;IACCC,QAAQ,4BADT;AAEA,IAAIC,SAAS,CAAb;IAEMC;AAML,uBAAc;;KAEP1b,QAAQ,IAAd;MAMK2b,cAAL,GAAsB;QAGf,CAHe;cAKT,CALS;iBAON,CAPM;WASZ;EATV;UAaSC,gBAAT,CAA2Bxc,EAA3B,EAA+Byc,KAA/B,EAAsCC,QAAtC,EAAiD;OAE3CzsB,SAAS0sB,eAAT,CAA0BP,KAA1B,EAAiCpc,EAAjC,CAAL;OACM,IAAIrN,GAAV,IAAiB8pB,KAAjB;MACItsB,YAAH,CAAiBwC,GAAjB,EAAsB8pB,MAAM9pB,GAAN,CAAtB;GACD,IAAKD,OAAOb,SAAP,CAAiBhB,QAAjB,CAA0BwB,IAA1B,CAAgCqqB,QAAhC,KAA8C,gBAAnD,EAAsEA,WAAW,CAACA,QAAD,CAAX;MAClExpB,IAAI,CAAR;MAAW0pB,MAAQF,SAAS,CAAT,KAAeA,SAAShrB,MAA1B,IAAsC,CAAvD;SACQwB,IAAI0pB,GAAZ,EAAiB1pB,GAAjB;MACI5C,WAAH,CAAgBosB,SAASxpB,CAAT,CAAhB;GACD,OAAO8M,EAAP;;MAgEI/G,MAAL,GAAc,UAAU4jB,eAAV,EAA2B3b,OAA3B,EAAqC;YAExCA,WAAW,EAArB;UACQ4b,WAAR,GAAsB5b,QAAQ4b,WAAR,IAAuB,YAA7C;WAESC,YAAT,GAAwB;UAAS7b,QAAQ4b,WAAR,KAAwB,YAA/B;;MAErB5b,QAAQ8b,SAAR,KAAsB5oB,SAA3B,EACC8M,QAAQ8b,SAAR,GAAoB,IAApB;UACOhtB,KAAR,GAAgBkR,QAAQlR,KAAR,IAAiB,EAAjC;UAEQA,KAAR,CAAc4P,KAAd,GAAsBsB,QAAQlR,KAAR,CAAc4P,KAAd,KAAyBmd,iBAAiB,GAAjB,GAAuB,EAAhD,CAAtB;UACQ/sB,KAAR,CAAc8P,MAAd,GAAuBoB,QAAQlR,KAAR,CAAc8P,MAAd,KAA0Bid,iBAAiB,EAAjB,GAAsB,GAAhD,CAAvB;UAEQE,OAAR,GAAkB/b,QAAQ+b,OAAR,IAAmB,YAAY,EAAjD;MAEKJ,2BAA2BK,WAA3B,KAA2C,IAAhD,EAAuD;OAEjD,OAAOL,eAAP,KAA2B,QAAhC,EAA2C;YAElC7I,KAAR,CAAe,mDAAmD6I,eAAlE;;;qBAIiB5sB,SAAS4hB,cAAT,CAAyBgL,eAAzB,CAAlB;OACKA,oBAAoB,IAAzB,EAAgC;YAEvB7I,KAAR,CAAe,mDAAmD6I,eAAlE;;;;kBAMcM,SAAhB,CAA0BjQ,GAA1B,CAA+B,gBAA/B;OACM,IAAIld,KAAV,IAAmBkR,QAAQlR,KAA3B,EAAmC;mBAElBA,KAAhB,CAAsBA,KAAtB,IAA+BkR,QAAQlR,KAAR,CAAcA,KAAd,CAA/B;;MAKKotB,UAAUlc,QAAQkc,OAAR,YAA2B,KAAKA,OAAhC,GAA0Clc,QAAQkc,OAAlD,GAA4D,IAAI,KAAKA,OAAT,CAAkBlc,OAAlB,CAA5E;MACImc,KAAJ;WACSC,cAAT,GAA0B;OAEpB,OAAOpc,QAAQlR,KAAR,CAAc8P,MAArB,KAAgC,QAArC,EACC,OAAO1K,SAAU8L,QAAQlR,KAAR,CAAc8P,MAAxB,CAAP;UACMoB,QAAQlR,KAAR,CAAc8P,MAArB;;WAGQyd,aAAT,GAAyB;UAASF,MAAMG,WAAb;;WAMlB5iB,QAAT,CAAmB3D,KAAnB,EAA0BoF,QAA1B,EAAqC;OAE/BohB,mBAAmBrpB,SAAxB,EAAoC;YAE3B4f,KAAR,CAAe,6GAAf;;;OAIKzd,IAAI6mB,QAAQM,OAAR,CAAiBzmB,KAAjB,CAAV;OACKV,MAAMnC,SAAX,EAAuB;YAEd4f,KAAR,CAAe,uCAAuCzd,CAAtD;;;WAKOA,EAAEonB,OAAV;OACKthB,aAAajI,SAAlB,EACCiI,WAAW0gB,iBACRQ,kBAAkBtmB,KAApB,GAA8B,GADpB,GAEVqmB,mBAAqBA,oBAAqBpc,QAAQ8b,SAAR,GAAoB/lB,KAApB,GAA4B,MAAMA,KAAvD,CAAF,GAAqE,GAFzF;sBAGmBoF,QAApB;OACK6E,QAAQ0c,eAAR,CAAwBhW,QAAxB,KAAqCxT,SAA1C,EAAsD;YAG7CwpB,eAAR,CAAwBhW,QAAxB,CAAkCrR,CAAlC;;;MAMEknB,cAAJ;MACKvc,QAAQ0c,eAAR,KAA4BxpB,SAAjC,EAA6C;oBAE3BnE,SAASC,aAAT,CAAwB,KAAxB,CAAjB;kBACe6M,SAAf,GAA2B,kBAA3B;OACKggB,cAAL,EACCU,eAAeztB,KAAf,CAAqB4P,KAArB,GAA6B,MAA7B,CADD,KAEK6d,eAAeztB,KAAf,CAAqB8P,MAArB,GAA8B,MAA9B;mBACWxP,WAAhB,CAA6BmtB,cAA7B;kBACeztB,KAAf,CAAqB6tB,aAArB,GAAqC,MAArC;;WAQQC,kBAAT,CAA6BzhB,QAA7B,EAAwC;OAElCohB,mBAAmBrpB,SAAxB,EACC;OAEI2oB,cAAL,EAAsB;QAEd1gB,WAAW,CAAb,IAAsBA,WAAWkhB,eAAtC,EAA0D;aAEjDvJ,KAAR,CAAe,wDAAwD3X,QAAvE;;;mBAIcrM,KAAf,CAAqBwM,GAArB,GAA2B,KAA3B;mBACexM,KAAf,CAAqBsM,IAArB,GAA8B,CAAE4E,QAAQ8b,SAAR,GAAoB3gB,QAApB,GAA+BkhB,kBAAkBlhB,QAAnD,IAAgEohB,eAAeM,WAAf,GAA6B,CAA/F,GAAqG,IAAjI;IATD,MAWO;QAEC1hB,WAAW,CAAb,IAAsBA,WAAWihB,gBAAtC,EAA2D;aAElDtJ,KAAR,CAAe,wDAAwD3X,QAAvE;;;mBAIcrM,KAAf,CAAqBsM,IAArB,GAA4B,KAA5B;mBACetM,KAAf,CAAqBwM,GAArB,GAA6BH,WAAWohB,eAAelP,YAAf,GAA8B,CAA3C,GAAiD,IAA5E;;;MAMGhO,QAAQ,KAAb,EAAqB;OAEhB;QAEGgG,iBAAiB,gBAAvB;YACQiW,iBAAkB,KAAlB,EAAyB;YACzB,4BADyB;cAEvB,KAFuB;YAGzBO,iBAAiB,MAAjB,GAA0B7b,QAAQlR,KAAR,CAAc4P,KAHf;aAIxBsB,QAAQlR,KAAR,CAAc8P;KAJf,EAMP,CACC0c,iBAAkB,MAAlB,EAA0B,EAA1B,EACCA,iBAAkBjW,cAAlB,EAAkC;SAE7B,kBAAkB8V,MAFW;SAG7BU,kBAAkB7b,QAAQ8b,SAA1B,GAAsC,MAAtC,GAA+C,IAHlB;SAI7B,CAACD,cAAD,IAAmB,CAAC7b,QAAQ8b,SAA5B,GAAwC,MAAxC,GAAiD,IAJpB;SAK7BD,kBAAkB,CAAC7b,QAAQ8b,SAA3B,GAAuC,MAAvC,GAAgD,IALnB;SAM7B,CAACD,cAAD,IAAmB7b,QAAQ8b,SAA3B,GAAuC,MAAvC,GAAgD;KANrD,EASCI,QAAQY,UAAR,EATD,CADD,CADD,EAcCxB,iBAAkB,MAAlB,EAA0B,EAAErf,GAAG,GAAL,EAAUE,GAAG,GAAb,EAAkBuC,OAAO,MAAzB,EAAiCE,QAAQ,MAAzC,EAAiDme,MAAM,uBAAuB5B,MAAvB,GAAgC,GAAvF,EAA1B,CAdD,CANO,CAAR;QAuBKoB,mBAAmBrpB,SAAxB,EAAoC;WAE7BpE,KAAN,CAAYmjB,MAAZ,GAAqB4J,iBAAiB,UAAjB,GAA8B,UAAnD;oBACe/sB,KAAf,CAAqBmjB,MAArB,GAA8BkK,MAAMrtB,KAAN,CAAYmjB,MAA1C;;IA7BF,CAgCE,OAAQ/X,CAAR,EAAY;YAOL4Y,KAAR,CAAe,gCAAgC5Y,EAAEoc,OAAjD;;mBAIelnB,WAAhB,CAA6B+sB,KAA7B;mBACgBrtB,KAAhB,CAAsB8P,MAAtB,GAA+Bwd,mBAAmB,IAAlD;OAEKG,mBAAmBrpB,SAAxB,EAAoC;QAE9B2oB,cAAL,EACCU,eAAeztB,KAAf,CAAqB8P,MAArB,GAAgC1K,SAAU8L,QAAQlR,KAAR,CAAc8P,MAAxB,IAAmC,CAArC,GAA2C,IAAzE,CADD,KAEK2d,eAAeztB,KAAf,CAAqB4P,KAArB,GAA+BxK,SAAU8L,QAAQlR,KAAR,CAAc4P,KAAxB,IAAkC,CAApC,GAA0C,IAAvE;YAEGge,eAAR,CAAwB3mB,KAAxB,GAAgCiK,QAAQ0c,eAAR,CAAwB3mB,KAAxB,IAAiC,CAAjE;aACUiK,QAAQ0c,eAAR,CAAwB3mB,KAAlC;;;GAvDF,MA4DO;WAEE+c,KAAR,CAAe,oBAAf;;WAIQkK,SAAT,CAAoBC,KAApB,EAA4B;SAGrBhhB,CAAN,GAAU/H,SAAU+oB,MAAMhhB,CAAhB,CAAV;SACME,CAAN,GAAUjI,SAAU+oB,MAAM9gB,CAAhB,CAAV;OAEIhB,QAAJ,EAAc+hB,IAAd,EAAoBnnB,KAApB;OACK8lB,cAAL,EAAsB;eAEVoB,MAAMhhB,CAAjB;WACOogB,kBAAkB,CAAzB;QAEKlhB,YAAYkhB,eAAjB,EACClhB,WAAW+hB,IAAX;YACS/hB,WAAW,GAAb,GAAqB+hB,IAA7B;QACK,CAACld,QAAQ8b,SAAd,EAA0B;aAEjB,MAAM/lB,KAAd;gBACWmnB,OAAO/hB,QAAlB;;IAXF,MAeO;eAEK8hB,MAAM9gB,CAAjB;WACOigB,mBAAmB,CAA1B;QAEKjhB,YAAYihB,gBAAjB,EACCjhB,WAAW+hB,IAAX;YACO,CAAE,IAAI/hB,WAAW+hB,IAAjB,IAA0B,GAAlC;QACK,CAACld,QAAQ8b,SAAd,EAA0B;aAEjB,MAAM/lB,KAAd;;;YAKQA,KAAV,EAAiBoF,QAAjB;;MAGIohB,mBAAmBrpB,SAAxB,EAAoC;OAQ1BiqB,aAR0B,GAQnC,SAASA,aAAT,GAAyB;WAEjB,UAAWrhB,GAAX,EAAiB;SAElBshB,QAAL,EACC;WAEKthB,OAAOjN,OAAOsO,KAApB;cAKSkgB,aAAT,CAAwBvhB,GAAxB,EAA8B;UAExBjN,OAAOsO,KAAP,IAAgBtO,OAAOsO,KAAP,CAAamgB,eAAb,KAAiCpqB,SAAtD,EAAkE;cAC1D,EAAE+I,GAAGpN,OAAOsO,KAAP,CAAaogB,OAAlB,EAA2BphB,GAAGtN,OAAOsO,KAAP,CAAaqgB,OAA3C,EAAP;;UAGI1hB,IAAIyhB,OAAJ,KAAgBrqB,SAAhB,IAA6B4I,IAAI0hB,OAAJ,KAAgBtqB,SAAlD,EAA8D;cACtD,EAAE+I,GAAGH,IAAIyhB,OAAT,EAAkBphB,GAAGL,IAAI0hB,OAAzB,EAAP;;UAGGC,UAAU3hB,IAAI7K,MAAJ,CAAWysB,UAAX,CAAsBA,UAApC;aACO,EAAEzhB,GAAGH,IAAI6hB,MAAJ,GAAaF,QAAQxe,UAA1B,EAAsC9C,GAAGL,IAAI8hB,MAAJ,GAAaH,QAAQve,SAA9D,EAAP;;eAGUme,cAAevhB,GAAf,CAAX;KAxBD;IAVkC;OAuC1BwB,gBAvC0B,GAuCnC,SAASA,gBAAT,CAA2B6C,OAA3B,EAAoChD,KAApC,EAA2C0gB,QAA3C,EAAsD;QAEhD1d,YAAY,IAAjB,EACC;QAEIA,QAAQ5C,WAAb,EAA2B;aAElBA,WAAR,CAAqB,OAAOJ,KAA5B,EAAmC0gB,QAAnC;KAFD,MAIO,IAAK1d,QAAQ7C,gBAAb,EAAgC;aAE9BA,gBAAR,CAA0BH,KAA1B,EAAiC0gB,QAAjC,EAA2C,KAA3C;;IAlDiC;OAiE1BC,cAjE0B,GAiEnC,SAASA,cAAT,CAAyBC,GAAzB,EAA8BF,QAA9B,EAAyC;QAEpC1d,UAAUgc,KAAd;qBAIkBhc,OAAlB,EAA2B,YAA3B,EAAyC,UAAWrE,GAAX,EAAiB,EAA1D;qBACkBqE,OAAlB,EAA2B,WAA3B,EAAwC,UAAWrE,GAAX,EAAiB;SAEpDmH,cAAJ;SAEI+a,OAAOliB,IAAImiB,UAAJ,CAAe9a,qBAAf,EAAX;SACClH,IAAMH,IAAIsH,OAAJ,CAAY,CAAZ,EAAepH,OAAf,GAAyBgiB,KAAK5iB,IADrC;SAECe,IAAML,IAAIsH,OAAJ,CAAY,CAAZ,EAAelH,OAAf,GAAyB8hB,KAAK1iB,GAFrC;SAGKW,IAAI,CAAT,EAAaA,IAAI,CAAJ;SACRE,IAAI,CAAT,EAAaA,IAAI,CAAJ;eACF,EAAEF,GAAGA,CAAL,EAAQE,GAAGA,CAAX,EAAX;KATD;qBAYkBgE,OAAlB,EAA2B,UAA3B,EAAuC,UAAWrE,GAAX,EAAiB,EAAxD;qBAMkBqE,OAAlB,EAA2B,WAA3B,EAAwC,UAAWrE,GAAX,EAAiB;SAElDoiB,UAAU,SAAhB;SAA2BC,YAAY,WAAvC;cACS5b,SAAT,GAAqB;eAGX9E,mBAAT,CAA8B0C,OAA9B,EAAuChD,KAAvC,EAA8C0gB,QAA9C,EAAyD;WAEnD1d,YAAY,IAAjB,EACC;WAEIA,QAAQzC,WAAb,EAA2B;gBAElBA,WAAR,CAAqB,OAAOP,KAA5B,EAAmC0gB,QAAnC;QAFD,MAIO,IAAK1d,QAAQ1C,mBAAb,EAAmC;gBAEjCA,mBAAR,CAA6BN,KAA7B,EAAoC0gB,QAApC,EAA8C,KAA9C;;;0BAImBhvB,MAArB,EAA6BqvB,OAA7B,EAAsC3b,SAAtC;0BACqB1T,MAArB,EAA6BsvB,SAA7B,EAAwCN,QAAxC;;sBAGiBhvB,MAAlB,EAA0BqvB,OAA1B,EAAmC3b,SAAnC;sBACkB1T,MAAlB,EAA0BsvB,SAA1B,EAAqCN,QAArC;KA1BD;qBA6BkB1d,OAAlB,EAA2B,UAA3B,EAAuC,UAAWrE,GAAX,EAAiB;gBAAa,IAAX;KAA1D;qBACkBqE,OAAlB,EAA2B,WAA3B,EAAwC,UAAWrE,GAAX,EAAiB;gBAAa,KAAX;KAA3D;IAxHkC;OAE/BshB,WAAW,KAAf;oBAoDkBjB,KAAlB,EAAyB,OAAzB,EAAkCgB,eAAlC;kBAoEgB,IAAhB,EAAsBA,eAAtB;;SAIM;aAEIzjB;GAFX;EA/WD;MAuYKwiB,OAAL,GAAe,UAAUlc,OAAV,EAAoB;WAGzBoe,WAAT,CAAsB3B,OAAtB,EAA+B7sB,CAA/B,EAAkCG,CAAlC,EAAqCC,CAArC,EAAyC;UAEjC;aAEGysB,OAFH;OAGH7sB,CAHG;OAIHG,CAJG;OAKHC;IALJ;;YAWSgQ,WAAW,EAArB;MASKA,QAAQkc,OAAR,KAAoBhpB,SAAzB,EACC8M,QAAQkc,OAAR,GAAkBxc,MAAM2b,cAAN,CAAqBgD,IAAvC;OAWIC,eAAL,GAAuB,YAAY;UAASte,QAAQkc,OAAf;GAArC;MAEIqC,eAAe,CAElB,IAAIH,WAAJ,CAAiB,CAAjB,EAAoB,IAApB,EAA0B,IAA1B,EAAgC,IAAhC,CAFkB;MAGdA,WAAJ,CAAiB,EAAjB,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CAHkB;MAIdA,WAAJ,CAAiB,EAAjB,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CAJkB;MAKdA,WAAJ,CAAiB,GAAjB,EAAsB,IAAtB,EAA4B,IAA5B,EAAkC,IAAlC,CALkB,CAAnB;kBAQgBpe,QAAQkc,OAAxB;QAEM,QAAL;YACUlc,QAAQkc,OAAjB;UAEMxc,MAAM2b,cAAN,CAAqBgD,IAA1B;YAFD;UAIM3e,MAAM2b,cAAN,CAAqBmD,UAA1B;UACKD,eAAe,CAElB,IAAIH,WAAJ,CAAiB,CAAjB,EAAoB,IAApB,EAA0B,IAA1B,EAAgC,IAAhC,CAFkB;UAGdA,WAAJ,CAAiB,GAAjB,EAAsB,IAAtB,EAA4B,IAA5B,EAAkC,IAAlC,CAHkB,CAAnB;;UAOI1e,MAAM2b,cAAN,CAAqBoD,aAA1B;UACKF,eAAe,CAClB,IAAIH,WAAJ,CAAiB,CAAjB,EAAoB,IAApB,EAA0B,IAA1B,EAAgC,IAAhC,CADkB;UAEdA,WAAJ,CAAiB,EAAjB,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CAFkB;UAGdA,WAAJ,CAAiB,GAAjB,EAAsB,IAAtB,EAA4B,IAA5B,EAAkC,IAAlC,CAHkB,CAAnB;;UAOI1e,MAAM2b,cAAN,CAAqBqD,OAA1B;UACKH,eAAe,CAElB,IAAIH,WAAJ,CAAiB,CAAjB,EAAoB,IAApB,EAA0B,IAA1B,EAAgC,IAAhC,CAFkB,EAGlB,IAAIA,WAAJ,CAAiB,EAAjB,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CAHkB,EAIlB,IAAIA,WAAJ,CAAiB,EAAjB,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CAJkB,EAKlB,IAAIA,WAAJ,CAAiB,EAAjB,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CALkB,EAMlB,IAAIA,WAAJ,CAAiB,EAAjB,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CANkB,EAOlB,IAAIA,WAAJ,CAAiB,EAAjB,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CAPkB,EAQlB,IAAIA,WAAJ,CAAiB,GAAjB,EAAsB,IAAtB,EAA4B,IAA5B,EAAkC,IAAlC,CARkB,CAAnB;;;cAYgBtL,KAAR,CAAe,2DAA2D9S,QAAQkc,OAAlF;;;QAIN,QAAL;QACMxrB,MAAM6C,OAAN,CAAeyM,QAAQkc,OAAvB,CAAL,EAAwC;oBAGxBlc,QAAQkc,OAAvB;;;;QAKG5F,UAAU,+BAA+BtW,QAAQkc,OAArD;YACQpJ,KAAR,CAAe,iCAAiCwD,OAAhD;YACQyF,OAAR,CAAiBzF,OAAjB;;OAMGwG,UAAL,GAAkB,YAAY;OAEvBZ,UAAU,EAAhB;gBACatrB,OAAb,CAAsB,UAAW4oB,IAAX,EAAkB;YAE/BmF,OAAR,CAAiBrD,iBAAkB,MAAlB,EAA0B;aAEhC,MAAM9B,KAAKiD,OAAb,GAAyB,GAFS,EAEJ,cAAc;OAEjD,CAAE,MAAQmC,OAAQpF,KAAK5pB,CAAb,EAAiBD,QAAjB,CAA2B,EAA3B,CAAV,EAA8CmB,KAA9C,CAAqD,CAAC,CAAtD,EAA0D+tB,WAA1D,EAFiD,GAGjD,CAAE,MAAQD,OAAQpF,KAAKzpB,CAAb,EAAiBJ,QAAjB,CAA2B,EAA3B,CAAV,EAA8CmB,KAA9C,CAAqD,CAAC,CAAtD,EAA0D+tB,WAA1D,EAHiD,GAIjD,CAAE,MAAQD,OAAQpF,KAAKxpB,CAAb,EAAiBL,QAAjB,CAA2B,EAA3B,CAAV,EAA8CmB,KAA9C,CAAqD,CAAC,CAAtD,EAA0D+tB,WAA1D,EANuC;qBAO1B;KAPA,CAAjB;IAFD;UAcO3C,OAAP;GAjBD;OA2BKM,OAAL,GAAe,UAAWsC,aAAX,EAA0BvpB,GAA1B,EAA+BC,GAA/B,EAAqC;OAE/CinB,UAAUtoB,WAAY2qB,aAAZ,CAAd;OACKvpB,QAAQrC,SAAR,IAAqBsC,QAAQtC,SAAlC,EACCupB,UAAY,OAAQjnB,MAAMD,GAAd,CAAF,IAA4BknB,UAAUlnB,GAAtC,CAAV;OACGwpB,cAAcR,aAAaA,aAAa/tB,MAAb,GAAsB,CAAnC,CAAlB;OACKuuB,YAAYtC,OAAZ,KAAwB,GAA7B,EAAmC;QAK5BuC,WAAW,EAAjB;WACO1tB,IAAP,CAAaytB,WAAb,EAA2BnuB,OAA3B,CAAoC,UAAWa,GAAX,EAAiB;cAE3CA,GAAT,IAAgBstB,YAAYttB,GAAZ,CAAhB;KAFD;aAKSgrB,OAAT,GAAmB,GAAnB;iBACa1e,IAAb,CAAmBihB,QAAnB;;OAGGC,QAAJ;QACM,IAAIjtB,IAAI,CAAd,EAAiBA,IAAIusB,aAAa/tB,MAAlC,EAA0CwB,GAA1C,EAAgD;QAEzCwnB,OAAO+E,aAAavsB,CAAb,CAAb;QACKitB,aAAa/rB,SAAlB,EACC+rB,WAAWzF,IAAX;QACQiD,WAAWwC,SAASxC,OAAtB,IAAqCA,WAAWjD,KAAKiD,OAA5D,EAA0E;SAEhEntB,KAFgE,GAEzE,SAASA,KAAT,CAAgB4vB,WAAhB,EAA6BC,IAA7B,EAAmCC,WAAnC,EAAgD5F,IAAhD,EAAuD;UAElD6F,WAAWD,cAAcF,WAA7B;UACKG,aAAa,CAAlB,EACC,OAAOF,IAAP;aACMtvB,KAAKC,KAAL,CAAYqvB,OAAS,CAAE3F,OAAO2F,IAAT,IAAkBE,QAApB,IAAmC5C,UAAUyC,WAA7C,CAAnB,CAAP;MAPwE;SAUnEtvB,IAAIN,MAAO2vB,SAASxC,OAAhB,EAAyBwC,SAASrvB,CAAlC,EAAqC4pB,KAAKiD,OAA1C,EAAmDjD,KAAK5pB,CAAxD,CAAV;SACCG,IAAIT,MAAO2vB,SAASxC,OAAhB,EAAyBwC,SAASlvB,CAAlC,EAAqCypB,KAAKiD,OAA1C,EAAmDjD,KAAKzpB,CAAxD,CADL;SAECC,IAAIV,MAAO2vB,SAASxC,OAAhB,EAAyBwC,SAASjvB,CAAlC,EAAqCwpB,KAAKiD,OAA1C,EAAmDjD,KAAKxpB,CAAxD,CAFL;YAGO;SAEHJ,CAFG;SAGHG,CAHG;SAIHC,CAJG;WAKD,MAAM,CAAE,WAAWA,CAAX,GAAiBD,KAAK,CAAtB,GAA8BH,KAAK,EAArC,EAA4CD,QAA5C,CAAsD,EAAtD,EAA2DmB,KAA3D,CAAkE,CAAlE,CALL;eAMG2rB;MANV;;eAWUjD,IAAX;;OAGIxZ,QAAQ+b,OAAR,KAAoB7oB,SAAzB,EACC8M,QAAQ+b,OAAR,CAAiB,6CAA6C+C,aAA9D;GAvDF;OAkEKQ,OAAL,GAAe,UAAWvpB,KAAX,EAAkBR,GAAlB,EAAuBC,GAAvB,EAA6B;OAErCmd,QAAQK,QAAML,KAApB;OASK5c,iBAAiB4c,MAAMta,KAA5B,EACC,OAAOtC,KAAP;OACGV,IAAI,KAAKmnB,OAAL,CAAczmB,KAAd,EAAqBR,GAArB,EAA0BC,GAA1B,CAAR;OACKH,MAAMnC,SAAX,EACCmC,IAAI,EAAEzF,GAAG,GAAL,EAAUG,GAAG,GAAb,EAAkBC,GAAG,GAArB,EAAJ;UACM,IAAI2iB,MAAMta,KAAV,CAAiB,SAAShD,EAAEzF,CAAX,GAAe,IAAf,GAAsByF,EAAEtF,CAAxB,GAA4B,IAA5B,GAAmCsF,EAAErF,CAArC,GAAyC,GAA1D,CAAP;GAhBD;;EArMD;;AA8NForB,cAAc,IAAIA,WAAJ,EAAd;AACA,oBAAeA,WAAf;;ACpvBA,IAAImE,gBAAgB,SAAhBA,aAAgB,CAAWpoB,MAAX,EAAmBkC,UAAnB,EAAgC;MAE7CmmB,kBAAkBxM,QAAML,KAAN,CAAY6M,eAApC;MACCC,QAAQzM,QAAML,KAAN,CAAY8M,KADrB;MAECC,aAAa1M,QAAML,KAAN,CAAY+M,UAF1B;MAGCC,YAAY3M,QAAML,KAAN,CAAYgN,SAHzB;MAICC,QAAQ5M,QAAML,KAAN,CAAYiN,KAJrB;MAKCC,UAAU7M,QAAML,KAAN,CAAYkN,OALvB;MAMC/K,UAAU9B,QAAML,KAAN,CAAYmC,OANvB;MAcKzb,eAAenG,SAApB,EAAgC2f,QAAQiN,IAAR,CAAc,0EAAd;MAC3BzmB,eAAetK,QAApB,EAA+B8jB,QAAQC,KAAR,CAAe,0HAAf;OAE1B3b,MAAL,GAAcA,MAAd;OACKkC,UAAL,GAAkBA,UAAlB;OAGK0mB,OAAL,GAAe,IAAf;OAGK9uB,MAAL,GAAc,IAAI6jB,OAAJ,EAAd;OAGKkL,WAAL,GAAmB,CAAnB;OACKC,WAAL,GAAmBC,QAAnB;OAGKC,OAAL,GAAe,CAAf;OACKC,OAAL,GAAeF,QAAf;OAIKG,aAAL,GAAqB,CAArB,CAtCmD;OAuC9CC,aAAL,GAAqBzwB,KAAK0wB,EAA1B,CAvCmD;OA2C9CC,eAAL,GAAuB,CAAEN,QAAzB,CA3CmD;OA4C9CO,eAAL,GAAuBP,QAAvB,CA5CmD;OAgD9CQ,aAAL,GAAqB,KAArB;OACKC,aAAL,GAAqB,IAArB;OAIKC,UAAL,GAAkB,IAAlB;OACKC,SAAL,GAAiB,GAAjB;OAGKC,YAAL,GAAoB,IAApB;OACKC,WAAL,GAAmB,GAAnB;OAGKC,SAAL,GAAiB,IAAjB;OACKC,QAAL,GAAgB,GAAhB;OACKC,kBAAL,GAA0B,IAA1B,CA/DmD;OAgE9CC,WAAL,GAAmB,GAAnB,CAhEmD;OAoE9CC,UAAL,GAAkB,KAAlB;OACKC,eAAL,GAAuB,GAAvB,CArEmD;OAwE9C/vB,IAAL,GAAY,EAAEgwB,MAAM,EAAR,EAAYC,IAAI,EAAhB,EAAoBC,OAAO,EAA3B,EAA+BC,QAAQ,EAAvC,EAAZ;OAGKC,YAAL,GAAoB,EAAEJ,MAAM7B,MAAMkC,MAAd,EAAsBC,QAAQnC,MAAMoC,KAApC,EAA2CL,OAAO/B,MAAMqC,GAAxD,EAApB;OAGK1e,OAAL,GAAe,EAAE2e,KAAKnC,MAAM+B,MAAb,EAAqBK,KAAKpC,MAAMqC,SAAhC,EAAf;OAGKC,OAAL,GAAe,KAAKjxB,MAAL,CAAYkkB,KAAZ,EAAf;OACKgN,SAAL,GAAiB,KAAKhrB,MAAL,CAAYgE,QAAZ,CAAqBga,KAArB,EAAjB;OACKiN,KAAL,GAAa,KAAKjrB,MAAL,CAAYuc,IAAzB;OAGK2O,oBAAL,GAA4B,IAA5B;OAMKC,aAAL,GAAqB,YAAY;WAEzBC,UAAUC,GAAjB;GAFD;OAMKC,iBAAL,GAAyB,YAAY;WAE7BF,UAAUG,KAAjB;GAFD;OAMKC,iBAAL,GAAyB,UAAWtpB,UAAX,EAAwB;eAErCiE,gBAAX,CAA6B,SAA7B,EAAwCslB,SAAxC;SACKP,oBAAL,GAA4BhpB,UAA5B;GAHD;OAOKwpB,SAAL,GAAiB,YAAY;UAEtBX,OAAN,CAAc1M,IAAd,CAAoBrjB,MAAMlB,MAA1B;UACMkxB,SAAN,CAAgB3M,IAAhB,CAAsBrjB,MAAMgF,MAAN,CAAagE,QAAnC;UACMinB,KAAN,GAAcjwB,MAAMgF,MAAN,CAAauc,IAA3B;GAJD;OAQKoP,KAAL,GAAa,YAAY;UAElB7xB,MAAN,CAAaukB,IAAb,CAAmBrjB,MAAM+vB,OAAzB;UACM/qB,MAAN,CAAagE,QAAb,CAAsBqa,IAAtB,CAA4BrjB,MAAMgwB,SAAlC;UACMhrB,MAAN,CAAauc,IAAb,GAAoBvhB,MAAMiwB,KAA1B;UAEMjrB,MAAN,CAAa4rB,sBAAb;UACM7lB,aAAN,CAAqB8lB,WAArB;UAEMC,MAAN;YAEQC,MAAMC,IAAd;GAXD;OAgBKF,MAAL,GAAc,YAAY;QAErBlkB,SAAS,IAAI+V,OAAJ,EAAb;QAGIsO,OAAO,IAAI1D,UAAJ,GAAiB2D,kBAAjB,CAAqClsB,OAAOmsB,EAA5C,EAAgD,IAAIxO,OAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,CAAhD,CAAX;QACIyO,cAAcH,KAAKjO,KAAL,GAAaqO,MAAb,EAAlB;QAEIC,eAAe,IAAI3O,OAAJ,EAAnB;QACI4O,iBAAiB,IAAIhE,UAAJ,EAArB;QAEIiE,QAAQ,IAAI9zB,KAAK0wB,EAArB;WAEO,SAAS0C,MAAT,GAAkB;UAEpB9nB,WAAWhJ,MAAMgF,MAAN,CAAagE,QAA5B;aAEOqa,IAAP,CAAara,QAAb,EAAwByoB,GAAxB,CAA6BzxB,MAAMlB,MAAnC;aAGO4yB,eAAP,CAAwBT,IAAxB;gBAGUU,cAAV,CAA0B/kB,MAA1B;UAEK5M,MAAMivB,UAAN,IAAoB2C,UAAUb,MAAMC,IAAzC,EAAgD;mBAEnCa,sBAAZ;;UAII7xB,MAAMuuB,aAAX,EAA2B;kBAEhBgC,KAAV,IAAmBuB,eAAevB,KAAf,GAAuBvwB,MAAMwuB,aAAhD;kBACU6B,GAAV,IAAiByB,eAAezB,GAAf,GAAqBrwB,MAAMwuB,aAA5C;OAHD,MAKO;kBAEI+B,KAAV,IAAmBuB,eAAevB,KAAlC;kBACUF,GAAV,IAAiByB,eAAezB,GAAhC;;UAMGjtB,MAAMpD,MAAMquB,eAAhB;UACIhrB,MAAMrD,MAAMsuB,eAAhB;UAEKyD,SAAU3uB,GAAV,KAAmB2uB,SAAU1uB,GAAV,CAAxB,EAA0C;YAEpCD,MAAM,CAAE1F,KAAK0wB,EAAlB,EAAuBhrB,OAAOouB,KAAP,CAAvB,KAA0C,IAAKpuB,MAAM1F,KAAK0wB,EAAhB,EAAqBhrB,OAAOouB,KAAP;YAE1DnuB,MAAM,CAAE3F,KAAK0wB,EAAlB,EAAuB/qB,OAAOmuB,KAAP,CAAvB,KAA0C,IAAKnuB,MAAM3F,KAAK0wB,EAAhB,EAAqB/qB,OAAOmuB,KAAP;YAE1DpuB,OAAOC,GAAZ,EAAkB;oBAEPktB,KAAV,GAAkB7yB,KAAK2F,GAAL,CAAUD,GAAV,EAAe1F,KAAK0F,GAAL,CAAUC,GAAV,EAAe+sB,UAAUG,KAAzB,CAAf,CAAlB;SAFD,MAIO;oBAEIA,KAAV,GAAoBH,UAAUG,KAAV,GAAkB,CAAEntB,MAAMC,GAAR,IAAgB,CAApC,GACjB3F,KAAK2F,GAAL,CAAUD,GAAV,EAAegtB,UAAUG,KAAzB,CADiB,GAEjB7yB,KAAK0F,GAAL,CAAUC,GAAV,EAAe+sB,UAAUG,KAAzB,CAFD;;;gBASQF,GAAV,GAAgB3yB,KAAK2F,GAAL,CAAUrD,MAAMkuB,aAAhB,EAA+BxwB,KAAK0F,GAAL,CAAUpD,MAAMmuB,aAAhB,EAA+BiC,UAAUC,GAAzC,CAA/B,CAAhB;gBAEU2B,QAAV;gBAGUC,MAAV,IAAoB7O,KAApB;gBAGU6O,MAAV,GAAmBv0B,KAAK2F,GAAL,CAAUrD,MAAM6tB,WAAhB,EAA6BnwB,KAAK0F,GAAL,CAAUpD,MAAM8tB,WAAhB,EAA6BsC,UAAU6B,MAAvC,CAA7B,CAAnB;UAIKjyB,MAAMuuB,aAAN,KAAwB,IAA7B,EAAoC;cAE7BzvB,MAAN,CAAaozB,eAAb,CAA8BC,SAA9B,EAAyCnyB,MAAMwuB,aAA/C;OAFD,MAIO;cAEA1vB,MAAN,CAAa+a,GAAb,CAAkBsY,SAAlB;;aAIMC,gBAAP,CAAyBhC,SAAzB;aAGOsB,eAAP,CAAwBN,WAAxB;eAES/N,IAAT,CAAerjB,MAAMlB,MAArB,EAA8B+a,GAA9B,CAAmCjN,MAAnC;YAEM5H,MAAN,CAAaqtB,MAAb,CAAqBryB,MAAMlB,MAA3B;UAEKkB,MAAMuuB,aAAN,KAAwB,IAA7B,EAAoC;uBAEpBgC,KAAf,IAA0B,IAAIvwB,MAAMwuB,aAApC;uBACe6B,GAAf,IAAwB,IAAIrwB,MAAMwuB,aAAlC;kBAEU8D,cAAV,CAA0B,IAAItyB,MAAMwuB,aAApC;OALD,MAOO;uBAES+D,GAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B;kBAEUA,GAAV,CAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB;;cAIO,CAAR;UAMKC,eACJlB,aAAamB,iBAAb,CAAgCzyB,MAAMgF,MAAN,CAAagE,QAA7C,IAA0D0pB,GADtD,IAEJ,KAAM,IAAInB,eAAeoB,GAAf,CAAoB3yB,MAAMgF,MAAN,CAAa4tB,UAAjC,CAAV,IAA4DF,GAF7D,EAEmE;cAE5D3nB,aAAN,CAAqB8lB,WAArB;qBAEaxN,IAAb,CAAmBrjB,MAAMgF,MAAN,CAAagE,QAAhC;uBACeqa,IAAf,CAAqBrjB,MAAMgF,MAAN,CAAa4tB,UAAlC;sBACc,KAAd;eAEO,IAAP;;aAIM,KAAP;KA1HD;GAba,EAAd;OA6IKC,OAAL,GAAe,YAAY;UAEpB3rB,UAAN,CAAiBoE,mBAAjB,CAAsC,aAAtC,EAAqDwnB,aAArD;UAEM5rB,UAAN,CAAiBoE,mBAAjB,CAAsC,aAAtC,EAAqDynB,aAArD;UACM7rB,UAAN,CAAiBoE,mBAAjB,CAAsC,OAAtC,EAA+C0nB,YAA/C;UAEM9rB,UAAN,CAAiBoE,mBAAjB,CAAsC,YAAtC,EAAoDuF,YAApD;UACM3J,UAAN,CAAiBoE,mBAAjB,CAAsC,UAAtC,EAAkD6F,UAAlD;UACMjK,UAAN,CAAiBoE,mBAAjB,CAAsC,WAAtC,EAAmD4F,WAAnD;UAEMhK,UAAN,CAAiB+rB,aAAjB,CAA+B3nB,mBAA/B,CAAoD,aAApD,EAAmE4nB,aAAnE;UACMhsB,UAAN,CAAiB+rB,aAAjB,CAA+B3nB,mBAA/B,CAAoD,WAApD,EAAiE6nB,WAAjE;QAGKnzB,MAAMkwB,oBAAN,KAA+B,IAApC,EAA2C;YAEpCA,oBAAN,CAA2B5kB,mBAA3B,CAAgD,SAAhD,EAA2DmlB,SAA3D;;GAjBF;MA6BIzwB,QAAQ,IAAZ;MAEI6wB,cAAc,EAAE3jB,MAAM,QAAR,EAAlB;MACIkmB,aAAa,EAAElmB,MAAM,OAAR,EAAjB;MACImmB,WAAW,EAAEnmB,MAAM,KAAR,EAAf;MAEI6jB,QAAQ;UACL,CAAE,CADG;YAEH,CAFG;WAGJ,CAHI;SAIN,CAJM;kBAKG,CALH;eAMA,CANA;qBAOM,CAPN;wBAQS;GARrB;MAWIa,QAAQb,MAAMC,IAAlB;MAEI0B,MAAM,QAAV;MAGItC,YAAY,IAAI5C,SAAJ,EAAhB;MACIsE,iBAAiB,IAAItE,SAAJ,EAArB;MAEIpK,QAAQ,CAAZ;MACI+O,YAAY,IAAIxP,OAAJ,EAAhB;MACI6P,cAAc,KAAlB;MAEIc,cAAc,IAAI5F,OAAJ,EAAlB;MACI6F,YAAY,IAAI7F,OAAJ,EAAhB;MACI8F,cAAc,IAAI9F,OAAJ,EAAlB;MAEI+F,WAAW,IAAI/F,OAAJ,EAAf;MACIgG,SAAS,IAAIhG,OAAJ,EAAb;MACIiG,WAAW,IAAIjG,OAAJ,EAAf;MAEIkG,aAAa,IAAIlG,OAAJ,EAAjB;MACImG,WAAW,IAAInG,OAAJ,EAAf;MACIoG,aAAa,IAAIpG,OAAJ,EAAjB;WAESmE,oBAAT,GAAgC;WAExB,IAAIn0B,KAAK0wB,EAAT,GAAc,EAAd,GAAmB,EAAnB,GAAwBpuB,MAAMkvB,eAArC;;WAIQ6E,YAAT,GAAwB;WAEhBr2B,KAAKsR,GAAL,CAAU,IAAV,EAAgBhP,MAAM0uB,SAAtB,CAAP;;WAIQsF,UAAT,CAAqBC,KAArB,EAA6B;mBAEb1D,KAAf,IAAwB0D,KAAxB;;WAIQC,QAAT,CAAmBD,KAAnB,EAA2B;mBAEX5D,GAAf,IAAsB4D,KAAtB;;MAIGE,UAAU,YAAY;QAErBj2B,IAAI,IAAIykB,OAAJ,EAAR;WAEO,SAASwR,OAAT,CAAkBC,QAAlB,EAA4BC,YAA5B,EAA2C;QAE/CC,mBAAF,CAAuBD,YAAvB,EAAqC,CAArC,EAFiD;QAG/C/B,cAAF,CAAkB,CAAE8B,QAApB;gBAEUva,GAAV,CAAe3b,CAAf;KALD;GAJa,EAAd;MAeIq2B,QAAQ,YAAY;QAEnBr2B,IAAI,IAAIykB,OAAJ,EAAR;WAEO,SAAS4R,KAAT,CAAgBH,QAAhB,EAA0BC,YAA1B,EAAyC;UAE1Cr0B,MAAM+uB,kBAAN,KAA6B,IAAlC,EAAyC;UAEtCuF,mBAAF,CAAuBD,YAAvB,EAAqC,CAArC;OAFD,MAIO;UAEJC,mBAAF,CAAuBD,YAAvB,EAAqC,CAArC;UACEG,YAAF,CAAgBx0B,MAAMgF,MAAN,CAAamsB,EAA7B,EAAiCjzB,CAAjC;;QAICo0B,cAAF,CAAkB8B,QAAlB;gBAEUva,GAAV,CAAe3b,CAAf;KAfD;GAJW,EAAZ;MA0BIu2B,MAAM,YAAY;QAEjB7nB,SAAS,IAAI+V,OAAJ,EAAb;WAEO,SAAS8R,GAAT,CAAcC,MAAd,EAAsBzU,MAAtB,EAA+B;UAEjCjS,UAAUhO,MAAMkH,UAApB;UAEKlH,MAAMgF,MAAN,CAAa2vB,mBAAlB,EAAwC;YAGnC3rB,WAAWhJ,MAAMgF,MAAN,CAAagE,QAA5B;eACOqa,IAAP,CAAara,QAAb,EAAwByoB,GAAxB,CAA6BzxB,MAAMlB,MAAnC;YACI81B,iBAAiBhoB,OAAOvO,MAAP,EAArB;0BAGkBX,KAAKm3B,GAAL,CAAY70B,MAAMgF,MAAN,CAAa8vB,GAAb,GAAmB,CAArB,GAA2Bp3B,KAAK0wB,EAAhC,GAAqC,KAA/C,CAAlB;gBAGS,IAAIsG,MAAJ,GAAaE,cAAb,GAA8B5mB,QAAQ+mB,YAA/C,EAA6D/0B,MAAMgF,MAAN,CAAagwB,MAA1E;cACO,IAAI/U,MAAJ,GAAa2U,cAAb,GAA8B5mB,QAAQ+mB,YAA7C,EAA2D/0B,MAAMgF,MAAN,CAAagwB,MAAxE;OAZD,MAcO,IAAKh1B,MAAMgF,MAAN,CAAaiwB,oBAAlB,EAAyC;gBAGtCP,UAAW10B,MAAMgF,MAAN,CAAakE,KAAb,GAAqBlJ,MAAMgF,MAAN,CAAaiE,IAA7C,IAAsDjJ,MAAMgF,MAAN,CAAauc,IAAnE,GAA0EvT,QAAQmc,WAA3F,EAAwGnqB,MAAMgF,MAAN,CAAagwB,MAArH;cACO/U,UAAWjgB,MAAMgF,MAAN,CAAamE,GAAb,GAAmBnJ,MAAMgF,MAAN,CAAaoE,MAA3C,IAAsDpJ,MAAMgF,MAAN,CAAauc,IAAnE,GAA0EvT,QAAQ+mB,YAAzF,EAAuG/0B,MAAMgF,MAAN,CAAagwB,MAApH;OAJM,MAMA;gBAGErH,IAAR,CAAc,8EAAd;cACMkB,SAAN,GAAkB,KAAlB;;KA5BF;GAJS,EAAV;WAwCSqG,QAAT,CAAmBC,UAAnB,EAAgC;QAE1Bn1B,MAAMgF,MAAN,CAAa2vB,mBAAlB,EAAwC;eAE9BQ,UAAT;KAFD,MAIO,IAAKn1B,MAAMgF,MAAN,CAAaiwB,oBAAlB,EAAyC;YAEzCjwB,MAAN,CAAauc,IAAb,GAAoB7jB,KAAK2F,GAAL,CAAUrD,MAAMguB,OAAhB,EAAyBtwB,KAAK0F,GAAL,CAAUpD,MAAMiuB,OAAhB,EAAyBjuB,MAAMgF,MAAN,CAAauc,IAAb,GAAoB4T,UAA7C,CAAzB,CAApB;YACMnwB,MAAN,CAAa4rB,sBAAb;oBACc,IAAd;KAJM,MAMA;cAEEjD,IAAR,CAAc,qFAAd;YACMc,UAAN,GAAmB,KAAnB;;;WAMO2G,OAAT,CAAkBD,UAAlB,EAA+B;QAEzBn1B,MAAMgF,MAAN,CAAa2vB,mBAAlB,EAAwC;eAE9BQ,UAAT;KAFD,MAIO,IAAKn1B,MAAMgF,MAAN,CAAaiwB,oBAAlB,EAAyC;YAEzCjwB,MAAN,CAAauc,IAAb,GAAoB7jB,KAAK2F,GAAL,CAAUrD,MAAMguB,OAAhB,EAAyBtwB,KAAK0F,GAAL,CAAUpD,MAAMiuB,OAAhB,EAAyBjuB,MAAMgF,MAAN,CAAauc,IAAb,GAAoB4T,UAA7C,CAAzB,CAApB;YACMnwB,MAAN,CAAa4rB,sBAAb;oBACc,IAAd;KAJM,MAMA;cAEEjD,IAAR,CAAc,qFAAd;YACMc,UAAN,GAAmB,KAAnB;;;WAUO4G,qBAAT,CAAgCrqB,KAAhC,EAAwC;gBAE3BunB,GAAZ,CAAiBvnB,MAAMnB,OAAvB,EAAgCmB,MAAMjB,OAAtC;;WAIQurB,oBAAT,CAA+BtqB,KAA/B,EAAuC;eAE3BunB,GAAX,CAAgBvnB,MAAMnB,OAAtB,EAA+BmB,MAAMjB,OAArC;;WAIQwrB,kBAAT,CAA6BvqB,KAA7B,EAAqC;aAE3BunB,GAAT,CAAcvnB,MAAMnB,OAApB,EAA6BmB,MAAMjB,OAAnC;;WAIQyrB,qBAAT,CAAgCxqB,KAAhC,EAAwC;cAE7BunB,GAAV,CAAevnB,MAAMnB,OAArB,EAA8BmB,MAAMjB,OAApC;gBAEY0rB,UAAZ,CAAwBlC,SAAxB,EAAmCD,WAAnC,EAAiDhB,cAAjD,CAAiEtyB,MAAM4uB,WAAvE;QAEI5gB,UAAUhO,MAAMkH,UAApB;eAEY,IAAIxJ,KAAK0wB,EAAT,GAAcoF,YAAY1pB,CAA1B,GAA8BkE,QAAQ+mB,YAAlD,EARuC;aAU7B,IAAIr3B,KAAK0wB,EAAT,GAAcoF,YAAYxpB,CAA1B,GAA8BgE,QAAQ+mB,YAAhD;gBAEY1R,IAAZ,CAAkBkQ,SAAlB;UAEMzC,MAAN;;WAIQ4E,oBAAT,CAA+B1qB,KAA/B,EAAuC;aAE7BunB,GAAT,CAAcvnB,MAAMnB,OAApB,EAA6BmB,MAAMjB,OAAnC;eAEW0rB,UAAX,CAAuB5B,QAAvB,EAAiCD,UAAjC;QAEKE,WAAW9pB,CAAX,GAAe,CAApB,EAAwB;eAEb+pB,cAAV;KAFD,MAIO,IAAKD,WAAW9pB,CAAX,GAAe,CAApB,EAAwB;cAErB+pB,cAAT;;eAIU1Q,IAAX,CAAiBwQ,QAAjB;UAEM/C,MAAN;;WAIQ6E,kBAAT,CAA6B3qB,KAA7B,EAAqC;WAE7BunB,GAAP,CAAYvnB,MAAMnB,OAAlB,EAA2BmB,MAAMjB,OAAjC;aAES0rB,UAAT,CAAqB/B,MAArB,EAA6BD,QAA7B,EAAwCnB,cAAxC,CAAwDtyB,MAAM8uB,QAA9D;QAEK6E,SAAS7pB,CAAd,EAAiB6pB,SAAS3pB,CAA1B;aAESqZ,IAAT,CAAeqQ,MAAf;UAEM5C,MAAN;;WAUQ8E,gBAAT,CAA2B5qB,KAA3B,EAAmC;QAE7BA,MAAMiV,MAAN,GAAe,CAApB,EAAwB;cAEd8T,cAAT;KAFD,MAIO,IAAK/oB,MAAMiV,MAAN,GAAe,CAApB,EAAwB;eAEpB8T,cAAV;;UAIKjD,MAAN;;WAIQ+E,aAAT,CAAwB7qB,KAAxB,EAAgC;QAE3B8qB,cAAc,KAAlB;YAES9qB,MAAMJ,OAAf;WAEM5K,MAAMb,IAAN,CAAWiwB,EAAhB;YACM,CAAL,EAAQpvB,MAAMgvB,WAAd;sBACc,IAAd;;WAGIhvB,MAAMb,IAAN,CAAWmwB,MAAhB;YACM,CAAL,EAAQ,CAAEtvB,MAAMgvB,WAAhB;sBACc,IAAd;;WAGIhvB,MAAMb,IAAN,CAAWgwB,IAAhB;YACMnvB,MAAMgvB,WAAX,EAAwB,CAAxB;sBACc,IAAd;;WAGIhvB,MAAMb,IAAN,CAAWkwB,KAAhB;YACM,CAAErvB,MAAMgvB,WAAb,EAA0B,CAA1B;sBACc,IAAd;;;QAKG8G,WAAL,EAAmB;YAGZhlB,cAAN;YAEMggB,MAAN;;;WAOOiF,sBAAT,CAAiC/qB,KAAjC,EAAyC;QAEnCA,MAAMiG,OAAN,CAAc5S,MAAd,IAAwB,CAA7B,EAAiC;kBAEpBk0B,GAAZ,CAAiBvnB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAApC,EAA2ChrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAA9D;KAFD,MAIO;UAEFnsB,IAAI,OAAQkB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAnB,GAA2BhrB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAtD,CAAR;UACIhsB,IAAI,OAAQgB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAnB,GAA2BjrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAtD,CAAR;kBAEY1D,GAAZ,CAAiBzoB,CAAjB,EAAoBE,CAApB;;;WAMOksB,mBAAT,CAA8BlrB,KAA9B,EAAsC;QAEhCA,MAAMiG,OAAN,CAAc5S,MAAd,IAAwB,CAA7B,EAAiC;eAEvBk0B,GAAT,CAAcvnB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAjC,EAAwChrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAA3D;KAFD,MAIO;UAEFnsB,IAAI,OAAQkB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAnB,GAA2BhrB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAtD,CAAR;UACIhsB,IAAI,OAAQgB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAnB,GAA2BjrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAtD,CAAR;eAES1D,GAAT,CAAczoB,CAAd,EAAiBE,CAAjB;;;WAMOmsB,qBAAT,CAAgCnrB,KAAhC,EAAwC;QAEnCorB,KAAKprB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAnB,GAA2BhrB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAvD;QACIK,KAAKrrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAnB,GAA2BjrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAvD;QAEI7B,WAAW12B,KAAK44B,IAAL,CAAWF,KAAKA,EAAL,GAAUC,KAAKA,EAA1B,CAAf;eAEW9D,GAAX,CAAgB,CAAhB,EAAmB6B,QAAnB;;WAIQmC,wBAAT,CAAmCvrB,KAAnC,EAA2C;QAErChL,MAAMyuB,UAAX,EAAwB0H,sBAAuBnrB,KAAvB;QAEnBhL,MAAM6uB,SAAX,EAAuBqH,oBAAqBlrB,KAArB;;WAIfwrB,2BAAT,CAAsCxrB,KAAtC,EAA8C;QAExChL,MAAMyuB,UAAX,EAAwB0H,sBAAuBnrB,KAAvB;QAEnBhL,MAAM2uB,YAAX,EAA0BoH,uBAAwB/qB,KAAxB;;WAIlByrB,qBAAT,CAAgCzrB,KAAhC,EAAwC;QAElCA,MAAMiG,OAAN,CAAc5S,MAAd,IAAwB,CAA7B,EAAiC;gBAEtBk0B,GAAV,CAAevnB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAlC,EAAyChrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAA5D;KAFD,MAIO;UAEFnsB,IAAI,OAAQkB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAnB,GAA2BhrB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAtD,CAAR;UACIhsB,IAAI,OAAQgB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAnB,GAA2BjrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAtD,CAAR;gBAEU1D,GAAV,CAAezoB,CAAf,EAAkBE,CAAlB;;gBAIWyrB,UAAZ,CAAwBlC,SAAxB,EAAmCD,WAAnC,EAAiDhB,cAAjD,CAAiEtyB,MAAM4uB,WAAvE;QAEI5gB,UAAUhO,MAAMkH,UAApB;eAEY,IAAIxJ,KAAK0wB,EAAT,GAAcoF,YAAY1pB,CAA1B,GAA8BkE,QAAQ+mB,YAAlD,EAnBuC;aAqB7B,IAAIr3B,KAAK0wB,EAAT,GAAcoF,YAAYxpB,CAA1B,GAA8BgE,QAAQ+mB,YAAhD;gBAEY1R,IAAZ,CAAkBkQ,SAAlB;;WAIQmD,kBAAT,CAA6B1rB,KAA7B,EAAqC;QAE/BA,MAAMiG,OAAN,CAAc5S,MAAd,IAAwB,CAA7B,EAAiC;aAEzBk0B,GAAP,CAAYvnB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAA/B,EAAsChrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAzD;KAFD,MAIO;UAEFnsB,IAAI,OAAQkB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAnB,GAA2BhrB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAtD,CAAR;UACIhsB,IAAI,OAAQgB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAnB,GAA2BjrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAtD,CAAR;aAEO1D,GAAP,CAAYzoB,CAAZ,EAAeE,CAAf;;aAIQyrB,UAAT,CAAqB/B,MAArB,EAA6BD,QAA7B,EAAwCnB,cAAxC,CAAwDtyB,MAAM8uB,QAA9D;QAEK6E,SAAS7pB,CAAd,EAAiB6pB,SAAS3pB,CAA1B;aAESqZ,IAAT,CAAeqQ,MAAf;;WAIQiD,oBAAT,CAA+B3rB,KAA/B,EAAuC;QAElCorB,KAAKprB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAnB,GAA2BhrB,MAAMiG,OAAN,CAAe,CAAf,EAAmB+kB,KAAvD;QACIK,KAAKrrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAnB,GAA2BjrB,MAAMiG,OAAN,CAAe,CAAf,EAAmBglB,KAAvD;QAEI7B,WAAW12B,KAAK44B,IAAL,CAAWF,KAAKA,EAAL,GAAUC,KAAKA,EAA1B,CAAf;aAES9D,GAAT,CAAc,CAAd,EAAiB6B,QAAjB;eAEW7B,GAAX,CAAgB,CAAhB,EAAmB70B,KAAKsR,GAAL,CAAU6kB,SAAS7pB,CAAT,GAAa4pB,WAAW5pB,CAAlC,EAAqChK,MAAM0uB,SAA3C,CAAnB;aAEUoF,WAAW9pB,CAArB;eAEWqZ,IAAX,CAAiBwQ,QAAjB;;WAIQ+C,uBAAT,CAAkC5rB,KAAlC,EAA0C;QAEpChL,MAAMyuB,UAAX,EAAwBkI,qBAAsB3rB,KAAtB;QAEnBhL,MAAM6uB,SAAX,EAAuB6H,mBAAoB1rB,KAApB;;WAIf6rB,0BAAT,CAAqC7rB,KAArC,EAA6C;QAEvChL,MAAMyuB,UAAX,EAAwBkI,qBAAsB3rB,KAAtB;QAEnBhL,MAAM2uB,YAAX,EAA0B8H,sBAAuBzrB,KAAvB;;WAclB+nB,aAAT,CAAwB/nB,KAAxB,EAAgC;QAE1BhL,MAAM4tB,OAAN,KAAkB,KAAvB,EAA+B;YAEtB5iB,MAAM8rB,WAAf;WAEM,OAAL;WACK,KAAL;oBACc9rB,KAAb;;;;WASMkoB,aAAT,CAAwBloB,KAAxB,EAAgC;QAE1BhL,MAAM4tB,OAAN,KAAkB,KAAvB,EAA+B;YAEtB5iB,MAAM8rB,WAAf;WAEM,OAAL;WACK,KAAL;oBACc9rB,KAAb;;;;WASMmoB,WAAT,CAAsBnoB,KAAtB,EAA8B;YAEpBA,MAAM8rB,WAAf;WAEM,OAAL;WACK,KAAL;kBACY9rB,KAAX;;;;WASMqF,WAAT,CAAsBrF,KAAtB,EAA8B;UAGvB8F,cAAN;UAKM5J,UAAN,CAAiB0X,KAAjB,GAAyB5e,MAAMkH,UAAN,CAAiB0X,KAAjB,EAAzB,GAAoDliB,OAAOkiB,KAAP,EAApD;QAEImY,WAAJ;YAES/rB,MAAMoT,MAAf;WAEM,CAAL;sBAEepe,MAAMuvB,YAAN,CAAmBJ,IAAjC;;WAGI,CAAL;sBAEenvB,MAAMuvB,YAAN,CAAmBE,MAAjC;;WAGI,CAAL;sBAEezvB,MAAMuvB,YAAN,CAAmBF,KAAjC;;;sBAKc,CAAE,CAAhB;;YAIO0H,WAAT;WAEMzJ,MAAMoC,KAAX;YAEM1vB,MAAMyuB,UAAN,KAAqB,KAA1B,EAAkC;6BAEZzjB,KAAtB;gBAEQ+lB,MAAMrB,KAAd;;WAIIpC,MAAMkC,MAAX;YAEMxkB,MAAMR,OAAN,IAAiBQ,MAAML,OAAvB,IAAkCK,MAAMN,QAA7C,EAAwD;cAElD1K,MAAM6uB,SAAN,KAAoB,KAAzB,EAAiC;6BAEb7jB,KAApB;kBAEQ+lB,MAAMpB,GAAd;SAND,MAQO;cAED3vB,MAAM2uB,YAAN,KAAuB,KAA5B,EAAoC;gCAEb3jB,KAAvB;kBAEQ+lB,MAAMvB,MAAd;;;WAMGlC,MAAMqC,GAAX;YAEM3kB,MAAMR,OAAN,IAAiBQ,MAAML,OAAvB,IAAkCK,MAAMN,QAA7C,EAAwD;cAElD1K,MAAM2uB,YAAN,KAAuB,KAA5B,EAAoC;gCAEb3jB,KAAvB;kBAEQ+lB,MAAMvB,MAAd;SAND,MAQO;cAEDxvB,MAAM6uB,SAAN,KAAoB,KAAzB,EAAiC;6BAEb7jB,KAApB;kBAEQ+lB,MAAMpB,GAAd;;;;gBAQOoB,MAAMC,IAAd;;QAIGY,UAAUb,MAAMC,IAArB,EAA4B;YAErB9pB,UAAN,CAAiB+rB,aAAjB,CAA+B9nB,gBAA/B,CAAiD,aAAjD,EAAgE+nB,aAAhE;YACMhsB,UAAN,CAAiB+rB,aAAjB,CAA+B9nB,gBAA/B,CAAiD,WAAjD,EAA8DgoB,WAA9D;YAEMpoB,aAAN,CAAqBqoB,UAArB;;;WAMO4D,WAAT,CAAsBhsB,KAAtB,EAA8B;QAExBhL,MAAM4tB,OAAN,KAAkB,KAAvB,EAA+B;UAEzB9c,cAAN;YAES8gB,KAAT;WAEMb,MAAMvB,MAAX;YAEMxvB,MAAM2uB,YAAN,KAAuB,KAA5B,EAAoC;8BAEb3jB,KAAvB;;WAII+lB,MAAMrB,KAAX;YAEM1vB,MAAMyuB,UAAN,KAAqB,KAA1B,EAAkC;6BAEZzjB,KAAtB;;WAII+lB,MAAMpB,GAAX;YAEM3vB,MAAM6uB,SAAN,KAAoB,KAAzB,EAAiC;2BAEb7jB,KAApB;;;;WAQMoF,SAAT,CAAoBpF,KAApB,EAA4B;UAErB9D,UAAN,CAAiB+rB,aAAjB,CAA+B3nB,mBAA/B,CAAoD,aAApD,EAAmE4nB,aAAnE;UACMhsB,UAAN,CAAiB+rB,aAAjB,CAA+B3nB,mBAA/B,CAAoD,WAApD,EAAiE6nB,WAAjE;QAEKnzB,MAAM4tB,OAAN,KAAkB,KAAvB,EAA+B;UAIzB7iB,aAAN,CAAqBsoB,QAArB;YAEQtC,MAAMC,IAAd;;WAIQgC,YAAT,CAAuBhoB,KAAvB,EAA+B;QAEzBhL,MAAM4tB,OAAN,KAAkB,KAAlB,IAA2B5tB,MAAMyuB,UAAN,KAAqB,KAAhD,IAA2DmD,UAAUb,MAAMC,IAAhB,IAAwBY,UAAUb,MAAMvB,MAAxG,EAAmH;UAE7G1e,cAAN;UACMiM,eAAN;UAEMhS,aAAN,CAAqBqoB,UAArB;qBAEkBpoB,KAAlB;UAEMD,aAAN,CAAqBsoB,QAArB;;WAIQ5C,SAAT,CAAoBzlB,KAApB,EAA4B;QAEtBhL,MAAM4tB,OAAN,KAAkB,KAAlB,IAA2B5tB,MAAM6uB,SAAN,KAAoB,KAApD,EAA4D;kBAE7C7jB,KAAf;;WAIQ6F,YAAT,CAAuB7F,KAAvB,EAA+B;QAEzBhL,MAAM4tB,OAAN,KAAkB,KAAvB,EAA+B;UAEzB9c,cAAN,GAJ8B;YAMrB9F,MAAMiG,OAAN,CAAc5S,MAAvB;WAEM,CAAL;gBAEU2B,MAAMiR,OAAN,CAAc2e,GAAvB;eAEMnC,MAAM+B,MAAX;gBAEMxvB,MAAM2uB,YAAN,KAAuB,KAA5B,EAAoC;mCAEZ3jB,KAAxB;oBAEQ+lB,MAAMkG,YAAd;;eAIIxJ,MAAMkC,GAAX;gBAEM3vB,MAAM6uB,SAAN,KAAoB,KAAzB,EAAiC;gCAEZ7jB,KAArB;oBAEQ+lB,MAAMmG,SAAd;;;oBAMQnG,MAAMC,IAAd;;;WAME,CAAL;gBAEUhxB,MAAMiR,OAAN,CAAc4e,GAAvB;eAEMpC,MAAMqC,SAAX;gBAEM9vB,MAAMyuB,UAAN,KAAqB,KAArB,IAA8BzuB,MAAM6uB,SAAN,KAAoB,KAAvD,EAA+D;qCAErC7jB,KAA1B;oBAEQ+lB,MAAMoG,eAAd;;eAII1J,MAAM2J,YAAX;gBAEMp3B,MAAMyuB,UAAN,KAAqB,KAArB,IAA8BzuB,MAAM2uB,YAAN,KAAuB,KAA1D,EAAkE;wCAErC3jB,KAA7B;oBAEQ+lB,MAAMsG,kBAAd;;;oBAMQtG,MAAMC,IAAd;;;;gBAQMD,MAAMC,IAAd;;QAIGY,UAAUb,MAAMC,IAArB,EAA4B;YAErBjmB,aAAN,CAAqBqoB,UAArB;;;WAMOliB,WAAT,CAAsBlG,KAAtB,EAA8B;QAExBhL,MAAM4tB,OAAN,KAAkB,KAAvB,EAA+B;UAEzB9c,cAAN,GAJ6B;UAKvBiM,eAAN;YAES6U,KAAT;WAEMb,MAAMkG,YAAX;YAEMj3B,MAAM2uB,YAAN,KAAuB,KAA5B,EAAoC;8BAEb3jB,KAAvB;cAEM8lB,MAAN;;WAIIC,MAAMmG,SAAX;YAEMl3B,MAAM6uB,SAAN,KAAoB,KAAzB,EAAiC;2BAEb7jB,KAApB;cAEM8lB,MAAN;;WAIIC,MAAMoG,eAAX;YAEMn3B,MAAMyuB,UAAN,KAAqB,KAArB,IAA8BzuB,MAAM6uB,SAAN,KAAoB,KAAvD,EAA+D;gCAEtC7jB,KAAzB;cAEM8lB,MAAN;;WAIIC,MAAMsG,kBAAX;YAEMr3B,MAAMyuB,UAAN,KAAqB,KAArB,IAA8BzuB,MAAM2uB,YAAN,KAAuB,KAA1D,EAAkE;mCAEtC3jB,KAA5B;cAEM8lB,MAAN;;;gBAMQC,MAAMC,IAAd;;;WAMM7f,UAAT,CAAqBnG,KAArB,EAA6B;QAEvBhL,MAAM4tB,OAAN,KAAkB,KAAvB,EAA+B;UAIzB7iB,aAAN,CAAqBsoB,QAArB;YAEQtC,MAAMC,IAAd;;WAIQ8B,aAAT,CAAwB9nB,KAAxB,EAAgC;QAE1BhL,MAAM4tB,OAAN,KAAkB,KAAvB,EAA+B;UAEzB9c,cAAN;;QAMK5J,UAAN,CAAiBiE,gBAAjB,CAAmC,aAAnC,EAAkD2nB,aAAlD;QAEM5rB,UAAN,CAAiBiE,gBAAjB,CAAmC,aAAnC,EAAkD4nB,aAAlD;QACM7rB,UAAN,CAAiBiE,gBAAjB,CAAmC,OAAnC,EAA4C6nB,YAA5C;QAEM9rB,UAAN,CAAiBiE,gBAAjB,CAAmC,YAAnC,EAAiD0F,YAAjD;QACM3J,UAAN,CAAiBiE,gBAAjB,CAAmC,UAAnC,EAA+CgG,UAA/C;QACMjK,UAAN,CAAiBiE,gBAAjB,CAAmC,WAAnC,EAAgD+F,WAAhD;OAIK4f,MAAL;CAxqCD;AAwrCA,IAAIwG,cAAc,SAAdA,WAAc,CAAWtyB,MAAX,EAAmBkC,UAAnB,EAAgC;gBAEnClI,IAAd,CAAoB,IAApB,EAA0BgG,MAA1B,EAAkCkC,UAAlC;OAEK6nB,kBAAL,GAA0B,KAA1B,CAJiD;OAM5CQ,YAAL,CAAkBJ,IAAlB,GAAyB7B,MAAMqC,GAA/B;OACKJ,YAAL,CAAkBF,KAAlB,GAA0B/B,MAAMkC,MAAhC;OAEKve,OAAL,CAAa2e,GAAb,GAAmBnC,MAAMkC,GAAzB;OACK1e,OAAL,CAAa4e,GAAb,GAAmBpC,MAAM2J,YAAzB;CAVD;AAkBA,IAAIG,wBAAwB,SAAxBA,qBAAwB,GAAY;gBAEzB/4B,SAAd,GAA0Ba,OAAOuG,MAAP,CAAeib,QAAML,KAAN,CAAY6M,eAAZ,CAA4B7uB,SAA3C,CAA1B;gBACcA,SAAd,CAAwB6C,WAAxB,GAAsC+rB,aAAtC;cAEY5uB,SAAZ,GAAwBa,OAAOuG,MAAP,CAAeib,QAAML,KAAN,CAAY6M,eAAZ,CAA4B7uB,SAA3C,CAAxB;cACYA,SAAZ,CAAsB6C,WAAtB,GAAoCi2B,WAApC;CAND;;AC7tCA;;;;;;;;;;;;;;;;AAiBA,AASA,SAASE,SAAT,GAAqB;QAEb/Q,UAAUgR,aAAjB;;AAcD,SAASlF,KAAT,CAAc/a,IAAd,EAAoB5T,KAApB,EAA2B8zB,WAA3B,EAAyC;KAEnC,CAACF,WAAN,EAAoB;;;;SAMZ5zB,MAAMpG,QAAN,EAAR;KAEKk6B,gBAAgB32B,SAArB,EAAiC;gBAElB,IAAI42B,IAAJ,EAAd,CAFgC;cAGpBC,OAAZ,CAAqBF,YAAYG,OAAZ,KAAwB,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,GAAnE,EAHgC;;UAMxBC,MAAT,GAAkBtgB,OAAO,GAAP,GAAa5T,KAAb,IAAyB,OAAOqd,QAAP,IAAmB,WAArB,GAAqC,EAArC,GAA0CA,QAAjE,IAA8E,YAA9E,GAA6FyW,YAAYK,WAAZ,EAA/G;KACKn7B,SAASk7B,MAAT,KAAoB,EAAzB,EACCpX,QAAQC,KAAR,CAAe,0BAAf;;AASF,SAASqX,SAAT,CAAoBxgB,IAApB,EAA0BxS,MAA1B,EAAmC;OAE7BwS,IAAL,EAAWU,KAAKe,SAAL,CAAgBjU,MAAhB,CAAX;;AAYD,SAASD,KAAT,CAAcyS,IAAd,EAAoBygB,YAApB,EAAmC;KAE7B,CAACT,WAAN,EAAoB;;;;KAOhBU,UAAUt7B,SAASk7B,MAAT,CAAgBh2B,KAAhB,CAAuB,YAAY0V,IAAZ,GAAmB,eAA1C,CAAd;KAEK0gB,OAAL,EACC,OAASC,SAAUD,QAAQ,CAAR,CAAV,CAAT;KACI,OAAOD,YAAP,IAAuB,WAA5B,EACC,OAAO,EAAP;QACMA,YAAP;;AAUD,SAASG,SAAT,CAAoB5gB,IAApB,EAA0B3J,OAA1B,EAAmCwqB,cAAnC,EAAoD;KAG/CC,aAAJ,GAAoBF,SAApB,CAA+B5gB,IAA/B,EAAqC3J,OAArC,EAA8C0qB,WAAY/gB,IAAZ,EAAkB6gB,cAAlB,CAA9C;;AAUD,SAASE,UAAT,CAAqB/gB,IAArB,EAA2BghB,aAA3B,EAA2C;QAEnCtgB,KAAKC,KAAL,CAAYpT,MAAKyS,IAAL,EAAWU,KAAKe,SAAL,CAAgBuf,aAAhB,CAAX,CAAZ,CAAP;;AAQD,AAeA,SAASC,oBAAT,GAAgC;SAEvB9X,KAAR,CAAe,+BAA+B8F,UAAUgR,aAAxD;;AAQD,SAASa,aAAT,CAAwB9gB,IAAxB,EAA+B;MAOzBzS,GAAL,GAAW,UAAWkzB,YAAX,EAA0B;SAE7BA,YAAP;EAFD;MASK1F,GAAL,GAAW,YAAY,EAAvB;MAUK6F,SAAL,GAAiB,UAAW5gB,IAAX,EAAiB3J,OAAjB,EAA0BwqB,cAA1B,EAA2C;MAGtD,CAACA,cAAN,EACC,OAJ0D;SAKpDl5B,IAAP,CAAak5B,cAAb,EAA8B55B,OAA9B,CAAuC,UAAWa,GAAX,EAAiB;OAKnDo5B,SAASL,eAAe/4B,GAAf,CAAb;OACOo5B,WAAW33B,SAAb,IAA8B,OAAO23B,MAAP,KAAkB,UAArD,EACC7qB,QAAQvO,GAAR,IAAe4Y,KAAKC,KAAL,CAAYD,KAAKe,SAAL,CAAgByf,MAAhB,CAAZ,CAAf;GAPF;EALD;MAuBKH,UAAL,GAAkB,UAAW/gB,IAAX,EAAiBghB,aAAjB,EAAgC;SAE1CtgB,KAAKC,KAAL,CAAYD,KAAKe,SAAL,CAAgBuf,aAAhB,CAAZ,CAAP;EAFD;MASKR,SAAL,GAAiB,YAAY,EAA7B;MAIKW,MAAL,GAAc,UAAWV,YAAX,EAA0B;SAEhCA,YAAP;EAFD;;;AC1NA;;;;;;;;;;;;;AAaD,AACA,IAAIH,SAAS;OAEPc,KAFO;aAGDZ,SAHC;OAIPa,KAJO;aAKDT,SALC;cAMAG,UANA;iBAOGD;CAPhB;;ACdA;;;;;;;;;;;;;AAkBA,AAAO,SAAShX,eAAT,GAA2B;WAGxBwX,UAAT,GAAsB;QAEhB,CAACrS,SAAN,EAAkB;cAET9F,KAAR,CAAe,gCAAf;aACO,EAAP;;QAKE8F,UAAUsS,SAAV,KAAwBh4B,SAA1B,IACK,OAAO0lB,UAAUsS,SAAjB,KAA+B,SADpC;OAEKtS,UAAUsS,SAAV,CAAoB16B,MAApB,GAA6B,CAHnC,EAKC,OAAOooB,UAAUsS,SAAV,CAAoB,CAApB,CAAP,CAdoB;QAiBhBtS,UAAUuS,QAAf,EAA0B;aAElBvS,UAAUuS,QAAjB;KAFD,MAIO,IAAKvS,UAAUwS,eAAf,EAAiC;aAEhCxS,UAAUwS,eAAjB;KAFM,MAIA,IAAKxS,UAAUyS,cAAf,EAAgC;aAE/BzS,UAAUyS,cAAjB;KAFM,MAIA,IAAKzS,UAAU0S,YAAf,EAA8B;aAE7B1S,UAAU0S,YAAjB;;YAIOxY,KAAR,CAAe,qBAAf;WACO,EAAP;;SAIMmY,aAAaM,WAAb,GAA2Bt3B,KAA3B,CAAkC,wBAAlC,EAA6D,CAA7D,CAAP;;;AC7DD;;;;;;;;;;;;;;AAgBA,AAkBA,SAASu3B,wBAAT,CAAmC7Y,KAAnC,EAA0C8Y,QAA1C,EAAoDC,MAApD,EAA4D1rB,OAA5D,EAAsE;KAEjE2rB,aAAa,KAAjB;KAAwBC,UAAxB;KAAoCC,YAApC;SAEQF,UAAR,GAAqB3rB,QAAQ2rB,UAAR,IAAsB,EAA3C;KACK3rB,QAAQ4rB,UAAb,EAA0BA,aAAa5rB,QAAQ4rB,UAArB;KACrB5rB,QAAQ6rB,YAAb,EAA4BA,eAAe7rB,QAAQ6rB,YAAvB;UACnBC,OAAT,CAAkBL,SAASpyB,UAAT,CAAoBqF,KAAtC,EAA6C+sB,SAASpyB,UAAT,CAAoBuF,MAAjE;KAEI9P,KAAJ;MAKKi9B,YAAL,GAAoB,YAAY;SAASJ,UAAP;EAAlC;MAIKK,eAAL,GAAuB,UAAWC,aAAX,EAA2B;iBAAiBA,aAAf;EAApD;MAKKC,aAAL,GAAqB,YAAsB;MAAXC,EAAW,uEAAR,KAAQ;MAEpCjP,OAAO,IAAIvK,MAAMkN,OAAV,EAAb;WACSuM,OAAT,CAAkBlP,IAAlB;eACaiP,EAAb;MACKR,UAAL,EAAkB;OAEZ78B,UAAUoE,SAAf,EAA2B;aAGjB44B,OAAT,CAAkBh9B,MAAMu9B,YAAN,CAAmBpwB,CAArC,EAAwCnN,MAAMu9B,YAAN,CAAmBlwB,CAA3D;aACS9C,UAAT,CAAoBvK,KAApB,CAA0BqM,QAA1B,GAAqCrM,MAAMqM,QAA3C;aACS9B,UAAT,CAAoBvK,KAApB,CAA0BsM,IAA1B,GAAiCtM,MAAMsM,IAAvC;aACS/B,UAAT,CAAoBvK,KAApB,CAA0BwM,GAA1B,GAAgCxM,MAAMwM,GAAtC;aACSjC,UAAT,CAAoBvK,KAApB,CAA0B4P,KAA1B,GAAkC5P,MAAM4P,KAAxC;aACSrF,UAAT,CAAoBvK,KAApB,CAA0B8P,MAA1B,GAAmC9P,MAAM8P,MAAzC;;GAVF,MAcO;OAED9P,UAAUoE,SAAf,EAA2B;YAElB;mBAEO,IAAIyf,MAAMkN,OAAV,EAFP;eAGG4L,SAASpyB,UAAT,CAAoBvK,KAApB,CAA0BqM,QAH7B;WAIDswB,SAASpyB,UAAT,CAAoBvK,KAApB,CAA0BsM,IAJzB;UAKFqwB,SAASpyB,UAAT,CAAoBvK,KAApB,CAA0BwM,GALxB;YAMAmwB,SAASpyB,UAAT,CAAoBvK,KAApB,CAA0B4P,KAN1B;aAOC+sB,SAASpyB,UAAT,CAAoBvK,KAApB,CAA0B8P;KAPnC;aAUSwtB,OAAT,CAAkBt9B,MAAMu9B,YAAxB;;YAIQP,OAAT,CAAkBj9B,OAAO4Y,UAAzB,EAAqC5Y,OAAO6Y,WAA5C;YACSrO,UAAT,CAAoBvK,KAApB,CAA0BqM,QAA1B,GAAqC,OAArC;YACS9B,UAAT,CAAoBvK,KAApB,CAA0BsM,IAA1B,GAAiC,CAAjC;YACS/B,UAAT,CAAoBvK,KAApB,CAA0BwM,GAA1B,GAAgC,CAAhC;YACSjC,UAAT,CAAoBvK,KAApB,CAA0B4P,KAA1B,GAAkC,MAAlC;YACSrF,UAAT,CAAoBvK,KAApB,CAA0B8P,MAA1B,GAAmC,MAAnC;;MAIIoB,QAAQ2rB,UAAR,CAAmBW,kBAAnB,KAA0Cp5B,SAA/C,EAA2D8M,QAAQ2rB,UAAR,CAAmBW,kBAAnB,CAAuCX,UAAvC;SAEpDY,MAAP,GAAgBrP,KAAKjhB,CAAL,GAASihB,KAAK/gB,CAA9B;SACO4mB,sBAAP;eACa,CAAC4I,UAAd;MACKC,cAAcA,WAAWY,mBAA9B,EAAoDZ,WAAWY,mBAAX,CAAgCb,UAAhC;2BAC3Bc,eAAzB,CAA0ChB,QAA1C,EAAoDzrB,QAAQ4rB,UAA5D;EApDD;MA2DK5Z,OAAL,GAAe,YAAY;MAGvB6Z,iBAAiB34B,SAAnB,IACKgB,SAAU23B,aAAazY,QAAb,CAAsBsZ,gBAAhC,MAAuDC,aAAaC,uBAAb,CAAqCC,IAFlG,EAGE;gBAEYzZ,QAAb,CAAsBsZ,gBAAtB,GAAyCC,aAAaC,uBAAb,CAAqCC,IAA9E;;OAIIX,aAAL,CAAoBP,UAApB;SACOA,UAAP;EAZD;;AAsBDH,yBAAyBiB,eAAzB,GAA2C,UAAWhB,QAAX,EAAqBG,UAArB,EAAiC;KAEtEH,SAASqB,UAAd,EACC;UAEQA,UAAT,GAAsBrB,SAASK,OAA/B;UACSA,OAAT,GAAmB,UAAWptB,KAAX,EAAkBE,MAAlB,EAA0BmuB,WAA1B,EAAwC;WAEjDD,UAAT,CAAqBpuB,KAArB,EAA4BE,MAA5B,EAAoCmuB,WAApC;MACMC,WAAWvB,SAASpyB,UAA1B;MAAsC4zB,cAAcD,SAASjgB,aAA7D;aAEY,YAAY;eAEXje,KAAZ,CAAkB8P,MAAlB,GAA2BouB,SAASl+B,KAAT,CAAe8P,MAA1C;eACY9P,KAAZ,CAAkB4P,KAAlB,GAA0BsuB,SAASl+B,KAAT,CAAe4P,KAAzC;eACY5P,KAAZ,CAAkBsM,IAAlB,GAAyB4xB,SAASl+B,KAAT,CAAesM,IAAxC;eACYtM,KAAZ,CAAkBwM,GAAlB,GAAwB0xB,SAASl+B,KAAT,CAAewM,GAAvC;eACYxM,KAAZ,CAAkBqM,QAAlB,GAA6B6xB,SAASl+B,KAAT,CAAeqM,QAA5C;OACKywB,UAAL,EAAkBA,WAAWE,OAAX,CAAoBptB,KAApB,EAA2BE,MAA3B;GAPnB,EASG,CATH;EALD;CAND;;AC1IA;;;;;;;;;;;;;;;AAiBA,AAqDO,SAASsuB,UAAT,CAAqBzpB,IAArB,EAA2BtI,QAA3B,EAAoD;KAAf6E,OAAe,uEAAL,EAAK;KAEpD2S,QAAQK,QAAML,KAApB;YAEWxX,YAAY,IAAIwX,MAAMmC,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAvB;KAEMqY,SAAS,IAAIxa,MAAMya,MAAV,CAAkB,IAAIza,MAAM0a,cAAV,CAA0B;OAErD,IAAI1a,MAAM2a,OAAV,EAFqD;mBAGzCttB,QAAQutB,eAAR,KAA4Br6B,SAA5B,GAAwC8M,QAAQutB,eAAhD,GAChB,KAJyD;EAA1B,CAAlB,CAAf;KAOMzX,SAAS/mB,SAASC,aAAT,CAAwB,QAAxB,CAAf;QACOw+B,QAAP,CAAgBttB,GAAhB,CAAoButB,SAApB,GAAgC9a,MAAM+a,YAAtC;KACMjX,WAAW,EAAjB;KACMkX,UAAU7X,OAAOE,UAAP,CAAmB,IAAnB,CAAhB;KAEKhW,QAAQ2J,IAAb,EAAoBwjB,OAAOxjB,IAAP,GAAc3J,QAAQ2J,IAAtB;QAEbikB,QAAP,CAAgB3K,MAAhB,GAAyB,6BAA+B;MAEjD4K,gBAAgB,EAAtB;MACKV,OAAO11B,MAAZ,EACCq2B,cAAeX,OAAO11B,MAAtB,EAA8Bo2B,aAA9B,EADD,KAEK,IAAK7tB,QAAQ+tB,KAAb,EACJD,cAAe9tB,QAAQ+tB,KAAvB,EAA8BF,aAA9B;MACGG,aAAahuB,QAAQguB,UAAR,IAAsBH,cAAcG,UAApC,IAAkD,IAAnE;MACM/G,MAAMjnB,QAAQinB,GAAR,IAAe4G,cAAc5G,GAAzC;MACCsG,kBAAkBvtB,QAAQutB,eAAR,IAA2BM,cAAcN,eAAzC,IAA4D,KAD/E;MAEC7X,WAAW1V,QAAQ0V,QAAR,IAAoBmY,cAAcnY,QAAlC,IAA8C,CAF1D;MAGCuY,WAAWjuB,QAAQiuB,QAAR,IAAoBJ,cAAcI,QAAlC,IAA8C,OAH1D;MAICC,OAAOluB,QAAQkuB,IAAR,IAAgBL,cAAcK,IAA9B,IAAsC,KAJ9C;MAKCC,SAASnuB,QAAQmuB,MAAR,IAAkBN,cAAcM,MAAhC,IAA0C,KALpD;MAMCC,iBAAiBpuB,QAAQouB,cAAR,IAA0BP,cAAcO,cAAxC,IAA0D,EAN5E;MAOCpQ,OAAOhe,QAAQge,IAAR,IAAgB6P,cAAc7P,IAA9B,IAAsC,EAP9C;MAQC1uB,QAAQ,wBART;MASC++B,YAAYruB,QAAQquB,SAAR,IAAqBR,cAAcQ,SAAnC,IAAgD/+B,KAT7D;MAUCg/B,SAASpB,WAAWqB,SAAX,CAAsBvuB,QAAQsuB,MAAR,IAAkBT,cAAcS,MAAtD,EAA8DnzB,QAA9D,CAVV;MAYK8rB,QAAQ/zB,SAAb,EACC86B,aAAa/G,MAAM+G,UAAN,GAAmB,EAAhC;OAEIQ,WAAL,GAAmBxQ,KAAKwQ,WAAL,IAAoB,KAAvC;MACMC,kBAAkBzQ,KAAKyQ,eAAL,GAAuBzQ,KAAKyQ,eAA5B,GAA8C,CAAtE;MACCC,YAAUN,cAAV,IAA2BF,OAAO,OAAP,GAAiB,EAA5C,KAAiDC,SAAS,SAAT,GAAqB,EAAtE,IAA2E1X,QAA3E,WAAyFwX,QAD1F;UAGQS,IAAR,GAAeA,IAAf;MAEIhwB,QAAQ,CAAZ;MAAeiwB,aAAa,CAA5B;MACCC,KADD;MAEK,OAAOnrB,IAAP,KAAgB,QAArB,EAAgC;gBAElB,CAAb;WACQA,KAAK5F,KAAL,CAAY,YAAZ,CAAR;SACMjN,OAAN,CAAe,UAAWi+B,IAAX,EAAkB;QAE5BC,YAAYnB,QAAQoB,WAAR,CAAqBF,IAArB,EAA4BnwB,KAA5C;QACKA,QAAQowB,SAAb,EACCpwB,QAAQowB,SAAR;kBACa,CAAd;IALD;GAJD,MAaOpwB,QAAQivB,QAAQoB,WAAR,CAAqBtrB,IAArB,EAA4B/E,KAApC;WAEE+vB,kBAAkB,CAA3B;MAEMO,YAAYtwB,KAAlB;SACOA,KAAP,GAAeswB,SAAf;SACOpwB,MAAP,GAAgB6X,WAAWkY,UAAX,GAAwBF,kBAAkB,CAA1D;UAEQC,IAAR,GAAeA,IAAf;MAIK1Q,KAAKwQ,WAAV,EAAwB;OAWdS,SAXc,GAWvB,SAASA,SAAT,CAAoBlR,GAApB,EAAyB9hB,CAAzB,EAA4BE,CAA5B,EAA+BoV,CAA/B,EAAkCrhB,CAAlC,EAAqCN,CAArC,EAAyC;QAEpCs/B,SAAJ;QACIC,MAAJ,CAAYlzB,IAAIrM,CAAhB,EAAmBuM,CAAnB;QACIizB,MAAJ,CAAYnzB,IAAIsV,CAAJ,GAAQ3hB,CAApB,EAAuBuM,CAAvB;QACIkzB,gBAAJ,CAAsBpzB,IAAIsV,CAA1B,EAA6BpV,CAA7B,EAAgCF,IAAIsV,CAApC,EAAuCpV,IAAIvM,CAA3C;QACIw/B,MAAJ,CAAYnzB,IAAIsV,CAAhB,EAAmBpV,IAAIjM,CAAJ,GAAQN,CAA3B;QACIy/B,gBAAJ,CAAsBpzB,IAAIsV,CAA1B,EAA6BpV,IAAIjM,CAAjC,EAAoC+L,IAAIsV,CAAJ,GAAQ3hB,CAA5C,EAA+CuM,IAAIjM,CAAnD;QACIk/B,MAAJ,CAAYnzB,IAAIrM,CAAhB,EAAmBuM,IAAIjM,CAAvB;QACIm/B,gBAAJ,CAAsBpzB,CAAtB,EAAyBE,IAAIjM,CAA7B,EAAgC+L,CAAhC,EAAmCE,IAAIjM,CAAJ,GAAQN,CAA3C;QACIw/B,MAAJ,CAAYnzB,CAAZ,EAAeE,IAAIvM,CAAnB;QACIy/B,gBAAJ,CAAsBpzB,CAAtB,EAAyBE,CAAzB,EAA4BF,IAAIrM,CAAhC,EAAmCuM,CAAnC;QACImzB,SAAJ;QACIvS,IAAJ;QACIwS,MAAJ;IAzBsB;WAGfC,SAAR,GAAoBxR,KAAKyR,eAAL,GAAuBzR,KAAKyR,eAA5B,GAA8C,kBAAlE;WAGQC,WAAR,GAAsB1R,KAAK2R,WAAL,GAAmB3R,KAAK2R,WAAxB,GAAsCtB,SAA5D;WAEQS,SAAR,GAAoBL,eAApB;aAoBWd,OAAX,EACCc,kBAAkB,CADnB,EAECA,kBAAkB,CAFnB,EAGC3Y,OAAOpX,KAAP,GAAe+vB,eAHhB,EAIC3Y,OAAOlX,MAAP,GAAgB6vB,eAJjB,EAKCzQ,KAAK4R,YAAL,KAAsB18B,SAAtB,GAAkC,CAAlC,GAAsC8qB,KAAK4R,YAL5C;;UAUOJ,SAAR,GAAoBnB,SAApB;UACQwB,YAAR,GAAuB,QAAvB;MACKlB,aAAa,CAAlB,EAAsB;QACf,IAAI38B,IAAI,CAAd,EAAiBA,IAAI48B,MAAMp+B,MAA3B,EAAmCwB,GAAnC,EAAyC;QAElC68B,OAAOD,MAAM58B,CAAN,CAAb;YACQ89B,QAAR,CAAkBjB,IAAlB,EAAwBJ,eAAxB,EAAyC3Y,OAAOlX,MAAP,GAAkB,CAAEgwB,MAAMp+B,MAAN,GAAewB,CAAf,GAAmB,CAArB,IAA2BykB,QAA7C,GAA0DgY,eAAnG;;GAJF,MAQOd,QAAQmC,QAAR,CAAkBrsB,IAAlB,EAAwBgrB,eAAxB,EAAyC3Y,OAAOlX,MAAP,GAAgB6vB,eAAzD;SAGAjB,QAAP,CAAgBttB,GAAhB,CAAoB6vB,KAApB,GAA4Bja,MAA5B;SACO0X,QAAP,CAAgBttB,GAAhB,CAAoB+nB,WAApB,GAAkC,IAAlC;MAEM+H,KAAKhC,aAAaW,UAAxB,CA9GuD;SA+GhDpZ,KAAP,CAAamP,GAAb,CAAkBsL,KAAKla,OAAOpX,KAAZ,GAAoBoX,OAAOlX,MAA7C,EAAqDoxB,EAArD;SACO70B,QAAP,CAAgBqa,IAAhB,CAAsBra,QAAtB;SACOmzB,MAAP,GAAgBA,MAAhB;SAIOd,QAAP,CAAgBD,eAAhB,GAAkCA,eAAlC;SAEOC,QAAP,CAAgB9X,QAAhB,GAA2BA,QAA3B;SACO8X,QAAP,CAAgBvF,WAAhB,GAA8B,IAA9B;EAxHD;QA2HO2F,QAAP,CAAgB3K,MAAhB;QAEO2K,QAAP,CAAgBqC,UAAhB,GAA6B,UAAWC,KAAX,EAAmB;SAExCA,KAAP;MACMlwB,UAAU,EAAhB;gBACemtB,OAAO11B,MAAtB,EAA8BuI,OAA9B;SACO4tB,QAAP,CAAgB3K,MAAhB,CAAwBjjB,OAAxB;EALD;KAQKA,QAAQ+tB,KAAb,EACC/tB,QAAQ+tB,KAAR,CAAc/hB,GAAd,CAAmBmhB,MAAnB;QAEMS,QAAP,CAAgBuC,iBAAhB,GAAoCnwB,OAApC;QAEOmtB,MAAP;;AAiBDD,WAAWqB,SAAX,GAAuB,YAAmC;KAAxBD,MAAwB,uEAAf,EAAe;KAAXnzB,QAAW;KAEnDwX,QAAQK,QAAML,KAApB;KACMmD,SAASwY,OAAOxY,MAAP,GAAgBwY,OAAOxY,MAAvB,GAAgC5iB,SAA/C;UAKSk9B,aAAT,GAAyB;MAElB1xB,QAAQoX,OAAOpX,KAArB;MAA4BE,SAASkX,OAAOlX,MAA5C;MACCyxB,YAAY3xB,QAAQ,CADrB;MACwB4xB,aAAa1xB,SAAS,CAD9C;MAGMsW,MAAM,IAAIvC,MAAMmC,OAAV,GAAoBU,IAApB,CAA0Bra,QAA1B,CAAZ;MACIo1B,OAAJ,CAAajC,OAAO5C,MAApB;MACIzvB,CAAJ,GAAUiZ,IAAIjZ,CAAJ,GAAQo0B,SAAV,GAAwBA,SAAhC;MACIl0B,CAAJ,GAAQ,EAAI+Y,IAAI/Y,CAAJ,GAAQm0B,UAAZ,IAA2BA,UAAnC;SACOpb,GAAP;;KAGKsb,YAAYlC,OAAOxY,MAAP,GAAgBsa,eAAhB,GAAkCl9B,SAApD;QACOo7B,kBAAkB3b,MAAMkN,OAAxB,IACF,QAAOyO,MAAP,yCAAOA,MAAP,OAAkB,QAApB,IAAoCA,OAAOryB,CAAP,KAAa/I,SAAjD,IAAkEo7B,OAAOnyB,CAAP,KAAajJ,SAD3E;GAEFo7B,MAFE,GAEOkC,YACZ,IAAI7d,MAAMkN,OAAV,CAAmB2Q,UAAUv0B,CAAV,GAAgB6Z,OAAOpX,KAAP,GAAe,CAA/B,GAAqC,CAArC,GAAyC,CAA5D,EAA+D8xB,UAAUr0B,CAAV,GAAgB2Z,OAAOlX,MAAP,GAAgB,CAAhC,GAAsC,CAAtC,GAA0C,CAAzG,CADY,GAEZ,IAAI+T,MAAMkN,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,CAJF,CArByD;CAA1D;AA6BA,SAASiO,aAAT,CAAwBC,KAAxB,EAA+B/tB,OAA/B,EAAyC;KAEnC+tB,MAAMH,QAAN,CAAeuC,iBAApB,EACC3+B,OAAOF,IAAP,CAAay8B,MAAMH,QAAN,CAAeuC,iBAA5B,EAAgDv/B,OAAhD,CAAyD,UAAWa,GAAX,EAAiB;MAEpEuO,QAAQvO,GAAR,MAAiByB,SAAtB;WACSzB,GAAR,IAAes8B,MAAMH,QAAN,CAAeuC,iBAAf,CAAiC1+B,GAAjC,CAAf;EAHF;QAMOs8B,MAAMt2B,MAAd,EAAuB;UAEds2B,MAAMt2B,MAAd;gBACes2B,KAAf,EAAsB/tB,OAAtB;;;AAqCFktB,WAAWuD,qBAAX,GAAmC,UAAU1C,KAAV,EAAkB;KAE9Cpb,QAAQK,QAAML,KAApB;OACM6I,QAAN,CAAe5qB,OAAf,CAAwB,UAAW8/B,UAAX,EAAwB;MAE1CA,sBAAsB/d,MAAMya,MAAjC,EAA0C;OAEpCsD,WAAW9C,QAAX,CAAoB3K,MAApB,KAA+B/vB,SAApC,EACCw9B,WAAW9C,QAAX,CAAoB3K,MAApB;GAL6C;aAQnCwN,qBAAX,CAAkCC,UAAlC;EARF;CAHD;;ACnUA;;;;;;;;;;;;;;;;;;;AAoBA,IAcM/D;AA6CL,sBAAalB,QAAb,EAAiD;SAA1BzrB,OAA0B,uEAAhB,IAAI2wB,OAAJ,EAAgB;;SAE3C,CAAClF,QAAN,EAAiB;kBAER3Y,KAAR,CAAe,8BAA8B2Y,QAA7C;;;SAQI,CAACzrB,QAAQ4wB,SAAd,EAA0B;oBAEf,IAAID,OAAJ,CAAa3wB,OAAb,CAAV;;SAOIA,QAAQ6rB,YAAR,KAAyB,KAA9B,EAAsC;SAElC7rB,QAAQ+S,GAAR,CAAYrH,GAAhB,EAAsB1L,QAAQ+S,GAAR,CAAY8d,UAAZ,GAAyB,KAAzB,CAvB0B;SA8B1Cle,QAAQK,QAAML,KAApB;;aAIQkZ,YAAR,GAAuB7rB,QAAQ6rB,YAAR,IAAwB,EAA/C;SAEMzY,WAAWpT,QAAQ6rB,YAAzB;UAIKzY,QAAL,GAAgBA,QAAhB;UAIKpT,OAAL,GAAeA,OAAf;aASQ6rB,YAAR,GAAuB,IAAvB;SAQKzY,SAASsZ,gBAAT,KAA8Bx5B,SAAnC,EAA+CkgB,SAASsZ,gBAAT,GAA4BE,wBAAwBC,IAApD,CA7DC;cA+DvCiE,MAAT,GAAkB,IAAIne,MAAMoe,YAAV,EAAlB;cACSD,MAAT,CAAgBvE,MAAhB,GAAyBnZ,SAAS4d,YAAT,IAAyB,CAAlD,CAhEgD;SAiE3C5d,SAAS6d,GAAT,KAAiB/9B,SAAtB,EACCkgB,SAAS6d,GAAT,GAAe,IAAIte,MAAMue,iBAAV,GAA8BngB,KAA7C;cACQA,KAAT,GAAiBqC,SAASsY,MAAT,KAAoBx4B,SAApB,GAAgC,IAAIyf,MAAMue,iBAAV,GAA8BngB,KAA9D,GAChB,IAAI4B,MAAMmC,OAAV,GAAoBqc,UAApB,CAAgC/d,SAASsY,MAAT,CAAgBvwB,QAAhD,CADD;cAESi2B,YAAT,GAAwB,CAAxB;cACSC,MAAT,GAAkBje,SAASie,MAAT,IAAqB,IAAI1e,MAAMoe,YAAV,GAAyBM,MAAzB,GAAkC,EAApC,GAA2Cje,SAAS6d,GAAzF;SACK7d,SAASsY,MAAT,KAAoBx4B,SAAzB,EACCkgB,SAASsY,MAAT,CAAgB3a,KAAhB,GAAwBqC,SAASrC,KAAjC;UAMIugB,gBAAL,GAAwB,UAAWD,MAAX,EAAoB;mBAElCP,MAAT,CAAgBO,MAAhB,GAAyBA,MAAzB;MAFD;UAMKC,gBAAL,CAAuBle,SAASie,MAAhC;UAYKE,eAAL,GAAuB,YAAY;iBAE3BZ,QAAQa,SAAR,CAAkBC,cAAlB,CAAiCF,eAAjC,CAAkD9F,QAAlD,EAA4DrY,SAAS6G,QAArE,CAAP;MAFD;SAgCIyX,kBAAJ;SACIC,mBAAJ;UAOKC,MAAL,GAAc,UAAWC,KAAX,EAAkBnG,MAAlB,EAA2B;cAElCgB,mBAAmBx4B,SAAUkf,SAASsZ,gBAAnB,CAAzB;cAEKtZ,SAAS0e,YAAT,IAAyB,CAACJ,kBAA/B,EAAoD;mBAE9CK,eAAeA,YAAYC,qBAAhC,EACCN,qBAAqBK,YAAYC,qBAAZ,CAAmC,IAAnC,CAArB,CADD,KAEKN,qBAAqB,IAAIlG,wBAAJ,CAA8B7Y,KAA9B,EAAqC8Y,QAArC,EAA+CC,MAA/C,EACzB;gCACaqG,WADb;kCAEe;gBAHU,CAArB;;gBASAE,iBAAN;cAEKvG,OAAOj0B,MAAP,KAAkB,IAAvB,EAA8Bi0B,OAAOuG,iBAAP;cAExB/U,OAAO,IAAIvK,MAAMkN,OAAV,EAAb;mBACSuM,OAAT,CAAkBlP,IAAlB;cAEKuO,SAASyG,SAAd,EAA0BzG,SAAS0G,KAAT;mBACjBC,cAAT,CAAyB,IAAzB;cAEIC,EAAJ,EAAQC,EAAR,EAAYC,MAAZ,EAAoBC,OAApB,EACCC,EADD,EACKC,EADL,EACSC,MADT,EACiBC,OADjB;cAEMC,WAAWzf,SAASge,YAA1B;mBAaS0B,YAAT,CAAuBjH,YAAvB,EAAsC;mBAEhC,CAAC6F,kBAAD,IAAyBC,wBAAwBjF,gBAAtD,EACC,OAAO,KAAP;qCACqBA,gBAAtB;mBACKb,aAAakH,6BAAlB,EAAkDlH,aAAakH,6BAAb,CAA4CrG,gBAA5C,EAAlD,KACK,IAAKb,aAAamH,mBAAlB,EAAwCnH,aAAamH,mBAAb,CAAkCtG,gBAAlC;sBACtC,IAAP;;mBAGQR,aAAT,CAAwBP,UAAxB,EAAoCE,YAApC,EAAmD;mBAE7CiH,aAAcjH,YAAd,CAAL,EACC6F,mBAAmBxF,aAAnB,CAAkCP,UAAlC;;kBAIOe,gBAAT;oBAEME,wBAAwBC,IAA7B;6BAEUoG,UAAT,CAAqB,CAArB,EAAwB,CAAxB,EAA2B/V,KAAKxe,KAAhC,EAAuCwe,KAAKte,MAA5C;6BACSs0B,WAAT,CAAsB,CAAtB,EAAyB,CAAzB,EAA4BhW,KAAKxe,KAAjC,EAAwCwe,KAAKte,MAA7C;6BACSgzB,MAAT,CAAiBC,KAAjB,EAAwBnG,MAAxB;6BACS0G,cAAT,CAAyB,KAAzB;iCAyBc,IAAd;;oBAOIxF,wBAAwBuG,GAA7B;wBAEOC,SAASlW,KAAKxe,KAAL,GAAa,CAA5B;yBAEK,IAAIm0B,QAAT,CAAmBP,KAAK,CAAL,CAAQC,SAASa,MAAT,CAAiBZ,UAAUtV,KAAKte,MAAf;yBACvCw0B,SAASP,QAAd,CAAwBH,KAAK,CAAL,CAAQC,SAASS,MAAT,CAAiBR,UAAU1V,KAAKte,MAAf;kCAElC,KAAf,EAAsB,IAAtB;;oBAIIguB,wBAAwByG,GAA7B;yBAEM,IAAIR,QAAT,CAAmBP,KAAK,CAAL,CAAQC,SAASrV,KAAKxe,KAAd,CAAqB8zB,UAAUtV,KAAKte,MAAL,GAAc,CAAxB;yBAC3C,IAAIi0B,QAAT,CAAmBH,KAAKxV,KAAKte,MAAL,GAAc,CAAnB,CAAsB+zB,SAASzV,KAAKxe,KAAd,CAAqBk0B,UAAU1V,KAAKte,MAAL,GAAc,CAAxB;kCAE/C,KAAf,EAAsB,IAAtB;;;4BAGgBkU,KAAR,CAAe,wEAAwE4Z,gBAAvF;;mBAIDoE,MAAT,CAAgB7N,MAAhB,CAAwByI,MAAxB;mBAESuH,UAAT,CAAqBZ,EAArB,EAAyBC,EAAzB,EAA6BC,MAA7B,EAAqCC,OAArC;mBACSU,WAAT,CAAsBb,EAAtB,EAA0BC,EAA1B,EAA8BC,MAA9B,EAAsCC,OAAtC;mBACSZ,MAAT,CAAiBC,KAAjB,EAAwBze,SAAS0d,MAAT,CAAgBwC,OAAxC;mBAESL,UAAT,CAAqBR,EAArB,EAAyBC,EAAzB,EAA6BC,MAA7B,EAAqCC,OAArC;mBACSM,WAAT,CAAsBT,EAAtB,EAA0BC,EAA1B,EAA8BC,MAA9B,EAAsCC,OAAtC;mBACShB,MAAT,CAAiBC,KAAjB,EAAwBze,SAAS0d,MAAT,CAAgByC,OAAxC;mBAESnB,cAAT,CAAyB,KAAzB;MAnID;cAwISoB,OAAT,CAAkB53B,MAAlB,EAA2B;mBAEjBA,UAAU,EAAnB;cACM63B,QAAQ;8BAEE,gBAFF;qCAIS,oBAJT;sCAKU,uCALV;kCAOM;4BACV7G,wBAAwBC,IADd;oCAEFD,wBAAwBuG,GAFtB;sCAGAvG,wBAAwByG,GAHxB;gBAPN;kCAaM,gBAbN;mCAcO,8CAdP;sBAgBN,OAhBM;2BAiBD,kBAjBC;iCAmBK,eAnBL;kCAoBM,yCApBN;8BAsBE,SAtBF;6BAuBC;WAvBf;cA2BM7f,gBAAgB5X,OAAO6X,eAAP,KAA2BvgB,SAA3B,GAAuC,IAAvC;YACnB0I,OAAO6X,eAAP,EADH;kBAESD,aAAT;oBAEM,IAAL;0BAEOkgB,aAAN,GAAsB,gBAAtB,CAFD;0BAIOC,oBAAN,GAA6B,aAA7B,CAJD;0BAKOC,qBAAN,GAA8B,iEAA9B;0BAEMC,iBAAN,GAA0B;iCACjBjH,wBAAwBC,IADP;0CAERD,wBAAwBuG,GAFhB;wCAGVvG,wBAAwByG,GAHd;qBAA1B;0BAMMS,iBAAN,GAA0B,cAA1B;0BACMC,kBAAN,GAA2B,2CAA3B;0BAEMhjB,KAAN,GAAc,OAAd;0BACMijB,UAAN,GAAmB,wBAAnB;0BAEMC,gBAAN,GAAyB,aAAzB;0BACMC,iBAAN,GAA0B,+CAA1B;0BAEMC,aAAN,GAAsB,cAAtB;0BACMC,YAAN,GAAqB,sDAArB;;;wBAIOx4B,OAAO2X,IAAP,KAAgBrgB,SAAlB,IAAmC0I,OAAO2X,IAAP,CAAYC,aAAZ,IAA6BA,aAArE,EACC;2BAEMliB,IAAP,CAAasK,OAAO2X,IAApB,EAA2B3iB,OAA3B,CAAoC,UAAWa,GAAX,EAAiB;6BAE/CgiC,MAAMhiC,GAAN,MAAeyB,SAApB,EACC;+BACKzB,GAAN,IAAamK,OAAO2X,IAAP,CAAY9hB,GAAZ,CAAb;qBAJD;;iBASKgiC,KAAP;;UAiBI/nB,GAAL,GAAW,YAA4B;cAAjB2oB,SAAiB,uEAAL,EAAK;cAUhC3oB,MAAM2oB,UAAUvnB,MAAV,IAAoB9M,QAAQ+S,GAAR,CAAYrH,GAA5C;cACK,CAACA,GAAD,IAAQ1L,QAAQ+S,GAAR,CAAYuhB,gBAAZ,KAAiC,KAA9C,EACC;cACKvhB,MAAMshB,UAAUthB,GAAV,IAAiBC,QAAMD,GAAnC,CAbsC;cAcjCshB,cAAcnhC,SAAnB,EAA+BmhC,YAAY,EAAZ;oBACrB9e,KAAV,GAAkB8e,UAAU9e,KAAV,IAAmB,CAArC;cAQMsW,eAAe7rB,QAAQ+S,GAAR,CAAYwhB,aAAZ,CAA2B,cAA3B,CAArB;cACCd,QAAQD,QAAS,EAAE/f,iBAAiBzT,QAAQyT,eAA3B,EAA4CF,MAAMvT,QAAQuT,IAA1D,EAAT,CADT;cAGMiX,iBAAiB;iCAGJpX,SAASsZ,gBAHL;uBAIZ,IAAI/Z,MAAMoe,YAAV,GAAyBM,MAAzB,GAAkC,EAApC,GAA2Cje,SAAS6d,GAJtC;sBAKf7d,SAASrC,KALM;6BAMR;WANf;iBASOyjB,MAAP,CAAehK,cAAf;kBACQzX,GAAR,CAAYkX,MAAZ,CAAmBM,SAAnB,CAA8BsB,YAA9B,EAA4CzY,QAA5C,EAAsDoX,cAAtD;mBACSkC,gBAAT,GAA4Bx4B,SAAUkf,SAASsZ,gBAAnB,CAA5B;cAEK,KAAKsG,mBAAV,EAAgC,KAAKA,mBAAL,CAA0B5f,SAASsZ,gBAAnC;mBAIvB+H,kBAAT,CAA6B1+B,KAA7B,EAAqC;mBAE9BsR,UAAUtR,SAAS62B,wBAAwBC,IAAjC,GAAwC,MAAxC,GAAiD,OAAjE;+BACgBxzB,UAAhB,CAA2BvK,KAA3B,CAAiCuY,OAAjC,GAA2CA,OAA3C;mBACKqtB,2BAA2BxhC,SAAhC,EACCwhC,uBAAuBpoB,IAAvB,CAA4Bxd,KAA5B,CAAkCuY,OAAlC,GAA4CA,OAA5C;mCACmBiF,IAApB,CAAyBxd,KAAzB,CAA+BuY,OAA/B,GAAyCA,OAAzC;uCACwBiF,IAAxB,CAA6Bxd,KAA7B,CAAmCuY,OAAnC,GAA6CA,OAA7C;;cAIKstB,kBAAkBjpB,IAAIgB,SAAJ,CAAe+mB,MAAMC,aAArB,CAAxB,CAtDsC;cAyDhCkB,8BAA8BD,gBAAgB3oB,GAAhB,CAAqBoH,QAArB,EAA+B,kBAA/B,EACnCqgB,MAAMI,iBAD6B,EACTr6B,QADS,CACC,UAAWzD,KAAX,EAAmB;uBAE9C7B,SAAU6B,KAAV,CAAR;kCACoBA,KAApB;yBACW81B,YAAX;mBACKwI,UAAUQ,YAAf,EACCR,UAAUQ,YAAV,CAAwB9+B,KAAxB;mBACI++B,oBAAL,EACCA,qBAAqBpkB,MAArB,CAA6B3a,KAA7B;WATiC,CAApC;cAYIg/B,sBAAJ,CAA4BH,2BAA5B,EAAyDnB,MAAME,oBAA/D,EAAqFF,MAAMG,qBAA3F;eACKb,6BAAL,GAAqC,UAAW30B,KAAX,EAAmB;8BAExC,KAAf;2CAC4B1E,QAA5B,CAAsC0E,KAAtC;8BACe,IAAf;WAJD;cAUM42B,kBAAkBL,gBAAgBjoB,SAAhB,CAA2B+mB,MAAMK,iBAAjC,CAAxB,CAhFsC;cAiFlCmB,kBAAJ,CAAwBD,eAAxB,EAAyCvB,MAAMK,iBAA/C,EAAkEL,MAAMM,kBAAxE;0BACgB/nB,GAAhB,CAAqB,IAAIkI,kBAAJ,CAAwB,UAAWK,KAAX,EAAmB;wBAEtD8c,MAAT,IAAmB9c,KAAnB;iCACkB7a,QAAlB,CAA4B0Z,SAASie,MAArC;WAHoB,EAKlB,EAAEje,UAAU,EAAErU,QAAQ,IAAV,EAAZ,EAA8BxJ,KAAK,MAAnC,EAA2CC,KAAK,IAAhD,EAAsDyL,MAAM,MAA5D,EALkB,CAArB;cAOMi0B,oBAAoBniB,IAAIoiB,kBAAJ,CAAwBH,eAAxB,EAAyC5hB,SAAS0d,MAAlD,EAA0D,QAA1D,EAAoE,UAAW/6B,KAAX,EAAmB;wBAEvGs7B,MAAT,GAAkBt7B,KAAlB;yBACW81B,YAAX;WAHyB,CAA1B;cAMIkJ,sBAAJ,CAA4BG,iBAA5B,EAA+CzB,MAAMK,iBAArD,EAAwEL,MAAMM,kBAA9E;cAEK3gB,SAASsY,MAAT,KAAoBx4B,SAAzB,EAAqCkgB,SAASsY,MAAT,CAAgB3a,KAAhB,GAAwBqC,SAASrC,KAAjC;cAEjC2jB,sBAAJ;cACKthB,SAASsY,MAAd,EAAuB;wCAEGiJ,gBAAgB3oB,GAAhB,CAAqBoH,SAASsY,MAA9B,EACxB,OADwB,EACflB,eAAezZ,KAAf,GAAuB,EADR,EACYyZ,eAAezZ,KAAf,GAAuB,CADnC,EACsCyZ,eAAezZ,KAAf,GAAuB,IAD7D,EAEvBvX,QAFuB,CAEb,UAAWzD,KAAX,EAAmB;6BAGpBgb,KAAT,GAAiBhb,KAAjB;8BACW81B,YAAX;gBANuB,CAAzB;mBASIkJ,sBAAJ,CAA4BL,sBAA5B,EAAoDjB,MAAM1iB,KAA1D,EAAiE0iB,MAAMO,UAAvE;;cAMKoB,UAAU,CAAE,KAAO,MAAM,CAAf,IAAuBf,UAAU9e,KAAjC,GAAyC,MAAM,CAA/D;cACM8f,0BAA0BV,gBAAgB3oB,GAAhB,CAAqBoH,QAArB,EAA+B,cAA/B,EAA+C,CAAEgiB,OAAjD,EAA0DA,OAA1D,EAC9B57B,QAD8B,CACpB,UAAWzD,KAAX,EAAmB;wBAEpBq7B,YAAT,GAAwBr7B,KAAxB;yBACW81B,YAAX;WAJ8B,CAAhC;cAOIkJ,sBAAJ,CAA4BM,uBAA5B,EAAqD5B,MAAMQ,gBAA3D,EAA6ER,MAAMS,iBAAnF;cAGMoB,sBAAsBX,gBAAgB3oB,GAAhB,CAAqB;yBACtC,kBAAWjW,KAAX,EAAmB;6BAEnB+6B,MAAT,CAAgBO,MAAhB,GAAyB7G,eAAe6G,MAAxC;sCACkB33B,QAAlB,CAA4B0Z,SAAS0d,MAAT,CAAgBO,MAA5C;wBAEKje,SAASsY,MAAd,EAAuB;kCAEbA,MAAT,CAAgB3a,KAAhB,GAAwByZ,eAAezZ,KAAvC;gDACuBrX,QAAvB,CAAiC0Z,SAASsY,MAAT,CAAgB3a,KAAjD;;6BAIQqgB,YAAT,GAAwB5G,eAAe4G,YAAvC;4CACwB13B,QAAxB,CAAkC0Z,SAASge,YAA3C;;WAd0B,EAkBzB,UAlByB,CAA5B;cAmBI2D,sBAAJ,CAA4BO,mBAA5B,EAAiD7B,MAAMU,aAAvD,EAAsEV,MAAMW,YAA5E;6BAEoBhhB,SAASsZ,gBAA7B;cAEI6I,eAAe,IAAnB;mBAKSpL,SAAT,CAAoBxgB,IAApB,EAA2B;mBAErB,CAAC4rB,YAAN,EACC;mBACKp+B,SAAS,EAAf;sBACO7F,IAAP,CAAak5B,cAAb,EAA8B55B,OAA9B,CAAuC,UAAWa,GAAX,EAAiB;2BAEhDA,GAAP,IAAc2hB,SAAS3hB,GAAT,CAAd;gBAFD;uBAMQshB,GAAR,CAAYkX,MAAZ,CAAmBE,SAAnB,CAA8BxgB,IAA9B,EAAoCxS,MAApC;;MAvKF;SA6KI46B,WAAJ,EAAiB+C,oBAAjB;UAaKU,oBAAL,GAA4B,UAAW5J,UAAX,EAAuBhwB,MAAvB,EAAgC;wBAE7CgwB,UAAd;mBACShwB,UAAU,EAAnB;cACM63B,QAAQD,QAAS,EAAE/f,iBAAiB7X,OAAO6X,eAA1B,EAA2CF,MAAM3X,OAAO2X,IAAxD,EAAT,CAAd;cACCsgB,oBAAoBriC,OAAOF,IAAP,CAAamiC,MAAMI,iBAAnB,CADrB;iCAEuB;qBAEhB,GAFgB;sBAGfJ,MAAMC,aAHS;mBAIlB,yBAJkB;qBAKhB,IALgB;sBAMf,CAEN;0BACOG,kBAAkBjH,wBAAwBC,IAA1C,CADP;wBAEK,6BAFL;2BAGQ,IAHR;6BAIUzZ,SAASsZ,gBAAT,KAA8BE,wBAAwBC,IAJhE;sCAKmBD,wBAAwBC,IAL3C;6BAMU,iBAAW1vB,KAAX,EAAmB;kCAElBuvB,gBAAT,GAA4BE,wBAAwBC,IAApD;;gBAVI,EAcN;0BACOgH,kBAAkBjH,wBAAwBuG,GAA1C,CADP;wBAEK,4BAFL;2BAGQ,IAHR;6BAIU/f,SAASsZ,gBAAT,KAA8BE,wBAAwBuG,GAJhE;sCAKmBvG,wBAAwBuG,GAL3C;6BAMU,iBAAWh2B,KAAX,EAAmB;kCAElBuvB,gBAAT,GAA4BE,wBAAwBuG,GAApD;;gBAtBI,EA2BN;0BACOU,kBAAkBjH,wBAAwByG,GAA1C,CADP;wBAEK,4BAFL;2BAGQ,IAHR;6BAIUjgB,SAASsZ,gBAAT,KAA8BE,wBAAwByG,GAJhE;sCAKmBzG,wBAAwByG,GAL3C;6BAMU,iBAAWl2B,KAAX,EAAmB;kCAElBuvB,gBAAT,GAA4BE,wBAAwByG,GAApD;;gBAnCI;WANR;+BAiDqB3iB,MAArB,GAA8B,UAAW3a,KAAX,EAAmB;oCAE3B0/B,KAArB,CAA2B7kC,OAA3B,CAAoC,UAAW4oB,IAAX,EAAkB;wBAEhDA,KAAKkT,gBAAL,KAA0B32B,KAA/B,EAAuC;6BAEjC,CAACyjB,KAAK3Z,OAAX,EACC2Z,KAAKkc,MAAL,CAAY1jB,OAAZ,CAAqB,EAAE/gB,QAAQuoB,KAAKkc,MAAf,EAArB;;gBALH;WAFD;eAcK1C,mBAAL,GAA2B,UAAW50B,KAAX,EAAmB;oCAExBsS,MAArB,CAA6BtS,KAA7B;WAFD;qBAKWu3B,IAAX,CAAgB53B,IAAhB,CAAsB+2B,oBAAtB;MA1ED;;AAgFD;AAeDnI,aAAaC,uBAAb,GAAuC;WAEhC,CAFgC;UAIjC,CAJiC;UAMjC,CANiC;CAAvC;AAQAp7B,OAAOgjC,MAAP,CAAe7H,aAAaC,uBAA5B;AACA,IAAMA,0BAA0BD,aAAaC,uBAA7C;AAKA,SAASgJ,MAAT,GAAkB;SAEXjjB,QAAQK,QAAML,KAApB;SAYK,IAAIA,MAAMkjB,SAAV,GAAsB7J,eAA3B,EACC;YAGM4J,MAAP,CAAejjB,MAAMkjB,SAAN,CAAgBllC,SAA/B,EAA0C;2BAYxB,yBAAWyiB,QAAX,EAAsB;0BAE3BA,YAAY,EAAvB;wBACS0iB,eAAT,GAA2B1iB,SAAS0iB,eAAT,KAA6B5iC,SAA7B,GAAyC,IAAzC,GAAgDkgB,SAAS0iB,eAApF;mBACMpK,SAAStY,SAASsY,MAAxB;mBAAgCD,WAAWrY,SAASqY,QAApD;mBAEKrY,SAAS0iB,eAAd,EAA+B;wBAExB7Y,SAAQ,IAAItK,MAAMkN,OAAV,EAAd;2BACOviB,gBAAP,CAAyB,WAAzB,EAAsC,UAAWH,KAAX,EAAmB;gCAKlDlB,CAAN,GAAYkB,MAAMnB,OAAN,GAAgBnN,OAAO4Y,UAAzB,GAAwC,CAAxC,GAA4C,CAAtD;gCACMtL,CAAN,GAAU,EAAIgB,MAAMjB,OAAN,GAAgBrN,OAAO6Y,WAA3B,IAA2C,CAA3C,GAA+C,CAAzD;mCAGUquB,aAAV,CAAyB9Y,MAAzB,EAAgCyO,MAAhC;mCAEUoF,MAAV,CAAiBkF,mBAAjB,CAAsC74B,KAAtC;qBAXD,EAaG,KAbH;2BAcOG,gBAAP,CAAyB,aAAzB,EAAwC,UAAWH,KAAX,EAAmB;mCAEhD2zB,MAAV,CAAiBmF,mBAAjB,CAAsC94B,KAAtC;qBAFD,EAIG,KAJH;;mBAQK0uB,eAAezY,SAASyY,YAAT,KAA0B34B,SAA1B,GAAsCkgB,SAASyY,YAA/C,GAA8D,OAAOqK,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC;mBAW9EvJ,YAAJ,CAAkBlB,QAAlB,EAA4B;kCAEZ;2CAEImB,wBAAwBC,IAF5B;8BAGTnB,SAASA,OAAOuF,GAAhB,GAAsB/9B,SAHb;iCAINw4B,MAJM;uCAKA;;gBAPhB,CAXD;mBAuBC8F,YAAY,IAvBb;mBAwBC2E,SAAS,IAAIxjB,MAAMkN,OAAV,EAxBV;mBAyBCuW,SAAS,IAAIzjB,MAAMkN,OAAV,EAzBV;mBA0BIwW,SAAJ;yBAAA;oBAAA,CAzDsC;wBA+D7BC,gBAAT,GAA4B;iCAEd/E,eAAb,GAA+B+E,gBAA/B,CAAiDrZ,KAAjD,EAAwD9f,KAAxD;6BAESkgB,aAAT,CAAwBkZ,UAAxB,EAAoCvmC,CAApC,EAAwC;gCAEhCwlB,IAAP,CAAayH,KAAb;gCACOzH,IAAP,CAAayH,KAAb;6BACMhtB,IAAI,GAAV;gCAEOsmC,UAAP,KAAsBtmC,CAAtB;gCACOsmC,UAAP,KAAsB,CAAtB;gCAEOA,UAAP,KAAsBtmC,CAAtB;gCACOsmC,UAAP,KAAsB,CAAtB;6BAGMrZ,OAAO,IAAIvK,MAAMkN,OAAV,EAAb;kCACSuM,OAAT,CAAkBlP,IAAlB;6BACMkU,eAAiBvF,aAAazY,QAAb,CAAsBge,YAAtB,GAAqClU,KAAKjhB,CAA5C,GAAkDjM,CAAvE;gCACOiM,CAAP,IAAYm1B,YAAZ;gCACOn1B,CAAP,IAAYm1B,YAAZ;;4BAGQl9B,SAAU23B,aAAazY,QAAb,CAAsBsZ,gBAAhC,CAAT;8BAEME,wBAAwBC,IAA7B;;8BAEKD,wBAAwBuG,GAA7B;4CACgB,GAAf,EAAoB,CAApB;;8BAEIvG,wBAAwByG,GAA7B;4CACgB,GAAf,EAAoB,CAApB;;;sCAEgBvgB,KAAR,CAAe,kGAAkGojB,OAAO9iB,QAAP,CAAgBsZ,gBAAjI;;;;wBAMF8J,aAAT,GAAyB;wBAEnBH,cAAcnjC,SAAnB,EACC;iCACYxC,MAAM6C,OAAN,CAAe8iC,SAAf,IAA6B7E,UAAUiF,gBAAV,CAA4BJ,SAA5B,CAA7B,GAAuE7E,UAAUkF,eAAV,CAA2BL,SAA3B,CAApF;;mBAGGM,oBAAoBzjC,SAAxB;wBACS0jC,YAAT,CAAuBC,mBAAvB,EAA6C;wBAEvC5Z,UAAU/pB,SAAf,EACC,OAH2C;0CAKtB2jC,uBAAuBzjB,QAA7C;6BACS0jB,cAAT,GAA0B;;6BAGpBC,WAAWvmC,MAAX,GAAoB,CAAzB,EAA6B;kCAEtBomC,gBAAeG,WAAW,CAAX,CAArB;kCAECH,iBACAA,cAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6B4D,SAD7B,IAEAoF,cAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6B4D,SAA7B,CAAuCwF,cAHxC,EAIE;iDAEY7/B,MAAb,CAAoBy2B,QAApB,CAA6B4D,SAA7B,CAAuCwF,cAAvC,CAAuDJ,aAAvD,EAAqE3Z,KAArE;uDACoB2Z,cAAaz/B,MAAjC;;0BAVF,MAcO,IAAKw/B,iBAAL,EAAwB;gDAEZ/I,QAAlB,CAA2B4D,SAA3B,CAAqCyF,iBAArC;kDACoB/jC,SAApB;;gCA0BM6jC,WAAWvmC,MAAX,GAAoB,CAA3B;;wBAGI0D,SAAU23B,aAAazY,QAAb,CAAsBsZ,gBAAhC,MAAuDE,wBAAwBC,IAApF,EAA2F;6BAEpFqK,WAAWja,KAAjB;iCACQkZ,MAAR;mCACUJ,aAAV,CAAyBI,MAAzB,EAAiCzK,MAAjC;6BACK,CAACoL,gBAAN,EAAyB;sCAEhBV,MAAR;wCACUL,aAAV,CAAyBK,MAAzB,EAAiC1K,MAAjC;;;iCAIOwL,QAAR;;;8BAISnB,aAAV,CAAyB9Y,KAAzB,EAAgCyO,MAAhC;;;oBAcIoF,MAAL,GAAc;yCAOQ,6BAAW3zB,KAAX,EAAmB;6BAElCk5B,cAAcnjC,SAAnB,EACC,OAHsC;+BAIjC+P,cAAN;6BACKga,UAAU/pB,SAAf,EACC+pB,QAAQ,IAAItK,MAAMkN,OAAV,EAAR;;;qBAbW;yCAuBQ,6BAAW1iB,KAAX,EAAmB;6BAElC0uB,aAAa7rB,OAAb,CAAqB+S,GAArB,CAAyB8d,UAA9B,EACC;6BACIkG,cAAcA,WAAWvmC,MAAX,GAAoB,CAAvC,EAA2C;kCAErCumC,WAAW,CAAX,EAAc5/B,MAAd,CAAqBy2B,QAArB,CAA8B4D,SAAnC,EAA+C;uCAExC2F,YAAYJ,WAAW,CAAX,CAAlB;uCACKI,UAAUhgC,MAAV,CAAiBy2B,QAAjB,CAA0B4D,SAA1B,CAAoChvB,WAAzC,EACC20B,UAAUhgC,MAAV,CAAiBy2B,QAAjB,CAA0B4D,SAA1B,CAAoChvB,WAApC,CAAiD20B,SAAjD;;;qBAjCS;wCAgDO,4BAAWC,QAAX,EAAsB;6BAEpC,CAACf,SAAN,EACC,OAAO,KAAP;gCACMA,UAAUgB,QAAV,CAAoBD,QAApB,CAAP;qBApDY;iCAgEA,qBAAWA,QAAX,EAAsB;6BAE7Bf,cAAcnjC,SAAnB,EACCmjC,YAAY,EAAZ;6BACI,KAAKiB,kBAAL,CAAyBF,QAAzB,CAAL,EAA2C;sCAElCtkB,KAAR,CAAe,yBAAyBskB,SAASztB,IAAlC,GAAyC,GAAxD;;;mCAIS5L,IAAV,CAAgBq5B,QAAhB;qBA1EY;kCAsFC,sBAAWG,YAAX,EAA0B;6BAElClB,cAAcnjC,SAAnB,EAA+B;kCAEzB,CAACxC,MAAM6C,OAAN,CAAe8iC,SAAf,CAAN,EAAmC;uCAE9BmB,eAAenB,SAAnB;+CACY,EAAZ;6CACUt4B,IAAV,CAAgBy5B,YAAhB;;wCAGSz5B,IAAV,CAAgBw5B,YAAhB;;;qCAIWA,YAAZ;qBArGY;oCAiHG,wBAAWH,QAAX,EAAsB;8BAE/B,IAAIplC,IAAI,CAAd,EAAiBA,IAAIqkC,UAAU7lC,MAA/B,EAAuCwB,GAAvC,EAA6C;kCAEvCR,OAAOohB,EAAP,CAAWwkB,QAAX,EAAqBf,UAAUrkC,CAAV,CAArB,CAAL,EAA2C;6CAEhCqM,MAAV,CAAkBrM,CAAlB,EAAqB,CAArB;;;;qBAvHU;qCAuII,2BAAY;qCAAckB,SAAZ;qBAvIlB;iCAiJA,qBAAW0jC,YAAX,EAA0B;6BAEhCniB,qBAAqBmiB,aAAaz/B,MAAb,CAAoBud,QAApB,CAA6BC,UAA7B,CAAwCxZ,QAAnE;6BAIIA,WAAWsZ,mBAAmBG,QAAnB,IAA+B,CAA/B,GAAmC,IAAIjC,MAAMkC,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,CAAnC,GAAqE,IAAIlC,MAAMmC,OAAV,EAApF;6BAEK8hB,aAAax4B,KAAb,KAAuBlL,SAA5B,EAAwC;uCAE9B6hB,SAAT,CAAoBN,mBAAmBO,KAAvC,EAA8C4hB,aAAax4B,KAAb,GAAqBqW,mBAAmBG,QAAtF;uCAESU,QAAT,CAAmBshB,aAAaz/B,MAAb,CAAoBoe,KAAvC;uCAESvJ,GAAT,CAAc4qB,aAAaz/B,MAAb,CAAoBgE,QAAlC;0BAND,MAQOA,WAAWy7B,aAAaz/B,MAAb,CAAoBgE,QAA/B;gCACAA,QAAP;;gBAlKF;;MAhNF;;AA8XDwxB,aAAaiJ,MAAb,GAAsBA,MAAtB;AAKA,AAGA,IAAMriB,OAAO;WAEN,MAFM;gBAGD,YAHC;YAIL,OAJK;cAKH;CALV;AASA,QAASE,iBAAT;UAEM,IAAL;eACMgkB,IAAL,GAAY,WAAZ;eACKC,SAAL,GAAiB,WAAjB;eACKpoC,KAAL,GAAa,MAAb;eACKgY,OAAL,GAAe,gBAAf;;;AAKF,AAmBAqlB,aAAagL,mBAAb,GAAmC,UAAWf,YAAX,EAAwC;SAAf52B,OAAe,uEAAL,EAAK;SAEpE43B,aAAajH,QAAQkH,0BAAR,CAAoC73B,QAAQ83B,aAAR,CAAsB/J,KAA1D,CAAnB;SACK6J,UAAL,EACC,OAAOA,UAAP;SAEKjlB,QAAQK,QAAML,KAApB;SACMxX,WAAWya,oBAAmBghB,aAAaz/B,MAAhC,EAAwCy/B,aAAax4B,KAArD,CAAjB;SACC25B,SAAS/3B,QAAQ+3B,MAAR,IAAkB,EAD5B;SAECC,eACGpB,aAAax4B,KAAb,KAAuBlL,SAAzB,IACE0jC,aAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6BqK,MAA7B,KAAwC/kC,SAD1C,IAEE0jC,aAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6BqK,MAA7B,CAAoCC,UAApC,KAAmDhlC,SALvD;SAOCilC,QAAQ,CAACH,YAAD,GAAgB9kC,SAAhB,GAA4B0jC,aAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6BqK,MAA7B,CAAoCC,UAPzE;SAQCxlC,OAASylC,UAAUjlC,SAAZ,IAA6B,OAAOilC,KAAP,KAAiB,UAA9C,GAA6DjlC,SAA7D,GAAyEilC,MAAMvB,aAAax4B,KAAnB,CARjF;SASCs5B,YAAYM,gBAAgBtlC,IAAhB,GAAuBA,KAAKiX,IAA5B,GAAmCzW,SAThD;SAUC5D,QAAQ,CAAC0oC,YAAD,IAAmBtlC,SAASQ,SAA5B,GACPA,SADO,GAEPxC,MAAM6C,OAAN,CAAeb,KAAK6e,CAApB,IACC6mB,OAAOC,QAAP,CAAiB3lC,IAAjB,EAAuB,GAAvB,EAA4Bq7B,MAAMH,QAAN,CAAex4B,CAA3C,EAA8C4K,OAA9C,CADD;UAEMuR,CAdR;SAgBM+mB,QAAQ,CAACP,OAAO97B,CAAR,IAAc,CAAC87B,OAAO57B,CAAtB,IAA4B,CAAC47B,OAAOpiB,CAAlD;aACQmiB,aAAR,CAAsBnuB,IAAtB,GAA6BgnB,QAAQkH,0BAAR,CAAmCU,0BAAhE;YACO,IAAIrL,UAAJ;MAGJ0J,aAAaz/B,MAAb,CAAoBwS,IAApB,KAA6B,EAA7B,GAAkC,EAAlC,GAAuC4J,KAAKkkB,IAAL,GAAY,IAAZ,GAAmBb,aAAaz/B,MAAb,CAAoBwS,IAAhF,KACE+tB,cAAcxkC,SAAd,GAA0B,EAA1B,GAA+B,OAAMqgB,KAAKmkB,SAAX,GAAuB,IAAvB,GAA8BA,SAD/D,KAEE,CAACY,KAAD,IAAU,CAACP,OAAO97B,CAAlB,GAAsB,EAAtB,GAA2B,QAAS87B,OAAO97B,CAAP,IAAY87B,OAAO97B,CAAP,CAAS0N,IAArB,GAA4BouB,OAAO97B,CAAP,CAAS0N,IAArC,GAA4C,GAArD,IAA6D,IAA7D,GAAoExO,SAASc,CAF1G,KAGE,CAACq8B,KAAD,IAAU,CAACP,OAAO57B,CAAlB,GAAsB,EAAtB,GAA2B,QAAS47B,OAAO57B,CAAP,IAAY47B,OAAO57B,CAAP,CAASwN,IAArB,GAA4BouB,OAAO57B,CAAP,CAASwN,IAArC,GAA4C,GAArD,IAA6D,IAA7D,GAAoExO,SAASgB,CAH1G,KAIE,CAACm8B,KAAD,IAAU,CAACP,OAAOpiB,CAAlB,GAAsB,EAAtB,GAA2B,QAASoiB,OAAOpiB,CAAP,IAAYoiB,OAAOpiB,CAAP,CAAShM,IAArB,GAA4BouB,OAAOpiB,CAAP,CAAShM,IAArC,GAA4C,GAArD,IAA6D,IAA7D,GAAoExO,SAASwa,CAJ1G;MAMEqiB,YAAD,GACC,EADD,GAECG,MAAMvB,aAAax4B,KAAnB,aAAqCuU,MAAMkC,OAA3C,IACCsjB,MAAMvB,aAAax4B,KAAnB,aAAqCuU,MAAMmC,OAD5C,IAEC,OAAOqjB,KAAP,KAAiB,UAFlB,GAGC7oC,iBAAiBqjB,MAAMta,KAAvB,GACC,OAAOkb,KAAKjkB,KAAZ,GAAoB,IAApB,GAA2B,IAAIqjB,MAAMta,KAAV,CAAiB/I,MAAMM,CAAvB,EAA0BN,MAAMS,CAAhC,EAAmCT,MAAMU,CAAzC,EAA6CwoC,YAA7C,EAD5B,GAECr9B,SAASoW,CAAT,KAAere,SAAf,GAA2B,QAAS6kC,OAAOxmB,CAAP,IAAYwmB,OAAOxmB,CAAP,CAAS5H,IAArB,GAA4BouB,OAAOxmB,CAAP,CAAS5H,IAArC,GAA4C,GAArD,IAA6D,IAA7D,GAAoExO,SAASoW,CAAxG,GAA4G,EAL9G,GAMC,EAdH;kBAkBgBpa,MAAb,CAAoBud,QAApB,CAA6BC,UAA7B,CAAwC8jB,EAAxC,KAA+CvlC,SAAjD,IACG0jC,aAAaz/B,MAAb,CAAoBud,QAApB,CAA6BC,UAA7B,CAAwC8jB,EAAxC,CAA2C7jB,QAA3C,GAAsD,CADzD,GAEC,EAFD,GAGC,OAAOrB,KAAKjM,OAAZ,GAAsB,IAAtB,GAA6B,IAAIqL,MAAMkC,OAAV,GAAoBE,SAApB,CAE5B6hB,aAAaz/B,MAAb,CAAoBud,QAApB,CAA6BC,UAA7B,CAAwC8jB,EAAxC,CAA2CzjB,KAFf,EAG5B4hB,aAAax4B,KAAb,GAAqBw4B,aAAaz/B,MAAb,CAAoBud,QAApB,CAA6BC,UAA7B,CAAwC8jB,EAAxC,CAA2C7jB,QAHpC,EAK3BrD,CA1BJ,CAHM,EAgCNpW,QAhCM,EAgCI6E,QAAQ83B,aAhCZ,CAAP;CAzBD;;AC/pCA;;;;;;;;;;;;;AAkBA,AAIA,IAAKjiB,MAAM6iB,gBAAN,OAA6B,KAAlC,EAA0C;YAEhCxxB,IAAT,CAAc9X,WAAd,CAA2BymB,MAAM8iB,oBAAN,EAA3B;SACO9iB,MAAM8iB,oBAAN,GAA6BzpC,SAApC;;AAID,IA2BMyhC;AAML,iBAAa3wB,OAAb,EAAuB;;;OAEhBN,QAAQ,IAAd;aACUM,WAAW,EAArB;OACKA,QAAQ4wB,SAAb,EACC,OAAO5wB,OAAP,CALqB;OAQjBA,QAAQ/P,CAAR,KAAciD,SAAnB,EAA+B8M,QAAQ/P,CAAR,GAAY,CAAZ;OAC1B+P,QAAQhQ,CAAR,KAAckD,SAAnB,EAA+B8M,QAAQhQ,CAAR,GAAY,CAAZ;QAa1B4oC,IAAL,GAAY,UAAWC,UAAX,EAAwB;mBAEtBA,cAAc74B,OAA3B;UACM84B,WAAW,GAAjB;iBACWf,MAAX,GAAoBc,WAAWd,MAAX,IAAqB,EAAzC;iBACWA,MAAX,CAAkBxmB,CAAlB,GAAsBsnB,WAAWd,MAAX,CAAkBxmB,CAAlB,IAAuB,EAA7C;UACMgE,QAAQsjB,WAAWd,MAAX,CAAkBxmB,CAAhC;YACM5H,IAAN,GAAa4L,MAAM5L,IAAN,IAAcmvB,QAA3B;UACK,CAACD,WAAW3c,OAAjB,EACC,KAAK6c,UAAL,CAAiBF,UAAjB;YAEKtjC,GAAN,GAAYggB,MAAMhgB,GAAN,KAAcrC,SAAd,GAA0B,CAA1B,GAA8BqiB,MAAMhgB,GAAhD;YAIMC,GAAN,GAAY+f,MAAM/f,GAAN,KAActC,SAAd,GAA0B,IAAI8f,QAAML,KAAN,CAAYkC,OAAhB,GAA0BtD,CAApD,GAAwDgE,MAAM/f,GAA1E;IAfD;WAkBQuiC,MAAR,GAAiB/3B,QAAQ+3B,MAAR,IAAkB,EAAnC;OACMiB,gBAAgB,CAACh5B,QAAQ+3B,MAAR,CAAe97B,CAAhB,IAAqB,CAAC+D,QAAQ+3B,MAAR,CAAe57B,CAArC,IAA0C,CAAC6D,QAAQ+3B,MAAR,CAAepiB,CAAhF;YACSsjB,QAAT,CAAmBH,QAAnB,EAA8B;UAGxBE,aAAL,EACCh5B,QAAQ+3B,MAAR,CAAee,QAAf,IAA2B94B,QAAQ+3B,MAAR,CAAee,QAAf,KAA4B,EAAvD;UAEI,CAAC94B,QAAQ+3B,MAAR,CAAee,QAAf,CAAN,EACC;cAEOf,MAAR,CAAee,QAAf,EAAyBnvB,IAAzB,GAAgC3J,QAAQ+3B,MAAR,CAAee,QAAf,EAAyBnvB,IAAzB,IAAiCmvB,QAAjE;cACQf,MAAR,CAAee,QAAf,EAAyBvjC,GAAzB,GAA+ByK,QAAQ+3B,MAAR,CAAee,QAAf,EAAyBvjC,GAAzB,KAAiCrC,SAAjC,GAA6C,CAAC,CAA9C,GAAkD8M,QAAQ+3B,MAAR,CAAee,QAAf,EAAyBvjC,GAA1G;cACQwiC,MAAR,CAAee,QAAf,EAAyBtjC,GAAzB,GAA+BwK,QAAQ+3B,MAAR,CAAee,QAAf,EAAyBtjC,GAAzB,KAAiCtC,SAAjC,GAA6C,CAA7C,GAAiD8M,QAAQ+3B,MAAR,CAAee,QAAf,EAAyBtjC,GAAzG;;YAIS,GAAV;YACU,GAAV;YACU,GAAV;WACQuiC,MAAR,CAAea,IAAf,GAAsB,YAAY;YAAQA,IAAN;IAApC;WACQM,KAAR,GAAgBl5B,QAAQk5B,KAAR,IAAiB,EAAjC;WACQA,KAAR,CAAchc,IAAd,GAAqBld,QAAQk5B,KAAR,CAAchc,IAAd,IAAsB,GAA3C;WACQgc,KAAR,CAAcC,kBAAd,GAAmCn5B,QAAQk5B,KAAR,CAAcC,kBAAd,IAAoC,KAAvE;QAMKJ,UAAL,GAAkB,YAAY;UAExB/4B,QAAQkc,OAAb,EACC;cACOA,OAAR,GAAkB,IAAId,cAAYc,OAAhB,EAAlB,CAJ6B;IAA9B;QAcKkd,mBAAL,GAA2B,UAAW1N,MAAX,EAAmBD,QAAnB,EAA6BoG,KAA7B,EAAqC;UAO1D7xB,QAAQq5B,aAAR,KAA0B,KAA/B,EACC;;YAWKA,aAAN,GAAsB,IAAI9Z,aAAJ,CAAmBmM,MAAnB,EAA2BD,SAASpyB,UAApC,CAAtB;YAKMggC,aAAN,CAAoBpoC,MAApB,CAA2ByzB,GAA3B,CAAgCmN,MAAM12B,QAAN,CAAec,CAAf,GAAmB,CAAnD,EAAsD41B,MAAM12B,QAAN,CAAegB,CAAf,GAAmB,CAAzE,EAA4E01B,MAAM12B,QAAN,CAAewa,CAAf,GAAmB,CAA/F;YACM0jB,aAAN,CAAoBxW,SAApB,GAzB+D;YA0BzDwW,aAAN,CAAoBpW,MAApB;IA1BD;QAmCKqW,sBAAL,GAA8B,UAAW5N,MAAX,EAAmBmG,KAAnB,EAA2B;UAEnD,CAAC7e,QAAMD,GAAZ;;UAKMQ,OAAO;wBAEG,SAFH;uBAGE;OAHf;cAOS,KAAKE,eAAL,EAAT;cAEM,IAAL;iBAEM0gB,aAAL,GAAqB,cAArB;iBACKC,YAAL,GAAoB,8CAApB;;;UAMImF,gBAAgB,IAAIvmB,QAAML,KAAN,CAAYmC,OAAhB,GAA0BU,IAA1B,CAAgCqc,MAAM12B,QAAtC,CAAtB;UACCq+B,iBAAiB,IAAIxmB,QAAML,KAAN,CAAYmC,OAAhB,GAA0BU,IAA1B,CAAgCkW,OAAOvwB,QAAvC,CADlB;cAGM4X,GAAN,CAAUgiB,sBAAV,CAAkC/0B,QAAQ+S,GAAR,CAAYrH,GAAZ,CAAgBM,GAAhB,CAAqB;mBAC5C,kBAAWjW,KAAX,EAAmB;gBAEvBiK,QAAQi4B,MAAb,EAAsBj4B,QAAQi4B,MAAR,CAAelO,OAAf,CAAwB/pB,QAAQy5B,aAAR,CAAsBlkC,GAA9C;mBAGf4F,QAAP,CAAgBqa,IAAhB,CAAsBgkB,cAAtB;kBACMr+B,QAAN,CAAeqa,IAAf,CAAqB+jB,aAArB;gBAIKv5B,QAAQq5B,aAAR,KAA0B,KAA/B,EAAuC;uBAE9BA,aAAR,CAAsBpoC,MAAtB,GAA+B,IAAI+hB,QAAML,KAAN,CAAYmC,OAAhB,EAA/B;uBACQukB,aAAR,CAAsBliC,MAAtB,CAA6BgE,QAA7B,CAAsCqa,IAAtC,CAA4CkW,OAAOvwB,QAAnD;uBACQk+B,aAAR,CAAsBpW,MAAtB;;;OAf+B,EA8B/B,UA9B+B,CAAlC,EA8BiB1P,KAAK4gB,aA9BtB,EA8BqC5gB,KAAK6gB,YA9B1C;IA5BD;UA8DO39B,gBAAP,CAAyB,IAAzB;qBAuBgB;cAET,kBAAY;oBAGRgjC,aAAR,GAAwBz5B,QAAQy5B,aAAR,IAAyB,EAAjD;gBACMA,gBAAgBz5B,QAAQy5B,aAA9B;0BACclkC,GAAd,GAAoBkkC,cAAclkC,GAAd,IAAqB,CAAzC;gBACKkkC,cAAcjkC,GAAd,KAAsB0qB,QAA3B,EAAsCuZ,cAAcjkC,GAAd,GAAoB,IAApB,CANtB;gBAOXikC,cAAcjkC,GAAd,KAAsB,IAA3B,EAAkC;mBAE5BikC,cAAcjkC,GAAd,KAAsBtC,SAA3B,EAAuCumC,cAAcjkC,GAAd,GAAoB,CAApB;6BACzBkkC,KAAd,GAAsBD,cAAcC,KAAd,IAAuB,EAA7C,CAHiC;aAAlC,MAKOD,cAAcC,KAAd,GAAsB,IAAtB;gBACFD,cAAcjkC,GAAd,KAAsB,IAA3B,EAAkCikC,cAAcE,EAAd,GAAmBF,cAAcE,EAAd,IAAoB,GAAvC,CAAlC,KACKF,cAAcE,EAAd,GAAmB,CAAEF,cAAcjkC,GAAd,GAAoBikC,cAAclkC,GAApC,KAA8CkkC,cAAcC,KAAd,GAAsB,CAApE,CAAnB;0BACSE,MAAd,GAAuBH,cAAcG,MAAd,IAAwB,KAA/C;0BACcC,QAAd,GAAyBJ,cAAcI,QAAd,IAA0B,CAAnD,CAhBgB;0BAiBFxmB,cAAd,GAA+BomB,cAAcpmB,cAAd,IAAgC,GAA/D;0BACctU,MAAd,GAAuB06B,cAAc16B,MAAd,IAAwB,GAA/C;0BACc4K,IAAd,GAAqB8vB,cAAc9vB,IAAd,IAAsB,EAA3C;gBACK,CAAC8vB,cAAcK,YAApB,EAAmC;mBAE5BA,eAAe,IAAI1B,SAAO0B,YAAX,EAArB;sBACOrjC,gBAAP,CAAyBgjC,aAAzB,EAAwC;gCAEzB;0BAER,kBAAY;+BAETK,YAAP;;;gBANH;;mBAeM95B,QAAQy5B,aAAf;UAxCa;cA2CT,gBAAWA,aAAX,EAA2B;oBAAUA,aAAR,GAAwBA,aAAxB;;OAlEpC;SA4EI;cAEG,kBAAY;mBAASz5B,QAAQ/P,CAAf;;OA9ErB;SAwFI;cAEG,kBAAY;mBAAS+P,QAAQhQ,CAAf;;OA1FrB;WAoHM;cAEC,kBAAY;gBAEV+pC,GAFU;yBAQFhnB,GAAb,EAAmB;;qBAEZA,OAAO,EAAb;mBACKA,IAAIinB,KAAT,EACC,OAAOjnB,GAAP,CAJiB;sBAKXtc,gBAAP,CAAyB,IAAzB,EAA+B;yBASvB;0BAED,kBAAY;+BAAS,IAAP;;mBAXU;uBAqBzB;0BAEC,kBAAY;gCAERqpB,IAAR,CAAa,2CAAb;+BACO9M,QAAMD,GAAb;sBALG;0BASC,gBAAWA,GAAX,EAAiB;gCAEb+M,IAAR,CAAa,2CAAb;4BAGC/M,IAAIA,GAAJ,IACEA,IAAIA,GAAJ,CAAQvf,WAAR,CAAoBmW,IAApB,KAA6BoJ,IAAIvf,WAAJ,CAAgBmW,IAD/C,IAEEoJ,IAAIA,GAAJ,CAAQvf,WAAR,CAAoBmW,IAApB,KAA6B,QAJhC,EAOCkJ,QAAQC,KAAR,CAAe,gBAAf;4BACGC,GAAJ,GAAUA,GAAV;;mBAzC4B;8BAqDjB;0BAEP,kBAAY;+BAASA,IAAIknB,UAAX;;mBAvDU;uBAiEzB;0BAEC,kBAAY;4BAEX,CAAClnB,IAAIrH,GAAL,IAAYsH,QAAMD,GAAvB,EAA6BA,IAAIrH,GAAJ,GAAU,IAAIsH,QAAMD,GAAN,CAAUzK,GAAd,EAAV;+BACtByK,IAAIrH,GAAX;;mBAtE4B;0BA2EtB;0BAEF,kBAAY;+BAASqH,IAAIkX,MAAX;sBAFZ;0BAGF,gBAAWA,SAAX,EAAoB;4BAAMA,MAAJ,GAAaA,SAAb;;mBA9EE;kCAiFd;0BAEV,kBAAY;+BAASlX,IAAImnB,cAAX;sBAFJ;0BAGV,gBAAWA,cAAX,EAA4B;4BAAMA,cAAJ,GAAqBA,cAArB;;mBApFN;6BAuFnB;0BAEL,kBAAY;+BAASnnB,IAAIonB,SAAX;sBAFT;0BAGL,gBAAWA,SAAX,EAAuB;4BAAMA,SAAJ,GAAgBA,SAAhB;;;gBA1FhC;oBAiGM,IAAIvqB,YAAV,IAA0BmD,GAA1B,EAAgC;sBAE1B,KAAKnD,YAAL,MAAuB1c,SAA5B,EAAwC2f,QAAQC,KAAR,CAAe,cAAclD,YAAd,GAA6B,gBAA5C;;aAhH3B;oBAuHRmD,GAAR,GAAc,IAAIgnB,GAAJ,CAAS/5B,QAAQ+S,GAAjB,CAAd;gBAGK/S,QAAQ+S,GAAR,CAAYrH,GAAjB,EAAuB;mBAEhB7P,YAAYmE,QAAQ+S,GAAR,CAAYrH,GAAZ,CAAgBrS,UAAhB,CAA2BwC,SAA7C;mBACIu+B,WAAW,CAAf;uBACQrnB,GAAR,CAAYrH,GAAZ,CAAgBrS,UAAhB,CAA2B0T,aAA3B,CAAyCrC,UAAzC,CAAoD9Z,OAApD,CAA6D,UAAWsc,IAAX,EAAkB;sBAEzEA,KAAKrR,SAAL,KAAmBA,SAAxB,EAAoCu+B;gBAFrC;mBAKKA,WAAW,CAAhB,EACCvnB,QAAQC,KAAR,CAAe,4BAAf;uBAEOC,GAAR,CAAYrH,GAAZ,CAAgBrS,UAAhB,CAA2BiE,gBAA3B,CAA6C,YAA7C,EAA2D,UAAWH,KAAX,EAAmB;0BAAU4V,GAAR,CAAY8d,UAAZ,GAAyB,IAAzB;gBAAhF;uBACQ9d,GAAR,CAAYrH,GAAZ,CAAgBrS,UAAhB,CAA2BiE,gBAA3B,CAA6C,YAA7C,EAA2D,UAAWH,KAAX,EAAmB;0BAAU4V,GAAR,CAAY8d,UAAZ,GAAyB,KAAzB;gBAAhF;;gBAGI7wB,QAAQ+S,GAAR,CAAYkX,MAAZ,KAAuB,KAA5B,EAAoCjqB,QAAQ+S,GAAR,CAAYkX,MAAZ,GAAqB,IAAIoQ,OAAO5P,aAAX,EAArB,CAApC,KACK,IAAKzqB,QAAQ+S,GAAR,CAAYkX,MAAZ,KAAuB/2B,SAA5B,EAAwC8M,QAAQ+S,GAAR,CAAYkX,MAAZ,GAAqBA,MAArB;oBAErClX,GAAR,CAAYwhB,aAAZ,GAA4B,YAA6B;mBAAlB0F,UAAkB,uEAAL,EAAK;mBAElDtwB,OAAO3J,QAAQ+S,GAAR,CAAYknB,UAAZ,KACVj6B,QAAQitB,WAAR,GACD/2B,QAAO8J,QAAQitB,WAAf,MAA+B,QAA/B,GACCjtB,QAAQitB,WAAR,CAAoB1W,EADrB,GAEC,OAAOvW,QAAQitB,WAAf,KAA+B,QAA/B,GACCjtB,QAAQitB,WADT,GAEC,EALD,GAMD,EAPW,CAAb;sBAQOgN,cAAiBA,eAAe,EAAjB,IAA2BtwB,SAAS,EAApC,GAA2C,GAA3C,GAAiD,EAAhE,IAAuEA,IAA9E;aAVD;mBAqBO3J,QAAQ+S,GAAf;UApKG;cAuKC,gBAAWA,GAAX,EAAiB;oBAAUA,GAAR,GAAcA,GAAd;;OA3R1B;uBA4TkB;cAEX,kBAAY;gBAEX,OAAO/S,QAAQyT,eAAf,KAAmC,QAAxC,EACC,OAAO,YAAY;sBAMXzT,QAAQyT,eAAf;aAND;mBASMzT,QAAQyT,eAAR,IAA2BA,eAAlC;;OA1UH;cAsVS;cAEF,kBAAY;mBAASzT,QAAQ+3B,MAAf;UAFZ;cAGF,gBAAWA,MAAX,EAAoB;oBAAUA,MAAR,GAAiBA,MAAjB;;OAzV7B;eAoWU;cAEH,kBAAY;gBAEX/3B,QAAQkc,OAAR,KAAoBhpB,SAAzB,EAAqC;+BAEpB8M,QAAQkc,OAAxB;uBAEM,QAAL;6BACSA,OAAR,GAAkB,IAAId,cAAYc,OAAhB,CAAyB,EAAEA,SAASlc,QAAQkc,OAAnB,EAAzB,CAAlB;;uBAEI,SAAL;yBACMlc,QAAQkc,OAAb,EACClc,QAAQkc,OAAR,GAAkB,IAAId,cAAYc,OAAhB,EAAlB,CAFF;;;;4BAMMlc,QAAQkc,OAAR,YAA2Bd,cAAYc,OAAvC,KAAmD,KAAxD,EACCrJ,QAAQC,KAAR,CAAe,sDAAqD9S,QAAQkc,OAA7D,CAAf;;;;mBAOGlc,QAAQkc,OAAf;;OA7XH;iBAyYY;cAEL,kBAAY;mBAAS,IAAP,CAAF;;OA3YnB;aA0ZQ;cAED,kBAAY;mBAASlc,QAAQk5B,KAAf;;OA5ZrB;kBAuaa;cAEN,kBAAY;gBAEXl5B,QAAQ43B,UAAb,EAA0B,OAAO53B,QAAQ43B,UAAf;mBACnB,EAAP;;OA5aH;iBAsbY;cAEL,kBAAY;gBAEX53B,QAAQwxB,SAAb,EAAyB,OAAOxxB,QAAQwxB,SAAf;UAJhB;cAOL,gBAAWA,SAAX,EAAuB;oBAAUA,SAAR,GAAoBA,SAApB;;OA7bhC;cAwcS;cAEF,kBAAY;oBAER9F,MAAR,GAAiB1rB,QAAQ0rB,MAAR,IAAkB,EAAnC;gBAKK,CAAC1rB,QAAQ0rB,MAAR,CAAevwB,QAArB,EAAgC6E,QAAQ0rB,MAAR,CAAevwB,QAAf,GAA0B,IAAI6X,QAAML,KAAN,CAAYmC,OAAhB,CAAyB,GAAzB,EAA8B,GAA9B,EAAmC,CAAnC,CAA1B;gBAC3B,CAAC9U,QAAQ0rB,MAAR,CAAenW,KAArB,EAA6BvV,QAAQ0rB,MAAR,CAAenW,KAAf,GAAuB,IAAIvC,QAAML,KAAN,CAAYmC,OAAhB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,CAAvB;mBACtB9U,QAAQ0rB,MAAf;UAXM;cAcF,gBAAWA,MAAX,EAAoB;oBAAUA,MAAR,GAAiBA,MAAjB;;OAtd7B;oBAiee;cAER,kBAAY;mBAAS1rB,QAAQ85B,YAAf;;OAnerB;mBA8ec;cAEP,kBAAY;mBAAS95B,QAAQitB,WAAf;;OAhfrB;kBA2fa;cAEN,kBAAY;mBAASjtB,QAAQ4rB,UAAf;UAFR;cAGN,gBAAWA,UAAX,EAAwB;gBAEvB5rB,QAAQ4rB,UAAR,IAAwB5rB,QAAQ4rB,UAAR,KAAuB,IAA/C,IAA2D5rB,QAAQ4rB,UAAR,KAAuB,KAAvF,EAAiG/Y,QAAQiN,IAAR,CAAc,sBAAd;oBACzF8L,UAAR,GAAqBA,UAArB;;OAjgBH;cA8gBS;cAEF,kBAAY;mBAAS5rB,QAAQ8V,MAAf;;OAhhBrB;qBA2hBgB;cAET,kBAAY;mBAAS9V,QAAQs6B,aAAf;UAFL;cAGT,gBAAWA,aAAX,EAA2B;gBAI9Bt6B,QAAQs6B,aAAR,IACEt6B,QAAQs6B,aAAR,CAAsB9mC,WAAtB,CAAkCmW,IAAlC,KAA2C2wB,cAAc9mC,WAAd,CAA0BmW,IADvE,IAEE3J,QAAQs6B,aAAR,CAAsB9mC,WAAtB,CAAkCmW,IAAlC,KAA2C,QAJ9C,EAOCkJ,QAAQC,KAAR,CAAe,0BAAf;oBACOwnB,aAAR,GAAwBA,aAAxB;;OAxiBH;oBAqjBe;cAER,kBAAY;mBAASt6B,QAAQ6rB,YAAf;UAFN;cAGR,gBAAWA,YAAX,EAA0B;gBAI7B7rB,QAAQ6rB,YAAR,IACE7rB,QAAQ6rB,YAAR,CAAqBr4B,WAArB,CAAiCmW,IAAjC,KAA0CkiB,aAAar4B,WAAb,CAAyBmW,IADrE,IAEE3J,QAAQ6rB,YAAR,CAAqBr4B,WAArB,CAAiCmW,IAAjC,KAA0C,QAJ7C,EAOCkJ,QAAQC,KAAR,CAAe,yBAAf;oBACO+Y,YAAR,GAAuBA,YAAvB;;OAlkBH;cA+kBS;cAEF,kBAAY;mBAAS7rB,QAAQi4B,MAAf;UAFZ;cAGF,gBAAWA,MAAX,EAAoB;gBAEnBj4B,QAAQi4B,MAAb,EAAsBplB,QAAQC,KAAR,CAAe,mBAAf;oBACdmlB,MAAR,GAAiBA,MAAjB;;OArlBH;YAimBO;cAEA,kBAAY;gBAEXj4B,QAAQi4B,MAAb,EACC,OAAOj4B,QAAQi4B,MAAR,CAAejO,OAAf,EAAP;mBACM,CAAP;;OAvmBH;kBAonBa;cAEN,kBAAY;mBAAShqB,QAAQu6B,UAAf;UAFR;cAGN,gBAAWA,UAAX,EAAwB;gBAEvBv6B,QAAQu6B,UAAb,EAA0B1nB,QAAQC,KAAR,CAAe,uBAAf;oBAClBynB,UAAR,GAAqBA,UAArB;;;0DAaU;WAEN,kBAAY;gBAASv6B,QAAQ4rB,UAAf;OAFR;WAGN,gBAAWA,UAAX,EAAwB;aAEvB5rB,QAAQ4rB,UAAb,EAA0B/Y,QAAQC,KAAR,CAAe,uBAAf;iBAClB8Y,UAAR,GAAqBA,UAArB;;IA7oBH,0DA0pBgB;WAET,kBAAY;gBAAS5rB,QAAQq5B,aAAf;OAFL;WAGT,gBAAWA,aAAX,EAA2B;aAI9Br5B,QAAQq5B,aAAR,IACEr5B,QAAQq5B,aAAR,CAAsB7lC,WAAtB,CAAkCmW,IAAlC,KAA2C0vB,cAAc7lC,WAAd,CAA0BmW,IADvE,IAEE3J,QAAQq5B,aAAR,CAAsB7lC,WAAtB,CAAkCmW,IAAlC,KAA2C,QAJ9C,EAOCkJ,QAAQC,KAAR,CAAe,0BAAf;iBACOumB,aAAR,GAAwBA,aAAxB;;IAvqBH,kDAgrBQ;WAED,kBAAY;gBAAS,CAAP;;IAlrBrB,uDA6rBa;WAEN,kBAAY;gBAASr5B,QAAQw6B,UAAf;;IA/rBrB,yDAysBe;WAER,kBAAY;gBAASx6B,QAAQ85B,YAAf;;IA3sBrB,2DAstBiB;WAEV,kBAAY;aAEX95B,QAAQy6B,cAAb,EAA8B,OAAOz6B,QAAQy6B,cAAf;gBACvB,EAAEC,aAAa,uBAAU,EAAzB,EAAP;OALc;WAQV,gBAAWD,cAAX,EAA4B;aAE3Bz6B,QAAQy6B,cAAb,EACC5nB,QAAQC,KAAR,CAAe,2BAAf;iBACO2nB,cAAR,GAAyBA,cAAzB;;IAluBH;QA+wBK,IAAI7qB,YAAT,IAAyB5P,OAAzB,EAAmC;UAE3B,KAAK4P,YAAL,MAAuB1c,SAA5B,EAAwC2f,QAAQC,KAAR,CAAe,sBAAsBlD,YAAtB,GAAqC,gBAApD;;QAGtC6pB,aAAL,CAAmBK,YAAnB,CAAgCt9B,IAAhC,CAAsC,KAAKs9B,YAA3C,EAAyD,IAAzD,EAA+D,KAA/D;;AAWFnJ,QAAQkH,0BAAR,GAAqC,UAAWhG,KAAX,EAAmB;OAEnD8I,sBAAJ;SACMnf,QAAN,CAAe5qB,OAAf,CAAwB,UAAW4oB,IAAX,EAAkB;UAElCA,KAAKna,IAAL,KAAc,QAAhB,IAAgCma,KAAK7P,IAAL,KAAcgnB,QAAQkH,0BAAR,CAAmCU,0BAAtF,EAAqH;kCAE3F/e,IAAzB;;;IAJF;UAUOmhB,sBAAP;CAbD;AAmBAhK,QAAQkH,0BAAR,CAAmCU,0BAAnC,GAAgE,wBAAhE;IAEM1C;AAKL,qBAAc;;OAET5jB,MAAJ;QAcK+kB,cAAL,GAAsB,UAAWJ,YAAX,EAAyB52B,OAAzB,EAAkC6xB,KAAlC,EAAyCnG,MAAzC,EAAiD5V,MAAjD,EAAyD2V,QAAzD,EAAoE;UAEpFmL,aAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6BgN,MAA7B,KAAwC1nC,SAAxC,IAAqD,CAAC0jC,aAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6BgN,MAA7B,EAA3D,EACC;UACGD,yBAAyBhK,QAAQkH,0BAAR,CAAoChG,KAApC,CAA7B;UACK8I,2BAA2BznC,SAAhC,EAA4C;aAGrC8qB,OAAOhe,QAAQ43B,UAAR,CAAmB5Z,IAAnB,GAA0B3T,KAAKC,KAAL,CAAYD,KAAKe,SAAL,CAAgBpL,QAAQ43B,UAAR,CAAmB5Z,IAAnC,CAAZ,CAA1B,GAAoF,EAAjG;cACKwQ,WAAL,GAAmB,IAAnB;cACKiB,eAAL,GAAuB,kBAAvB;kCACyB9C,aAAagL,mBAAb,CAAkCf,YAAlC,EAAgD;oBAEhE52B,QAAQ+3B,MAFwD;2BAGzD;2BAEF/3B,QAAQ43B,UAAR,CAAmB5J,UAFjB;0BAGHhuB,QAAQ43B,UAAR,CAAmBvJ,SAHhB;qBAIRrQ,IAJQ;sBAKP6T,KALO;uBAMN;0BAECnG,MAFD;0BAGC5V;;;UAZc,CAAzB;gCAoBuBP,KAAvB,CAA6BslB,MAA7B,CAAqChJ,MAAMtc,KAA3C;eACMvJ,GAAN,CAAW2uB,sBAAX;aAEK1oB,WAAW/e,SAAhB,EAA4B+e,SAASwZ,SAASpyB,UAAT,CAAoBvK,KAApB,CAA0BmjB,MAAnC;kBACnB5Y,UAAT,CAAoBvK,KAApB,CAA0BmjB,MAA1B,GAAmC,SAAnC;OA9BD,MAgCO0oB,uBAAuBx/B,QAAvB,CAAgCqa,IAAhC,CAAsCohB,aAAasC,KAAnD;IArCR;QA8CKjC,iBAAL,GAAyB,UAAWpF,KAAX,EAAkBpG,QAAlB,EAA6B;UAEjDqP,WAAW,KAAf;SACG;aAEEH,yBAAyBhK,QAAQkH,0BAAR,CAAoChG,KAApC,CAA7B;aACK8I,2BAA2BznC,SAAhC,EAA4C;kBAErCiZ,MAAN,CAAcwuB,sBAAd;gBACKG,QAAL,EACCjoB,QAAQC,KAAR,CAAe,kCAAf;uBACU,IAAX;;OARF,QAYU6nB,2BAA2BznC,SAZrC;eAcSmG,UAAT,CAAoBvK,KAApB,CAA0BmjB,MAA1B,GAAmCA,MAAnC;IAjBD;QA4BKzP,WAAL,GAAmB,UAAWo0B,YAAX,EAAyB52B,OAAzB,EAAmC;UAE9C42B,aAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6BgN,MAA7B,KAAwC1nC,SAA1C,IAAyD,CAAC0jC,aAAaz/B,MAAb,CAAoBy2B,QAApB,CAA6BgN,MAA7B,EAA/D,EACC,OAHoD;UAIhD56B,QAAQk6B,cAAb,EACCl6B,QAAQk6B,cAAR,CAAuBxpB,MAAvB,CAA+BkmB,YAA/B,EADD,KAEK,IAAK52B,QAAQu6B,UAAb,EACJv6B,QAAQu6B,UAAR,CAAmBQ,cAAnB,CAAmCnE,YAAnC;IAPF;QAkBKnF,cAAL;sBAWc/F,MAAb,EAAqBD,QAArB,EAA+C;aAAhBrY,QAAgB,uEAAL,EAAK;;aAE1C2jB,UAAJ,EAAgBJ,iBAAhB;aACMhkB,QAAQK,QAAML,KAApB;aAA2BsK,QAAQ,IAAItK,MAAMkN,OAAV,EAAnC;aAAwDwW,YAAY,EAApE;aACC7E,YAAY,IAAI7e,MAAMkjB,SAAV,EADb;aACoC71B,UAAUoT,SAASpT,OAAT,IAAoB,EADlE;mBAEUpE,MAAV,CAAiBo/B,MAAjB,CAAwBroC,SAAxB,GAAoCygB,SAASzgB,SAAT,KAAuBO,SAAvB,GAAmCkgB,SAASzgB,SAA5C,GAAwD,IAA5F;aAEK6+B,UAAUxF,eAAf,EAAiC;sBAKtBA,eAAV,CAA2B;yBAEhBP,QAFgB;uBAGlBC,MAHkB;6BAIZ1rB,QAAQ6rB,YAJI;gCAKT;aALlB;;gBAYMvuB,gBAAP,CAAyB,WAAzB,EAAsC,UAAWH,KAAX,EAAmB;gBAEnDq0B,UAAUV,MAAV,KAAqB59B,SAA1B,EAAsC;yBAE3B49B,MAAV,CAAiBkF,mBAAjB,CAAsC74B,KAAtC;;;oBAKOq0B,SAAR,CAAkBC,cAAlB,CAAiCF,eAAjC,CAAkD9F,QAAlD,EAA6D6K,gBAA7D,CAA+ErZ,KAA/E,EAAsF9f,KAAtF;sBAaU44B,aAAV,CAAyB9Y,KAAzB,EAAgCyO,MAAhC;yBAEa8F,UAAUiF,gBAAV,CAA4BJ,SAA5B,CAAb;gBACK,CAACU,UAAN,EACC;gBAEIA,WAAWvmC,MAAX,KAAsB,CAA3B,EAA+B;mBAEzBmmC,iBAAL,EAAyB;oCAEN/I,QAAlB,CAA2B4D,SAA3B,CAAqCyF,iBAArC;sCACoB/jC,SAApB;;aALF,MASO;mBAEAikC,YAAYJ,WAAW,CAAX,CAAlB;mBAAiC5/B,SAASggC,UAAUhgC,MAApD;sBACOy2B,QAAP,CAAgB4D,SAAhB,CAA0BwF,cAA1B,CAA0CG,SAA1C;mCACoBhgC,MAApB;;UAzCF,EAwEG,KAxEH;gBA6EOmG,gBAAP,CAAyB,aAAzB,EAAwC,UAAWH,KAAX,EAAmB;gBAErDq0B,cAAct+B,SAAnB,EACC;gBAEIs+B,UAAUV,MAAV,KAAqB59B,SAA1B,EAAsC;yBAE3B49B,MAAV,CAAiBmF,mBAAjB,CAAsC94B,KAAtC;;;gBAII45B,cAAgBA,WAAWvmC,MAAX,GAAoB,CAAzC,EAA+C;mBAExC2mC,YAAYJ,WAAW,CAAX,CAAlB;mBACKI,UAAUhgC,MAAV,CAAiBy2B,QAAjB,CAA0B4D,SAA/B,EAA2C;4BAEhCr6B,MAAV,CAAiBy2B,QAAjB,CAA0B4D,SAA1B,CAAoChvB,WAApC,CAAiD20B,SAAjD;sBACKn3B,WAAWA,QAAQk6B,cAAxB,EAAyCl6B,QAAQk6B,cAAR,CAAuBxpB,MAAvB,CAA+BymB,SAA/B;;;UAjB5C,EAuBG,KAvBH;kBAwBSG,kBAAT,CAA6BF,QAA7B,EAAwC;mBAASf,UAAUgB,QAAV,CAAoBD,QAApB,CAAP;;cAMrCsD,WAAL,GAAmB,UAAWtD,QAAX,EAAsB;gBAEnCA,SAASxJ,QAAT,CAAkBqN,eAAvB,EACC;gBACIzJ,UAAUV,MAAf,EAAwB;yBAEbA,MAAV,CAAiB4J,WAAjB,CAA8BtD,QAA9B;;;gBAIIE,mBAAoBF,QAApB,CAAL,EAAsC;uBAE7BtkB,KAAR,CAAe,yBAAyBskB,SAASztB,IAAlC,GAAyC,GAAxD;;;sBAIS5L,IAAV,CAAgBq5B,QAAhB;UAhBD;;;;yCAkCuB3L,QAhLzB,EAgLmC3sB,EAhLnC,EAgLwC;iBAEjCA,MAAM2sB,SAASpyB,UAApB;gBACMvK,QAAQ;yBAEHgQ,GAAGhQ,KAAH,CAASqM,QAFN;qBAGP2D,GAAGhQ,KAAH,CAASsM,IAHF;oBAIR0D,GAAGhQ,KAAH,CAASwM,GAJD;sBAKNwD,GAAGhQ,KAAH,CAAS4P,KALH;uBAMLI,GAAGhQ,KAAH,CAAS8P;aANlB;gBASCof,OAAOlf,GAAGqE,qBAAH,EATR;gBAUC/H,OAAOvL,KAAKC,KAAL,CAAYkuB,KAAK5iB,IAAjB,CAVR;gBAWCE,MAAMzL,KAAKC,KAAL,CAAYkuB,KAAK1iB,GAAjB,CAXP;gBAYC4hB,OAAO,IAAIlK,QAAML,KAAN,CAAYkN,OAAhB,EAZR;qBAaSuM,OAAT,CAAkBlP,IAAlB;mBACO;iCAEY,0BAAWD,KAAX,EAAkB9f,KAAlB,EAA0B;wBAErClB,CAAN,GAAYkB,MAAMnB,OAAN,GAAgBkhB,KAAKjhB,CAAvB,GAA6B,CAA7B,GAAiC,CAAjC,GAAuCb,OAAO8hB,KAAKjhB,CAAd,GAAoB,CAAnE;wBACME,CAAN,GAAU,EAAIgB,MAAMjB,OAAN,GAAgBghB,KAAK/gB,CAAzB,IAA+B,CAA/B,GAAmC,CAAnC,GAAyCb,MAAM4hB,KAAK/gB,CAAb,GAAmB,CAApE;;aALF;;;;;;AAsBJw0B,QAAQa,SAAR,GAAoB,IAAIqE,SAAJ,EAApB;;AC92CA;;;;;;;;;;;;AAgBA,IAiDMuC;AA+BL,gBAAarK,KAAb,EAAkC;OAAd3a,QAAc,uEAAL,EAAK;;;OAa5B,CAACA,SAASpT,OAAV,IAAqBoT,SAASknB,aAAnC,EAAmDlnB,SAASpT,OAAT,GAAmBoT,SAASknB,aAAT,CAAuBY,UAAvB,EAAnB;YAC1Cl7B,OAAT,GAAmBoT,SAASpT,OAAT,IAAoB,IAAI2wB,OAAJ,EAAvC;OACM3wB,UAAUoT,SAASpT,OAAzB;OACK,CAACA,QAAQ4wB,SAAd,EAA0B;cAEjB9d,KAAR,CAAe,qDAAf;;;OAkBI9S,QAAQi4B,MAAR,KAAmB,KAAxB,EAAgC;WAKxBkD,QAAR,GAAmBn7B,QAAQm7B,QAAR,IAAoB,KAAvC;OAYKn7B,QAAQi4B,MAAb,EAAsB;cAEbnlB,KAAR,CAAe,2BAAf;;;WAIOmlB,MAAR,GAAiB,IAAjB;YAES6B,YAAT,GAAwB1mB,SAAS0mB,YAAT,IAAyB,EAAjD;YAMSsB,aAAT,CAAwBh9B,KAAxB,EAAgC;cAEvBA,SAAS,CAAjB;UACMhJ,IAAIsK,MAAMsqB,OAAN,EAAV;aACOqR,eAAP,CAAwBtN,KAAxB,EAA+B,EAAE34B,GAAGA,CAAL,EAAQgJ,OAAOA,KAAf,EAAsB4B,SAASoT,SAASpT,OAAxC,EAA/B;YAEMs7B,QAAN,CAAgBl9B,KAAhB,EAAuB,CAAE4B,QAAQy5B,aAAR,CAAsB9vB,IAAtB,KAA+B,EAA/B,GAAoC,EAApC,GAAyC3J,QAAQy5B,aAAR,CAAsB9vB,IAAtB,GAA6B,IAAxE,IAAiFvU,CAAxG;UACKge,SAASgoB,aAAd,EAA8BhoB,SAASgoB,aAAT,CAAwBh9B,KAAxB,EAA+BhJ,CAA/B;UACzB4K,QAAQs6B,aAAb,EAA6Bt6B,QAAQs6B,aAAR,CAAsBiB,iBAAtB;;cAMlB,YAAY;;IAAxB,EAA8C,CAA9C;OAEIC,mBAAmB,CAAvB;OACM97B,QAAQ,IAAd;QAKKsqB,OAAL,GAAe,YAAY;UAEpByP,gBAAgBz5B,QAAQy5B,aAA9B;UAA6CrkC,IAAIqkC,cAAclkC,GAAd,GAAoBimC,mBAAmB/B,cAAcE,EAAtG;UACKtmC,MAAO+B,CAAP,CAAL,EAAkByd,QAAQC,KAAR,CAAe,2BAA2B1d,CAA1C;UACXqkC,cAAcjkC,GAAd,KAAsB,IAAxB,IAAoCJ,IAAIqkC,cAAcjkC,GAA3D,EACCqd,QAAQC,KAAR,CAAe,2BAA2B1d,CAA3B,GAA+B,uBAA/B,GAAyDqkC,cAAcjkC,GAAtF;UACMJ,IAAIqkC,cAAclkC,GAApB,IAA+BkkC,cAAcjkC,GAAd,KAAsB,IAA1D,EACCqd,QAAQC,KAAR,CAAe,2BAA2B1d,CAA3B,GAA+B,uBAA/B,GAAyDqkC,cAAclkC,GAAtF;aASMH,CAAP;IAhBD;QAwBK20B,OAAL,GAAe,UAAW30B,CAAX,EAAe;WAGxBqmC,WAAL,CAAkBvnC,SAAU,CAAEkB,IAAI4K,QAAQy5B,aAAR,CAAsBlkC,GAA5B,IAAoCyK,QAAQy5B,aAAR,CAAsBE,EAApE,CAAlB;IAHD;QAWK8B,WAAL,GAAmB,UAAWr9B,KAAX,EAAmB;UAEhCA,UAAUlL,SAAf,EAA2B;uBAEXsoC,gBAAf;;;cAIOtnC,SAAUkK,KAAV,CAAR;UAEK4B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAnC,EAA0C;aAGpC4I,SAAS4B,QAAQy5B,aAAR,CAAsBC,KAApC,EACCt7B,QAAQ,CAAR,CADD,KAEK,IAAKA,QAAQ,CAAb,EACJA,QAAQ4B,QAAQy5B,aAAR,CAAsBC,KAAtB,GAA8B,CAAtC;aAMI8B,mBAAmBx7B,QAAQy5B,aAAR,CAAsBC,KAA9C,EACC8B,mBAAmBx7B,QAAQy5B,aAAR,CAAsBC,KAAzC;;aAGM8B,qBAAqBp9B,KAA7B,EAAqC;aAE/Bo9B,mBAAmBp9B,KAAxB,EACCo9B,mBADD,KAEKA;uBACUA,gBAAf;;IA/BF;QAwCK1hB,IAAL,GAAY,YAAY;YAEjB2hB,WAAN,CAAmBD,mBAAmB,CAAtC;IAFD;QASKrc,IAAL,GAAY,YAAY;YAEjBsc,WAAN,CAAmBD,mBAAmB,CAAtC;IAFD;QASKE,cAAL,GAAsB,UAAWtvB,UAAX,EAAwB;UAEtCA,WAAWjV,MAAX,KAAsBjE,SAAxB,IAAyCkZ,WAAWjV,MAAX,CAAkBwkC,QAAlB,KAA+BzoC,SAA7E,EACCkZ,WAAWjV,MAAX,CAAkBwkC,QAAlB,GAA6B37B,QAAQy5B,aAAR,CAAsBlkC,GAAnD;WAEIsc,WAAL,CAAiB9T,IAAjB,CAAuBqO,UAAvB;IALD;QAWKyF,WAAL,GAAmB,EAAnB;OACI+pB,UAAU,KAAd;OAAqBC,IAArB;OAA2BC,QAA3B;YAESC,iBAAT,GAA6B;cAGpB9D,MAAR,CAAepmB,WAAf,CAA2BjhB,OAA3B,CAAoC,UAAWwb,UAAX,EAAwB;aAAOA,WAAW4vB,mBAAhB,EAAsC5vB,WAAW4vB,mBAAX,CAAgCJ,OAAhC;OAApG;;YAIQK,IAAT,GAAgB;UAIZT,qBAAqB,CAAC,CAAxB,IAEGA,qBAAqBx7B,QAAQy5B,aAAR,CAAsBC,KAA7C,IACE15B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAJlC,EAME;4BAEkB,CAAnB;;oBAGcgmC,gBAAf;;YAIQU,KAAT,GAAiB;gBAEN,KAAV;;aAGOhpC,SAAP;;YAGQipC,QAAT,GAAoB;aAGZn8B,QAAQy5B,aAAR,CAAsBG,MAA7B;;YAIQwC,QAAT,GAAoB;;UAIZp8B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAhC,IAA0CgmC,oBAAoBx7B,QAAQy5B,aAAR,CAAsBC,KAAzF,EAAiG;aAE3FyC,UAAL,EACCX,mBAAmB,CAAnB,CADD,KAEK;+BAOex7B,QAAQy5B,aAAR,CAAsBC,KAAtB,GAA8B,CAAjD;;;;;;;QAgBE2C,YAAL,GAAoB,YAAY;UAE1BT,OAAL,EAAe;;;;gBAOL,IAAV;UAEO57B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAhC,IAA4CgmC,oBAAsBx7B,QAAQy5B,aAAR,CAAsBC,KAAtB,GAA8B,CAArG,EACC8B,mBAAmB,CAAnB,CAZ8B;;;eAgBtBv6B,IAAT,CAAeq7B,SAAf,EAA2B;aAErBV,OAAL,EACC/sC,OAAO4X,qBAAP,CAA8BxF,IAA9B,EADD,KAEK46B,OAAO3oC,SAAP;aAEA2oC,SAAS3oC,SAAd,EAA0B;mBAElBopC,SAAP;uBAEWT,OAAO,OAAO77B,QAAQy5B,aAAR,CAAsBI,QAA/C;;aAGIxmC,MAAOyoC,QAAP,KAAuBA,aAAa5b,QAAzC,EAAsD;oBAE7CpN,KAAR,CAAe,gCAAgCgpB,QAA/C;sBACU,KAAV;;aAIIQ,YAAYR,QAAjB,EACC;gBACOQ,YAAYR,QAApB;wBACa,OAAO97B,QAAQy5B,aAAR,CAAsBI,QAAzC;UAvByB;;;aA4BpBpzB,qBAAP,CAA8BxF,IAA9B;IA5CD;QAmDK24B,MAAL,GAAc,YAAY;cAEjBH,aAAR,CAAsBG,MAAtB,GAA+B,CAAC55B,QAAQy5B,aAAR,CAAsBG,MAAtD;WACK2C,cAAL,CAAqBv8B,QAAQy5B,aAAR,CAAsBG,MAA3C;IAHD;QAcK4C,WAAL,GAAmB,YAAY;aAASppB,QAAP;IAAjC;QAIKqpB,mBAAL,GAA2B,YAAY;aAASjB,gBAAP;IAAzC;QAOKe,cAAL,GAAsB,UAAWxmC,KAAX,EAAmB;cAGhC0jC,aAAR,CAAsBG,MAAtB,GAA+B7jC,KAA/B;WACK8b,WAAL,CAAiBjhB,OAAjB,CAA0B,UAAWwb,UAAX,EAAwB;aAAOA,WAAWmwB,cAAhB,EAAiCnwB,WAAWmwB,cAAX;OAArF;IAJD;YASS/I,OAAT,CAAkB53B,MAAlB,EAA2B;eAEjBA,UAAU,EAAnB;UACM2X,OAAO;iBAEJ,QAFI;sBAGC,uBAHD;cAKP,KALO;cAMP,KANO;aAOR,MAPQ;kBAQH,qBARG;gBAUL,QAVK;qBAWA,qBAXA;mBAaF,MAbE;wBAcG,kDAdH;eAgBN,MAhBM;wBAkBG,SAlBH;uBAmBE;OAnBf;UAuBMC,gBAAgB5X,OAAO6X,eAAP,KAA2BvgB,SAA3B,GAAuC,IAAvC;QACnB0I,OAAO6X,eAAP,EADH;cAESD,aAAT;cAEM,IAAL;iBAEMykB,MAAL,GAAc,eAAd;iBACKyE,WAAL,GAAmB,uBAAnB;iBAEKnnC,GAAL,GAAW,SAAX;iBACKC,GAAL,GAAW,UAAX;iBACKmkC,EAAL,GAAU,KAAV;iBACKgD,OAAL,GAAe,sBAAf;iBAEKjD,KAAL,GAAa,OAAb;iBACKkD,UAAL,GAAkB,iCAAlB;iBAEK/C,QAAL,GAAgB,MAAhB,EACCtmB,KAAKspB,aAAL,GAAqB,kCADtB;iBAGKhB,IAAL,GAAY,OAAZ;iBAEK1H,aAAL,GAAqB,cAArB;iBACKC,YAAL,GAAoB,oDAApB;;;gBAIOx4B,OAAO2X,IAAP,KAAgBrgB,SAAlB,IAAmC0I,OAAO2X,IAAP,CAAYC,aAAZ,IAA6BA,aAArE,EACC;mBAEMliB,IAAP,CAAasK,OAAO2X,IAApB,EAA2B3iB,OAA3B,CAAoC,UAAWa,GAAX,EAAiB;mBAE/CgiC,MAAMhiC,GAAN,MAAeyB,SAApB,EACC;qBACKzB,GAAN,IAAamK,OAAO2X,IAAP,CAAY9hB,GAAZ,CAAb;aAJD;;aASK8hB,IAAP;;OAMKA,OAAO;kBAEA,GAFA;uBAGK,gCAHL;kBAIA,GAJA;uBAKK,4BALL;kBAMA,GANA;iBAOD,MAPC;aAQL,IARK;kBASA,OATA;cAUJ,GAVI;gBAWF,gBAXE;iBAYD,iBAZC;uBAaK,eAbL;qBAcG,gBAdH;YAeN,MAfM;kBAgBA,cAhBA;oBAiBE;IAjBf;YAoBSupB,YAAT,CAAuBrpB,eAAvB,EAAyC;cAC/BA,iBAAT;cAEM,IAAL;iBACMspB,eAAL,GAAuB,YAAvB,CADD;iBAEMC,SAAL,GAAiB,WAAjB,CAFD;iBAGMC,eAAL,GAAuB,aAAvB,CAHD;iBAIMC,UAAL,GAAkB,OAAlB,CAJD;iBAKMC,QAAL,GAAgB,wBAAhB;iBACKC,SAAL,GAAiB,gCAAjB;iBACKC,eAAL,GAAuB,gBAAvB;iBACK3J,aAAL,GAAqB,gBAArB;iBACK4J,IAAL,GAAY,MAAZ;iBACKC,UAAL,GAAkB,eAAlB;iBACKC,YAAL,GAAoB,aAApB;;;;QAkBEV,YAAL,GAAoB,YAA0D;UAA/CrpB,eAA+C,uEAA7B,YAAW;gBAAS,IAAP;OAAgB;mBAE/DA,eAAd;aACOF,IAAP;IAHD;QAOKkqB,cAAL;;sBAOc/xB,GAAb,EAAmB;;aAGZusB,SAASj4B,QAAQi4B,MAAvB;aAA+BxkB,kBAAkBzT,QAAQyT,eAAzD;eAEM/H,OAAO1L,QAAQ+S,GAAR,CAAYrH,GAAzB;aACK,CAACA,GAAD,IAAQ1L,QAAQ+S,GAAR,CAAY2qB,cAAZ,KAA+B,KAA5C,EAAoD;wHAE5C,EAF4C;;;sBAOtCjqB,eAAd;kBAESO,SAAT,CAAoB9kB,SAApB,EAA+B6iB,KAA/B,EAAsCC,OAAtC,EAAgD;gBAEzCzB,SAASxhB,SAASC,aAAT,CAAwB,MAAxB,CAAf;mBACOE,SAAP,GAAmBA,SAAnB;mBACO6iB,KAAP,GAAeA,KAAf;mBACOjjB,KAAP,CAAamjB,MAAb,GAAsB,SAAtB;mBACOnjB,KAAP,CAAayjB,MAAb,GAAsB,SAAtB;mBACOP,OAAP,GAAiBA,OAAjB;mBACOzB,MAAP;;aAIGotB,SAAJ,EAAeC,YAAf,EAA6BC,kBAA7B,EAAiDC,oBAAjD,CA3BkB;aA4BZC,WAAW,kBAAjB;aAAqCC,UAAU,kBAA/C,CA5BkB;qHA8BX;sBAEI,CAFJ;sBAGI,kBAAW1qB,gBAAX,EAA8B;mBAEnCS,UAAU,EAAd;wBACSgoB,iBAAT,CAA4B7sC,SAA5B,EAAuC6iB,KAAvC,EAA+C;0BAEtCksB,UAAR,CAAmB/uC,SAAnB,GAA+BA,SAA/B;0BACQ+uC,UAAR,CAAmBlsB,KAAnB,GAA2BA,KAA3B;;oCAGoBgqB,iBAArB;uBAEQmC,UAAR,GAAqBlqB,UAAWT,KAAK4qB,UAAhB,EAA4B5qB,KAAKwpB,eAAjC,EAAkD9E,OAAO9Y,IAAzD,CAArB;uBACQ8e,UAAR,GAAqBjqB,UAAW4nB,UAAUroB,KAAK2oB,KAAf,GAAuB3oB,KAAK6qB,UAAvC,EACpBxC,UAAUroB,KAAK2pB,UAAf,GAA4B3pB,KAAKypB,SADb,EACwB/E,OAAOoE,YAD/B,CAArB;mBAGKpE,OAAOuE,WAAP,GAAqBx8B,OAArB,CAA6By5B,aAA7B,CAA2CjkC,GAA3C,KAAmD,IAAxD,EAA+D;sBAIrD6oC,mBAJqD,GAI9D,SAASA,mBAAT,CAA8BlC,QAA9B,EAAyC;yBAEpCpqB,KAAJ,EAAWziB,KAAX;yBACK6sC,QAAL,EAAgB;gCAEP5oB,KAAK6pB,SAAb;gCACQW,QAAR;sBAHD,MAKO;gCAEExqB,KAAK4pB,QAAb;gCACQa,OAAR;;yBAIIjqB,QAAQuqB,YAAR,CAAqBvsB,KAArB,KAA+BA,KAApC,EACC,OAhBuC;6BAkBhCusB,YAAR,CAAqBvsB,KAArB,GAA6BA,KAA7B;6BACQusB,YAAR,CAAqBxvC,KAArB,CAA2BQ,KAA3B,GAAmCA,KAAnC;4BAEOitC,cAAP,CAAuBJ,QAAvB;mBAzB6D;sBA6BrDvC,MA7BqD,GA6B9D,SAASA,MAAT,CAAiB7jC,KAAjB,EAAyB;yCAEHge,QAAQuqB,YAAR,CAAqBvsB,KAArB,KAA+BwB,KAAK4pB,QAAzD;mBA/B6D;yCA4BvCkB,mBAAvB;sBAOItsB,KAAJ,EAAWziB,KAAX;sBACK2oC,OAAOuE,WAAP,GAAqB5C,MAA1B,EAAmC;6BAE1BrmB,KAAK6pB,SAAb;6BACQW,QAAR;mBAHD,MAKO;6BAEExqB,KAAK4pB,QAAb;6BACQa,OAAR;;0BAGOM,YAAR,GAAuBtqB,UAAWT,KAAKqmB,MAAhB,EAAwB7nB,KAAxB,EAA+B6nB,MAA/B,CAAvB;0BACQ0E,YAAR,CAAqBxvC,KAArB,CAA2BQ,KAA3B,GAAmCA,KAAnC;;uBAGOivC,UAAR,GAAqBvqB,UAAWT,KAAKirB,UAAhB,EAA4BjrB,KAAK0pB,eAAjC,EAAkDhF,OAAOne,IAAzD,CAArB;sBAQO/F,OAAP;;UA3GgB,EA+Gf,UA/Ge;gBAgHX0pB,cAAP;gBACKlqB,IAAL,GAAYA,IAAZ;gBAOKyoB,mBAAL,GAA2B,UAAWJ,OAAX,EAAqB;gBAE3CjyB,IAAJ,EAAUoI,KAAV;gBACK6pB,OAAL,EAAe;sBAEProB,KAAK2oB,KAAZ;uBACQ3oB,KAAK2pB,UAAb;aAHD,MAKO;sBAEC3pB,KAAK6qB,UAAZ;uBACQ7qB,KAAKypB,SAAb;;+BAGmBrzB,IAApB,EAA0BoI,KAA1B,EAAiC,IAAjC;UAdD;gBAoBKwqB,cAAL,GAAsB,YAAY;iCAGXtE,OAAOuE,WAAP,GAAqBx8B,OAArB,CAA6By5B,aAA7B,CAA2CG,MAAjE;UAHD;gBAMO8B,cAAP;gBAIKhiC,QAAL,GAAgB,UAAW3D,KAAX,EAAmB;iBAE7B8P,WAAL,CAAiBxM,UAAjB,CAA4BqR,UAA5B,CAAuC,CAAvC,EAA0C3U,KAA1C,GAAkDA,KAAlD;UAFD;aAMM0oC,YAAY/yB,IAAIM,GAAJ,QAAlB;mBAEU/J,qBAAV,GAAkC,IAAlC;;;;;8BAGe2D,aAxKjB,EAwKiC;iBAE1BC,WAAL,GAAmBD,aAAnB;iBAEKC,WAAL,CAAiBrM,QAAjB,CAA2B,UAAWzD,KAAX,EAAmB;uBAAUkiC,MAAR,CAAelO,OAAf,CAAwBh0B,KAAxB,EAAF;aAA9C;iBACK8P,WAAL,CAAiBxM,UAAjB,CAA4B0Y,KAA5B,GAAoC,KAAKwB,IAAL,CAAU8pB,eAA9C;UA7KF;gCAgLkB;mBAAS,KAAKx3B,WAAZ;;;;KAhLgBgM,cAAYlM,gBAAhD;QAwLK+F,GAAL,GAAW,UAAWoB,MAAX,EAAoB;UASxBmd,SAASjqB,QAAQ+S,GAAR,CAAYkX,MAA3B;UACCgQ,aAAaj6B,QAAQ+S,GAAR,CAAYwhB,aAAZ,CAA2B,QAA3B,CADd;UAEC9gB,kBAAkBzT,QAAQyT,eAF3B;UAGCV,MAAMC,QAAMD,GAHb,CAT8B;eAcrBjG,UAAU9M,QAAQ+S,GAAR,CAAYrH,GAA/B;UACK,CAACoB,MAAD,IAAW9M,QAAQ+S,GAAR,CAAY2rB,SAAZ,KAA0B,KAA1C,EACC;eAEQC,KAAT,GAAiB;aAMX3+B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAnC,EAA0CwK,QAAQy5B,aAAR,CAAsBE,EAAtB,GAA2B35B,QAAQy5B,aAAR,CAAsBE,EAAtB,IAA4B,GAAvD,CAA1C,KACK35B,QAAQy5B,aAAR,CAAsBE,EAAtB,GAA2B,CAAE35B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,GAA4BwK,QAAQy5B,aAAR,CAAsBlkC,GAApD,KAA8DyK,QAAQy5B,aAAR,CAAsBC,KAAtB,GAA8B,CAA5F,CAA3B;;eAIGkF,WAAT,GAAuB;;gBAOfzU,SAAP,CAAkB8P,UAAlB,EAA8Bj6B,QAAQy5B,aAAtC;aACKrmB,SAASyrB,cAAd,EAA+BzrB,SAASyrB,cAAT,CAAyB7+B,QAAQy5B,aAAjC;;eAIvBqF,MAAT,GAAkB;aAEZ9+B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAnC,EACCwK,QAAQy5B,aAAR,CAAsBjkC,GAAtB,GAA4BwK,QAAQy5B,aAAR,CAAsBlkC,GAAtB,GAA4ByK,QAAQy5B,aAAR,CAAsBE,EAAtB,IAA6B35B,QAAQy5B,aAAR,CAAsBC,KAAtB,GAA8B,CAA3D,CAAxD;;;UAKIqF,cAAc10B,KAAKC,KAAL,CAAYD,KAAKe,SAAL,CAAgBpL,QAAQy5B,aAAxB,CAAZ,CAApB;UACClmB,OAAOigB,QAAS;0BAEE/f;OAFX,CADR;aAMO+gB,MAAP,CAAeuK,WAAf;UAKMvpC,MAAMwK,QAAQy5B,aAAR,CAAsBjkC,GAAlC;UAAuCkkC,QAAQ15B,QAAQy5B,aAAR,CAAsBC,KAArE;aACOnP,SAAP,CAAkB0P,UAAlB,EAA8Bj6B,QAAQy5B,aAAtC,EAAqDz5B,QAAQy5B,aAA7D;UACOjkC,QAAQ,IAAV,IAAsBA,QAAQ0qB,QAA9B;cAEMuZ,aAAR,CAAsBjkC,GAAtB,KAA8B,IAFjC;QAGE;oBAMOikC,aAAR,CAAsBjkC,GAAtB,GAA4BA,GAA5B;oBACQikC,aAAR,CAAsBC,KAAtB,GAA8BA,KAA9B;;UAIKsF,UAAUlyB,OAAOJ,SAAP,CAAkB6G,KAAK0kB,MAAvB,CAAhB;UACIhD,kBAAJ,CAAwB+J,OAAxB,EAAiCzrB,KAAK0kB,MAAtC,EAA8C1kB,KAAKmpB,WAAnD;eAESnnB,KAAT,GAAiB;aAGV0pB,OAAOj/B,QAAQy5B,aAArB;aACCyF,mBAAmB,EADpB;kBAESltB,OAAT,CAAkBsB,gBAAlB,EAAoC6rB,MAApC,EAA6C;gBAExCzrB,OAAOJ,iBAAiBlH,UAAjB,CAA4BvS,QAA5B,EAAX;iBAEKtE,GAAL,GAAW4pC,OAAQF,KAAK1pC,GAAb,EAAkBme,IAAlB,CAAX;6BACiBne,GAAjB,CAAqBmE,QAArB,CAA+BulC,KAAK1pC,GAApC;gBACK0pC,KAAKzpC,GAAV,EAAgB;oBAEVA,GAAL,GAAW2pC,OAAQF,KAAKzpC,GAAb,EAAkBke,IAAlB,CAAX;;gCAEiBle,GAAjB,CAAqBkE,QAArB,CAA+BulC,KAAKzpC,GAApC;;;;0BAQesX,MAAjB,GAA0BkyB,QAAQtyB,SAAR,CAAmBuyB,KAAKt1B,IAAL,KAAc,EAAd,GAAmBs1B,KAAKt1B,IAAxB,GAA+B4J,KAAKsoB,IAAvD,CAA1B;0BAEiBuD,eAAjB,GAAmCF,iBAAiBpyB,MAAjB,CAAwBd,GAAxB,CAA6B,IAAImH,eAAJ,CAAqBnB,OAArB,EAC/D,EAAEoB,UAAUA,SAASpT,OAAT,CAAiBy5B,aAA7B,EAA4ChmB,iBAAiBA,eAA7D,EAD+D,CAA7B,EACkDja,QADlD,CAC4D,UAAWzD,KAAX,EAAmB;iBAE3Gsd,cAAL,GAAsBtd,KAAtB;;UAHiC,CAAnC;aAQMspC,qBAAqB,IAAInrB,kBAAJ,CAAwB,UAAWK,KAAX,EAAmB;oBAE5D8qB,kBAAT,EAA6B,UAAWtpC,KAAX,EAAkB2d,IAAlB,EAAyB;wBAE5Ca,KAAT,CAFqD;sBAG9Cxe,KAAP;aAHD;UAF0B,EASxB,EAAEqd,UAAUA,SAASpT,OAAT,CAAiBy5B,aAA7B,EAA4ChmB,iBAAiBA,eAA7D,EATwB,CAA3B;0BAUiB4rB,kBAAjB,GAAsCH,iBAAiBpyB,MAAjB,CAAwBd,GAAxB,CAA6BqzB,kBAA7B,EAAkD7lC,QAAlD,CAA4D,UAAWzD,KAAX,EAAmB;iBAE/GgJ,MAAL,GAAchJ,KAAd;;UAFqC,CAAtC;0BAQiBR,GAAjB,GAAuBwd,IAAIoiB,kBAAJ,CAAwB+J,iBAAiBpyB,MAAzC,EAAiDmyB,IAAjD,EAAuD,KAAvD,EAA8D,UAAWlpC,KAAX,EAAmB;;UAAjF,CAAvB;aACIg/B,sBAAJ,CAA4BmK,iBAAiB3pC,GAA7C,EAAkDge,KAAKhe,GAAvD;;aAMK0pC,KAAKzpC,GAAL,KAAa,IAAlB,EAAyB;6BAEPA,GAAjB,GAAuBud,IAAIoiB,kBAAJ,CAAwB+J,iBAAiBpyB,MAAzC,EAAiDmyB,IAAjD,EAAuD,KAAvD,EAA8D,UAAWlpC,KAAX,EAAmB;;aAAjF,CAAvB;gBACIg/B,sBAAJ,CAA4BmK,iBAAiB1pC,GAA7C,EAAkD+d,KAAK/d,GAAvD;UAHD,MAKO;6BAGWmkC,EAAjB,GAAsB5mB,IAAIoiB,kBAAJ,CAAwB+J,iBAAiBpyB,MAAzC,EAAiDmyB,IAAjD,EAAuD,IAAvD,EAA6D,UAAWlpC,KAAX,EAAmB;;aAAhF,CAAtB;gBACIg/B,sBAAJ,CAA4BmK,iBAAiBvF,EAA7C,EAAiDpmB,KAAKomB,EAAtD,EAA0DpmB,KAAKopB,OAA/D;;aAKIsC,KAAKvF,KAAV,EAAkB;6BAEAA,KAAjB,GAAyBwF,iBAAiBpyB,MAAjB,CAAwBd,GAAxB,CAA6BizB,IAA7B,EAAmC,OAAnC,EAA6CzlC,QAA7C,CAAuD,UAAWzD,KAAX,EAAmB;oBAE7F2jC,KAAL,GAAaxlC,SAAU+qC,KAAKvF,KAAf,CAAb;;mBAEM4F,WAAWC,kBAAjB;mBAEKD,QAAL,EAAgBA,SAAS9pC,GAAT,GAAewK,QAAQy5B,aAAR,CAAsBC,KAAtB,GAA8B,CAA7C;aANQ,CAAzB;gBASI3E,sBAAJ,CAA4BmK,iBAAiBxF,KAA7C,EAAoDuF,KAAKO,SAAL,KAAmBtsC,SAAnB,GAA+BqgB,KAAKmmB,KAApC,GAA4CuF,KAAKO,SAArG,EACCP,KAAKrC,UAAL,KAAoB1pC,SAApB,GAAgCqgB,KAAKqpB,UAArC,GAAkDqC,KAAKrC,UADxD;;0BAMgB/C,QAAjB,GAA4BqF,iBAAiBpyB,MAAjB,CAAwBd,GAAxB,CAA6BoH,SAASpT,OAAT,CAAiBy5B,aAA9C,mBAA6E,UAA7E,EAAyF,CAAzF,EAA4F,EAA5F,EAAgG,CAAhG,EAAoGjgC,QAApG,CAA8G,UAAWzD,KAAX,EAAmB;;UAAjI,CAA5B;aAKIg/B,sBAAJ,CAA4BmK,iBAAiBrF,QAA7C,EAAuDtmB,KAAKsmB,QAA5D,EAAsEtmB,KAAKspB,aAA3E;aAGI9H,sBAAJ,CAA4BmK,iBAAiBpyB,MAAjB,CAAwBd,GAAxB,CAA6B;sBAE9C,kBAAWjW,KAAX,EAAmB;oBAEvBsd,cAAL,GAAsB0rB,YAAY1rB,cAAlC;gCACiB+rB,eAAjB,CAAiC1lC,QAAjC,CAA2CulC,KAAK5rB,cAAhD;oBAEKtU,MAAL,GAAcggC,YAAYhgC,MAA1B;gCACiBsgC,kBAAjB,CAAoC3lC,QAApC,CAA8CulC,KAAKlgC,MAAnD;oBAEKxJ,GAAL,GAAWwpC,YAAYxpC,GAAvB;gCACiBA,GAAjB,CAAqBmE,QAArB,CAA+BulC,KAAK1pC,GAApC;mBAEK2pC,iBAAiB1pC,GAAtB,EAA4B;uBAEtBA,GAAL,GAAWupC,YAAYvpC,GAAvB;;mCAEiBA,GAAjB,CAAqBkE,QAArB,CAA+BulC,KAAKzpC,GAApC;;mBAII0pC,iBAAiBvF,EAAtB,EAA2B;uBAErBA,EAAL,GAAUoF,YAAYpF,EAAtB;mCACiBA,EAAjB,CAAoBjgC,QAApB,CAA8BulC,KAAKtF,EAAnC;;mBAIIoF,YAAYrF,KAAjB,EAAyB;uBAEnBA,KAAL,GAAaqF,YAAYrF,KAAzB;sBAMKwF,iBAAiBxF,KAAtB,EACCwF,iBAAiBxF,KAAjB,CAAuBhgC,QAAvB,CAAiCulC,KAAKvF,KAAtC;;oBAIGG,QAAL,GAAgBkF,YAAYlF,QAA5B;gCACiBA,QAAjB,CAA0BngC,QAA1B,CAAoCulC,KAAKpF,QAAzC;;;UA1C0B,EAgDzB,UAhDyB,CAA5B,EAgDiBtmB,KAAK4gB,aAhDtB,EAgDqC5gB,KAAK6gB,YAhD1C;;;IAhLF;OAuOIrC,WAAJ;QAaKyD,oBAAL,GAA4B,UAAW5J,UAAX,EAAsE;UAA/CnY,eAA+C,uEAA7B,YAAW;gBAAS,IAAP;OAAgB;oBAEnFmY,UAAd;UAGMqM,SAAS,IAAf;UAAqBtC,OAAO/J,WAAW+J,IAAvC;UAA6CpiB,OAAO0kB,OAAO6E,YAAP,CAAqBrpB,eAArB,CAApD;WAGK1V,IAAL,CAAW;eAEJwV,KAAK4qB,UAFD;gBAGH5qB,KAAKwpB,eAHF;kBAID,iBAAW5/B,KAAX,EAAmB;mBAASgiB,IAAP;;OAJ/B;WASKphB,IAAL,CAAW;eAEJ69B,UAAUroB,KAAK2oB,KAAf,GAAuB3oB,KAAK6qB,UAFxB;gBAGHxC,UAAUroB,KAAK2pB,UAAf,GAA4B3pB,KAAKypB,SAH9B;aAIN,gBAJM;kBAKD,iBAAW7/B,KAAX,EAAmB;mBAEpBk/B,YAAP;;OAPF;UAcKr8B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAnC,EAA0C;cAGpCuI,IAAL,CAAW;kBAEJwV,KAAKqmB,MAFD;mBAGH,KAAK4C,WAAL,GAAmB5C,MAAnB,GAA4BrmB,KAAK6pB,SAAjC,GAA6C7pB,KAAK4pB,QAH/C;gBAIN,kBAJM;qBAKD,iBAAWhgC,KAAX,EAAmB;sBAASy8B,MAAP;;UAL/B;;WAYI77B,IAAL,CAAW;eAEJwV,KAAKirB,UAFD;gBAGHjrB,KAAK0pB,eAHF;kBAID,iBAAW9/B,KAAX,EAAmB;mBAAS2c,IAAP;;OAJ/B;WAQKjI,WAAL,CAAiB9T,IAAjB,CAAuB;8BAOD,6BAAW69B,OAAX,EAAqB;gBAErCjyB,IAAJ,EAAUoI,KAAV;gBACK6pB,OAAL,EAAe;sBAEProB,KAAK2oB,KAAZ;uBACQ3oB,KAAK2pB,UAAb;aAHD,MAKO;sBAEC3pB,KAAK6qB,UAAZ;uBACQ7qB,KAAKypB,SAAb;;gBAGKyC,mBAAmB7T,WAAW8T,aAAX,CAA0B,iBAA1B,CAAzB;6BACiBxwC,SAAjB,GAA6Bya,IAA7B;6BACiBoI,KAAjB,GAAyBA,KAAzB;UAvBqB;yBA8BN,0BAAY;uBAGhB2tB,aAAX,CAA0B,mBAA1B,EAAgD3tB,KAAhD,GAAwD/R,QAAQy5B,aAAR,CAAsBG,MAAtB,GAA+BrmB,KAAK6pB,SAApC,GAAgD7pB,KAAK4pB,QAA7G;;OAjCF;IAtDD;QAkGKwC,SAAL,GAAiB,YAAY;UAGvB3/B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAnC,EACC;kBAEWmgC,IAAZ,CAAiB53B,IAAjB,CAAuB;eAGhB,uCAAwCiC,QAAQy5B,aAAR,CAAsBC,KAAtB,GAA8B,CAAtE,IAA4E,iDAH5D;gBAIf;OAJR;IAND;YAgBS6F,gBAAT,GAA4B;UAAOxN,WAAL,EAAmB,OAAOA,YAAY2N,aAAZ,CAA2B,iBAA3B,CAAP;;QAM5CE,eAAL,GAAuB,YAAY;UAE5BN,WAAWC,kBAAjB;UACKD,QAAL,EAAgB;kBAENO,QAAT,GAAoB,UAAW1iC,KAAX,EAAmB;oBAASs+B,WAAP,CAAoBvnC,SAAUorC,SAASvpC,KAAnB,CAApB;UAAzC;kBACS+pC,OAAT,GAAmB,UAAW3iC,KAAX,EAAmB;oBAASs+B,WAAP,CAAoBvnC,SAAUorC,SAASvpC,KAAnB,CAApB;UAAxC;aAEIgqC,WAAJ;aACM9H,UAAS,IAAf;kBACS36B,gBAAT,CAA2B,aAA3B,EAA0C,aAAK;0BAAgB,IAAd;UAAjD;kBACSA,gBAAT,CAA2B,WAA3B,EAAwC,aAAK;0BAAgB,KAAd;UAA/C;kBACSA,gBAAT,CAA2B,WAA3B,EAAwC,aAAK;gBAEvC,CAACyiC,WAAN,EACC;oBAEMtE,WAAP,CAAoB,CAAEz7B,QAAQy5B,aAAR,CAAsBC,KAAtB,GAA8B,CAAhC,IAAsCx/B,EAAEqjB,OAAxC,GAAkD+hB,SAAShjB,WAA/E;UALD;;aAUMgjB,QAAP;IAtBD;QA+BKhE,QAAL,GAAgB,UAAWl9B,KAAX,EAAkB2T,KAAlB,EAA0B;UAEpC7b,QAAO,KAAKunC,cAAZ,MAA+B,QAApC,EAA+C,KAAKA,cAAL,CAAoB/jC,QAApB,CAA8B,KAAKswB,OAAL,EAA9B;UACzCsV,WAAWC,kBAAjB;UACKD,QAAL,EAAgB;kBAENvpC,KAAT,GAAiBqI,KAAjB;kBACS2T,KAAT,GAAiBA,KAAjB;;IAPF;QAiBKiuB,aAAL,GAAqB,UAAWzqB,KAAX,EAAmB;yBAEpB/f,GAAnB,GAAyB+f,MAAMmkB,KAAN,GAAc,CAAvC;WACK+B,WAAL,CAAkB,CAAlB;IAHD;;AAqBFrD,SAAO0B,YAAP;sBAKe;;UAEPmG,sBAAsB,EAAEC,QAAQ,KAAV,EAA5B;sBACiB;iBAEPD,oBAAoBC,MAFb;4BAAA,iCAGO;gBAEhB,OAAO,KAAKC,mBAAZ,KAAoC,WAAzC,EAAuD,OAAO,KAAKA,mBAAZ;mBAChD,KAAKC,gBAAZ;;OAPH;UAWI/xB,QAAJ;0BAEoBqH,QAApB,GAA+B,EAA/B;oBACcA,QAAd,GAAyB,EAAzB;UACI2qB,WAAW,KAAf;iBACY,KADZ,CAjBa;UAwBTC,kBAAJ;WAOKppC,GAAL,GAAW,UAAW8I,OAAX,EAAqB;aAE1B,CAACA,OAAD,IAAY,CAACqO,QAAlB,EACCwE,QAAQC,KAAR,CAAe,wCAAwC9S,OAAvD,EADD,KAEK,IAAKqO,YAAYrO,OAAZ,IAAuB,CAACxO,OAAOohB,EAAP,CAAWvE,QAAX,EAAqBrO,OAArB,CAA7B,EACJ6S,QAAQC,KAAR,CAAe,+CAAf;oBACUzE,YAAYrO,OAAvB;aAUK,CAACugC,cAAc7U,MAAf,IAAyB,CAACyP,QAA1B,IAAsC9sB,SAAS4pB,MAApD,EAA6D;gCAExCvM,MAApB,GAA6Brd,SAAS4pB,MAAT,CAAgBuE,WAAhB,GAA8B1C,YAA9B,CAA2CpO,MAAxE;gBACKuU,oBAAoBvU,MAAzB,EAAkC8U;uBACvB,IAAX;;aAGID,cAAc7U,MAAnB,EACC,OAAO6U,aAAP;OAxBF;WAgEK/jC,IAAL,GAAY,UAAWs9B,YAAX,EAAyB95B,OAAzB,EAA0D;aAAxBygC,cAAwB,uEAAP,IAAO;aAEhE,CAAC3G,YAAN,EAAqB;aAEhB,CAAC95B,OAAD,IAAY,CAACqO,QAAlB,EACCwE,QAAQC,KAAR,CAAe,yCAAyC9S,OAAxD,EADD,KAEK,IAAKqO,YAAYrO,OAAZ,IAAuB,CAACxO,OAAOohB,EAAP,CAAWvE,QAAX,EAAqBrO,OAArB,CAA7B,EACJ6S,QAAQC,KAAR,CAAe,gDAAf;oBACUzE,YAAYrO,OAAvB;aAcK85B,aAAa4G,SAAb,KAA2B,KAAhC,EAAwC;gBAElCL,QAAL,EACC,OAHsC;gBAOlCvG,aAAaoG,MAAb,KAAwBhtC,SAA7B,EAAyC;mCAEpBgtC,MAApB,GAA6BpG,aAAaoG,MAA1C;oCACqBpG,aAAaoG,MAAlC;;UAVF,MAcO,IAAKpG,aAAaoG,MAAb,KAAwB,IAA7B,EAAoC;gBAIrCG,QAAL,EAAgBxtB,QAAQiN,IAAR,CAAc,wDAAd;uBACL,IAAX;gBAEKwgB,uBAAuBptC,SAA5B,EACC+sC,oBAAoBC,MAApB,GAA6B,IAA7B,CARyC;UAApC,MAUA;6BAEaxU,MAApB,GAA6BuU,oBAAoBvU,MAApB,IAC5BoO,aAAapO,MADe,KAE1Brd,SAAS4pB,MAAT,GAAkB5pB,SAAS4pB,MAAT,CAAgBuE,WAAhB,GAA8B1C,YAA9B,CAA2CpO,MAA7D,GAAsEx4B,SAF5C,CAA7B;aAGK,CAAC+sC,oBAAoBvU,MAArB,IAA+B+U,cAApC,EAAqD;oBAE5C3tB,KAAR,CAAe,kEAAkEmtB,oBAAoBvU,MAArG;;;6BAImB0U,gBAApB,GAAuCH,oBAAoBG,gBAApB,IAAwCtG,aAAasG,gBAA5F;sBACa1qB,QAAb,GAAwBokB,aAAapkB,QAAb,IAAyB,EAAjD;6BACoBA,QAApB,CAA6B0Q,KAA7B,GAAqC6Z,oBAAoBvqB,QAApB,CAA6B0Q,KAA7B,IAAsC0T,aAAapkB,QAAb,CAAsB0Q,KAAjG;6BACoB1Q,QAApB,CAA6BirB,IAA7B,GAAoCV,oBAAoBvqB,QAApB,CAA6BirB,IAA7B,IAAqC7G,aAAapkB,QAAb,CAAsBirB,IAA/F;yBACiB7G,YAAjB;OA7DD;eAgES0G,eAAT,CAA0B1G,YAA1B,EAAyC;;aAInC,CAACA,YAAN,EACCA,eAAemG,mBAAf,CALuC;aAMnC,CAACM,cAAcK,OAApB,EAA8B;gBAExB9G,aAAaoG,MAAb,KAAwBhtC,SAA7B,EACCqtC,cAAcL,MAAd,GAAuBpG,aAAaoG,MAApC,CADD,KAEKK,cAAcL,MAAd,GAAuBD,oBAAoBC,MAA3C;;uBAIQxU,MAAd,GAAuBoO,aAAapO,MAAb,IAAuBuU,oBAAoBvU,MAAlE;uBAQc0U,gBAAd,GACCtG,aAAasG,gBAAb,IACAH,oBAAoBG,gBADpB,IAEAG,cAAcH,gBAFd,IAGA,IAAIztB,MAAMmC,OAAV,GAAoBU,IAApB,CAA0ByqB,oBAAoBvU,MAApB,CAA2BvwB,QAArD,CAJD;aAMK,CAAC2+B,aAAapkB,QAAnB,EAA8BokB,aAAapkB,QAAb,GAAwB,EAAxB;aACzBokB,aAAapkB,QAAb,CAAsB0Q,KAAtB,KAAgClzB,SAArC,EACCqtC,cAAc7qB,QAAd,CAAuB0Q,KAAvB,GAA+B0T,aAAapkB,QAAb,CAAsB0Q,KAArD,CADD,KAEKma,cAAc7qB,QAAd,CAAuB0Q,KAAvB,GAA+B6Z,oBAAoBvqB,QAApB,CAA6B0Q,KAA7B,IAAsC,CAArE;uBACS1Q,QAAd,CAAuBirB,IAAvB,GAA8B7G,aAAapkB,QAAb,CAAsBirB,IAAtB,IAA8BV,oBAAoBvqB,QAApB,CAA6BirB,IAA3D,IAAmE,IAAIhuB,MAAMmC,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAjG,CAhCwC;;WA+DpC+rB,YAAL,GAAoB,UAAWpJ,IAAX,EAAiBzlC,CAAjB,EAAqB;;aAKlC8nC,eAAezrB,SAASorB,aAAT,CAAuBK,YAAvB,CAAoC5iC,GAApC,EAArB;aAGMxE,OAAO,CAAC+kC,KAAK7J,QAAL,CAAcqK,MAAf,IAA2B,OAAOR,KAAK7J,QAAL,CAAcqK,MAAd,CAAqBC,UAA5B,KAA2C,UAAtE,GAAqF,EAArF,GAA0FT,KAAK7J,QAAL,CAAcqK,MAAd,CAAqBC,UAArB,CAAgClmC,CAAhC,CAAvG;aACK,CAACU,KAAKonC,YAAX,EACCpnC,KAAKonC,YAAL,GAAoB,EAAEoG,QAAQ,KAAV,EAApB;yBACgBxtC,KAAKonC,YAAtB;aAEKA,gBAAgBA,aAAaoG,MAAlC,EAA2C;gBAEpCjvC,SAASgkB,iBAAkBwiB,IAAlB,EAAwB,IAAI9kB,MAAMmC,OAAV,GAAoBC,SAApB,CAA+B0iB,KAAK/iB,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkC6Z,KAAjE,EAAwEhjB,IAAIylC,KAAK/iB,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkCyZ,QAA9G,CAAxB,CAAf;yBACa3jB,MAAb,GAAsBA,MAAtB;UAHD,MAKO,OAAO6oC,aAAa7oC,MAApB;OAlBR;WAyBKuvC,eAAL,GAAuB,UAAWxgC,OAAX,EAAqB;;aAKvC85B,eAAe95B,QAAQy5B,aAAR,CAAsBK,YAAtB,CAAmC5iC,GAAnC,CAAwC8I,OAAxC,CAAnB;aACK,CAAC85B,YAAN,EAAqBA,eAAeA,gBAAgB,EAA/B;aACfpO,SAASoO,aAAapO,MAA5B;aAEK,CAACA,MAAN,EACC,OAV0C;aAatC,CAACoO,aAAasG,gBAAnB,EACCtG,aAAasG,gBAAb,GAAgC,IAAIztB,MAAMmC,OAAV,GAAoBU,IAApB,CAA0BkW,OAAOvwB,QAAjC,CAAhC;aAEI,CAAC2+B,aAAaqG,mBAAnB,EACCrG,aAAaqG,mBAAb,GAAmC,IAAIxtB,MAAMmC,OAAV,EAAnC;aAGK1f,IAAI4K,QAAQ67B,IAAlB;aACCuE,mBAAmBtG,aAAasG,gBADjC;aAECD,sBAAsB,IAAIxtB,MAAMmC,OAAV,GAAoBU,IAApB,CAA0BskB,aAAaqG,mBAAvC,CAFvB;sBAGaA,mBAAb,CAAiCzb,GAAjC,CAEC0T,SAAOC,QAAP,CAAiB+H,gBAAjB,EAAmC,GAAnC,EAAwChrC,CAAxC,EAA2C4K,OAA3C,CAFD,EAGCo4B,SAAOC,QAAP,CAAiB+H,gBAAjB,EAAmC,GAAnC,EAAwChrC,CAAxC,EAA2C4K,OAA3C,CAHD,EAICo4B,SAAOC,QAAP,CAAiB+H,gBAAjB,EAAmC,GAAnC,EAAwChrC,CAAxC,EAA2C4K,OAA3C,CAJD;aASK,CAAC85B,aAAagH,iBAAnB,EACChH,aAAagH,iBAAb,GAAiC,gCAAkC;gBAE9D7vC,SAAS6oC,aAAa7oC,MAA1B;gBAIC,CAAC6oC,aAAaoG,MAAd;aAEEjvC,MAAD;yBACakvC,mBAAb,CAAiCY,MAAjC,CAAyCZ,mBAAzC,CAHD;cAKC;yBAAA;;gCAUkB3qB,IAApB,CAA0BskB,aAAaqG,mBAAvC;gBAEM/qC,IAAI4K,QAAQ67B,IAAlB;mBACO1gC,QAAP,CAAgBqa,IAAhB,CAAsBskB,aAAaqG,mBAAnC;mBACOhlC,QAAP,CAAgB6lC,cAAhB,CAAgClH,aAAapkB,QAAb,CAAsBirB,IAAtD,EAA4DvI,SAAOC,QAAP,CAAiByB,aAAapkB,QAA9B,EAAwC,OAAxC,EAAiDtgB,CAAjD,EAAoD4K,OAApD,CAA5D;gBACK,CAAC/O,MAAN,EAAe;mBAETmnC,SAAOiB,aAAZ,EAA4BpoC,SAASmnC,SAAOiB,aAAP,CAAqBpoC,MAA9B,CAA5B,KACK;;;;mBAQCkK,QAAP,CAAgB6Q,GAAhB,CAAqB/a,MAArB;mBACOuzB,MAAP,CAAevzB,MAAf;gBACK+O,QAAQq5B,aAAb,EAA6B;mBAEvB,CAACr5B,QAAQq5B,aAAR,CAAsBpoC,MAAtB,CAA6B8vC,MAA7B,CAAqC9vC,MAArC,CAAN,EAAsD;0BAE7CooC,aAAR,CAAsBpoC,MAAtB,CAA6BukB,IAA7B,CAAmCvkB,MAAnC;sBACK+O,QAAQihC,gBAAb,EACCjhC,QAAQihC,gBAAR,CAAyBC,SAAzB,CAAoCjwC,MAApC;;mBAGG+O,QAAQq5B,aAAR,CAAsB8H,UAA3B,EACCnhC,QAAQq5B,aAAR,CAAsB8H,UAAtB,CAAiCC,MAAjC,CAAwC,CAAxC,IAV2B;;UAvC9B;aAuEIphC,QAAQm6B,SAAb,EAAyBn6B,QAAQm6B,SAAR,CAAkBlX,MAAlB;OAxG1B;;;;AA2HFmV,SAAOC,QAAP,GAAkB,UAAWF,KAAX,EAAkBW,QAAlB,EAA4B1jC,CAA5B,EAA4C;OAAb4K,OAAa,uEAAL,EAAK;OAQzDtN,OAAOylC,MAAMW,QAAN,CAAX;OACM7oC,IAAI+P,QAAQ/P,CAAlB;OAAqBD,IAAIgQ,QAAQhQ,CAAjC;OAAoCqxC,qBAAqB3uC,IAArB,yCAAqBA,IAArB,CAApC;OACK,OAAO0C,CAAP,KAAa,WAAlB,EAAgCA,IAAI4K,QAAQy5B,aAAR,GAAwBz5B,QAAQy5B,aAAR,CAAsBlkC,GAA9C,GAAoD,CAAxD;WACvB8rC,WAAT;WAEM,WAAL;gBACQnuC,SAAP;WACI,QAAL;gBACQ,IAAIoE,QAAJ,CAAc,GAAd,EAAmB,GAAnB,EAAwB,GAAxB,EAA6B,YAAY5E,IAAzC,CAAP;WACI,UAAL;aACK;gBAEG4uC,MAAM5uC,KAAM0C,CAAN,EAASnF,CAAT,EAAYD,CAAZ,CAAZ;gBACKsxC,QAAQpuC,SAAb,EACC,MAAM,sBAAsBouC,GAA5B;mBACMA,GAAP;UALD,CAOE,OAAOpnC,CAAP,EAAW;oBAEJ4Y,KAAR,CAAe5Y,CAAf;kBACMA,CAAN;;;WAIG,QAAL;gBACQxH,IAAP;WACI,QAAL;aACMhC,MAAM6C,OAAN,CAAeb,IAAf,CAAL,EAA6B;gBA2BnB6uC,KA3BmB,GA2B5B,SAASA,KAAT,CAAgBvvC,CAAhB,EAAoB;mBAEd,OAAO/B,GAAE+B,CAAF,CAAP,KAAgB,UAArB,EACC,OAAO/B,GAAE+B,CAAF,EAAMoD,CAAN,EAASnF,EAAT,EAAYD,CAAZ,CAAP;mBACIC,GAAE+B,CAAF,aAAgB2gB,MAAMta,KAA3B,EACC,OAAOpI,GAAE+B,CAAF,CAAP;aAhC0B;gBAEvBU,KAAKlC,MAAL,KAAgB,CAArB,EAAyB;uBAEhBsiB,KAAR,CAAe,6BAA6BgmB,QAA7B,GAAwC,mBAAvD;;;gBAIK7oC,KAAIyC,IAAV;gBACCN,IAAIM,KAAKlC,MAAL,GAAc,CADnB;gBAECgF,MAAMwK,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAA9B,GAAqC0qB,QAArC,GAAgDlgB,QAAQy5B,aAAR,CAAsBjkC,GAF7E;gBAGCD,MAAMyK,QAAQy5B,aAAR,CAAsBlkC,GAH7B;gBAICisC,QAAQ,CAAEhsC,MAAMD,GAAR,IAAgBnD,CAJzB;gBAKIqvC,SAASlsC,GAAb;gBAAkBmsC,QAAQlsC,GAA1B;gBACCmsC,SAAS,CADV;gBACaC,QAAQxvC,CADrB;iBAEM,IAAIJ,IAAI,CAAd,EAAiBA,IAAIU,KAAKlC,MAA1B,EAAkCwB,GAAlC,EAAwC;mBAElCwvC,QAAQxvC,CAAR,GAAYuD,GAAZ,GAAkBH,CAAvB,EAA2B;2BAEjBpD,CAAT;0BACQA,IAAI,CAAZ;2BACSwvC,QAAQG,MAAR,GAAiBpsC,GAA1B;0BACQisC,QAAQI,KAAR,GAAgBrsC,GAAxB;;;gBAaG,OAAOtF,GAAE0xC,MAAF,CAAP,KAAqB,QAA1B,EAAqC;mBAE/B7I,aAAa,GAAlB,EAAwB;yBAEhByI,MAAOI,MAAP,CAAP;;mBAGIzrC,QAAOjG,GAAE0xC,MAAF,CAAP,MAAqB,QAA1B,EAAqC;uBAE9B,IAAI3vC,IAAI,CAAd,EAAiBA,IAAIU,KAAKlC,MAA1B,EAAkCwB,GAAlC,EAAuC;yBAEjCA,MAAQU,KAAKlC,MAAL,GAAc,CAA3B,EAAiC,OAAOP,GAAE+B,CAAF,EAAK3B,CAAZ;8BAExB2B,CAAT,CAAY4vC,QAAQ5vC,IAAI,CAAZ;8BACH/B,GAAE0xC,MAAF,EAAUvsC,CAAnB,CAAsBssC,QAAQzxC,GAAE2xC,KAAF,EAASxsC,CAAjB;yBACfqsC,UAAUrsC,CAAZ,IAAqBssC,QAAQtsC,CAAlC,EAAwC;4BAEnC6G,IAAI,CAAEhM,GAAE2xC,KAAF,EAASvxC,CAAT,GAAaJ,GAAE0xC,MAAF,EAAUtxC,CAAzB,KAAiCqxC,QAAQD,MAAzC,CAAR;4BACCtlC,IAAIlM,GAAE0xC,MAAF,EAAUtxC,CAAV,GAAc4L,IAAIwlC,MADvB;+BAEOxlC,IAAI7G,CAAJ,GAAQ+G,CAAf;;;0BAKM2W,KAAR,CAAe,wCAAf;;gBAjBD,MAoBO;0BAEEA,KAAR,CAAe,6BAA6BgmB,QAA7B,GAAwC,gBAAxC,GAA2D6I,MAA3D,GAAoE,YAApE,WAA4F1xC,GAAE0xC,MAAF,CAA5F,IAA0G,gBAAzH;;;;gBAMGC,SAASlvC,KAAKlC,MAAnB,EAA4BoxC,QAAQD,MAAR;gBACvB,OAAO1xC,GAAE2xC,KAAF,CAAP,KAAoB,QAAzB,EAAoC;mBAE9B9I,aAAa,GAAlB,EACC,OAAOyI,MAAOK,KAAP,CAAP;mBACI1rC,QAAOjG,GAAE2xC,KAAF,CAAP,MAAoB,QAAzB,EAAoC;0BAE3B9uB,KAAR,CAAe,6BAA6BgmB,QAA7B,GAAwC,gBAAxC,GAA2D8I,KAA3D,GAAmE,YAAnE,WAA2F3xC,GAAE2xC,KAAF,CAA3F,IAAwG,gBAAvH;;;;gBAME3lC,IAAI,CAAEhM,GAAE2xC,KAAF,IAAW3xC,GAAE0xC,MAAF,CAAb,KAA6BD,QAAQD,MAArC,CAAR;gBACCtlC,IAAIlM,GAAE0xC,MAAF,IAAY1lC,IAAIwlC,MADrB;gBAEKpuC,MAAO4I,CAAP,KAAc5I,MAAO8I,CAAP,CAAnB,EAAgC0W,QAAQC,KAAR,CAAe,kCAAkC7W,CAAlC,GAAsC,UAAtC,GAAmDE,CAAlE;mBACzBF,IAAI7G,CAAJ,GAAQ+G,CAAf;;aAGIzJ,KAAKA,IAAV,EACC,OAAOA,KAAKA,IAAL,YAAqB4E,QAArB,GAAgC5E,KAAKA,IAAL,CAAW0C,CAAX,EAAcnF,CAAd,EAAiBD,CAAjB,CAAhC,GAAuD0C,KAAKA,IAAnE;aACIomC,aAAa,GAAlB,EACCjmB,QAAQC,KAAR,CAAe,6BAA6BgmB,QAA7B,GAAwC,wBAAvD;gBACMpmC,IAAP;;iBAEQogB,KAAR,CAAe,4CAA4CgmB,QAA5C,GAAuD,MAAvD,GAAgEuI,WAA/E;;;CAlIH;AA8KAjJ,SAAOyJ,mBAAP,GAA6B,UAAWpK,IAAX,EAAiC;OAAhBrkB,QAAgB,uEAAL,EAAK;;OAIzDhe,IAAIge,SAAShe,CAAjB;OAAoB4K,UAAUoT,SAASpT,OAAT,IAAoB,EAAE+S,KAAK,KAAP,EAAlD,CAJ6D;OAWxD3d,MAAMlC,SAAX,EAAuBkC,IAAI4K,QAAQy5B,aAAR,CAAsBlkC,GAA1B;WAIfwiC,MAAR,CAAea,IAAf;OAGC,CAACnB,KAAK7J,QAAL,CAAcqK,MAAf,IACEj4B,WAAWA,QAAQm7B,QAAnB,IAA+B1D,KAAK7J,QAAL,CAAcqN,eAHhD,EAMC;OAIIxD,KAAK/iB,QAAV,EAAqB;aAEb+iB,KAAK/iB,QAAL,CAAcotB,cAArB;WACKptB,QAAL,CAAcotB,cAAd,GAA+B,IAA/B;;OAIIrK,KAAK7J,QAAL,CAAcqK,MAAd,CAAqBoD,eAA1B,EAA4C;UAWlC0G,WAXkC,GAW3C,SAASA,WAAT,CAAsBjJ,QAAtB,EAAiC;gBAExBrB,KAAK/hB,QAAL,CAAcojB,QAAd,IAA0B,CAAlC;iBAA2CpjB,QAAL,CAAcojB,QAAd,KAA2BjpC,KAAK0wB,EAAL,GAAU,CAArC;UACtC,OAAQkX,KAAK/hB,QAAL,CAAcojB,QAAd,IAA0BjpC,KAAK0wB,EAAL,GAAU,CAA5C;iBAAqD7K,QAAL,CAAcojB,QAAd,KAA2BjpC,KAAK0wB,EAAL,GAAU,CAArC;;OAdN;WAEtCqN,QAAL,CAAcqK,MAAd,CAAqBoD,eAArB,CAAsCjmC,CAAtC;kBAea,GAAb;kBACa,GAAb;kBACa,GAAb;;YAIQ4sC,aAAT,CAAwB/xC,CAAxB,EAA2BD,CAA3B,EAA+B;UAEzB,CAACynC,KAAK/iB,QAAX,EACC;UAEKC,aAAa8iB,KAAK/iB,QAAL,CAAcC,UAAjC;UACCujB,aAAaT,KAAK7J,QAAL,CAAcqK,MAAd,CAAqBC,UADnC;UAEKA,eAAehlC,SAApB,EACC;UACIkC,MAAMlC,SAAX,EACC2f,QAAQC,KAAR,CAAe,sBAAsB1d,CAArC;UAEGG,GAAJ,EAASC,GAAT;UACKwK,WAAaA,QAAQ+3B,MAAR,CAAexmB,CAAf,KAAqBre,SAAvC,EAAqD;eAE9C8M,QAAQ+3B,MAAR,CAAexmB,CAAf,CAAiBhc,GAAvB,CAA4BC,MAAMwK,QAAQ+3B,MAAR,CAAexmB,CAAf,CAAiB/b,GAAvB;OAF7B,MAIO;eAEAO,KAAN;eACMP,MAAM,CAAZ;;;iBAMY0iC,WAAWlmC,CAAX,CA1BiB;uBA0BY,KA1BZ;kBA2BpBiwC,WAAT,CAAsBnJ,QAAtB,EAAgCoJ,MAAhC,EAAyC;gBAEpCnsC,QAAQqiC,SAAOC,QAAP,CAAiBF,KAAjB,EAAwBW,QAAxB,EAAkC1jC,CAAlC,EAAqC4K,OAArC,CAAZ,CAFwC;gBAGnCjK,UAAU7C,SAAf,EAA2B;0BAEfiI,QAAX,CAAoB+mC,MAApB,EAA6BlwC,CAA7B,EAAgC+D,KAAhC;6BACc,IAAd;;;qBAKW,GAAb,EAAkB,MAAlB;qBACa,GAAb,EAAkB,MAAlB;qBACa,GAAb,EAAkB,MAAlB;aAIIzG,cAAJ;kBAES6yC,QAAT,GAAoB;gBAEd1K,KAAK7J,QAAL,CAAcqK,MAAd,CAAqB/b,OAA1B,EACC5sB,QAAQmoC,KAAK7J,QAAL,CAAcqK,MAAd,CAAqB/b,OAArB,CAA6BoD,OAA7B,CAAsCvpB,KAAtC,EAA6CR,GAA7C,EAAkDC,GAAlD,CAAR,CADD,KAEK,IAAKwK,QAAQkc,OAAb,EACJ5sB,QAAQ0Q,QAAQkc,OAAR,CAAgBoD,OAAhB,CAAyBvpB,KAAzB,EAAgCR,GAAhC,EAAqCC,GAArC,CAAR,CADI,KAEA;mBAEEH,IAAI,EAAEzF,GAAG,GAAL,EAAUG,GAAG,GAAb,EAAkBC,GAAG,GAArB,EAAV;uBACQ,IAAI2iB,MAAMta,KAAV,CAAiB,SAAShD,EAAEzF,CAAX,GAAe,IAAf,GAAsByF,EAAEtF,CAAxB,GAA4B,IAA5B,GAAmCsF,EAAErF,CAArC,GAAyC,GAA1D,CAAR;sBACOV,KAAP;;;aAMG,OAAO6oC,MAAM5mB,CAAb,KAAmB,UAAxB,EAAqC;oBAExB4mB,MAAM5mB,CAAN,CAASnc,CAAT,EAAYnF,CAAZ,EAAeD,CAAf,CAFwB;gBAG/BgQ,QAAQ+3B,MAAR,CAAexmB,CAApB,EAAwB;qBAEjBvR,QAAQ+3B,MAAR,CAAexmB,CAAf,CAAiBhc,GAAvB;qBACMyK,QAAQ+3B,MAAR,CAAexmB,CAAf,CAAiB/b,GAAvB;aAHD,MAKO;uBAEEsqB,IAAR,CAAc,mEAAd;qBACM,CAAN;qBACM,GAAN;;gBAGInL,WAAWxZ,QAAX,CAAoByZ,QAApB,IAAgC,CAArC,EACCD,WAAWxZ,QAAX,CAAoBy9B,IAApB,CAA0B5mC,CAA1B,EAA6B+D,KAA7B;0BACa,IAAd;;UAjBD,MAqBO,IAAKG,QAAOiiC,MAAM5mB,CAAb,MAAmB,QAAxB,EAAmC;gBAEpC4mB,MAAM5mB,CAAN,YAAmBoB,MAAMta,KAA9B,EACC/I,QAAQ6oC,MAAM5mB,CAAd,CADD,KAEK;uBAGQ6mB,SAAOC,QAAP,CAAiBF,KAAjB,EAAwB,GAAxB,EAA6B/iC,CAA7B,EAAgC4K,OAAhC,CAHR;mBAICm4B,MAAM5mB,CAAN,CAAQhc,GAAR,KAAgBrC,SAArB,EAAiCqC,MAAM4iC,MAAM5mB,CAAN,CAAQhc,GAAd;mBAC5B4iC,MAAM5mB,CAAN,CAAQ/b,GAAR,KAAgBtC,SAArB,EAAiCsC,MAAM2iC,MAAM5mB,CAAN,CAAQ/b,GAAd;;;UAT5B,MAcA,IAAO,OAAO2iC,MAAM5mB,CAAb,KAAmB,QAArB,IAAmCvR,QAAQkc,OAAhD,EACN5sB,QAAQ0Q,QAAQkc,OAAR,CAAgBoD,OAAhB,CAAyB6Y,MAAM5mB,CAA/B,EAAkChc,GAAlC,EAAuCC,GAAvC,CAAR;aACIlG,KAAL,EAAa;gBAEP,CAACmoC,KAAKjK,QAAN,YAA0B7a,MAAMyvB,cAAhC,IAAkD3K,KAAKjK,QAAL,CAAc6U,YAAd,KAA+B1vB,MAAM2vB,YAA5F,EACCzvB,QAAQC,KAAR,CAAe,+KAAf;gBACI,CAACslB,SAAOmK,iBAAP,CAA0B5tB,UAA1B,EAAsC3iB,CAAtC,EAAyC1C,KAAzC,CAAD,IAAqD6oC,iBAAiBxlB,MAAMkC,OAAjF,EAA2F;oBAErFH,QAAL,CAAczlB,YAAd,CAA4B,OAA5B,EACC,IAAI0jB,MAAM6vB,sBAAV,CAAkCpK,SAAOqK,SAAP,CAAkBvK,UAAlB,EACjC;6BAEYT,KAAK/iB,QAAL,CAAcC,UAAd,CAAyBxZ,QAFrC;2BAGU6E;gBAJuB,CAAlC,EAUM,CAVN,CADD;mBAYK,CAACo4B,SAAOmK,iBAAP,CAA0B5tB,UAA1B,EAAsC3iB,CAAtC,EAAyC1C,KAAzC,CAAN,EACCujB,QAAQC,KAAR,CAAe,0JAAf;;;aAKEmV,WAAL,EACCtT,WAAWxZ,QAAX,CAAoB8sB,WAApB,GAAkC,IAAlC;aAEIkQ,MAAMtJ,IAAN,IAAcsJ,MAAMtJ,IAAN,CAAW6T,QAA9B,EACCvK,MAAMtJ,IAAN,CAAW6T,QAAX,CAAqBjL,IAArB,EAA2BzlC,CAA3B,EAA8B1C,KAA9B;aACI6oC,MAAM2B,YAAN,IAAwB3B,MAAM2B,YAAN,CAAmBoG,MAAnB,KAA8B,IAA3D,EACClgC,QAAQy5B,aAAR,CAAsBK,YAAtB,CAAmC+G,YAAnC,CAAiDpJ,IAAjD,EAAuDzlC,CAAvD;;WAzGI,IAAIA,IAAI,CAAd,EAAiBA,IAAIkmC,WAAW1nC,MAAhC,EAAwCwB,GAAxC,EAA8C;aAEzCmmC,KAFyC,EAElBlQ,WAFkB;aAwCxClyB,KAxCwC;aAkEvCA,KAlEuC;;;;iBA+GhCiK,UAAUA,QAAQ/P,CAAlB,GAAsB,CAArC,EAAwC+P,UAAUA,QAAQhQ,CAAlB,GAAsB,CAA9D;OACMsmB,UAAU,iDAAhB;OACKmhB,KAAKliB,KAAL,CAAWtZ,CAAX,IAAgB,CAArB,EAAyB4W,QAAQC,KAAR,CAAewD,UAAU,MAAV,GAAmBmhB,KAAKliB,KAAL,CAAWtZ,CAA7C;OACpBw7B,KAAKliB,KAAL,CAAWpZ,CAAX,IAAgB,CAArB,EAAyB0W,QAAQC,KAAR,CAAewD,UAAU,MAAV,GAAmBmhB,KAAKliB,KAAL,CAAWpZ,CAA7C;OACpBs7B,KAAKliB,KAAL,CAAWI,CAAX,IAAgB,CAArB,EAAyB9C,QAAQC,KAAR,CAAewD,UAAU,MAAV,GAAmBmhB,KAAKliB,KAAL,CAAWI,CAA7C;OAEpB,CAAC3V,OAAD,IAAY,CAACA,QAAQk6B,cAA1B,EACC;WAEOA,cAAR,CAAuByI,OAAvB;OAEIC,qBAAqB5iC,QAAQk6B,cAAR,CAAuB2I,qBAAvB,EAAzB;OACOD,uBAAuB,CAAC,CAA1B,IAAiC5iC,QAAQk6B,cAAR,CAAuB4I,cAAvB,CAAuCrL,IAAvC,CAAtC,EAAsF;cAE7EyC,cAAR,CAAuB+H,WAAvB,qDAAuF;iBAE9ExK,IAF8E;gBAG/EmL;OAHR;;CA7MF;AAgOAxK,SAAOmK,iBAAP,GAA2B,UAAW5tB,UAAX,EAAuB3iB,CAAvB,EAA0B1C,KAA1B,EAAkC;OAEvD,OAAOA,KAAP,KAAiB,QAAtB,EACCA,QAAQ,IAAIqjB,MAAMta,KAAV,CAAiB/I,KAAjB,CAAR;OACKyzC,iBAAiBpuB,WAAWrlB,KAAX,IAAoBqlB,WAAW8jB,EAAtD;OACKsK,mBAAmB7vC,SAAxB,EACC,OAAO,KAAP;kBACc8vC,IAAf,CAAqBhxC,CAArB,EAAwB1C,MAAMM,CAA9B;kBACeqzC,IAAf,CAAqBjxC,CAArB,EAAwB1C,MAAMS,CAA9B;kBACemzC,IAAf,CAAqBlxC,CAArB,EAAwB1C,MAAMU,CAA9B;kBACei4B,WAAf,GAA6B,IAA7B;UACO,IAAP;CAXD;AAuIAmQ,SAAO+K,SAAP,GAAmB,UAAWjL,UAAX,EAAuBkL,aAAvB,EAAuC;;OAIpD,CAAC1yC,MAAM6C,OAAN,CAAe2kC,UAAf,CAAN,EAAoCA,aAAa,CAAEA,UAAF,CAAb;mBAEpBkL,iBAAiB,EAAjC;OACKA,cAAchuC,CAAd,KAAoBlC,SAAzB,EAAqCkwC,cAAchuC,CAAd,GAAkBguC,cAAcpjC,OAAd,IAAyBojC,cAAcpjC,OAAd,CAAsBi4B,MAA/C,GAAwDmL,cAAcpjC,OAAd,CAAsBi4B,MAAtB,CAA6BuE,WAA7B,GAA2Cx8B,OAA3C,CAAmDy5B,aAAnD,CAAiElkC,GAAzH,GAA+H,CAAjJ;OAC/ByK,UAAUojC,cAAcpjC,OAAd,IAAyB,IAAI2wB,OAAJ,EAAzC;OACCnG,iBAAiB,EAAEtO,SAASlc,QAAQkc,OAAnB,EADlB;WAUQ0c,IAAR,CAAcpO,cAAd;OAEM6Y,WAAW7Y,eAAeuN,MAAf,CAAsBxmB,CAAtB,CAAwB/b,GAAzC,CApByD;QAwBnD,IAAIxD,IAAI,CAAd,EAAiBA,IAAIkmC,WAAW1nC,MAAhC,EAAwCwB,GAAxC,EAA8C;UAEzCwnB,OAAO0e,WAAWlmC,CAAX,CAAX;UACKtB,MAAM6C,OAAN,CAAeimB,IAAf,CAAL,EACC0e,WAAWlmC,CAAX,IAAgB,IAAI2gB,MAAMkC,OAAV,CAEf2E,KAAK,CAAL,MAAYtmB,SAAZ,GAAwB,CAAxB,GAA4BsmB,KAAK,CAAL,CAFb,EAGfA,KAAK,CAAL,MAAYtmB,SAAZ,GAAwB,CAAxB,GAA4BsmB,KAAK,CAAL,CAHb,EAIfA,KAAK,CAAL,MAAYtmB,SAAZ,GAAwB,CAAxB,GAA4BsmB,KAAK,CAAL,CAJb,EAKfA,KAAK,CAAL,MAAYtmB,SAAZ,GAAwBmwC,QAAxB,GAAmC7pB,KAAK,CAAL,CALpB,CAAhB,CADD,KASK,IAEF,QAAOA,IAAP,yCAAOA,IAAP,OAAgB,QAAlB,IACKA,gBAAgB7G,MAAMkN,OAAtB,KAAkC,KADvC,IAEKrG,gBAAgB7G,MAAMmC,OAAtB,KAAkC,KAFvC,IAGK0E,gBAAgB7G,MAAMkC,OAAtB,KAAkC,KALnC,EAOH;aAEM2E,KAAK8pB,MAAL,KAAgBpwC,SAAvB,EACCglC,WAAWlmC,CAAX,IAAgB,IAAI2gB,MAAMkC,OAAV,CAEf2E,KAAKvd,CAAL,KAAW/I,SAAX,GAAuB,CAAvB,GAA2BsmB,KAAKvd,CAFjB,EAGfud,KAAKrd,CAAL,KAAWjJ,SAAX,GAAuB,CAAvB,GAA2BsmB,KAAKrd,CAHjB,EAIfqd,KAAK7D,CAAL,KAAWziB,SAAX,GAAuB,CAAvB,GAA2BsmB,KAAK7D,CAJjB,EAKf6D,KAAKjI,CAAL,KAAWre,SAAX,GAAuB,CAAvB,GAA2BsmB,KAAKjI,CALjB,CAAhB,CADD,KASK,IAEFiI,KAAK8pB,MAAL,YAAuB3wB,MAAMkN,OAA7B,KAAyC,IAA3C,IACKrG,KAAK8pB,MAAL,YAAuB3wB,MAAMmC,OAA7B,KAAyC,IAD9C,IAEK0E,KAAK8pB,MAAL,YAAuB3wB,MAAMkC,OAA7B,KAAyC,IAJ1C,EAMH;gBAEI2E,KAAK8pB,MAAL,YAAuB3wB,MAAMkN,OAA7B,KAAyC,IAA9C,EACCqY,WAAWlmC,CAAX,EAAcsxC,MAAd,GAAuB,IAAI3wB,MAAMmC,OAAV,CAEtB0E,KAAK8pB,MAAL,CAAYrnC,CAAZ,KAAkB/I,SAAlB,GAA8B,CAA9B,GAAkCsmB,KAAK8pB,MAAL,CAAYrnC,CAFxB,EAGtBud,KAAK8pB,MAAL,CAAYnnC,CAAZ,KAAkBjJ,SAAlB,GAA8B,CAA9B,GAAkCsmB,KAAK8pB,MAAL,CAAYnnC,CAHxB,EAItBqd,KAAK8pB,MAAL,CAAY3tB,CAAZ,KAAkBziB,SAAlB,GAA8B,CAA9B,GAAkCsmB,KAAK8pB,MAAL,CAAY3tB,CAJxB,CAAvB;UATG,MAiBE;gBAED6D,KAAK8pB,MAAL,CAAY9yC,MAAZ,KAAuB,CAA5B,EACC0nC,WAAWlmC,CAAX,EAAcsxC,MAAd,GAAuB,IAAI3wB,MAAMkC,OAAV,CAEtB2E,KAAK8pB,MAAL,CAAY,CAAZ,MAAmBpwC,SAAnB,GAA+B,CAA/B,GAAmCsmB,KAAK8pB,MAAL,CAAY,CAAZ,CAFb,EAGtB9pB,KAAK8pB,MAAL,CAAY,CAAZ,MAAmBpwC,SAAnB,GAA+B,CAA/B,GAAmCsmB,KAAK8pB,MAAL,CAAY,CAAZ,CAHb,EAItB9pB,KAAK8pB,MAAL,CAAY,CAAZ,MAAmBpwC,SAAnB,GAA+B,CAA/B,GAAmCsmB,KAAK8pB,MAAL,CAAY,CAAZ,CAJb,EAKtB9pB,KAAK8pB,MAAL,CAAY,CAAZ,MAAmBpwC,SAAnB,GAA+B,CAA/B,GAAmCsmB,KAAK8pB,MAAL,CAAY,CAAZ,CALb,CAAvB,CADD,KASK,IAAK9pB,KAAK8pB,MAAL,CAAY9yC,MAAZ,KAAuB,CAA5B,EAEJ0nC,WAAWlmC,CAAX,EAAcsxC,MAAd,GAAuB,IAAI3wB,MAAMmC,OAAV,CAEtB0E,KAAK8pB,MAAL,CAAY,CAAZ,MAAmBpwC,SAAnB,GAA+B,CAA/B,GAAmCsmB,KAAK8pB,MAAL,CAAY,CAAZ,CAFb,EAGtB9pB,KAAK8pB,MAAL,CAAY,CAAZ,MAAmBpwC,SAAnB,GAA+B,CAA/B,GAAmCsmB,KAAK8pB,MAAL,CAAY,CAAZ,CAHb,EAItB9pB,KAAK8pB,MAAL,CAAY,CAAZ,MAAmBpwC,SAAnB,GAA+B,CAA/B,GAAmCsmB,KAAK8pB,MAAL,CAAY,CAAZ,CAJb,CAAvB,CAFI,KASAzwB,QAAQC,KAAR,CAAe,wDAAwD0G,KAAK8pB,MAAL,CAAY9yC,MAAnF;;;;OAOF+yC,SAAS,EAAf;QACM,IAAIvxC,IAAI,CAAd,EAAiBA,IAAIkmC,WAAW1nC,MAAhC,EAAwCwB,GAAxC,EAA8C;UAGpCwxC,OAHoC,GAG7C,SAASA,OAAT,CAAkB1K,QAAlB,EAA6B;aAEvB,OAAOX,KAAP,KAAiB,QAAtB,EACCA,QAAQ,IAAIxlB,MAAMkC,OAAV,CAAmBsjB,KAAnB,EAA0B,CAA1B,EAA6B,CAA7B,EAAgC,CAAhC,CAAR;aACMA,iBAAiBxlB,MAAMkN,OAAzB,IAAwCsY,iBAAiBxlB,MAAMmC,OAA/D,IAA8EqjB,iBAAiBxlB,MAAMkC,OAA1G,EAAsH;gBAE/G9e,QAAQqiC,SAAOC,QAAP,CAAiBF,KAAjB,EAAwBW,QAAxB,EAAkCsK,cAAchuC,CAAhD,EAAmD4K,OAAnD,CAAd;mBACOjK,KAAP;;aAGIoiC,MAAMmL,MAAN,KAAiBpwC,SAAtB,EAAkC;oBAEzB4f,KAAR,CAAe,kDAAkDqlB,MAAMmL,MAAvE;;;aAIInL,MAAMxuB,IAAN,KAAezW,SAApB,EACCilC,MAAMmL,MAAN,CAAa35B,IAAb,GAAoBwuB,MAAMxuB,IAA1B;aACIwuB,MAAMsL,KAAN,IAAezjC,QAAQi4B,MAA5B,EAAqCE,MAAMmL,MAAN,CAAazU,IAAb,GAAoB,IAAIuJ,SAAOsL,SAAX,CAAsB1jC,OAAtB,CAApB;aAChCm4B,MAAM2B,YAAX,EAA0B;kBAEnBwJ,MAAN,CAAaxJ,YAAb,GAA4B3B,MAAM2B,YAAlC;mBACO3B,MAAM2B,YAAb;;oBAGU9nC,CAAX,IAAgBmmC,MAAMmL,MAAtB;iBACQnL,MAAMmL,MAAd;gBACOlL,SAAOC,QAAP,CAAiBF,KAAjB,EAAwBW,QAAxB,EAAkCsK,cAAchuC,CAAhD,EAAmD4K,OAAnD,CAAP;OA9B4C;UAEzCm4B,QAAQD,WAAWlmC,CAAX,CAAZ;UAgCMknC,QAAQf,MAAMmL,MAAN,YAAwB3wB,MAAMmC,OAA9B,KAA0C,IAA1C,GACb,IAAInC,MAAMmC,OAAV,CAAmB0uB,QAAS,GAAT,CAAnB,EAAmCA,QAAS,GAAT,CAAnC,EAAmDA,QAAS,GAAT,CAAnD,CADa,GAEb,IAAI7wB,MAAMkC,OAAV,CAAmB2uB,QAAS,GAAT,CAAnB,EAAmCA,QAAS,GAAT,CAAnC,EAAmDA,QAAS,GAAT,CAAnD,EAAmEA,QAAS,GAAT,CAAnE,CAFD;UAIKrL,MAAM2B,YAAX,EAA0B;eAEnBA,YAAN,CAAmB4G,SAAnB,GAA+B,KAA/B;aACKvI,MAAM2B,YAAN,CAAmBoG,MAAnB,KAA8BhtC,SAAnC,EAA+CilC,MAAM2B,YAAN,CAAmBoG,MAAnB,GAA4B,IAA5B;iBAMvCzG,aAAR,CAAsBK,YAAtB,CAAmCt9B,IAAnC,CAAyC27B,MAAM2B,YAA/C,EAA6D95B,OAA7D;;aAIMjC,IAAP,CAAam7B,KAAb;;UAGMqK,MAAP;CAzJD;AA4JA,IAAII,iBAAiB,IAArB;AA2DAvL,SAAOqK,SAAP,GAAmB,UAAWvK,UAAX,EAAuB0L,YAAvB,EAAsC;;OAInD,CAAClzC,MAAM6C,OAAN,CAAe2kC,UAAf,CAAN,EAAoCA,aAAa,CAAEA,UAAF,CAAb;kBAErB0L,gBAAgB,EAA/B;gBACa5jC,OAAb,GAAuB4jC,aAAa5jC,OAAb,IAAwB,EAA/C;OAGG4jC,aAAaC,SAAb,KAA2B3wC,SAA7B,IACAxC,MAAM6C,OAAN,CAAe2kC,UAAf,CADA,IAEEA,WAAW1nC,MAAX,KAAsBozC,aAAaC,SAAb,CAAuBC,KAHhD,EAIE;cAEOhxB,KAAR,CAAe,0CAA0ColB,WAAW1nC,MAArD,GAA8D,uBAA9D,GAAwFozC,aAAaC,SAAb,CAAuBC,KAA9H;aACOF,aAAaG,MAApB;;OAKKvzC,SAASE,MAAM6C,OAAN,CAAe2kC,UAAf,IAA8BA,WAAW1nC,MAAzC,GAAkDozC,aAAaC,SAAb,CAAuBC,KAAxF;gBAEaC,MAAb,GAAsBH,aAAaG,MAAb,IAAuB,EAA7C;OACK,CAACH,aAAa5jC,OAAb,CAAqBkc,OAA3B,EACC0nB,aAAa5jC,OAAb,CAAqB+4B,UAArB;QAGK,IAAI/mC,IAAI,CAAd,EAAiBA,IAAIxB,MAArB,EAA6BwB,GAA7B,EAAmC;UAE5BmmC,QAAQznC,MAAM6C,OAAN,CAAe2kC,UAAf,IAA8BA,WAAWlmC,CAAX,CAA9B,GAA8CkB,SAA5D;UACIowC,MAAJ;UAEGnL,iBAAiBxlB,MAAMkC,OAAzB;mBACegvB,SAAb,IAA4BD,aAAaC,SAAb,CAAuBjvB,QAAvB,KAAoC,CAFnE;QAGG;gBAEErf,YAAJ;gBAASC,YAAT;gBACI+b,IAAI4mB,MAAM5mB,CAAd;gBACK4mB,MAAM5mB,CAAN,YAAmB/f,MAAnB,IAA6B2mC,MAAM5mB,CAAN,CAAQ7e,IAA1C,EAAiD;mBAE3CylC,MAAM5mB,CAAN,CAAQ/b,GAAb,EAAmBA,MAAM2iC,MAAM5mB,CAAN,CAAQ/b,GAAd;mBACd2iC,MAAM5mB,CAAN,CAAQhc,GAAb,EAAmBA,MAAM4iC,MAAM5mB,CAAN,CAAQhc,GAAd;mBACf4iC,MAAM5mB,CAAN,CAAQ7e,IAAZ;aAJD,MAMO;4BAGOsN,OAAb,CAAqB44B,IAArB;qBACMgL,aAAa5jC,OAAb,CAAqB+3B,MAArB,CAA4BxmB,CAA5B,CAA8Bhc,GAApC,CAAyCC,MAAMouC,aAAa5jC,OAAb,CAAqB+3B,MAArB,CAA4BxmB,CAA5B,CAA8B/b,GAApC;;gBAGrC+b,aAAaja,QAAb,IAAyB,CAACssC,aAAa5jC,OAAb,CAAqBi4B,MAA/C,IAAyD0L,cAA9D,EAA+E;gCAS7D,KAAjB;;gBAGGr0C,QAAQs0C,aAAa5jC,OAAb,CAAqBkc,OAArB,CAA6BoD,OAA7B,CACX6Y,UAAUjlC,SAAV,GACC,IAAIyf,MAAMkC,OAAV,GAAoBmvB,mBAApB,CAAyCJ,aAAaC,SAAtD,EAAiE7xC,CAAjE,EAAqEuf,CADtE,GAECA,aAAaja,QAAb;cAGIssC,aAAa5jC,OAAb,CAAqBy5B,aAArB,GAAqCmK,aAAa5jC,OAAb,CAAqBy5B,aAArB,CAAmClkC,GAAxE,GAA8E,CAAjF,CAHD,GAICgc,CAPS,EAQXhc,GARW,EAQNC,GARM,CAAZ;yBASauuC,MAAb,CAAoBhmC,IAApB,CAA0BzO,MAAMM,CAAhC,EAAmCN,MAAMS,CAAzC,EAA4CT,MAAMU,CAAlD;UAzCD,MA2CO,IAAK4zC,aAAaG,MAAb,YAA+BpxB,MAAM6vB,sBAA1C,EACNc,SAAS,IAAI3wB,MAAMmC,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAT,CADM,KAEF8uB,aAAaG,MAAb,CAAoBhmC,IAApB,CAA0B,CAA1B,EAA6B,CAA7B,EAAgC,CAAhC,EAjD6B;UAoD7B6lC,aAAat8B,OAAb,KAAyBpU,SAA9B,EAA0C;aAErCoU,UAAU,CAAd;aACC28B,iCAAiCC,8BAA+B,CAA/B,CADlC;eAEM1oB,QAAN,CAAe5qB,OAAf,CAAwB,UAAW6mC,IAAX,EAAkB;gBAEpC,CAACA,KAAK7J,QAAL,CAAcuW,KAApB,EACC;iBACK,IAAIC,QAAQ,CAAlB,EAAqBA,QAAQ3M,KAAK/iB,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkC2oC,KAA/D,EAAsEM,OAAtE,EAAgF;mBAE3EjpC,WAAWya,kBAAmB6hB,IAAnB,EAAyB2M,KAAzB,CAAf;0BACWF,8BACVjvB,iBACCyW,MADD,EACS,IAAI/Y,MAAMmC,OAAV,GAAoBkvB,mBAApB,CAAyCJ,aAAaC,SAAtD,EAAiE7xC,CAAjE,CADT,EAEEm/B,UAFF,CAEch2B,QAFd,IAE2B,CAHjB,IAIP8oC,8BAJJ;;UAPF;aAiBKI,MAAM/8B,OAAN,KAAkBpU,SAAvB,EACCoU,UAAU+8B,MAAM/8B,OAAhB;aAEIs8B,aAAaG,MAAb,YAA+BpxB,MAAM6vB,sBAA1C,EAAmE;yBAErDuB,MAAb,CAAoBO,OAApB,CAA6BtyC,CAA7B,EAAgCsxC,OAAOrnC,CAAvC,EAA0CqnC,OAAOnnC,CAAjD,EAAoDmnC,OAAO3tB,CAA3D,EAA8DrO,OAA9D;UAFD,MAKKs8B,aAAaG,MAAb,CAAoBhmC,IAApB,CAA0BuJ,OAA1B;OA7BN,MA+BOs8B,aAAaG,MAAb,CAAoBhmC,IAApB,CAA0B,CAA1B;;UAGD6lC,aAAaG,MAApB;CAlHD;AAuHA3L,SAAOsL,SAAP;AASC,mBAAa1jC,OAAb,EAAuB;;OAElB6uB,IAAJ;OACM0V,aAAa,EAAnB,CAHsB;;OAQjB,CAACvkC,QAAQi4B,MAAd,EAAuB;;;QAgBlBuM,SAAL,GAAiB,YAAY;UAGvB,CAACxkC,QAAQi4B,MAAd,EACC,OAAO,KAAP,CAJ2B;UAMvBpJ,IAAL,EAAY,OAAOA,KAAK4V,OAAZ;UACPF,WAAW/zC,MAAX,KAAsB,CAA3B,EAA+B,OAAO,KAAP;aAExB+zC,WAAW,CAAX,EAAcE,OAArB;IATD;QAiBKA,OAAL,GAAe,UAAWA,OAAX,EAAqB;UAG9B,CAACzkC,QAAQi4B,MAAd,EACC,OAAO,KAAP,CAJkC;UAM9BpJ,IAAL,EAAY;cAEN4V,OAAL,GAAeA,OAAf;;;iBAKU7zC,OAAX,CAAoB,UAAWi+B,IAAX,EAAkB;cAEhC4V,OAAL,GAAeA,OAAf;OAFD;IAbD;QA2BK/B,QAAL,GAAgB,UAAWjL,IAAX,EAAiBr5B,KAAjB,EAAwB9O,KAAxB,EAAgC;UAEzCmlB,qBAAqBgjB,KAAK/iB,QAAL,CAAcC,UAAd,CAAyBxZ,QAApD;UACI+9B,QAAQzkB,mBAAmBG,QAAnB,IAA+B,CAA/B,GAAmC,IAAIjC,MAAMkC,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,CAAnC,GAAqE,IAAIlC,MAAMmC,OAAV,EAAjF;YACMC,SAAN,CAAiBN,mBAAmBO,KAApC,EAA2C5W,QAAQqW,mBAAmBG,QAAtE;UAKI8vB,aAAa1kC,QAAQi4B,MAAR,GAAiBj4B,QAAQi4B,MAAR,CAAewE,mBAAf,EAAjB,GAAwD,CAAzE;UAEKz8B,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAnC,EAA0C;sBAE5B3F,KAAKwR,GAAL,CAAUqjC,UAAV,CAAb;aACKA,aAAeH,WAAW/zC,MAAX,GAAoB,CAAxC,EAA8C;mBAErCk0C,aAAeH,WAAW/zC,MAAX,GAAoB,CAA3C,EAAiD;oBAE3C2b,MAAL,CAAao4B,WAAWA,WAAW/zC,MAAX,GAAoB,CAA/B,CAAb;0BACWm0C,GAAX;;;;aAOIjwB,WAAW,IAAI/B,MAAMiyB,cAAV,EAAjB;aAA6CC,cAAa,CAA1D;aAGMhB,YAAY,IAAIiB,YAAJ,CAAkBD,cAAa,CAA/B,CAAlB,CAlByC;kBAmBhC51C,YAAT,CAAuB,UAAvB,EAAmC,IAAI0jB,MAAMoyB,eAAV,CAA2BlB,SAA3B,EAAsC,CAAtC,CAAnC;aACME,SAAS,IAAIe,YAAJ,CAAkBD,cAAa,CAA/B,CAAf,CApByC;kBAqBhC51C,YAAT,CAAuB,OAAvB,EAAgC,IAAI0jB,MAAM6vB,sBAAV,CAAkCuB,MAAlC,EAA0C,CAA1C,CAAhC;aAEMlV,QAAO,IAAIlc,MAAMqyB,IAAV,CAAgBtwB,QAAhB,EAA0B,IAAI/B,MAAMsyB,iBAAV,CAA6B,EAAE5C,cAAc1vB,MAAM2vB,YAAtB,EAA7B,CAA1B,CAAb;cAEKt2B,GAAL,CAAU6iB,KAAV;aAKK0V,WAAW,CAAX,CAAL,EAAqB1V,MAAK4V,OAAL,GAAeF,WAAW,CAAX,EAAcE,OAA7B;iBAGb,IAAI9xB,MAAMmC,OAAV,GAAoBU,IAApB,CAA0B0jB,KAA1B,CAAR;aACMtkB,WAAWia,MAAKna,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkCyZ,QAAnD;eACM3hB,OAAN,CAAe47B,MAAKna,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkC6Z,KAAjD,EAAwD,IAAIJ,QAA5D;aACMswB,SAASX,WAAW/zC,MAAX,KAAsB,CAAtB,GAA0B0oC,KAA1B,GACd,IAAIvmB,MAAMmC,OAAV,GAAoBC,SAApB,CAA+BwvB,WAAWA,WAAW/zC,MAAX,GAAoB,CAA/B,EAAkCkkB,QAAlC,CAA2CC,UAA3C,CAAsDxZ,QAAtD,CAA+D6Z,KAA9F,EAAqG,IAAIJ,QAAzG,CADD;gBAEO3hB,OAAP,CAAgB47B,MAAKna,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkC6Z,KAAlD,EAAyD,IAAIJ,QAA7D;eACKF,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkC8sB,WAAlC,GAAgD,IAAhD;aAGK34B,UAAU4D,SAAf,EACC5D,QAAQ,IAAIqjB,MAAMta,KAAV,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,CAAR,CA3CwC;kBA4ClCkqC,iBAAP,CAA0B1T,MAAKna,QAAL,CAAcC,UAAxC,EAAoD,CAApD,EAAuD4vB,WAAW/zC,MAAX,KAAsB,CAAtB,GAA0BlB,KAA1B,GACtD,IAAIqjB,MAAMta,KAAV,GAAkB0c,SAAlB,CAA6BwvB,WAAWA,WAAW/zC,MAAX,GAAoB,CAA/B,EAAkCkkB,QAAlC,CAA2CC,UAA3C,CAAsDrlB,KAAtD,CAA4D0lB,KAAzF,EAAgG,IAAIJ,QAApG,CADD;kBAEO2tB,iBAAP,CAA0B1T,MAAKna,QAAL,CAAcC,UAAxC,EAAoD,CAApD,EAAuDrlB,KAAvD;oBAEWyO,IAAX,CAAiB8wB,KAAjB;;;UAKIA,SAAS37B,SAAd,EAA0B;aAGnBwhB,YAAW,IAAI/B,MAAMiyB,cAAV,EAAjB;aAGIC,UAAJ;aAEK7kC,QAAQy5B,aAAR,CAAsBjkC,GAAtB,KAA8B,IAAnC,EAA0C;gBAEpCwK,QAAQy5B,aAAR,IAAyBz5B,QAAQy5B,aAAR,CAAsBC,KAApD,EACCmL,aAAa7kC,QAAQy5B,aAAR,CAAsBC,KAAnC,CADD,KAEK,IAAK15B,QAAQi4B,MAAR,IAAkBj4B,QAAQi4B,MAAR,CAAeyB,KAAtC,EACJmL,aAAa7kC,QAAQi4B,MAAR,CAAeyB,KAA5B,CADI,KAEA;uBAEI5mB,KAAR,CAAe,oCAAoC+xB,UAApC,GAAiD,mFAAhE;;;UARF,MAaOA,aAAaH,aAAa,CAA1B;aAGDb,aAAY,IAAIiB,YAAJ,CAAkBD,aAAa,CAA/B,CAAlB,CAxByB;mBAyBhB51C,YAAT,CAAuB,UAAvB,EAAmC,IAAI0jB,MAAMoyB,eAAV,CAA2BlB,UAA3B,EAAsC,CAAtC,CAAnC;aACME,UAAS,IAAIe,YAAJ,CAAkBD,aAAa,CAA/B,CAAf,CA1ByB;mBA2BhB51C,YAAT,CAAuB,OAAvB,EAAgC,IAAI0jB,MAAM6vB,sBAAV,CAAkCuB,OAAlC,EAA0C,CAA1C,CAAhC;mBAGSoB,YAAT,CAAuBT,UAAvB,EAAmCA,UAAnC;gBAEO,IAAI/xB,MAAMqyB,IAAV,CAAgBtwB,SAAhB,EAA0B,IAAI/B,MAAMsyB,iBAAV,CAA6B,EAAE5C,cAAc1vB,MAAM2vB,YAAtB,EAA7B,CAA1B,CAAP;cACKmC,OAAL,GAAe,IAAf;cACKz4B,GAAL,CAAU6iB,IAAV;;UAOIA,KAAKna,QAAV,EAAqB;gBAEbma,KAAKna,QAAL,CAAcotB,cAArB;cACKptB,QAAL,CAAcotB,cAAd,GAA+B,IAA/B;;cAKO,IAAInvB,MAAMmC,OAAV,GAAoBU,IAApB,CAA0B0jB,KAA1B,CAAR;YACMjmC,OAAN,CAAe47B,KAAKna,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkC6Z,KAAjD,EAAwD0vB,aAAa7V,KAAKna,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkCyZ,QAAvG;WACKF,QAAL,CAAcC,UAAd,CAAyBxZ,QAAzB,CAAkC8sB,WAAlC,GAAgD,IAAhD;UAGK34B,UAAU4D,SAAf,EACC5D,QAAQ,IAAIqjB,MAAMta,KAAV,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,CAAR,CAvH8C;eAwHxCkqC,iBAAP,CAA0B1T,KAAKna,QAAL,CAAcC,UAAxC,EAAoD+vB,UAApD,EAAgEp1C,KAAhE;UAGI81C,QAAQvW,KAAKna,QAAL,CAAc2wB,SAAd,CAAwBD,KAApC;UAA2CtB,QAAQY,aAAa,CAAb,GAAiBU,KAApE;UACKA,QAAQV,UAAb,EAA0B;aAErBY,OAAOF,QAAQvW,KAAKna,QAAL,CAAc2wB,SAAd,CAAwBvB,KAA3C;iBACQY,UAAR;iBACQY,OAAOF,KAAf;;WAGI1wB,QAAL,CAAcywB,YAAd,CAA4BC,KAA5B,EAAmCtB,KAAnC;IAnID;QAyIK33B,MAAL,GAAc,YAAY;UAEpB0iB,SAAS37B,SAAd,EACC;WACIwhB,QAAL,CAAcsQ,OAAd;WACKwI,QAAL,CAAcxI,OAAd;WACKvtB,MAAL,CAAY0U,MAAZ,CAAoB0iB,IAApB;IAND;CAtNF;AAmQAuJ,SAAOmN,WAAP,GAAqB,UAAWrN,UAAX,EAAwB;;QAItC,IAAIlmC,IAAI,CAAd,EAAiBA,IAAIkmC,WAAW1nC,MAAhC,EAAwCwB,GAAxC,EAA8C;UAEzCU,OAAOwlC,WAAWlmC,CAAX,CAAX;UACKU,gBAAgBigB,MAAMkC,OAA3B,EACC,OAAO,CAAP;;UAGK,CAAP;CAXD;AAsBAujB,SAAOiD,eAAP,GAAyB,UAAWtN,KAAX,EAAkC;OAAhB3a,QAAgB,uEAAL,EAAK;OAMpDhe,IAAIge,SAAShe,CAAT,KAAelC,SAAf,GAA2BkgB,SAAShe,CAApC,GAAwC,CAAlD;OACCgJ,QAAQgV,SAAShV,KAAT,KAAmBlL,SAAnB,GAA+BkgB,SAAShV,KAAxC,GAAgDlL,SADzD;OAEC8M,UAAUoT,SAASpT,OAAT,IAAoB,IAAI2wB,OAAJ,EAF/B;SAGM/C,QAAN,CAAex4B,CAAf,GAAmBA,CAAnB;YAEOysC,mBAAP,CAA4B9T,KAA5B,EAAmC,EAAE34B,GAAGA,CAAL,EAAQ4K,SAASA,OAAjB,EAAnC;SACMwb,QAAN,CAAe5qB,OAAf,CAAwB,UAAW6mC,IAAX,EAAkB;eAGlCoK,mBAAP,CAA4BpK,IAA5B,EAAkC,EAAEriC,GAAGA,CAAL,EAAQ4K,SAASA,OAAjB,EAAlC;IAHD;WAUQy5B,aAAR,CAAsBK,YAAtB,CAAmC0G,eAAnC,CAAoDxgC,OAApD;OACM85B,eAAe95B,QAAQy5B,aAAR,CAAsBK,YAAtB,CAAmC5iC,GAAnC,EAArB;OAOK4iC,gBAAgBA,aAAagH,iBAAlC,EAAsDhH,aAAagH,iBAAb,CAAgC1iC,UAAUlL,SAA1C;CA9BvD;AAiCA,IAAIyf,KAAJ;AAIA,SAASijB,QAAT,GAAmB;OAEb,CAAC5iB,QAAME,OAAN,EAAN,EAAwB;cAEf4M,IAAR,CAAc,0CAAd;;;WAIO9M,QAAML,KAAd;UACOijB,MAAP,CAAejjB,MAAMiyB,cAAN,CAAqBj0C,SAApC,EAA+C;qBAE/B,uBAAW4yC,MAAX,EAAmB3uB,QAAnB,EAA8B;oBAEjCA,YAAY,CAAvB;aACIzZ,WAAW,EAAf;cAEM,IAAInJ,IAAI,CAAR,EAAWI,IAAImxC,OAAO/yC,MAA5B,EAAoCwB,IAAII,CAAxC,EAA2CJ,GAA3C,EAAiD;gBAE5CknC,QAAQqK,OAAOvxC,CAAP,CAAZ;qBACS+L,IAAT,CAAem7B,MAAMj9B,CAArB,EAAwBi9B,MAAM/8B,CAA9B,EAAiC+8B,MAAMvjB,CAAN,IAAW,CAA5C;gBACKf,YAAY,CAAjB,EACCzZ,SAAS4C,IAAT,CAAem7B,MAAM3nB,CAAN,IAAW,CAA1B;;cAIGtiB,YAAL,CAAmB,UAAnB,EAA+B,IAAI0jB,MAAM6vB,sBAAV,CAAkCrnC,QAAlC,EAA4CyZ,QAA5C,CAA/B;gBAEO,IAAP;;IAlBF;UAyBOghB,MAAP,CAAejjB,MAAMkC,OAAN,CAAclkB,SAA7B,EAAwC;gBAE7B,kBAAWN,CAAX,EAAe;cAEnB4L,CAAL,IAAU5L,EAAE4L,CAAZ;cACKE,CAAL,IAAU9L,EAAE8L,CAAZ;cACKwZ,CAAL,IAAUtlB,EAAEslB,CAAZ;aAEKtlB,EAAEkhB,CAAF,KAAQre,SAAb,EACC,KAAKqe,CAAL,IAAUlhB,EAAEkhB,CAAZ;gBAEM,IAAP;;IAXF;UAiBOqkB,MAAP,CAAejjB,MAAMkC,OAAN,CAAclkB,SAA7B,EAAwC;WAElC,aAAWN,CAAX,EAAckhB,CAAd,EAAkB;aAEjBA,MAAMre,SAAX,EAAuB;oBAEd4sB,IAAR,CAAc,uFAAd;mBACO,KAAK0lB,UAAL,CAAiBn1C,CAAjB,EAAoBkhB,CAApB,CAAP;;cAIItV,CAAL,IAAU5L,EAAE4L,CAAZ;cACKE,CAAL,IAAU9L,EAAE8L,CAAZ;cACKwZ,CAAL,IAAUtlB,EAAEslB,CAAZ;aACKtlB,EAAEkhB,CAAF,KAAQre,SAAb,EACC,KAAKqe,CAAL,IAAUlhB,EAAEkhB,CAAZ;gBAEM,IAAP;;IAjBF;UAuBOqkB,MAAP,CAAejjB,MAAMqoB,MAAN,CAAarqC,SAA5B,EAAuC;eAE7B,iBAAW6gC,SAAX,EAAsBuF,UAAtB,EAAmC;aAErC0O,iBAAiB,IAAI9yB,MAAM+yB,OAAV,EAAvB;aACMC,OAAO,IAAIhzB,MAAMizB,GAAV,EAAb;aACMC,UAAU,IAAIlzB,MAAMmzB,MAAV,EAAhB;aACMC,YAAY,IAAIpzB,MAAMmC,OAAV,EAAlB;kBACSkxB,SAAT,CAAoB9M,KAApB,EAA2B96B,KAA3B,EAAkC6nC,gBAAlC,EAAoDC,WAApD,EAAiE1U,SAAjE,EAA4EuF,UAA5E,EAAwF5/B,MAAxF,EAAiG;gBAE1FgvC,qBAAqBR,KAAKS,iBAAL,CAAwBlN,KAAxB,CAA3B;gBAEKiN,qBAAqBF,gBAA1B,EAA6C;mBAEtCI,iBAAiB,IAAI1zB,MAAMmC,OAAV,EAAvB;oBAEKwxB,mBAAL,CAA0BpN,KAA1B,EAAiCmN,cAAjC;8BACeE,YAAf,CAA6BL,WAA7B;mBAEM3f,WAAWiL,UAAUgV,GAAV,CAAcC,MAAd,CAAqBtV,UAArB,CAAiCkV,cAAjC,CAAjB;mBAEK9f,WAAWiL,UAAUkV,IAArB,IAA6BngB,WAAWiL,UAAUP,GAAvD,EAA6D;0BAElDlzB,IAAX,CAAiB;4BAENwoB,QAFM;iCAGD12B,KAAK44B,IAAL,CAAW0d,kBAAX,CAHC;yBAITE,cAJS;yBAKTjoC,KALS;wBAMV,IANU;0BAORjH;gBAPT;;;aAeIud,WAAW,KAAKA,QAAtB;aACMwxB,cAAc,KAAKA,WAAzB;aACMvzC,YAAY6+B,UAAU51B,MAAV,CAAiBo/B,MAAjB,CAAwBroC,SAA1C;aAIK+hB,SAASotB,cAAT,KAA4B,IAAjC,EAAwCptB,SAASiyB,qBAAT;iBAEhCnxB,IAAR,CAAcd,SAASotB,cAAvB;iBACQyE,YAAR,CAAsBL,WAAtB;iBACQ9hB,MAAR,IAAkBzxB,SAAlB;aAEK6+B,UAAUgV,GAAV,CAAcI,gBAAd,CAAgCf,OAAhC,MAA8C,KAAnD,EAA2D;wBAI5CrwB,IAAf,CAAqB0wB,WAArB,EAAmC1iB,MAAnC;cAEKhO,IAAL,CAAWgc,UAAUgV,GAArB,EAA2BD,YAA3B,CAAyCd,cAAzC;aAEMoB,iBAAiBl0C,aAAc,CAAE,KAAK4iB,KAAL,CAAWtZ,CAAX,GAAe,KAAKsZ,KAAL,CAAWpZ,CAA1B,GAA8B,KAAKoZ,KAAL,CAAWI,CAA3C,IAAiD,CAA/D,CAAvB;aACMswB,mBAAmBY,iBAAiBA,cAA1C;aAEKnyB,SAASoyB,gBAAd,EAAiC;gBAE1B1oC,QAAQsW,SAAStW,KAAvB;gBACMuW,aAAaD,SAASC,UAA5B;gBACMkvB,YAAYlvB,WAAWxZ,QAAX,CAAoB6Z,KAAtC;gBACMJ,WAAWD,WAAWxZ,QAAX,CAAoByZ,QAArC;gBAEKxW,UAAU,IAAf,EAAsB;mBAEf2oC,UAAU3oC,MAAM4W,KAAtB;oBAEM,IAAIhjB,IAAI,CAAR,EAAWg1C,KAAKD,QAAQv2C,MAA9B,EAAsCwB,IAAIg1C,EAA1C,EAA8Ch1C,GAA9C,EAAoD;sBAE7C/B,IAAI82C,QAAQ/0C,CAAR,CAAV;4BAEU+iB,SAAV,CAAqB8uB,SAArB,EAAgC5zC,IAAI2kB,QAApC;4BAEWmxB,SAAX,EAAsB91C,CAAtB,EAAyBg2C,gBAAzB,EAA2CC,WAA3C,EAAwD1U,SAAxD,EAAmEuF,UAAnE,EAA+E,IAA/E;;aAVF,MAcO;oBAEA,IAAI/kC,KAAI,CAAR,EAAWI,IAAIyxC,UAAUrzC,MAAV,GAAmBokB,QAAxC,EAAkD5iB,KAAII,CAAtD,EAAyDJ,IAAzD,EAA+D;4BAEpD+iB,SAAV,CAAqB8uB,SAArB,EAAgC7xC,KAAI4iB,QAApC;4BAEWmxB,SAAX,EAAsB/zC,EAAtB,EAAyBi0C,gBAAzB,EAA2CC,WAA3C,EAAwD1U,SAAxD,EAAmEuF,UAAnE,EAA+E,IAA/E;;;UA3BH,MAiCO;gBAEAkQ,WAAWvyB,SAASuyB,QAA1B;iBAEM,IAAIj1C,MAAI,CAAR,EAAWI,KAAI60C,SAASz2C,MAA9B,EAAsCwB,MAAII,EAA1C,EAA6CJ,KAA7C,EAAmD;yBAEvCi1C,SAASj1C,GAAT,CAAX,EAAwBA,GAAxB,EAA2Bi0C,gBAA3B,EAA6CC,WAA7C,EAA0D1U,SAA1D,EAAqEuF,UAArE,EAAiF,IAAjF;;;;IApGJ;;AAoHDqB,SAAOxC,MAAP,GAAgB,YAAY;;CAA5B;;;;"}