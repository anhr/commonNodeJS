/**
 * @module Player
 * @description 3D objects animation.
 *
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.player={})}(this,function(e){"use strict";
/**
 * @module cookie
 * @description node.js version of the cookie.
 * Cookies let you store user information in web pages.
 * @see {@link https://www.w3schools.com/js/js_cookies.asp}
 *
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */function o(){return navigator.cookieEnabled}function n(e,t,n){o()?(t=t.toString(),void 0===n&&(n=new Date).setTime(n.getTime()+31536e6),document.cookie=e+"="+t+("undefined"==typeof settings?"":settings)+"; expires="+n.toGMTString(),""===document.cookie&&console.error("document.cookie is empty")):a()}function i(e,t){if(o()){e=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return e?unescape(e[2]):void 0===t?"":t}a()}function r(e,t){return JSON.parse(i(e,JSON.stringify(t)))}function a(){console.error("navigator.cookieEnabled = "+navigator.cookieEnabled)}function s(e){this.get=function(e){return e},this.set=function(){},this.getObject=function(e,n,o){o&&Object.keys(o).forEach(function(e){var t=o[e];void 0!==t&&(n[e]=JSON.parse(JSON.stringify(t)))})},this.copyObject=function(e,t){return JSON.parse(JSON.stringify(t))},this.setObject=function(){},this.isTrue=function(e){return e}}
/**
* node.js version of the cookie.
*
* @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
*
* @copyright 2011 Data Arts Team, Google Creative Lab
*
* @license under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*/var m={set:n,setObject:function(e,t){n(e,JSON.stringify(t))},get:i,getObject:function(e,t,n){(new s).getObject(e,t,r(e,n))},copyObject:r,defaultCookie:s},y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e};function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var J=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},u=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t};function p(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),i=Math.round(e.g),r=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var d=e.hex.toString(16);d.length<6;)d="0"+d;return"#"+d}return"CSS_RGB"===n?"rgb("+o+","+i+","+r+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+r+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+r+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+r+","+a+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+",a:"+a+"}":"unknown format"}var f,h=Array.prototype.forEach,_=Array.prototype.slice,g={BREAK:{},extend:function(n){return this.each(_.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(t[e])||(n[e]=t[e])}.bind(this))},this),n},defaults:function(n){return this.each(_.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(n[e])&&(n[e]=t[e])}.bind(this))},this),n},compose:function(){var n=_.call(arguments);return function(){for(var e=_.call(arguments),t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},each:function(e,t,n){if(e)if(h&&e.forEach&&e.forEach===h)e.forEach(t,n);else if(e.length===e.length+0){for(var o=void 0,o=0,i=e.length;o<i;o++)if(o in e&&t.call(n,e[o],o)===this.BREAK)return}else for(var r in e)if(t.call(n,e[r],r)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(o,i,r){var a=void 0;return function(){var e=this,t=arguments;var n=r||!a;clearTimeout(a),a=setTimeout(function(){a=null,r||o.apply(e,t)},i),n&&o.apply(e,t)}},toArray:function(e){return e.toArray?e.toArray():_.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:(f=function(e){return isNaN(e)},b.toString=function(){return f.toString()},b),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};function b(e){return f.apply(this,arguments)}var v,w=[{litmus:g.isString,conversions:{THREE_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:p},SIX_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:p},CSS_RGB:{read:function(e){e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:p},CSS_RGBA:{read:function(e){e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:p}}},{litmus:g.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:g.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:g.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(g.isNumber(e.r)&&g.isNumber(e.g)&&g.isNumber(e.b)&&g.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(g.isNumber(e.r)&&g.isNumber(e.g)&&g.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(g.isNumber(e.h)&&g.isNumber(e.s)&&g.isNumber(e.v)&&g.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(g.isNumber(e.h)&&g.isNumber(e.s)&&g.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],x=void 0,C=void 0,E=function(e){C=!1;var n=1<arguments.length?g.toArray(arguments):e;return g.each(w,function(e){if(e.litmus(n))return g.each(e.conversions,function(e,t){if(x=e.read(n),!1===C&&!1!==x)return(C=x).conversionName=t,x.conversion=e,g.BREAK}),g.BREAK}),C},S={hsv_to_rgb:function(e,t,n){var o=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),r=n*(1-t),e=n*(1-i*t),t=n*(1-(1-i)*t),o=[[n,t,r],[e,n,r],[r,n,t],[r,e,n],[t,r,n],[n,r,e]][o];return{r:255*o[0],g:255*o[1],b:255*o[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),i=Math.max(e,t,n),r=i-o,o=void 0;return 0===i?{h:NaN,s:0,v:0}:(o=e===i?(t-n)/r:t===i?2+(n-e)/r:4+(e-t)/r,(o/=6)<0&&(o+=1),{h:360*o,s:r/i,v:i/255})},rgb_to_hex:function(e,t,n){e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t);return e=this.hex_with_component(e,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(v=8*t)|e&~(255<<v)}},A="function"==typeof Symbol&&"symbol"===y(Symbol.iterator)?function(e){return void 0===e?"undefined":y(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":y(e)},k=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},T=function(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),e};function O(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function P(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0!==o){if("value"in o)return o.value;o=o.get;return void 0!==o?o.call(n):void 0}if(e=Object.getPrototypeOf(e),null!==e)return P(e,t,n)}var R=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":y(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},L=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":y(t))&&"function"!=typeof t?e:t},D=(T(N,[{key:"toString",value:function(){return p(this)}},{key:"toHexString",value:function(){return p(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),N);function N(){if(k(this,N),this.__state=E.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}function V(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||D.recalculateRGB(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(D.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function F(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||D.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(D.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}D.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=S.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");g.extend(e.__state,S.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},D.recalculateHSV=function(e){var t=S.rgb_to_hsv(e.r,e.g,e.b);g.extend(e.__state,{s:t.s,v:t.v}),g.isNaN(t.h)?g.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},D.COMPONENTS=["r","g","b","h","s","v","hex","a"],V(D.prototype,"r",2),V(D.prototype,"g",1),V(D.prototype,"b",0),F(D.prototype,"h"),F(D.prototype,"s"),F(D.prototype,"v"),Object.defineProperty(D.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(D.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=S.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var j=(T(B,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),B);function B(e,t){k(this,B),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}var H={};g.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){g.each(e,function(e){H[e]=t})});var M=/(\d+(\.\d+)?)px/;function z(e){if("0"===e||g.isUndefined(e))return 0;e=e.match(M);return g.isNull(e)?0:parseFloat(e[1])}var I={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){g.isUndefined(t)&&(t=!0),g.isUndefined(n)&&(n=!0),e.style.position="absolute",t&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var i=n||{},n=H[t];if(!n)throw new Error("Event type "+t+" not supported.");var r=document.createEvent(n);switch(n){case"MouseEvents":var a=i.x||i.clientX||0,s=i.y||i.clientY||0;r.initMouseEvent(t,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,a,s,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":s=r.initKeyboardEvent||r.initKeyEvent;g.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),s(t,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:r.initEvent(t,i.bubbles||!1,i.cancelable||!0)}g.defaults(r,o),e.dispatchEvent(r)},bind:function(e,t,n,o){o=o||!1;return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n),I},unbind:function(e,t,n,o){o=o||!1;return e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n),I},addClass:function(e,t){var n;return void 0===e.className?e.className=t:e.className===t||-1===(n=e.className.split(/ +/)).indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")),I},removeClass:function(e,t){var n;return t?e.className===t?e.removeAttribute("class"):-1!==(t=(n=e.className.split(/ +/)).indexOf(t))&&(n.splice(t,1),e.className=n.join(" ")):e.className=void 0,I},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){e=getComputedStyle(e);return z(e["border-left-width"])+z(e["border-right-width"])+z(e["padding-left"])+z(e["padding-right"])+z(e.width)},getHeight:function(e){e=getComputedStyle(e);return z(e["border-top-width"])+z(e["border-bottom-width"])+z(e["padding-top"])+z(e["padding-bottom"])+z(e.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)for(;n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent,t;);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},G=(R(X,j),T(X,[{key:"setValue",value:function(e){e=P(X.prototype.__proto__||Object.getPrototypeOf(X.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),P(X.prototype.__proto__||Object.getPrototypeOf(X.prototype),"updateDisplay",this).call(this)}}]),X);function X(e,t){k(this,X);var t=L(this,(X.__proto__||Object.getPrototypeOf(X)).call(this,e,t)),n=t;return t.__prev=t.getValue(),t.__checkbox=document.createElement("input"),t.__checkbox.setAttribute("type","checkbox"),I.bind(t.__checkbox,"change",function(){n.setValue(!n.__prev)},!1),t.domElement.appendChild(t.__checkbox),t.updateDisplay(),t}var U=(R(q,j),T(q,[{key:"setValue",value:function(e){e=P(q.prototype.__proto__||Object.getPrototypeOf(q.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e}},{key:"updateDisplay",value:function(){return I.isActive(this.__select)?this:(this.__select.value=this.getValue(),P(q.prototype.__proto__||Object.getPrototypeOf(q.prototype),"updateDisplay",this).call(this))}}]),q);function q(e,t,n){k(this,q);var o,t=L(this,(q.__proto__||Object.getPrototypeOf(q)).call(this,e,t)),n=n,i=t;return t.__select=document.createElement("select"),g.isArray(n)&&(o={},g.each(n,function(e){o[e]=e}),n=o),g.each(n,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),i.__select.appendChild(n)}),t.updateDisplay(),I.bind(t.__select,"change",function(){var e=this.options[this.selectedIndex].value;i.setValue(e)}),t.domElement.appendChild(t.__select),t}var W=(R(Y,j),T(Y,[{key:"updateDisplay",value:function(){return I.isActive(this.__input)||(this.__input.value=this.getValue()),P(Y.prototype.__proto__||Object.getPrototypeOf(Y.prototype),"updateDisplay",this).call(this)}}]),Y);function Y(e,t){k(this,Y);var t=L(this,(Y.__proto__||Object.getPrototypeOf(Y)).call(this,e,t)),n=t;function o(){n.setValue(n.__input.value)}return t.__input=document.createElement("input"),t.__input.setAttribute("type","text"),I.bind(t.__input,"keyup",o),I.bind(t.__input,"change",o),I.bind(t.__input,"blur",function(){n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())}),I.bind(t.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),t.updateDisplay(),t.domElement.appendChild(t.__input),t}function K(e){e=e.toString();return-1<e.indexOf(".")?e.length-e.indexOf(".")-1:0}var Q=(R(Z,j),T(Z,[{key:"setValue",value:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),P(Z.prototype.__proto__||Object.getPrototypeOf(Z.prototype),"setValue",this).call(this,e)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=K(e),this}}]),Z);function Z(e,t,n){k(this,Z);t=L(this,(Z.__proto__||Object.getPrototypeOf(Z)).call(this,e,t)),n=n||{};return t.__min=n.min,t.__max=n.max,t.__step=n.step,g.isUndefined(t.__step)?0===t.initialValue?t.__impliedStep=1:t.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(t.initialValue))/Math.LN10))/10:t.__impliedStep=t.__step,t.__precision=K(t.__impliedStep),t}var $=(R(ee,Q),T(ee,[{key:"updateDisplay",value:function(){var e,t;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),t=this.__precision,t=Math.pow(10,t),Math.round(e*t)/t),P(ee.prototype.__proto__||Object.getPrototypeOf(ee.prototype),"updateDisplay",this).call(this)}}]),ee);function ee(e,t,n){k(this,ee);n=L(this,(ee.__proto__||Object.getPrototypeOf(ee)).call(this,e,t,n));n.__truncationSuspended=!1;var o=n,i=void 0;function r(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function a(e){var t=i-e.clientY;o.setValue(o.getValue()+t*o.__impliedStep),i=e.clientY}function s(){I.unbind(window,"mousemove",a),I.unbind(window,"mouseup",s),r()}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),I.bind(n.__input,"change",function(){var e=parseFloat(o.__input.value);g.isNaN(e)||o.setValue(e)}),I.bind(n.__input,"blur",function(){r()}),I.bind(n.__input,"mousedown",function(e){I.bind(window,"mousemove",a),I.bind(window,"mouseup",s),i=e.clientY}),I.bind(n.__input,"keydown",function(e){13===e.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,r())}),n.updateDisplay(),n.domElement.appendChild(n.__input),n}function te(e,t,n,o,i){return o+(e-t)/(n-t)*(i-o)}var ne=(R(oe,Q),T(oe,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",P(oe.prototype.__proto__||Object.getPrototypeOf(oe.prototype),"updateDisplay",this).call(this)}}]),oe);function oe(e,t,n,o,i){k(this,oe);var i=L(this,(oe.__proto__||Object.getPrototypeOf(oe)).call(this,e,t,{min:n,max:o,step:i})),r=i;function a(e){e.preventDefault();var t=r.__background.getBoundingClientRect();return r.setValue(te(e.clientX,t.left,t.right,r.__min,r.__max)),!1}function s(){I.unbind(window,"mousemove",a),I.unbind(window,"mouseup",s),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function l(e){var t=e.touches[0].clientX,e=r.__background.getBoundingClientRect();r.setValue(te(t,e.left,e.right,r.__min,r.__max))}function c(){I.unbind(window,"touchmove",l),I.unbind(window,"touchend",c),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}return i.__background=document.createElement("div"),i.__foreground=document.createElement("div"),I.bind(i.__background,"mousedown",function(e){document.activeElement.blur(),I.bind(window,"mousemove",a),I.bind(window,"mouseup",s),a(e)}),I.bind(i.__background,"touchstart",function(e){if(1!==e.touches.length)return;I.bind(window,"touchmove",l),I.bind(window,"touchend",c),l(e)}),I.addClass(i.__background,"slider"),I.addClass(i.__foreground,"slider-fg"),i.updateDisplay(),i.__background.appendChild(i.__foreground),i.domElement.appendChild(i.__background),i}var ie=(R(re,j),T(re,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),re);function re(e,t,n){k(this,re);var t=L(this,(re.__proto__||Object.getPrototypeOf(re)).call(this,e,t)),o=t;return t.__button=document.createElement("div"),t.__button.innerHTML=void 0===n?"Fire":n,I.bind(t.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),I.addClass(t.__button,"button"),t.domElement.appendChild(t.__button),t}var ae=(R(se,j),T(se,[{key:"updateDisplay",value:function(){var t,n=E(this.getValue());!1!==n&&(t=!1,g.each(D.COMPONENTS,function(e){if(!g.isUndefined(n[e])&&!g.isUndefined(this.__color.__state[e])&&n[e]!==this.__color.__state[e])return t=!0,{}},this),t&&g.extend(this.__color.__state,n)),g.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var e=this.__color.v<.5||.5<this.__color.s?255:0,o=255-e;g.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+e+","+e+","+e+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,ce(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),g.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+e+","+e+","+e+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),se);function se(e,t){k(this,se);var n=L(this,(se.__proto__||Object.getPrototypeOf(se)).call(this,e,t));n.__color=new D(n.getValue()),n.__temp=new D(0);var o=n;n.domElement=document.createElement("div"),I.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",I.bind(n.__input,"keydown",function(e){13===e.keyCode&&l.call(this)}),I.bind(n.__input,"blur",l),I.bind(n.__selector,"mousedown",function(){I.addClass(this,"drag").bind(window,"mouseup",function(){I.removeClass(o.__selector,"drag")})}),I.bind(n.__selector,"touchstart",function(){I.addClass(this,"drag").bind(window,"touchend",function(){I.removeClass(o.__selector,"drag")})});e=document.createElement("div");function i(e){d(e),I.bind(window,"mousemove",d),I.bind(window,"touchmove",d),I.bind(window,"mouseup",a),I.bind(window,"touchend",a)}function r(e){u(e),I.bind(window,"mousemove",u),I.bind(window,"touchmove",u),I.bind(window,"mouseup",s),I.bind(window,"touchend",s)}function a(){I.unbind(window,"mousemove",d),I.unbind(window,"touchmove",d),I.unbind(window,"mouseup",a),I.unbind(window,"touchend",a),c()}function s(){I.unbind(window,"mousemove",u),I.unbind(window,"touchmove",u),I.unbind(window,"mouseup",s),I.unbind(window,"touchend",s),c()}function l(){var e=E(this.value);!1!==e?(o.__color.__state=e,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function c(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function d(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,e=n.clientX,n=n.clientY,e=(e-t.left)/(t.right-t.left),t=1-(n-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),1<e?e=1:e<0&&(e=0),o.__color.v=t,o.__color.s=e,o.setValue(o.__color.toOriginal()),!1}function u(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__hue_field.getBoundingClientRect(),t=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),o.__color.h=360*t,o.setValue(o.__color.toOriginal()),!1}return g.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),g.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),g.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),g.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),g.extend(e.style,{width:"100%",height:"100%",background:"none"}),ce(e,"top","rgba(0,0,0,0)","#000"),g.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(t=n.__hue_field).style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",g.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),I.bind(n.__saturation_field,"mousedown",i),I.bind(n.__saturation_field,"touchstart",i),I.bind(n.__field_knob,"mousedown",i),I.bind(n.__field_knob,"touchstart",i),I.bind(n.__hue_field,"mousedown",r),I.bind(n.__hue_field,"touchstart",r),n.__saturation_field.appendChild(e),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}var le=["-moz-","-o-","-webkit-","-ms-",""];function ce(t,n,o,i){t.style.background="",g.each(le,function(e){t.style.cssText+="background: "+e+"linear-gradient("+n+", "+o+" 0%, "+i+" 100%); "})}var de=function(e,t,n,o,i){var r=e[t];return g.isArray(n)||g.isObject(n)?new U(e,t,n):g.isNumber(r)?g.isNumber(n)&&g.isNumber(o)?g.isNumber(i)?new ne(e,t,n,o,i):new ne(e,t,n,o):g.isNumber(i)?new $(e,t,{min:n,max:o,step:i}):new $(e,t,{min:n,max:o}):g.isString(r)?new W(e,t):g.isFunction(r)?new ie(e,t,""):g.isBoolean(r)?new G(e,t):null},ue=(R(pe,j),T(pe,[{key:"controller",set:function(e){this._controller=e},get:function(){return this._controller}}]),pe);function pe(e,t){k(this,pe);var n=L(this,(pe.__proto__||Object.getPrototypeOf(pe)).call(this,e,t));return n.arguments={object:e,property:t,opts:Array.prototype.slice.call(arguments,2)},e.property&&(n.property=e.property(n)),n}R=function(e,t){var t=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var o=t.getElementsByTagName("head")[0];try{o.appendChild(n)}catch(e){}};var fe=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},he=(T(_e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),g.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",I.unbind(t.domElement,"webkitTransitionEnd",e),I.unbind(t.domElement,"transitionend",e),I.unbind(t.domElement,"oTransitionEnd",e)}var t=this;I.bind(this.domElement,"webkitTransitionEnd",e),I.bind(this.domElement,"transitionend",e),I.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-I.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-I.getHeight(this.domElement)/2+"px"}}]),_e);function _e(){k(this,_e),this.backgroundElement=document.createElement("div"),g.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),I.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),g.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;I.bind(this.backgroundElement,"click",function(){e.hide()})}R(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var me="Default",ge=function(){try{return!!window.localStorage}catch(e){return!1}}(),be=void 0,ve=!0,ye=void 0,we=!1,xe=[],Ce=function t(e){var n=this,o=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),I.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=g.defaults(o,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),o=g.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),g.isUndefined(o.load)?o.load={preset:me}:o.preset&&(o.load.preset=o.preset),g.isUndefined(o.parent)&&o.hideable&&xe.push(this),o.resizable=g.isUndefined(o.parent)&&o.resizable,o.autoPlace&&g.isUndefined(o.scrollable)&&(o.scrollable=!0);var i,r,a,s,l=ge&&"true"===localStorage.getItem(Oe(0,"isLocal")),c=void 0,d=void 0;function u(e){return e.preventDefault(),r.width+=a-e.clientX,r.onResize(),a=e.clientX,!1}function p(){I.removeClass(r.__closeButton,Ce.CLASS_DRAG),I.unbind(window,"mousemove",u),I.unbind(window,"mouseup",p)}function f(e){return e.preventDefault(),a=e.clientX,I.addClass(r.__closeButton,Ce.CLASS_DRAG),I.bind(window,"mousemove",u),I.bind(window,"mouseup",p),!1}Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return(n.parent?n.getRoot():o.load).preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,Le(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,d&&(d.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(e){o.closed=e,o.closed?I.addClass(n.__ul,t.CLASS_CLOSED):I.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return l},set:function(e){ge&&((l=e)?I.bind(window,"unload",c):I.unbind(window,"unload",c),localStorage.setItem(Oe(0,"isLocal"),e))}}}),g.isUndefined(o.parent)?(this.closed=o.closed||!1,I.addClass(this.domElement,t.CLASS_MAIN),I.makeSelectable(this.domElement,!1),ge&&l&&(n.useLocalStorage=!0,(i=localStorage.getItem(Oe(0,"gui")))&&(o.load=JSON.parse(i))),this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,I.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),o.closeOnTop?(I.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(I.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),I.bind(this.__closeButton,"click",function(){n.closed=!n.closed})):(void 0===o.closed&&(o.closed=!0),i=document.createTextNode(o.name),I.addClass(i,"controller-name"),d=Ee(n,i),I.addClass(this.__ul,t.CLASS_CLOSED),I.addClass(d,"title"),I.bind(d,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),o.closed||(this.closed=!1)),o.autoPlace&&(g.isUndefined(o.parent)&&(ve&&(ye=document.createElement("div"),I.addClass(ye,"dg"),I.addClass(ye,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(ye),ve=!1),ye.appendChild(this.domElement),I.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||Le(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},I.bind(window,"resize",this.__resizeHandler),I.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),I.bind(this.__ul,"transitionend",this.__resizeHandler),I.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&(a=void 0,(r=this).__resize_handle=document.createElement("div"),g.extend(r.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),I.bind(r.__resize_handle,"mousedown",f),I.bind(r.__closeButton,"mousedown",f),r.domElement.insertBefore(r.__resize_handle,r.domElement.firstElementChild)),c=function(){ge&&"true"===localStorage.getItem(Oe(0,"isLocal"))&&localStorage.setItem(Oe(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=c,o.parent||((s=n.getRoot()).width+=1,g.defer(function(){--s.width}))};function Ee(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o),e.onResize(),o}function Se(e){I.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&I.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function Ae(e,t){e=e.__preset_select[e.__preset_select.selectedIndex];e.innerHTML=t?e.value+"*":e.value}function ke(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[t.property]=t,n.load&&n.load.remembered){i=n.load.remembered,n=void 0;if(i[e.preset])n=i[e.preset];else{if(!i[me])return;n=i[me]}n[o]&&void 0!==n[o][t.property]&&(o=n[o][t.property],t.initialValue=o,t.setValue(o))}}}function Te(e,t,n,o){var i;if(t.arguments&&(t=(i=t).arguments.object,n=i.arguments.property,o={factoryArgs:i.arguments.opts}),void 0===i&&void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var r=void 0;null===(r=o.color?new ae(t,n):void 0!==i&&"string"==typeof i.property?i:(l=[t,n].concat(o.factoryArgs),de.apply(e,l)))?r=i:void 0!==i&&(i.controller=r),o.before instanceof j&&(o.before=o.before.__li),ke(e,r),I.addClass(r.domElement,"c");var a=document.createElement("span");if(I.addClass(a,"property-name"),void 0!==i&&"object"===A(i.property))for(var s in i.property)a.appendChild(i.property[s]);else a.innerHTML=r.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(r.domElement);var c,d,u,p,o=Ee(e,l,o.before);return I.addClass(o,Ce.CLASS_CONTROLLER_ROW),r instanceof ae?I.addClass(o,"color"):I.addClass(o,A(r.getValue())),c=e,d=o,(u=r).__li=d,u.__gui=c,g.extend(u,{options:function(e){if(1<arguments.length){var t=u.__li.nextElementSibling;return u.remove(),Te(c,u.object,u.property,{before:t,factoryArgs:[g.toArray(arguments)]})}if(g.isArray(e)||g.isObject(e)){t=u.__li.nextElementSibling;return u.remove(),Te(c,u.object,u.property,{before:t,factoryArgs:[e]})}},name:function(e){return u.__li.firstElementChild.firstElementChild.innerHTML=e,u},listen:function(){return u.__gui.listen(u),u},remove:function(){return u.__gui.remove(u),u}}),u instanceof ne?(p=new $(u.object,u.property,{min:u.__min,max:u.__max,step:u.__step}),g.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(e){var t=u[e],n=p[e];u[e]=p[e]=function(){var e=Array.prototype.slice.call(arguments);return n.apply(p,e),t.apply(u,e)}}),I.addClass(d,"has-slider"),u.domElement.insertBefore(p.domElement,u.domElement.firstElementChild)):u instanceof $?(o=function(e){if(g.isNumber(u.__min)&&g.isNumber(u.__max)){var t=u.__li.firstElementChild.firstElementChild.innerHTML,n=-1<u.__gui.__listening.indexOf(u);u.remove();var o=Te(c,u.object,u.property,{before:u.__li.nextElementSibling,factoryArgs:[u.__min,u.__max,u.__step]});return o.name(t),n&&o.listen(),o}return e},u.min=g.compose(o,u.min),u.max=g.compose(o,u.max)):u instanceof G?(I.bind(d,"click",function(){I.fakeEvent(u.__checkbox,"click")}),I.bind(u.__checkbox,"click",function(e){e.stopPropagation()})):u instanceof ie?(I.bind(d,"click",function(){I.fakeEvent(u.__button,"click")}),I.bind(d,"mouseover",function(){I.addClass(u.__button,"hover")}),I.bind(d,"mouseout",function(){I.removeClass(u.__button,"hover")})):u instanceof ae&&(I.addClass(d,"color"),u.updateDisplay=g.compose(function(e){return d.style.borderLeftColor=u.__color.toString(),e},u.updateDisplay),u.updateDisplay()),u.setValue=g.compose(function(e){return c.getRoot().__preset_select&&u.isModified()&&Ae(c.getRoot(),!0),e},u.setValue),e.__controllers.push(r),r}function Oe(e,t){return document.location.href+"."+t}function Pe(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function Re(e,t){t.style.display=e.useLocalStorage?"block":"none"}function Le(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function De(i,r){var a={};return g.each(i.__rememberedObjects,function(e,t){var n={},o=i.__rememberedObjectIndecesToControllers[t];g.each(o,function(e,t){n[t]=r?e.initialValue:e.getValue()}),a[t]=n}),a}Ce.toggleHide=function(){we=!we,g.each(xe,function(e){e.domElement.style.display=we?"none":""})},Ce.CLASS_AUTO_PLACE="a",Ce.CLASS_AUTO_PLACE_CONTAINER="ac",Ce.CLASS_MAIN="main",Ce.CLASS_CONTROLLER_ROW="cr",Ce.CLASS_TOO_TALL="taller-than-window",Ce.CLASS_CLOSED="closed",Ce.CLASS_CLOSE_BUTTON="close-button",Ce.CLASS_CLOSE_TOP="close-top",Ce.CLASS_CLOSE_BOTTOM="close-bottom",Ce.CLASS_DRAG="drag",Ce.DEFAULT_WIDTH=245,Ce.TEXT_CLOSED="Close Controls",Ce.TEXT_OPEN="Open Controls",Ce._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||Ce.toggleHide()},I.bind(window,"keydown",Ce._keydownHandler,!1),g.extend(Ce.prototype,{add:function(e,t){return Te(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Te(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;g.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&ye.removeChild(this.domElement);var t=this;g.each(this.__folders,function(e){t.removeFolder(e)}),I.unbind(window,"keydown",Ce._keydownHandler,!1),Se(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);t=new Ce(t);this.__folders[e]=t;e=Ee(this,t.domElement);return I.addClass(e,"folder"),t},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],Se(t);var e=this;g.each(t.__folders,function(e){t.removeFolder(e)}),g.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e,t,n=this.getRoot();n.scrollable&&(e=I.getOffset(n.__ul).top,t=0,g.each(n.__ul.childNodes,function(e){n.autoPlace&&e===n.__save_row||(t+=I.getHeight(e))}),window.innerHeight-e-20<t?(I.addClass(n.domElement,Ce.CLASS_TOO_TALL),n.__ul.style.height=window.innerHeight-e-20+"px"):(I.removeClass(n.domElement,Ce.CLASS_TOO_TALL),n.__ul.style.height="auto")),n.__resize_handle&&g.defer(function(){n.__resize_handle.style.height=n.__ul.offsetHeight+"px"}),n.__closeButton&&(n.__closeButton.style.width=n.width+"px")},onResizeDebounced:g.debounce(function(){this.onResize()},50),remember:function(){if(g.isUndefined(be)&&((be=new he).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;g.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(n){var e=n.__save_row=document.createElement("li");I.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),I.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",I.addClass(t,"button gears");var o=document.createElement("span");o.innerHTML="Save",I.addClass(o,"button"),I.addClass(o,"save");var i=document.createElement("span");i.innerHTML="New",I.addClass(i,"button"),I.addClass(i,"save-as");var r=document.createElement("span");r.innerHTML="Revert",I.addClass(r,"button"),I.addClass(r,"revert");var a=n.__preset_select=document.createElement("select");n.load&&n.load.remembered?g.each(n.load.remembered,function(e,t){Pe(n,t,t===n.preset)}):Pe(n,me,!1);{var s;I.bind(a,"change",function(){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].innerHTML=n.__preset_select[e].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(o),e.appendChild(i),e.appendChild(r),ge&&(s=document.getElementById("dg-local-explain"),e=document.getElementById("dg-local-storage"),document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(Oe(0,"isLocal"))&&e.setAttribute("checked","checked"),Re(n,s),I.bind(e,"change",function(){n.useLocalStorage=!n.useLocalStorage,Re(n,s)}))}var l=document.getElementById("dg-new-constructor");I.bind(l,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||be.hide()}),I.bind(t,"click",function(){l.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),be.show(),l.focus(),l.select()}),I.bind(o,"click",function(){n.save()}),I.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&n.saveAs(e)}),I.bind(r,"click",function(){n.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&Le(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var n=this.load;return n.closed=this.closed,0<this.__rememberedObjects.length&&(n.preset=this.preset,n.remembered||(n.remembered={}),n.remembered[this.preset]=De(this)),n.folders={},g.each(this.__folders,function(e,t){n.folders[t]=e.getSaveObject()}),n},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=De(this),Ae(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[me]=De(this,!0)),this.load.remembered[e]=De(this),this.preset=e,Pe(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(t){g.each(this.__controllers,function(e){this.getRoot().load.remembered?ke(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),g.each(this.__folders,function(e){e.revert(e)}),t||Ae(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&fe.call(window,function(){e(t)});g.each(t,function(e){e.updateDisplay()})}(this.__listening)},updateDisplay:function(){g.each(this.__controllers,function(e){e.updateDisplay()}),g.each(this.__folders,function(e){e.updateDisplay()})}});var Ne,T={Controller:j,BooleanController:G,OptionController:U,StringController:W,NumberController:Q,NumberControllerBox:$,NumberControllerSlider:ne,FunctionController:ie,ColorController:ae,CustomController:ue};
/**
 * Modify of the dat object.
 * @see {@link https://github.com/dataarts/dat.gui} about dat.gui
 *
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
function Ve(){}void 0!==Ve&&(Ne=function(e,t,n){void 0===t&&console.warn("elNameAndTitle: name = "+t),e.innerHTML=t,void 0!==n&&(e.title=n)},Ve.GUI=Ce,void 0===Ve.controllerNameAndTitle?Ve.controllerNameAndTitle=function(e,t,n){Ne(e.__li.querySelector(".property-name"),t,n)}:console.error("Duplicate dat.controllerNameAndTitle method."),void 0===Ve.folderNameAndTitle?Ve.folderNameAndTitle=function(e,t,n){Ne(e.__ul.querySelector("li.title"),t,n)}:console.error("Duplicate dat.folderNameAndTitle method."),void 0===Ve.controllerZeroStep?Ve.controllerZeroStep=function(e,t,n,o){var e=e.add(t,n),i=e.__input;return e.__input=document.createElement("input"),i.value=t[n],i.onchange=function(e){t[n]=parseFloat(i.value),void 0!==o&&o(t[n])},e.setValue=function(e){i.value=t[n]=e},e}:console.error("Duplicate dat.controllerZeroStep method."),void 0===Ve.controllerSetValue?Ve.controllerSetValue=function(e,t){e.setValue(t),e.__li.querySelector("select").selectedIndex=t}:console.error("Duplicate dat.controllerSetValue method.")
/**
* custom controller, allow to user to change a value step by step.
*
* @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
*
* @copyright 2011 Data Arts Team, Google Creative Lab
*
* @license under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*/);var Fe={addButton:function(e,t){t=t||{};var n=document.createElement("span");return n.innerHTML=e,void 0!==t.title&&(n.title=t.title),void 0!==t.onclick&&(n.style.cursor="pointer",n.onclick=t.onclick),void 0!==t.onwheel&&(e=function(e){e=(e=e||window.event).deltaY||e.detail||e.wheelDelta;t.onwheel(e)},n.style.cursor="n-resize",n.addEventListener?"onwheel"in document?n.addEventListener("wheel",e):"onmousewheel"in document?n.addEventListener("mousewheel",e):n.addEventListener("MozMousePixelScroll",e):n.attachEvent("onmousewheel",e)),n.style.margin="0px 2px",n}},je=(c(Be,T.CustomController),Be);
/**
 * @module ScaleController
 * @description is dat.GUI graphical user interface controller for control of the scale of threejs 3D object
 *
 * @see {@link https://threejs.org/} about threejs
 * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI
 *
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */function Be(r,a){d(this,Be),(a=a||{}).settings=a.settings||{},a.settings.zoomMultiplier=a.settings.zoomMultiplier||1.1;var e=u(this,(Be.__proto__||Object.getPrototypeOf(Be)).call(this,{multiplier:a.settings.zoomMultiplier,property:function(e){var t={zoom:"Zoom",in:"in",out:"out",wheelZoom:"Scroll the mouse wheel to zoom"},n=void 0===a.getLanguageCode?"en":a.getLanguageCode();switch(n){case"ru":t.zoom="",t.in="",t.out="",t.wheelZoom="     ";break;default:if(void 0===a.lang||a.lang.languageCode!=n)break;Object.keys(a.lang).forEach(function(e){void 0!==t[e]&&(t[e]=a.lang[e])})}var o={},i=Fe.addButton;return o.zoomLabel=i(t.zoom,{title:t.wheelZoom,onwheel:function(n){r(e,function(e,t){return 0<n?e*=t:e/=t,e})}}),o.in=i("",{title:t.in,onclick:function(){r(e,function(e,t){return e*=t})}}),o.out=i("",{title:t.out,onclick:function(){r(e,function(e,t){return e/=t})}}),o}},"multiplier",1.1,10,.1));return void 0===e.property&&console.error("init() returns "+e.property),e}
/**
 * PositionController is dat.GUI graphical user interface controller for control of the position of threejs 3D object
 *
 * @see {@link https://threejs.org/} about threejs
 * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI
 *
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var He=(c(Me,T.CustomController),Me);
/**
 * node.js version of the synchronous download of the file.
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */function Me(r,a){d(this,Me),(a=a||{}).settings=a.settings||{};var e=a.settings;a.min=a.min||.1,a.max=a.max||10,e.offset=e.offset||.1,a.step=a.step||.1;e=u(this,(Me.__proto__||Object.getPrototypeOf(Me)).call(this,{offset:e.offset,property:function(n){var t={offset:"Offset",add:"add",subtract:"subtract",wheelPosition:"Scroll the mouse wheel to change the position"},e=void 0===a.getLanguageCode?"en":a.getLanguageCode();switch(e){case"ru":t.offset="",t.add="",t.subtract="",t.wheelPosition="     ";break;default:if(void 0===a.lang||a.lang.languageCode!=e)break;Object.keys(a.lang).forEach(function(e){void 0!==t[e]&&(t[e]=a.lang[e])})}var o={},i=Fe.addButton;return o.Label=i(t.offset,{title:t.wheelPosition,onwheel:function(e){var t=n.controller.getValue();r(0<e?t:-t)}}),o.in=i("",{title:t.add,onclick:function(){r(n.controller.getValue())}}),o.out=i("",{title:t.subtract,onclick:function(){r(-n.controller.getValue())}}),o}},"offset",a.min,a.max,a.step));return void 0===e.property&&console.error("init() returns "+e.property),e}function ze(t){if(this.loadXMLDoc=function(){var e;if(window.XMLHttpRequest){if(!(e=new XMLHttpRequest))throw"new XMLHttpRequest() failed!"}else{if(!window.ActiveXObject)throw"myRequest.loadXMLDoc(...) failed!";if(!(e=this.NewActiveXObject()))throw"NewActiveXObject() failed!"}return e},this.NewActiveXObject=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}return a('This browser does not support XMLHttpRequest. Probably, your security settings do not allow Web sites to use ActiveX controls installed on your computer. Refresh your Web page to find out the current status of your Web page or enable the "Initialize and script ActiveX controls not marked as safe" and "Run Active X controls and plug-ins" of the Security settings of the Internet zone of your browser.'),null},this.XMLHttpRequestStart=function(e,t){this.XMLHttpRequestStop(),this.req.onreadystatechange=e,"onerror"in this.req&&(this.req.onerror=function(e){a("XMLHttpRequest error. url: "+this.url)}),this.XMLHttpRequestReStart(t)},this.getUrl=function(){return void 0!==this.url&&null!=this.url||(this.url="XMLHttpRequest.xml"),this.url+(this.params||"")},this.XMLHttpRequestReStart=function(e){try{void 0===e&&(e=!0),this.req.open("GET",this.getUrl(),e),e&&("timeout"in this.req&&(this.req.timeout=9e4),"ontimeout"in this.req?this.req.ontimeout=function(){a("XMLHttpRequest timeout")}:(clearTimeout(this.timeout_id_SendReq),this.timeout_id_SendReq=setTimeout(function(){a("XMLHttpRequest timeout 2")},9e4))),this.req.send(null)}catch(e){a(e.message+" url: "+this.url)}},this.XMLHttpRequestStop=function(){null!=this.req&&this.req.abort()},this.ProcessReqChange=function(e){var t=this.req;switch(t.readyState){case 4:if("unknown"==typeof t.status)return consoleError('typeof XMLHttpRequest status == "unknown"'),!0;if(200==t.status)return clearTimeout(this.timeout_id_SendReq),e(this);a("Invalid XMLHttpRequest status : "+t.status+" url: "+this.url);break;case 1:case 2:case 3:break;case 0:default:throw"processReqChange(); req.readyState = "+t.readyState}return!0},this.processStatus200Error=function(){var e=this.GetElementText("error",!0);return!!e&&(a(e),!0)},this.GetElementText=function(e,t){var n=this.req;if(!n.responseXML)return 1!=t&&a("GetXMLElementText(xmlhttp, "+e+"); xmlhttp.responseXML is null.\nxmlhttp.responseText:\n"+n.responseText),null;var o=n.responseXML.getElementsByTagName(e);if(0==o.length)return 1!=t&&a('GetXMLElementText(xmlhttp, "'+e+'"); element.length == '+o.length),"";for(var i="",r=0;r<o.length;r++)if(void 0===o[r].textContent){if(void 0===o[r].text)return a("GetXMLElementText(xmlhttp, "+e+"); element["+r+"].text) == undefined"),"";""!=i&&(i+=" "),i+=o[r].text}else i+=o[r].textContent;return i},t.data)this.req=t.data.req,this.url=t.data.url,this.params=t.data.params;else try{this.req=this.loadXMLDoc()}catch(e){var n=void 0===e.message?e:e.message;return void a("Your browser is too old and is not compatible with our site.\n\n"+window.navigator.appName+" "+window.navigator.appVersion+"\n\n"+n)}function a(e){console.error(e),t.onerror(e)}this.req||consoleError("Invalid myRequest.req: "+this.req)}function Ie(t,n){(n=n||{}).onload=n.onload||function(){},n.onerror=n.onerror||function(){};var o,e=new ze(n);return e.url=t,e.XMLHttpRequestStart(function(){e.ProcessReqChange(function(e){e.processStatus200Error()||(o=e.req.responseText,n.onload(o,t))})},!1),o}
/**
 * node.js version of the load JavaScript file
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * Thanks to:
 *http://javascript.ru/forum/events/21439-dinamicheskaya-zagruzka-skriptov.html
 *https://learn.javascript.ru/onload-onerror
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */function Ge(e,t){if(t.tag=t.tag||{},"string"==typeof t.tag){if("style"!==t.tag)return void console.error("Invalid options.tag: "+t.tag);t.tag={name:"style",attribute:{name:"rel",value:"stylesheet"}}}t.tag.name=t.tag.name||"script";var n=document.createElement(t.tag.name);t.tag.attribute=t.tag.attribute||{},t.tag.attribute.name=t.tag.attribute.name||"type",t.tag.attribute.value=t.tag.attribute.value||"text/javascript",n.setAttribute(t.tag.attribute.name,t.tag.attribute.value),e(n),t.appendTo.appendChild(n)}function Xe(e,t){for(var n=e.querySelectorAll("script"),o=0;o<n.length;o++)if(n[o].id===t)return 1}var Ue,R={sync:function(t,n){if((n=n||{}).onload=n.onload||function(){},n.onerror=n.onerror||function(){},n.appendTo=n.appendTo||document.getElementsByTagName("head")[0],Xe(n.appendTo,t))n.onload();else if(t instanceof Array){for(var o,i={appendTo:n.appendTo,tag:n.tag,onload:function(e,t){console.log("loadScript.sync.onload: "+t)},onerror:function(e){n.onerror(e),o=e}},e=0;e<t.length;e++){var r=t[e];if(Ge(function(e){e.setAttribute("id",r),e.innerHTML=Ie(r,i)},i),void 0!==o)break}void 0===o&&n.onload()}else Ge(function(e){e.setAttribute("id",t),e.innerHTML=Ie(t,n)},n)},async:function(e,o){var i;function r(t){function n(){e instanceof Array&&i<e.length-1?r(e[++i]):o.onload()}Xe(o.appendTo,t,o.onload)?n():Ge(function(e){e.setAttribute("id",t),e.readyState&&!e.onload?e.onreadystatechange=function(){"complete"==e.readyState&&void 0!==o.onload&&o.onload(),"loaded"==e.readyState&&(setTimeout(o.onload,0),this.onreadystatechange=null)}:(e.onload=function(){console.log("loadScript.async.onload() "+t),void 0!==o.onload&&n()},e.onerror=function(e){var t='loadScript: "'+this.src+'" failed';void 0!==o.onerror&&o.onerror(t,e),console.error(t)}),e.src=t},o)}(o=o||{}).appendTo=o.appendTo||document.getElementsByTagName("head")[0],o.onload=o.onload||function(){},e instanceof Array?r(e[i=0]):r(e)}},Q=(Ue=function(){if(document.currentScript&&""!==document.currentScript.src)return document.currentScript.src;var e=document.getElementsByTagName("script");return""!==e[e.length-1].src?src:(new Error).stack.match(/(https?:[^:]*)/)[0]}()).substring(0,Ue.lastIndexOf("/"));
/**
 * @module ColorPicker
 * @description Pure JavaScript color picker.
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 * @See Thanks to [FlexiColorPicker]{@link https://github.com/DavidDurman/FlexiColorPicker}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */R.sync(Q+"/colorpicker.css",{tag:"style"});var qe,We=window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",Ye="http://www.w3.org/2000/svg",Je=0,Ke={BGRW:0,monochrome:1,bidirectional:2,rainbow:3};function Qe(e,t,n){for(var o in e=document.createElementNS(Ye,e),t)e.setAttribute(o,t[o]);"[object Array]"!=Object.prototype.toString.call(n)&&(n=[n]);for(var i=0,r=n[0]&&n.length||0;i<r;i++)e.appendChild(n[i]);return e}function Ze(p){function e(e,t,n,o){return{percent:e,r:t,g:n,b:o}}void 0===(p=p||{}).palette&&(p.palette=Ke.BGRW);var f=[new e(0,0,0,255),new e(33,0,255,0),new e(66,255,255,0),new e(100,255,255,255)];switch(y(p.palette)){case"number":switch(p.palette){case Ke.BGRW:break;case Ke.monochrome:f=[new e(0,0,0,0),new e(100,255,255,255)];break;case Ke.bidirectional:f=[new e(0,255,48,48),new e(50,48,48,48),new e(100,48,255,48)];break;case Ke.rainbow:f=[new e(0,255,50,50),new e(16,252,245,40),new e(32,40,252,40),new e(50,40,252,248),new e(66,39,46,249),new e(82,255,40,251),new e(100,255,50,50)];break;default:console.error("ColorPicker.create.Palette: invalid options.palette = "+p.palette)}break;case"object":if(Array.isArray(p.palette)){f=p.palette;break}default:var t="invalid options.palette = "+p.palette;console.error("ColorPicker.create.Palette: "+t),p.onError(t)}this.getPalette=function(){var t=[];return f.forEach(function(e){t.unshift(Qe("stop",{offset:100-e.percent+"%","stop-color":"#"+("0"+Number(e.r).toString(16)).slice(-2).toUpperCase()+("0"+Number(e.g).toString(16)).slice(-2).toUpperCase()+("0"+Number(e.b).toString(16)).slice(-2).toUpperCase(),"stop-opacity":"1"}))}),t},this.hsv2rgb=function(e,t,n){var i=parseFloat(e);void 0!==t&&void 0!==n&&(i=100/(n-t)*(i-t));var o,r,a=f[f.length-1];100!==a.percent&&(o={},Object.keys(a).forEach(function(e){o[e]=a[e]}),o.percent=100,f.push(o));for(var s=0;s<f.length;s++){var l=f[s];if(void 0===r&&(r=l),i>=r.percent&&i<=l.percent){var c=function(e,t,n,o){n-=e;return 0==n?t:Math.round(t+(o-t)/n*(i-e))},d=c(r.percent,r.r,l.percent,l.r),u=c(r.percent,r.g,l.percent,l.g),c=c(r.percent,r.b,l.percent,l.b);return{r:d,g:u,b:c,hex:"#"+(16777216|c|u<<8|d<<16).toString(16).slice(1),percent:i}}r=l}void 0!==p.onError&&p.onError("Invalid color value of the ColorPicker: "+e)},this.toColor=function(e,t,n){if(void 0!==qe){if(e instanceof qe.Color)return e;n=this.hsv2rgb(e,t,n);return void 0===n&&(n={r:255,g:255,b:255}),new qe.Color("rgb("+n.r+", "+n.g+", "+n.b+")")}console.error("Call ColorPicker.palette.setTHREE(THREE) first.")}}Ze.setTHREE=function(e){qe?Object.is(qe,e)||console.error("Palette.setTHREE: duplicate THREE. Please use one instance of the THREE library."):qe=e};
/**
* @module ColorPicker
* @description Pure JavaScript color picker.
* @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
*
* Thanks to https://github.com/DavidDurman/FlexiColorPicker
*
* @copyright 2011 Data Arts Team, Google Creative Lab
*
* @license under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
*/
var $e,et={create:function(e,i){function r(){return"horizontal"===i.orientation}if((i=i||{}).orientation=i.orientation||"horizontal",void 0===i.direction&&(i.direction=!0),i.style=i.style||{},i.style.width=i.style.width||(r()?200:30),i.style.height=i.style.height||(r()?30:200),i.onError=i.onError||function(){},e instanceof HTMLElement!=!0){if("string"!=typeof e)return void console.error("ColorPicker.create: invalid elSliderWrapper = "+e);if(null===(e=document.getElementById(e)))return void console.error("ColorPicker.create: invalid elSliderWrapper = "+e)}for(var t in e.classList.add("slider-wrapper"),i.style)e.style[t]=i.style[t];var o,n,a,s,l,c=i.palette instanceof Ze?i.palette:new Ze(i);function d(){return"string"==typeof i.style.height?parseInt(i.style.height):i.style.height}function u(){return f.clientWidth}function p(e,t){var n;void 0!==o?void 0!==(n=c.hsv2rgb(e))?(e=n.percent,void 0===t&&(t=r()?u()*e/100:d()-d()*(i.direction?e:100-e)/100),function(e){if(void 0===o)return;r()?e<0||e>u()?console.error("ColorPicker.positionIndicators: Invalid position = "+e):(o.style.top="0px",o.style.left=(i.direction?e:u()-e)-o.offsetWidth/2+"px"):e<0||e>d()?console.error("ColorPicker.positionIndicators: Invalid position = "+e):(o.style.left="0px",o.style.top=e-o.offsetHeight/2+"px")}(t),void 0!==i.sliderIndicator.callback&&i.sliderIndicator.callback(n)):console.error("ColorPicker.setValue: invalud c = "+n):console.error("Set value of this instance of the ColorPicker is impossible because options.sliderIndicator is not defined.")}if(void 0!==i.sliderIndicator&&((o=document.createElement("div")).className="slider-indicator",r()?o.style.width="10px":o.style.height="10px",e.appendChild(o),o.style.pointerEvents="none"),"SVG"==We){try{var f=Qe("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:r()?"100%":i.style.width,height:i.style.height},[Qe("defs",{},Qe("linearGradient",{id:"gradient-hsv-"+Je,x1:r()&&i.direction?"100%":"0%",y1:r()||i.direction?"0%":"100%",x2:r()&&!i.direction?"100%":"0%",y2:!r()&&i.direction?"100%":"0%"},c.getPalette())),Qe("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv-"+Je+")"})]);void 0!==o&&(f.style.cursor=r()?"e-resize":"s-resize",o.style.cursor=f.style.cursor)}catch(e){console.error("Create SVG element failed! "+e.message)}e.appendChild(f),e.style.height=d()+"px",void 0!==o&&(r()?o.style.height=parseInt(i.style.height)-2+"px":o.style.width=parseInt(i.style.width)-2+"px",i.sliderIndicator.value=i.sliderIndicator.value||0,p(i.sliderIndicator.value)),Je++}else console.error("Under constraction");function h(e){var t,n,o;e.x=parseInt(e.x),e.y=parseInt(e.y),r()?(t=e.x,n=u()-1,t>=u()&&(t=n),o=100*t/n,i.direction||(o=100-o,t=n-t)):(t=e.y,n=d()-1,t>=d()&&(t=n),o=100*(1-t/n),i.direction||(o=100-o)),p(o,t)}return void 0!==o&&(n=function(){return function(e){l||h(function(e){if(window.event&&void 0!==window.event.contentOverflow)return{x:window.event.offsetX,y:window.event.offsetY};if(void 0!==e.offsetX&&void 0!==e.offsetY)return{x:e.offsetX,y:e.offsetY};var t=e.target.parentNode.parentNode;return{x:e.layerX-t.offsetLeft,y:e.layerY-t.offsetTop}}(e=e||window.event))}},l=!(s=function(e,i){var t=f;a(t,"touchstart",function(e){}),a(t,"touchmove",function(e){e.preventDefault();var t=e.srcElement.getBoundingClientRect(),n=e.touches[0].clientX-t.left,t=e.touches[0].clientY-t.top;n<0&&(n=0),t<0&&(t=0),h({x:n,y:t})}),a(t,"touchend",function(e){}),a(t,"mousedown",function(e){var n="mouseup",o="mousemove";a(window,n,function e(){function t(e,t,n){null!==e&&(e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener&&e.removeEventListener(t,n,!1))}t(window,n,e),t(window,o,i)}),a(window,o,i)}),a(t,"mouseout",function(e){l=!0}),a(t,"mouseover",function(e){l=!1})}),(a=function(e,t,n){null!==e&&(e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,!1))})(f,"click",n()),s(0,n())),{setValue:p}},paletteIndexes:Ke,palette:Ze};
/**
 * @module GuiSelectPoint
 *
 * @description A dat.gui based graphical user interface for select a point from the mesh.
 *
 * @see {@link https://github.com/anhr/dat.gui|dat.gui}, {@link https://threejs.org/docs/index.html#api/en/objects/Mesh|three.js mesh}.
 *
 * @author Andrej Hristoliubov. {@link https://anhr.github.io/AboutMe/|AboutMe}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
*/function tt(e,u){tt.setTHREE(e);var p,f=(u=u||{}).axesHelper,h=u.options||(f?f.options:void 0)||{scales:{x:{name:"x",min:-1,max:1},y:{name:"y",min:-1,max:1},z:{name:"z",min:-1,max:1}}},o=this,_=u.getLanguageCode||function(){return"en"},m={meshs:"Meshs",notSelected:"Not selected",select:"Select",position:"Position",rotation:"Rotation",points:"Points",point:"Point Local Position",pointTitle:"The position attribute of the selected point",pointWorld:"Point World Position",pointWorldTitle:"The position of the selected point after scaling, moving and rotation of the mesh",mesh:"Mesh",scale:"Scale",color:"olor",opacity:"Opacity",opacityTitle:"Float in the range of 0.0 - 1.0 indicating how transparent the material is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.",defaultButton:"Default",defaultScaleTitle:"Restore default 3d object scale.",defaultPositionTitle:"Restore default 3d object position.",default3DObjectTitle:"Restore default settings of all 3d objects.",defaultRotationTitle:"Restore default 3d object rotation.",defaultLocalPositionTitle:"Restore default local position.",moveGroup:"Move Scene"},t=_();switch(t){case"ru":m.meshs="3D ",m.notSelected=" ",m.select="",m.position="",m.rotation="",m.points="",m.point="  ",m.pointTitle="Position attribute  ",m.pointWorld="  ",m.pointWorldTitle="    ,    3D ",m.mesh="3D ",m.scale="",m.color="",m.opacity="",m.opacityTitle="   0,0 - 1,0, ,   .  0.0   , 1.0 -  .",m.defaultButton="",m.defaultScaleTitle="  3D   .",m.defaultPositionTitle="  3D   .",m.default3DObjectTitle="   3D   .",m.defaultRotationTitle="  3D   .",m.defaultLocalPositionTitle="     .";break;default:if(void 0===u.lang||u.lang.languageCode!=t)break;Object.keys(u.lang).forEach(function(e){void 0!==m[e]&&(m[e]=u.lang[e])})}var g,b,v,y,w,x,C,E,S,A,k,T,O,P,R,L,D,N,V,F,j=this,B=new $e.Vector3,H=new $e.Vector3,M=new $e.Vector3,z=!1;function I(e,t){if(void 0!==e){"boolean"==typeof t&&(t=t?"block":"none");for(var n=e.domElement;"LI"!==n.tagName.toUpperCase();)n=n.parentElement;n.style.display=t}}function G(e){var t,n;void 0===e&&(e=o.getSelectedPointIndex()),-1!==e&&(n=it(t=x.__select.options[x.__select.options.selectedIndex].mesh,e),void 0!==f&&f.exposePosition({object:t,index:e}),M.x&&M.x.setValue(n.x),M.y&&M.y.setValue(n.y),M.z&&M.z.setValue(n.z))}function X(e,t){if(e){var n=e.domElement.querySelector("input"),o=n.readOnly;return n.readOnly=!1,e.object[e.property]=t,e.__onChange&&e.__onChange.call(e,t),e.initialValue=t,e.updateDisplay(),n.readOnly=o,e}}function i(e){var t=nt(e.object,e.index);X(O,t.x),X(P,t.y),X(R,t.z);var n=it(e.object,e.index);X(M.x,n.x),X(M.y,n.y),X(M.z,n.z);var o="none",t="block";"function"==typeof E.object.userData.arrayFuncs&&console.error('arrayFuncs === "function" under constraction');var i,r,a,s,l,n=e.object.userData.arrayFuncs?e.object.userData.arrayFuncs[e.index]:void 0,n=void 0===n?void 0:Array.isArray(n.w)||"function"==typeof n.w?execFunc(n,"w",group.userData.t,h.a,h.b):n.w;void 0===n&&(void 0===e.object.geometry.attributes.ca?console.warn("Under constraction.  frustumPoints         D:My documentsMyProjectswebgl\three.jsGitHubmyThreejsmaster\frustumPoints\vertex.c"):(r=(new $e.Vector4).fromArray(e.object.geometry.attributes.ca.array,e.index*e.object.geometry.attributes.ca.itemSize),n=new $e.Color(r.x,r.y,r.z),i=r.w)),n instanceof $e.Color?(a=o,l=s=t,void 0===e.object.userData.arrayFuncs?l=s=o:(r="#"+n.getHexString(),V.initialValue=r,V.setValue(r),V.userData={intersection:e},void 0!==i?X(F,i):l=o,F.userData={intersection:e})):(a=void 0===L||void 0===n?o:(X(L,n),t),l=s=o),I(L,a),I(V,s),I(F,l);e=!0===e.object.userData.boFrustumPoints;O&&(O.domElement.querySelector("input").readOnly=e),P&&(P.domElement.querySelector("input").readOnly=e),R&&(R.domElement.querySelector("input").readOnly=e),L&&(L.domElement.querySelector("input").readOnly=e),V.domElement.querySelector("input").readOnly=e,F.domElement.querySelector("input").readOnly=e}function U(){if(-1!==x.__select.options.selectedIndex)return x.__select.options[x.__select.options.selectedIndex].mesh}function n(){return void 0===U()}function q(){var e;n()||(e=U(),S&&S.setValue(e.scale.x),A&&A.setValue(e.scale.y),k&&k.setValue(e.scale.z))}function W(){var e;n()||(e=U(),B.x&&B.x.setValue(e.position.x),B.y&&B.y.setValue(e.position.y),B.z&&B.z.setValue(e.position.z))}function Y(){var e;n()||(e=U(),H.x&&H.x.setValue(e.rotation.x),H.y&&H.y.setValue(e.rotation.y),H.z&&H.z.setValue(e.rotation.z))}return h.arrayCloud&&(p=new h.arrayCloud.cFrustumPointsF(j)),this.setMesh=function(){z=!0,q(),W(),Y(),G(),z=!1},this.setPosition=function(e,t){for(var n=0;n<x.__select.length;n++){var o=x.__select[n];o.selected&&Object.is(o.mesh,t.object)&&i(t)}},this.update=function(){var e,t=x.__select.options[x.__select.options.selectedIndex].mesh;!t||-1!==(e=this.getSelectedPointIndex())&&(e=it(t,e),M.x.setValue(e.x),M.y.setValue(e.y),M.z.setValue(e.z))},this.getMeshIndex=function(e){if(void 0===e)return e;for(var t=0;t<x.__select.options.length;t++){var n=x.__select.options[t];if(Object.is(n.mesh,e))return t}},this.setIndexMesh=function(e,t){void 0!==e&&(x.__select.options[e].mesh=t,this.selectPoint(-1))},this.selectPoint=function(e){T.__onChange(e),T.__select[e+1].selected=!0},this.removeMesh=function(e){var t=this.getMeshIndex(e),e=x.__select.selectedIndex;x.__select.remove(t),e===t&&(T.__onChange(-1),j.removePoints())},this.addMesh=function(e){for(var t=0;t<x.__select.options.length;t++){var n=x.__select.options[t];if(e.userData.boFrustumPoints&&void 0!==n.mesh&&n.mesh.userData.boFrustumPoints)return;if(void 0!==n.mesh&&""!==e.name&&n.mesh.name===e.name)return}var o=document.createElement("option");o.innerHTML=x.__select.length+" "+(""===e.name?e.constructor:e).name,(o.mesh=e).userData.default=e.userData.default||{scale:(new $e.Vector3).copy(e.scale),position:e.position instanceof $e.Vector3?(new $e.Vector3).copy(e.position):e.position instanceof $e.Vector4?(new $e.Vector4).copy(e.position):void 0,rotation:(new $e.Euler).copy(e.rotation)},x.__select.appendChild(o)},this.select=function(n){nt(n.object,n.index);void 0===g&&console.error("    ");var e=this.getMeshIndex(n.object);e&&(!1===x.__select[e].selected&&(x.__select[e].selected=!0,x.__onChange(e-1)),this.selectPoint2=function(e){var t;void 0===n.index||isNaN(n.index)||void 0!==e&&!Object.is(n.object,e)||(n.object.userData.boFrustumPoints?p.pointIndexes(n.object.userData.pointIndexes(n.index)):T.__select[n.index+1].selected=!0,t="block",b.domElement.style.display=t,y.domElement.style.display=t,E=n,u.setIntersection&&u.setIntersection(n),i(n),e=void 0===(e=U()).userData.arrayFuncs||"function"==typeof E.object.userData.arrayFuncs?void 0:e.userData.arrayFuncs[n.index].line,D&&D.setValue(void 0!==e&&e.isVisible()),v.domElement.parentElement.parentElement.style.display=void 0===E.object.userData.arrayFuncs?"none":t)},this.selectPoint2())},this.isSelectedMesh=function(e){return U()===e},this.getSelectedPointIndex=function(){if(void 0!==p&&p.isDisplay()&&h.arrayCloud.frustumPoints&&h.arrayCloud.frustumPoints.isDisplay()){var e=p.getSelectedIndex();return null===e?-1:e}return void 0===T?-1:T.__select.selectedOptions[0].index-1},this.add=function(e){var a,s,l,c;g=e.addFolder(m.meshs),x=g.add({Meshs:m.notSelected},"Meshs",J({},m.notSelected,-1)).onChange(function(e){var t;if(e=parseInt(e),void 0===(a=U()))t="none",(a=void 0)!==f&&f.exposePosition(it(U(),e));else{var n=void 0===a.userData.default?"none":"block";s.domElement.parentElement.parentElement.style.display=n,l.domElement.parentElement.parentElement.style.display=n,c.domElement.parentElement.parentElement.style.display=n;e="none",n=t="block";if(T.__onChange(-1),j.removePoints(),void 0!==a.userData.controllers)a.userData.controllers();else{e="block",n="none";for(var o=0;o<a.geometry.attributes.position.count;o++){var i=document.createElement("option"),r=void 0===a.userData.arrayFuncs?void 0:void 0===a.userData.pointName?"function"==typeof a.userData.arrayFuncs?void 0:a.userData.arrayFuncs[o].name:a.userData.pointName(o);i.innerHTML=o+(void 0===r?"":" "+r),i.setAttribute("value",o),T.__select.appendChild(i)}}T.domElement.parentElement.parentElement.style.display=e,N&&(N.domElement.parentElement.parentElement.style.display=e),void 0!==p&&p.display(n),q(),W(),Y()}C.domElement.style.display=t,void 0!==a&&void 0!==a.userData.traceAll&&N.setValue(a.userData.traceAll)}),Ve.controllerNameAndTitle(x,m.select),(C=g.addFolder(m.mesh)).domElement.style.display="none",C.open();var t=C.addFolder(m.scale);t.add(new je(function(e,t){e=e.controller.getValue();a.scale.x=t(a.scale.x,e),a.scale.y=t(a.scale.y,e),a.scale.z=t(a.scale.z,e),a.needsUpdate=!0,q(),G(),void 0!==h.arrayCloud&&void 0!==h.arrayCloud.frustumPoints&&h.arrayCloud.frustumPoints.updateCloudPoint(a)},{settings:{zoomMultiplier:1.1},getLanguageCode:_}));e=new $e.Vector3;function n(e,t){a.scale[e]=t,a.needsUpdate=!0,G(),void 0!==h.arrayCloud&&void 0!==h.arrayCloud.frustumPoints&&h.arrayCloud.frustumPoints.updateCloudPoint(a)}h.scales.x&&(S=Ve.controllerZeroStep(t,e,"x",function(e){n("x",e)}),Ve.controllerNameAndTitle(S,h.scales.x.name)),h.scales.y&&(A=Ve.controllerZeroStep(t,e,"y",function(e){n("y",e)}),Ve.controllerNameAndTitle(A,h.scales.y.name)),h.scales.z&&(k=Ve.controllerZeroStep(t,e,"z",function(e){n("z",e)}),Ve.controllerNameAndTitle(k,h.scales.z.name)),s=t.add({defaultF:function(){a.scale.copy(a.userData.default.scale),a.needsUpdate=!0,q(),G()}},"defaultF"),Ve.controllerNameAndTitle(s,m.defaultButton,m.defaultScaleTitle);var i=C.addFolder(m.position);function o(t){var e,n,o=h.scales[t];o&&(e=o.name,(n=i.addFolder(e)).add(new He(function(e){a.position[t]+=e,a.needsUpdate=!0,W(),G(),void 0!==h.arrayCloud&&void 0!==h.arrayCloud.frustumPoints&&h.arrayCloud.frustumPoints.updateCloudPoint(a)},{getLanguageCode:_})),o=new $e.Vector3,B[t]=Ve.controllerZeroStep(n,o,t,function(e){e=e,a.position[t]=e,a.needsUpdate=!0,G()}),Ve.controllerNameAndTitle(B[t],e))}o("x"),o("y"),o("z"),l=i.add({defaultF:function(){a.position.copy(a.userData.default.position),a.needsUpdate=!0,W(),G()}},"defaultF"),Ve.controllerNameAndTitle(l,m.defaultButton,m.defaultPositionTitle);var r=C.addFolder(m.rotation);function d(n){var e=h.scales[n];e&&(H[n]=r.add(new $e.Vector3,n,0,2*Math.PI,1/360).onChange(function(e){var t=U();t.userData.boFrustumPoints||(t.rotation[n]=e,t.needsUpdate=!0),z||G(),void 0!==h.arrayCloud&&void 0!==h.arrayCloud.frustumPoints&&h.arrayCloud.frustumPoints.updateCloudPoint(t)}),Ve.controllerNameAndTitle(H[n],e.name))}d("x"),d("y"),d("z"),c=r.add({defaultF:function(){a.rotation.copy(a.userData.default.rotation),a.needsUpdate=!0,Y(),G()}},"defaultF"),Ve.controllerNameAndTitle(c,m.defaultButton,m.defaultRotationTitle),w=C.addFolder(m.points),(T=w.add({Points:m.notSelected},"Points",J({},m.notSelected,-1)).onChange(function(e){var t;-1===(e=parseInt(e))?t="none":(t="block",j.select({object:U(),index:e})),void 0!==f&&f.exposePosition(it(U(),e)),b.domElement.style.display=t,y.domElement.style.display=t})).__select[0].selected=!0,Ve.controllerNameAndTitle(T,m.select),void 0!==p&&p.create(w,_()),u.myThreejs&&(u.myThreejs.cFrustumPoints=p),b=w.addFolder(m.point),Ve.folderNameAndTitle(b,m.point,m.pointTitle),b.domElement.style.display="none",y=w.addFolder(m.pointWorld),Ve.folderNameAndTitle(y,m.pointWorld,m.pointWorldTitle),y.domElement.style.display="none",y.open(),u.pointsControls&&(N=u.pointsControls(w,I,U)),Ve.controllerNameAndTitle(g.add({defaultF:function(){for(var e=0;e<x.__select.options.length;e++){var t=x.__select.options[e].mesh;t&&(t.scale.copy(t.userData.default.scale),t.position.copy(t.userData.default.position),t.rotation.copy(t.userData.default.rotation),t.needsUpdate=!0)}q(),W(),Y(),G()}},"defaultF"),m.defaultButton,m.default3DObjectTitle),function(){function r(e){return e.domElement.querySelector("input").readOnly&&(e.getValue()!==e.initialValue&&void 0===e.boSetValue&&(e.boSetValue=!0,X(e,e.initialValue),e.boSetValue=void 0,e.initialValue=e.getValue()),1)}function e(o){if("w"===o){if(void 0===h.scales.w)return;var e,t=h.scales.w,i=b.add({value:t.min},"value",t.min,t.max,(t.max-t.min)/100).onChange(function(e){var t=h.palette.toColor(e,i.__min,i.__max),n=E.object.geometry.attributes,o=E.index;j.setColorAttribute(n,o,t),n.position.setW(o,e),void 0!==h.arrayCloud&&void 0!==h.arrayCloud.frustumPoints&&h.arrayCloud.frustumPoints.updateCloudPointItem(E.object,E.index)});h.palette instanceof et.palette&&(i.domElement.querySelector(".slider-fg").style.height="40%",e=i.domElement.querySelector(".slider"),et.create(e,{palette:h.palette,style:{}}))}else(t=void 0===f?h.scales[o]:f.options?f.options.scales[o]:void 0)&&(i=b.add({value:t.min},"value",t.min,t.max,(t.max-t.min)/100).onChange(function(e){var t,n;r(i)||(t=E.object,n="x"===o?0:"y"===o?1:"z"===o?2:"w"===o?3:console.error("axisName:"+o),t.geometry.attributes.position.array[n+E.index*t.geometry.attributes.position.itemSize]=e,t.geometry.attributes.position.needsUpdate=!0,G(E.index),void 0!==h.arrayCloud&&void 0!==h.arrayCloud.frustumPoints&&h.arrayCloud.frustumPoints.updateCloudPointItem(t,E.index))}));return t&&Ve.controllerNameAndTitle(i,t.name),i}O=e("x"),P=e("y"),R=e("z"),L=e("w"),V=b.addColor({color:"#FFFFFF"},"color").onChange(function(e){var t;r(V)||void 0!==V.userData&&(t=V.userData.intersection,j.setColorAttribute(t.object.geometry.attributes,t.index,e))}),Ve.controllerNameAndTitle(V,m.color),F=b.add({opasity:1},"opasity",0,1,.01).onChange(function(e){var t,n;r(F)||void 0!==(n=(t=V.userData.intersection).object).geometry.attributes.ca&&(n.geometry.attributes.ca.array[3+t.index*n.geometry.attributes.ca.itemSize]=e,n.geometry.attributes.ca.needsUpdate=!0)}),Ve.controllerNameAndTitle(F,m.opacity,m.opacityTitle),u.pointControls&&(D=u.pointControls(b,I,U,E));function t(e){var t=void 0===f?h.scales[e]:f.options?f.options.scales[e]:void 0;if(t){e=Ve.controllerZeroStep(y,{value:t.min},"value");return e.domElement.querySelector("input").readOnly=!0,Ve.controllerNameAndTitle(e,t.name),e}}M.x=t("x"),M.y=t("y"),M.z=t("z"),v=b.add({defaultF:function(){var e=E.object.userData.arrayFuncs[E.index];O.setValue("function"==typeof e.x?e.x(group.userData.t,h.a,h.b):e.x),P.setValue("function"==typeof e.y?e.y(group.userData.t,h.a,h.b):e.y),R.setValue("function"==typeof e.z?e.z(group.userData.t,h.a,h.b):void 0===e.z?0:e.z),void 0!==e.w?void 0!==e.w.r?V.setValue("#"+new $e.Color(e.w.r,e.w.g,e.w.b).getHexString()):"function"==typeof e.w?X(L,e.w(group.userData.t)):console.error("Restore default local position: Invalid W axis."):(V.setValue(V.initialValue),F.setValue(F.initialValue))}},"defaultF"),Ve.controllerNameAndTitle(v,m.defaultButton,m.defaultLocalPositionTitle)}()},this.setColorAttribute=function(e,t,n){"string"==typeof n&&(n=new $e.Color(n));e=e.color||e.ca;void 0!==e&&(e.setX(t,n.r),e.setY(t,n.g),e.setZ(t,n.b),e.needsUpdate=!0)},this.removePoints=function(){T.domElement.querySelectorAll("select option").forEach(function(e){return e.remove()});var e=document.createElement("option");e.innerHTML=m.notSelected,e.setAttribute("value",-1),T.__select.appendChild(e)},this.getFrustumPoints=function(){return p},this.windowRange=function(e){pointLight1.windowRange(e.scales),pointLight2.windowRange(e.scales),O.min(e.scales.x.min),O.max(e.scales.x.max),O.updateDisplay(),P.min(e.scales.y.min),P.max(e.scales.y.max),P.updateDisplay(),R.min(e.scales.z.min),R.max(e.scales.z.max),R.updateDisplay(),void 0!==L&&(L.min(e.scales.w.min),L.max(e.scales.w.max),L.updateDisplay())},this}function nt(e,t){if($e){var n=e.geometry.attributes.position,e=4<=n.itemSize?new $e.Vector4(0,0,0,0):new $e.Vector3;return e.fromArray(n.array,t*n.itemSize),e}console.error("getObjectLocalPosition: call GuiSelectPoint.setTHREE( THREE ); first")}function ot(e,t){var n,o,i,r,a=t.clone();for(;n=e,o=a,r=i=void 0,i=new $e.Vector3,r=new $e.Vector3,(i=o.clone()).multiply(n.scale),r.copy(i),r.applyEuler(n.rotation),i.x=r.x,i.y=r.y,i.z=r.z,i.add(n.position),a=i,e=e.parent,e.parent;);return a}function it(e,t){if(-1!==t)return void 0===t?e.position:ot(e,nt(e,t))}function rt(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),i=Math.round(e.g),r=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var d=e.hex.toString(16);d.length<6;)d="0"+d;return"#"+d}return"CSS_RGB"===n?"rgb("+o+","+i+","+r+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+r+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+r+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+r+","+a+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+",a:"+a+"}":"unknown format"}tt.setTHREE=function(e){$e?Object.is($e,e)||console.error("GuiSelectPoint.setTHREE: duplicate THREE. Please use one instance of the THREE library."):$e=e};var at,st=Array.prototype.forEach,lt=Array.prototype.slice,ct={BREAK:{},extend:function(n){return this.each(lt.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(t[e])||(n[e]=t[e])}.bind(this))},this),n},defaults:function(n){return this.each(lt.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(n[e])&&(n[e]=t[e])}.bind(this))},this),n},compose:function(){var n=lt.call(arguments);return function(){for(var e=lt.call(arguments),t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},each:function(e,t,n){if(e)if(st&&e.forEach&&e.forEach===st)e.forEach(t,n);else if(e.length===e.length+0){for(var o=void 0,o=0,i=e.length;o<i;o++)if(o in e&&t.call(n,e[o],o)===this.BREAK)return}else for(var r in e)if(t.call(n,e[r],r)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(o,i,r){var a=void 0;return function(){var e=this,t=arguments;var n=r||!a;clearTimeout(a),a=setTimeout(function(){a=null,r||o.apply(e,t)},i),n&&o.apply(e,t)}},toArray:function(e){return e.toArray?e.toArray():lt.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:(at=function(e){return isNaN(e)},dt.toString=function(){return at.toString()},dt),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};function dt(e){return at.apply(this,arguments)}var ut,pt=[{litmus:ct.isString,conversions:{THREE_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:rt},SIX_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:rt},CSS_RGB:{read:function(e){e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:rt},CSS_RGBA:{read:function(e){e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:rt}}},{litmus:ct.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:ct.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:ct.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(ct.isNumber(e.r)&&ct.isNumber(e.g)&&ct.isNumber(e.b)&&ct.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(ct.isNumber(e.r)&&ct.isNumber(e.g)&&ct.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(ct.isNumber(e.h)&&ct.isNumber(e.s)&&ct.isNumber(e.v)&&ct.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(ct.isNumber(e.h)&&ct.isNumber(e.s)&&ct.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],ft=void 0,ht=void 0,_t=function(e){ht=!1;var n=1<arguments.length?ct.toArray(arguments):e;return ct.each(pt,function(e){if(e.litmus(n))return ct.each(e.conversions,function(e,t){if(ft=e.read(n),!1===ht&&!1!==ft)return(ht=ft).conversionName=t,ft.conversion=e,ct.BREAK}),ct.BREAK}),ht},mt={hsv_to_rgb:function(e,t,n){var o=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),r=n*(1-t),e=n*(1-i*t),t=n*(1-(1-i)*t),o=[[n,t,r],[e,n,r],[r,n,t],[r,e,n],[t,r,n],[n,r,e]][o];return{r:255*o[0],g:255*o[1],b:255*o[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),i=Math.max(e,t,n),r=i-o,o=void 0;return 0===i?{h:NaN,s:0,v:0}:(o=e===i?(t-n)/r:t===i?2+(n-e)/r:4+(e-t)/r,(o/=6)<0&&(o+=1),{h:360*o,s:r/i,v:i/255})},rgb_to_hex:function(e,t,n){e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t);return e=this.hex_with_component(e,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(ut=8*t)|e&~(255<<ut)}},gt="function"==typeof Symbol&&"symbol"===y(Symbol.iterator)?function(e){return void 0===e?"undefined":y(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":y(e)},bt=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ue=function(e,t,n){return t&&vt(e.prototype,t),n&&vt(e,n),e};function vt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function yt(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0!==o){if("value"in o)return o.value;o=o.get;return void 0!==o?o.call(n):void 0}if(e=Object.getPrototypeOf(e),null!==e)return yt(e,t,n)}var T=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":y(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},wt=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":y(t))&&"function"!=typeof t?e:t},xt=(ue(Ct,[{key:"toString",value:function(){return rt(this)}},{key:"toHexString",value:function(){return rt(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),Ct);function Ct(){if(bt(this,Ct),this.__state=_t.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}function Et(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||xt.recalculateRGB(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(xt.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function St(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||xt.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(xt.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}xt.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=mt.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");ct.extend(e.__state,mt.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},xt.recalculateHSV=function(e){var t=mt.rgb_to_hsv(e.r,e.g,e.b);ct.extend(e.__state,{s:t.s,v:t.v}),ct.isNaN(t.h)?ct.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},xt.COMPONENTS=["r","g","b","h","s","v","hex","a"],Et(xt.prototype,"r",2),Et(xt.prototype,"g",1),Et(xt.prototype,"b",0),St(xt.prototype,"h"),St(xt.prototype,"s"),St(xt.prototype,"v"),Object.defineProperty(xt.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(xt.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=mt.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var At=(ue(kt,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),kt);function kt(e,t){bt(this,kt),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}var Tt={};ct.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){ct.each(e,function(e){Tt[e]=t})});var Ot=/(\d+(\.\d+)?)px/;function Pt(e){if("0"===e||ct.isUndefined(e))return 0;e=e.match(Ot);return ct.isNull(e)?0:parseFloat(e[1])}var Rt={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){ct.isUndefined(t)&&(t=!0),ct.isUndefined(n)&&(n=!0),e.style.position="absolute",t&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var i=n||{},n=Tt[t];if(!n)throw new Error("Event type "+t+" not supported.");var r=document.createEvent(n);switch(n){case"MouseEvents":var a=i.x||i.clientX||0,s=i.y||i.clientY||0;r.initMouseEvent(t,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,a,s,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":s=r.initKeyboardEvent||r.initKeyEvent;ct.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),s(t,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:r.initEvent(t,i.bubbles||!1,i.cancelable||!0)}ct.defaults(r,o),e.dispatchEvent(r)},bind:function(e,t,n,o){o=o||!1;return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n),Rt},unbind:function(e,t,n,o){o=o||!1;return e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n),Rt},addClass:function(e,t){var n;return void 0===e.className?e.className=t:e.className===t||-1===(n=e.className.split(/ +/)).indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")),Rt},removeClass:function(e,t){var n;return t?e.className===t?e.removeAttribute("class"):-1!==(t=(n=e.className.split(/ +/)).indexOf(t))&&(n.splice(t,1),e.className=n.join(" ")):e.className=void 0,Rt},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){e=getComputedStyle(e);return Pt(e["border-left-width"])+Pt(e["border-right-width"])+Pt(e["padding-left"])+Pt(e["padding-right"])+Pt(e.width)},getHeight:function(e){e=getComputedStyle(e);return Pt(e["border-top-width"])+Pt(e["border-bottom-width"])+Pt(e["padding-top"])+Pt(e["padding-bottom"])+Pt(e.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)for(;n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent,t;);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},Lt=(T(Dt,At),ue(Dt,[{key:"setValue",value:function(e){e=yt(Dt.prototype.__proto__||Object.getPrototypeOf(Dt.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),yt(Dt.prototype.__proto__||Object.getPrototypeOf(Dt.prototype),"updateDisplay",this).call(this)}}]),Dt);function Dt(e,t){bt(this,Dt);var t=wt(this,(Dt.__proto__||Object.getPrototypeOf(Dt)).call(this,e,t)),n=t;return t.__prev=t.getValue(),t.__checkbox=document.createElement("input"),t.__checkbox.setAttribute("type","checkbox"),Rt.bind(t.__checkbox,"change",function(){n.setValue(!n.__prev)},!1),t.domElement.appendChild(t.__checkbox),t.updateDisplay(),t}var Nt=(T(Vt,At),ue(Vt,[{key:"setValue",value:function(e){e=yt(Vt.prototype.__proto__||Object.getPrototypeOf(Vt.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e}},{key:"updateDisplay",value:function(){return Rt.isActive(this.__select)?this:(this.__select.value=this.getValue(),yt(Vt.prototype.__proto__||Object.getPrototypeOf(Vt.prototype),"updateDisplay",this).call(this))}}]),Vt);function Vt(e,t,n){bt(this,Vt);var o,t=wt(this,(Vt.__proto__||Object.getPrototypeOf(Vt)).call(this,e,t)),n=n,i=t;return t.__select=document.createElement("select"),ct.isArray(n)&&(o={},ct.each(n,function(e){o[e]=e}),n=o),ct.each(n,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),i.__select.appendChild(n)}),t.updateDisplay(),Rt.bind(t.__select,"change",function(){var e=this.options[this.selectedIndex].value;i.setValue(e)}),t.domElement.appendChild(t.__select),t}var Ft=(T(jt,At),ue(jt,[{key:"updateDisplay",value:function(){return Rt.isActive(this.__input)||(this.__input.value=this.getValue()),yt(jt.prototype.__proto__||Object.getPrototypeOf(jt.prototype),"updateDisplay",this).call(this)}}]),jt);function jt(e,t){bt(this,jt);var t=wt(this,(jt.__proto__||Object.getPrototypeOf(jt)).call(this,e,t)),n=t;function o(){n.setValue(n.__input.value)}return t.__input=document.createElement("input"),t.__input.setAttribute("type","text"),Rt.bind(t.__input,"keyup",o),Rt.bind(t.__input,"change",o),Rt.bind(t.__input,"blur",function(){n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())}),Rt.bind(t.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),t.updateDisplay(),t.domElement.appendChild(t.__input),t}function Bt(e){e=e.toString();return-1<e.indexOf(".")?e.length-e.indexOf(".")-1:0}T(Ht,At),ue(Ht,[{key:"setValue",value:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),yt(Ht.prototype.__proto__||Object.getPrototypeOf(Ht.prototype),"setValue",this).call(this,e)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=Bt(e),this}}]),R=Ht;function Ht(e,t,n){bt(this,Ht);t=wt(this,(Ht.__proto__||Object.getPrototypeOf(Ht)).call(this,e,t)),n=n||{};return t.__min=n.min,t.__max=n.max,t.__step=n.step,ct.isUndefined(t.__step)?0===t.initialValue?t.__impliedStep=1:t.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(t.initialValue))/Math.LN10))/10:t.__impliedStep=t.__step,t.__precision=Bt(t.__impliedStep),t}var Mt=(T(zt,R),ue(zt,[{key:"updateDisplay",value:function(){var e,t;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),t=this.__precision,t=Math.pow(10,t),Math.round(e*t)/t),yt(zt.prototype.__proto__||Object.getPrototypeOf(zt.prototype),"updateDisplay",this).call(this)}}]),zt);function zt(e,t,n){bt(this,zt);n=wt(this,(zt.__proto__||Object.getPrototypeOf(zt)).call(this,e,t,n));n.__truncationSuspended=!1;var o=n,i=void 0;function r(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function a(e){var t=i-e.clientY;o.setValue(o.getValue()+t*o.__impliedStep),i=e.clientY}function s(){Rt.unbind(window,"mousemove",a),Rt.unbind(window,"mouseup",s),r()}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),Rt.bind(n.__input,"change",function(){var e=parseFloat(o.__input.value);ct.isNaN(e)||o.setValue(e)}),Rt.bind(n.__input,"blur",function(){r()}),Rt.bind(n.__input,"mousedown",function(e){Rt.bind(window,"mousemove",a),Rt.bind(window,"mouseup",s),i=e.clientY}),Rt.bind(n.__input,"keydown",function(e){13===e.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,r())}),n.updateDisplay(),n.domElement.appendChild(n.__input),n}function It(e,t,n,o,i){return o+(e-t)/(n-t)*(i-o)}var Gt=(T(Xt,R),ue(Xt,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",yt(Xt.prototype.__proto__||Object.getPrototypeOf(Xt.prototype),"updateDisplay",this).call(this)}}]),Xt);function Xt(e,t,n,o,i){bt(this,Xt);var i=wt(this,(Xt.__proto__||Object.getPrototypeOf(Xt)).call(this,e,t,{min:n,max:o,step:i})),r=i;function a(e){e.preventDefault();var t=r.__background.getBoundingClientRect();return r.setValue(It(e.clientX,t.left,t.right,r.__min,r.__max)),!1}function s(){Rt.unbind(window,"mousemove",a),Rt.unbind(window,"mouseup",s),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function l(e){var t=e.touches[0].clientX,e=r.__background.getBoundingClientRect();r.setValue(It(t,e.left,e.right,r.__min,r.__max))}function c(){Rt.unbind(window,"touchmove",l),Rt.unbind(window,"touchend",c),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}return i.__background=document.createElement("div"),i.__foreground=document.createElement("div"),Rt.bind(i.__background,"mousedown",function(e){document.activeElement.blur(),Rt.bind(window,"mousemove",a),Rt.bind(window,"mouseup",s),a(e)}),Rt.bind(i.__background,"touchstart",function(e){if(1!==e.touches.length)return;Rt.bind(window,"touchmove",l),Rt.bind(window,"touchend",c),l(e)}),Rt.addClass(i.__background,"slider"),Rt.addClass(i.__foreground,"slider-fg"),i.updateDisplay(),i.__background.appendChild(i.__foreground),i.domElement.appendChild(i.__background),i}var Ut=(T(qt,At),ue(qt,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),qt);function qt(e,t,n){bt(this,qt);var t=wt(this,(qt.__proto__||Object.getPrototypeOf(qt)).call(this,e,t)),o=t;return t.__button=document.createElement("div"),t.__button.innerHTML=void 0===n?"Fire":n,Rt.bind(t.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),Rt.addClass(t.__button,"button"),t.domElement.appendChild(t.__button),t}var Wt=(T(Yt,At),ue(Yt,[{key:"updateDisplay",value:function(){var t,n=_t(this.getValue());!1!==n&&(t=!1,ct.each(xt.COMPONENTS,function(e){if(!ct.isUndefined(n[e])&&!ct.isUndefined(this.__color.__state[e])&&n[e]!==this.__color.__state[e])return t=!0,{}},this),t&&ct.extend(this.__color.__state,n)),ct.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var e=this.__color.v<.5||.5<this.__color.s?255:0,o=255-e;ct.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+e+","+e+","+e+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,Kt(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),ct.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+e+","+e+","+e+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),Yt);function Yt(e,t){bt(this,Yt);var n=wt(this,(Yt.__proto__||Object.getPrototypeOf(Yt)).call(this,e,t));n.__color=new xt(n.getValue()),n.__temp=new xt(0);var o=n;n.domElement=document.createElement("div"),Rt.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",Rt.bind(n.__input,"keydown",function(e){13===e.keyCode&&l.call(this)}),Rt.bind(n.__input,"blur",l),Rt.bind(n.__selector,"mousedown",function(){Rt.addClass(this,"drag").bind(window,"mouseup",function(){Rt.removeClass(o.__selector,"drag")})}),Rt.bind(n.__selector,"touchstart",function(){Rt.addClass(this,"drag").bind(window,"touchend",function(){Rt.removeClass(o.__selector,"drag")})});e=document.createElement("div");function i(e){d(e),Rt.bind(window,"mousemove",d),Rt.bind(window,"touchmove",d),Rt.bind(window,"mouseup",a),Rt.bind(window,"touchend",a)}function r(e){u(e),Rt.bind(window,"mousemove",u),Rt.bind(window,"touchmove",u),Rt.bind(window,"mouseup",s),Rt.bind(window,"touchend",s)}function a(){Rt.unbind(window,"mousemove",d),Rt.unbind(window,"touchmove",d),Rt.unbind(window,"mouseup",a),Rt.unbind(window,"touchend",a),c()}function s(){Rt.unbind(window,"mousemove",u),Rt.unbind(window,"touchmove",u),Rt.unbind(window,"mouseup",s),Rt.unbind(window,"touchend",s),c()}function l(){var e=_t(this.value);!1!==e?(o.__color.__state=e,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function c(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function d(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,e=n.clientX,n=n.clientY,e=(e-t.left)/(t.right-t.left),t=1-(n-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),1<e?e=1:e<0&&(e=0),o.__color.v=t,o.__color.s=e,o.setValue(o.__color.toOriginal()),!1}function u(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__hue_field.getBoundingClientRect(),t=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),o.__color.h=360*t,o.setValue(o.__color.toOriginal()),!1}return ct.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),ct.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),ct.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),ct.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),ct.extend(e.style,{width:"100%",height:"100%",background:"none"}),Kt(e,"top","rgba(0,0,0,0)","#000"),ct.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(t=n.__hue_field).style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",ct.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),Rt.bind(n.__saturation_field,"mousedown",i),Rt.bind(n.__saturation_field,"touchstart",i),Rt.bind(n.__field_knob,"mousedown",i),Rt.bind(n.__field_knob,"touchstart",i),Rt.bind(n.__hue_field,"mousedown",r),Rt.bind(n.__hue_field,"touchstart",r),n.__saturation_field.appendChild(e),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}var Jt=["-moz-","-o-","-webkit-","-ms-",""];function Kt(t,n,o,i){t.style.background="",ct.each(Jt,function(e){t.style.cssText+="background: "+e+"linear-gradient("+n+", "+o+" 0%, "+i+" 100%); "})}var Qt=function(e,t,n,o,i){var r=e[t];return ct.isArray(n)||ct.isObject(n)?new Nt(e,t,n):ct.isNumber(r)?ct.isNumber(n)&&ct.isNumber(o)?ct.isNumber(i)?new Gt(e,t,n,o,i):new Gt(e,t,n,o):ct.isNumber(i)?new Mt(e,t,{min:n,max:o,step:i}):new Mt(e,t,{min:n,max:o}):ct.isString(r)?new Ft(e,t):ct.isFunction(r)?new Ut(e,t,""):ct.isBoolean(r)?new Lt(e,t):null},Q=(T(Zt,At),ue(Zt,[{key:"controller",set:function(e){this._controller=e},get:function(){return this._controller}}]),Zt);function Zt(e,t){bt(this,Zt);var n=wt(this,(Zt.__proto__||Object.getPrototypeOf(Zt)).call(this,e,t));return n.arguments={object:e,property:t,opts:Array.prototype.slice.call(arguments,2)},e.property&&(n.property=e.property(n)),n}T=function(e,t){var t=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var o=t.getElementsByTagName("head")[0];try{o.appendChild(n)}catch(e){}};var $t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},en=(ue(tn,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),ct.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",Rt.unbind(t.domElement,"webkitTransitionEnd",e),Rt.unbind(t.domElement,"transitionend",e),Rt.unbind(t.domElement,"oTransitionEnd",e)}var t=this;Rt.bind(this.domElement,"webkitTransitionEnd",e),Rt.bind(this.domElement,"transitionend",e),Rt.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Rt.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Rt.getHeight(this.domElement)/2+"px"}}]),tn);function tn(){bt(this,tn),this.backgroundElement=document.createElement("div"),ct.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Rt.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),ct.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;Rt.bind(this.backgroundElement,"click",function(){e.hide()})}T(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var nn="Default",on=function(){try{return!!window.localStorage}catch(e){return!1}}(),rn=void 0,an=!0,sn=void 0,ln=!1,cn=[],dn=function t(e){var n=this,o=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Rt.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=ct.defaults(o,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),o=ct.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),ct.isUndefined(o.load)?o.load={preset:nn}:o.preset&&(o.load.preset=o.preset),ct.isUndefined(o.parent)&&o.hideable&&cn.push(this),o.resizable=ct.isUndefined(o.parent)&&o.resizable,o.autoPlace&&ct.isUndefined(o.scrollable)&&(o.scrollable=!0);var i,r,a,s,l=on&&"true"===localStorage.getItem(mn(0,"isLocal")),c=void 0,d=void 0;function u(e){return e.preventDefault(),r.width+=a-e.clientX,r.onResize(),a=e.clientX,!1}function p(){Rt.removeClass(r.__closeButton,dn.CLASS_DRAG),Rt.unbind(window,"mousemove",u),Rt.unbind(window,"mouseup",p)}function f(e){return e.preventDefault(),a=e.clientX,Rt.addClass(r.__closeButton,dn.CLASS_DRAG),Rt.bind(window,"mousemove",u),Rt.bind(window,"mouseup",p),!1}Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return(n.parent?n.getRoot():o.load).preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,vn(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,d&&(d.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(e){o.closed=e,o.closed?Rt.addClass(n.__ul,t.CLASS_CLOSED):Rt.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return l},set:function(e){on&&((l=e)?Rt.bind(window,"unload",c):Rt.unbind(window,"unload",c),localStorage.setItem(mn(0,"isLocal"),e))}}}),ct.isUndefined(o.parent)?(this.closed=o.closed||!1,Rt.addClass(this.domElement,t.CLASS_MAIN),Rt.makeSelectable(this.domElement,!1),on&&l&&(n.useLocalStorage=!0,(i=localStorage.getItem(mn(0,"gui")))&&(o.load=JSON.parse(i))),this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,Rt.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),o.closeOnTop?(Rt.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Rt.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Rt.bind(this.__closeButton,"click",function(){n.closed=!n.closed})):(void 0===o.closed&&(o.closed=!0),i=document.createTextNode(o.name),Rt.addClass(i,"controller-name"),d=un(n,i),Rt.addClass(this.__ul,t.CLASS_CLOSED),Rt.addClass(d,"title"),Rt.bind(d,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),o.closed||(this.closed=!1)),o.autoPlace&&(ct.isUndefined(o.parent)&&(an&&(sn=document.createElement("div"),Rt.addClass(sn,"dg"),Rt.addClass(sn,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(sn),an=!1),sn.appendChild(this.domElement),Rt.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||vn(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},Rt.bind(window,"resize",this.__resizeHandler),Rt.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Rt.bind(this.__ul,"transitionend",this.__resizeHandler),Rt.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&(a=void 0,(r=this).__resize_handle=document.createElement("div"),ct.extend(r.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Rt.bind(r.__resize_handle,"mousedown",f),Rt.bind(r.__closeButton,"mousedown",f),r.domElement.insertBefore(r.__resize_handle,r.domElement.firstElementChild)),c=function(){on&&"true"===localStorage.getItem(mn(0,"isLocal"))&&localStorage.setItem(mn(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=c,o.parent||((s=n.getRoot()).width+=1,ct.defer(function(){--s.width}))};function un(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o),e.onResize(),o}function pn(e){Rt.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&Rt.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function fn(e,t){e=e.__preset_select[e.__preset_select.selectedIndex];e.innerHTML=t?e.value+"*":e.value}function hn(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[t.property]=t,n.load&&n.load.remembered){i=n.load.remembered,n=void 0;if(i[e.preset])n=i[e.preset];else{if(!i[nn])return;n=i[nn]}n[o]&&void 0!==n[o][t.property]&&(o=n[o][t.property],t.initialValue=o,t.setValue(o))}}}function _n(e,t,n,o){var i;if(t.arguments&&(t=(i=t).arguments.object,n=i.arguments.property,o={factoryArgs:i.arguments.opts}),void 0===i&&void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var r=void 0;null===(r=o.color?new Wt(t,n):void 0!==i&&"string"==typeof i.property?i:(l=[t,n].concat(o.factoryArgs),Qt.apply(e,l)))?r=i:void 0!==i&&(i.controller=r),o.before instanceof At&&(o.before=o.before.__li),hn(e,r),Rt.addClass(r.domElement,"c");var a=document.createElement("span");if(Rt.addClass(a,"property-name"),void 0!==i&&"object"===gt(i.property))for(var s in i.property)a.appendChild(i.property[s]);else a.innerHTML=r.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(r.domElement);var c,d,u,p,o=un(e,l,o.before);return Rt.addClass(o,dn.CLASS_CONTROLLER_ROW),r instanceof Wt?Rt.addClass(o,"color"):Rt.addClass(o,gt(r.getValue())),c=e,d=o,(u=r).__li=d,u.__gui=c,ct.extend(u,{options:function(e){if(1<arguments.length){var t=u.__li.nextElementSibling;return u.remove(),_n(c,u.object,u.property,{before:t,factoryArgs:[ct.toArray(arguments)]})}if(ct.isArray(e)||ct.isObject(e)){t=u.__li.nextElementSibling;return u.remove(),_n(c,u.object,u.property,{before:t,factoryArgs:[e]})}},name:function(e){return u.__li.firstElementChild.firstElementChild.innerHTML=e,u},listen:function(){return u.__gui.listen(u),u},remove:function(){return u.__gui.remove(u),u}}),u instanceof Gt?(p=new Mt(u.object,u.property,{min:u.__min,max:u.__max,step:u.__step}),ct.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(e){var t=u[e],n=p[e];u[e]=p[e]=function(){var e=Array.prototype.slice.call(arguments);return n.apply(p,e),t.apply(u,e)}}),Rt.addClass(d,"has-slider"),u.domElement.insertBefore(p.domElement,u.domElement.firstElementChild)):u instanceof Mt?(o=function(e){if(ct.isNumber(u.__min)&&ct.isNumber(u.__max)){var t=u.__li.firstElementChild.firstElementChild.innerHTML,n=-1<u.__gui.__listening.indexOf(u);u.remove();var o=_n(c,u.object,u.property,{before:u.__li.nextElementSibling,factoryArgs:[u.__min,u.__max,u.__step]});return o.name(t),n&&o.listen(),o}return e},u.min=ct.compose(o,u.min),u.max=ct.compose(o,u.max)):u instanceof Lt?(Rt.bind(d,"click",function(){Rt.fakeEvent(u.__checkbox,"click")}),Rt.bind(u.__checkbox,"click",function(e){e.stopPropagation()})):u instanceof Ut?(Rt.bind(d,"click",function(){Rt.fakeEvent(u.__button,"click")}),Rt.bind(d,"mouseover",function(){Rt.addClass(u.__button,"hover")}),Rt.bind(d,"mouseout",function(){Rt.removeClass(u.__button,"hover")})):u instanceof Wt&&(Rt.addClass(d,"color"),u.updateDisplay=ct.compose(function(e){return d.style.borderLeftColor=u.__color.toString(),e},u.updateDisplay),u.updateDisplay()),u.setValue=ct.compose(function(e){return c.getRoot().__preset_select&&u.isModified()&&fn(c.getRoot(),!0),e},u.setValue),e.__controllers.push(r),r}function mn(e,t){return document.location.href+"."+t}function gn(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function bn(e,t){t.style.display=e.useLocalStorage?"block":"none"}function vn(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function yn(i,r){var a={};return ct.each(i.__rememberedObjects,function(e,t){var n={},o=i.__rememberedObjectIndecesToControllers[t];ct.each(o,function(e,t){n[t]=r?e.initialValue:e.getValue()}),a[t]=n}),a}dn.toggleHide=function(){ln=!ln,ct.each(cn,function(e){e.domElement.style.display=ln?"none":""})},dn.CLASS_AUTO_PLACE="a",dn.CLASS_AUTO_PLACE_CONTAINER="ac",dn.CLASS_MAIN="main",dn.CLASS_CONTROLLER_ROW="cr",dn.CLASS_TOO_TALL="taller-than-window",dn.CLASS_CLOSED="closed",dn.CLASS_CLOSE_BUTTON="close-button",dn.CLASS_CLOSE_TOP="close-top",dn.CLASS_CLOSE_BOTTOM="close-bottom",dn.CLASS_DRAG="drag",dn.DEFAULT_WIDTH=245,dn.TEXT_CLOSED="Close Controls",dn.TEXT_OPEN="Open Controls",dn._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||dn.toggleHide()},Rt.bind(window,"keydown",dn._keydownHandler,!1),ct.extend(dn.prototype,{add:function(e,t){return _n(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return _n(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;ct.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&sn.removeChild(this.domElement);var t=this;ct.each(this.__folders,function(e){t.removeFolder(e)}),Rt.unbind(window,"keydown",dn._keydownHandler,!1),pn(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);t=new dn(t);this.__folders[e]=t;e=un(this,t.domElement);return Rt.addClass(e,"folder"),t},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],pn(t);var e=this;ct.each(t.__folders,function(e){t.removeFolder(e)}),ct.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e,t,n=this.getRoot();n.scrollable&&(e=Rt.getOffset(n.__ul).top,t=0,ct.each(n.__ul.childNodes,function(e){n.autoPlace&&e===n.__save_row||(t+=Rt.getHeight(e))}),window.innerHeight-e-20<t?(Rt.addClass(n.domElement,dn.CLASS_TOO_TALL),n.__ul.style.height=window.innerHeight-e-20+"px"):(Rt.removeClass(n.domElement,dn.CLASS_TOO_TALL),n.__ul.style.height="auto")),n.__resize_handle&&ct.defer(function(){n.__resize_handle.style.height=n.__ul.offsetHeight+"px"}),n.__closeButton&&(n.__closeButton.style.width=n.width+"px")},onResizeDebounced:ct.debounce(function(){this.onResize()},50),remember:function(){if(ct.isUndefined(rn)&&((rn=new en).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;ct.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(n){var e=n.__save_row=document.createElement("li");Rt.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),Rt.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",Rt.addClass(t,"button gears");var o=document.createElement("span");o.innerHTML="Save",Rt.addClass(o,"button"),Rt.addClass(o,"save");var i=document.createElement("span");i.innerHTML="New",Rt.addClass(i,"button"),Rt.addClass(i,"save-as");var r=document.createElement("span");r.innerHTML="Revert",Rt.addClass(r,"button"),Rt.addClass(r,"revert");var a=n.__preset_select=document.createElement("select");n.load&&n.load.remembered?ct.each(n.load.remembered,function(e,t){gn(n,t,t===n.preset)}):gn(n,nn,!1);{var s;Rt.bind(a,"change",function(){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].innerHTML=n.__preset_select[e].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(o),e.appendChild(i),e.appendChild(r),on&&(s=document.getElementById("dg-local-explain"),e=document.getElementById("dg-local-storage"),document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(mn(0,"isLocal"))&&e.setAttribute("checked","checked"),bn(n,s),Rt.bind(e,"change",function(){n.useLocalStorage=!n.useLocalStorage,bn(n,s)}))}var l=document.getElementById("dg-new-constructor");Rt.bind(l,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||rn.hide()}),Rt.bind(t,"click",function(){l.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),rn.show(),l.focus(),l.select()}),Rt.bind(o,"click",function(){n.save()}),Rt.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&n.saveAs(e)}),Rt.bind(r,"click",function(){n.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&vn(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var n=this.load;return n.closed=this.closed,0<this.__rememberedObjects.length&&(n.preset=this.preset,n.remembered||(n.remembered={}),n.remembered[this.preset]=yn(this)),n.folders={},ct.each(this.__folders,function(e,t){n.folders[t]=e.getSaveObject()}),n},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=yn(this),fn(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[nn]=yn(this,!0)),this.load.remembered[e]=yn(this),this.preset=e,gn(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(t){ct.each(this.__controllers,function(e){this.getRoot().load.remembered?hn(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),ct.each(this.__folders,function(e){e.revert(e)}),t||fn(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&$t.call(window,function(){e(t)});ct.each(t,function(e){e.updateDisplay()})}(this.__listening)},updateDisplay:function(){ct.each(this.__controllers,function(e){e.updateDisplay()}),ct.each(this.__folders,function(e){e.updateDisplay()})}});Q={Controller:At,BooleanController:Lt,OptionController:Nt,StringController:Ft,NumberController:R,NumberControllerBox:Mt,NumberControllerSlider:Gt,FunctionController:Ut,ColorController:Wt,CustomController:Q};
/**
 * @module Localization.
 *
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
/**
 * @module PlayController
 * @description PlayController class for using in my version of dat.gui(https://github.com/anhr/dat.gui) for playing of 3D objects in my projects.
 *
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var wn={prevSymbol:"",prevSymbolTitle:"Go to previous animation scene",nextSymbol:"",nextSymbolTitle:"Go to next animation scene",playSymbol:"",playTitle:"Play",pause:"",pauseTitle:"Pause",repeat:"",repeatOn:"Turn repeat on",repeatOff:"Turn repeat off",controllerTitle:"Current time.",fullScreen:"Full Screen",nonFullScreen:"Non Full Screen",stereoEffects:"Stereo effects",mono:"Mono",sideBySide:"Side by side",topAndBottom:"Top and bottom"};function xn(e,t,n){var o=document.createElement("span");return o.innerHTML=e,o.title=t,o.style.cursor="pointer",o.style.margin="0px 2px",o.onclick=n,o}"ru"===(navigator?void 0!==navigator.languages&&"unknown"!=typeof navigator.languages&&0<navigator.languages.length?navigator.languages[0]:navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||(console.error("getLocale() failed!"),""):(console.error("getLocale() failed! !navigator"),"")).toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/)[1]&&(wn.prevSymbolTitle=" ",wn.playTitle="",wn.nextSymbolTitle=" ",wn.pauseTitle="",wn.repeatOn=" ",wn.repeatOff="  ",wn.controllerTitle=" .",wn.fullScreen="  ",wn.nonFullScreen="  ",wn.stereoEffects=" ",wn.mono="",wn.sideBySide=" ",wn.topAndBottom=" ");var Cn,En;
/**
 * @module Player
 * @description 3D objects animation.
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */c(Sn,Q.CustomController),t(Sn,[{key:"controller",set:function(e){this._controller=e;var t=this;this._controller.onChange(function(e){t.onChange(e)}),this._controller.domElement.title=wn.controllerTitle},get:function(){return this._controller}}]);function Sn(i,e){var r,a,s;d(this,Sn);var l="rgb(255,255,255)",c="rgb(128,128,128)",t=u(this,(Sn.__proto__||Object.getPrototypeOf(Sn)).call(this,{playRate:1,property:function(){var e,t,n,o={};return a=function(e,t){o.buttonPlay.innerHTML=e,o.buttonPlay.title=t},o.buttonPrev=xn(wn.prevSymbol,wn.prevSymbolTitle,i.prev),o.buttonPlay=xn(wn.playSymbol,wn.playTitle,i.play3DObject),null!==i.getOptions().settings.max&&(s=e=function(e){var t,n=e?(t=wn.repeatOff,l):(t=wn.repeatOn,c);o.buttonRepeat.title!==t&&(o.buttonRepeat.title=t,o.buttonRepeat.style.color=n,i.onChangeRepeat(e))},n=i.getOptions().repeat?(t=wn.repeatOff,l):(t=wn.repeatOn,c),o.buttonRepeat=xn(wn.repeat,t,function(){e(o.buttonRepeat.title===wn.repeatOn)}),o.buttonRepeat.style.color=n),o.buttonNext=xn(wn.nextSymbol,wn.nextSymbolTitle,i.next),r=function(){return group},o}},"playRate"));return(i.PlayController=t).onRenamePlayButtons=function(e){var t,e=e?(t=wn.pause,wn.pauseTitle):(t=wn.playSymbol,wn.playTitle);a(t,e,!0)},t.onChangeRepeat=function(){s(i.getOptions().settings.repeat)},i.pushController(t),t.onChange=function(e){i.setTime(e)},t.getGroup=function(){return r()},t.selectScene=function(e){(void 0)(parseInt(e))},t.setValue=function(e){this._controller.domElement.childNodes[0].value=e},e.add(t).__truncationSuspended=!0,t}function An(n,o,c){function t(e){e=e||0;var t=a();An.selectPlayScene(n,o,t,e,c.selectPlaySceneOptions),r.setIndex(e,(""===Cn.name?"":Cn.name+": ")+t),c.onSelectScene&&c.onSelectScene(e,t)}(En=(En=(c=c||{}).selectPlaySceneOptions)||{}).boPlayer=En.boPlayer||!1,En.a=c.a||1,En.b=c.b||0,En.scales=En.scales||{},Cn=c.settings||{},Pn(),setTimeout(function(){t()},0);var i=0,r=this;function a(){var e=Cn.min+i*Cn.dt;return isNaN(e)&&console.error("Player.getTime(): res = "+e),e}this.setTime=function(e){this.selectScene(parseInt((e-Cn.min)/Cn.dt))},this.selectScene=function(e){for(e=parseInt(e),null!==Cn.max&&(e>=Cn.marks?e=0:e<0&&(e=Cn.marks-1),i>Cn.marks&&(i=Cn.marks));i!==e;)i<e?i++:i--,console.warn("selectSceneIndex = "+i),t(i)},this.next=function(){r.selectScene(i+1)},this.prev=function(){r.selectScene(i-1)},this.pushController=function(e){void 0!==e.object&&void 0!==e.object.playRate&&(e.object.playRate=Cn.min),p.push(e)};var s,l,d,u=!(this.controllers=[]),p=this.controllers;function e(){p.forEach(function(e){e.onRenamePlayButtons&&e.onRenamePlayButtons(u)})}function f(){u=!1,e(),s=void 0}function h(){if(i++,null!==Cn.max&&i>=Cn.marks){if(!Cn.repeat)return void f();i=0}-1!==i&&i!==Cn.marks||(i=0),t(i)}function _(){if(d)return d.querySelector("#sliderPosition")}this.play3DObject=function(){u?f():(u=!0,null!==Cn.max&&i>=Cn.marks&&(i=-1),h(),e(),window.requestAnimationFrame(function e(t){if(u?window.requestAnimationFrame(e):s=void 0,void 0===s&&(l=(s=t)+1e3/Cn.interval),!isNaN(l)&&l!==1/0||(console.error("Player.animate: timeNext = "+l),u=!1),!(t<l)){for(;l<t;)l+=1e3/Cn.interval;h()}}))},this.repeat=function(){Cn.repeat=!Cn.repeat,this.onChangeRepeat(Cn.repeat)},this.getOptions=function(){return c},this.getSelectSceneIndex=function(){return i},this.onChangeRepeat=function(e){Cn.repeat=e,this.controllers.forEach(function(e){e.onChangeRepeat&&e.onChangeRepeat()})},this.gui=function(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i.getLanguageCode=i.getLanguageCode||function(){return"en"},i.cookie=i.cookie||new m.defaultCookie,i.cookieName=i.cookieName||"";var t=i.cookie,n="Player"+i.cookieName;function r(){Tn(),t.setObject(n,Cn),c.onChangeScaleT&&c.onChangeScaleT(Cn)}On();var a=JSON.parse(JSON.stringify(Cn)),s=function(t){var e={player:"Player",playerTitle:"3D objects animation.",min:"Min",max:"Max",dt:"Step",marks:"Frames",marksTitle:"Player frames count",interval:"Rate",intervalTitle:"Rate of changing of animation scenes per second.",time:"Time",defaultButton:"Default",defaultTitle:"Restore default player settings."},n=void 0===(t=t||{}).getLanguageCode?"en":t.getLanguageCode();switch(n){case"ru":e.player="",e.playerTitle=" 3D .",e.min="",e.max="",e.dt="",e.marks="",e.marksTitle="  ",e.interval="",e.intervalTitle="    .",e.time="",e.defaultButton="",e.defaultTitle="    .";break;default:if(void 0===t.lang||t.lang._languageCode!=n)break;Object.keys(t.lang).forEach(function(e){void 0!==_lang[e]&&(_lang[e]=t.lang[e])})}return e}({getLanguageCode:i.getLanguageCode});Object.freeze(a);var o=Cn.max;t.getObject(n,Cn,Cn),null!==o&&o!==1/0||(Cn.max=o);var l=e.addFolder(s.player);Ve.folderNameAndTitle(l,s.player,s.playerTitle),function(){var n=Cn,o={};function e(e,t){e=e.controller.getValue();n.min=t(n.min,e),o.min.setValue(n.min),n.max&&(n.max=t(n.max,e),Tn(),o.max.setValue(n.max)),r()}o.folder=l.addFolder(""!==n.name?n.name:s.time),o.scaleController=o.folder.add(new je(e,{settings:c.settings,getLanguageCode:i.getLanguageCode})).onChange(function(e){n.zoomMultiplier=e,r()});var t=new He(function(n){e(t,function(e,t){return e+=n})},{settings:c.settings,getLanguageCode:i.getLanguageCode});o.positionController=o.folder.add(t).onChange(function(e){n.offset=e,r()}),o.min=Ve.controllerZeroStep(o.folder,n,"min",function(e){r()}),Ve.controllerNameAndTitle(o.min,s.min),On(),null!==n.max?(o.max=Ve.controllerZeroStep(o.folder,n,"max",function(e){r()}),Ve.controllerNameAndTitle(o.max,s.max)):(o.dt=Ve.controllerZeroStep(o.folder,n,"dt",function(e){r()}),Ve.controllerNameAndTitle(o.dt,s.dt)),n.marks&&(o.marks=o.folder.add(n,"marks").onChange(function(e){n.marks=parseInt(n.marks),r();var t=_();t&&(t.max=Cn.marks-1)}),Ve.controllerNameAndTitle(o.marks,void 0===n.marksName?s.marks:n.marksName,(void 0===n.marksTitle?s:n).marksTitle)),o.interval=o.folder.add(c.settings,"interval",1,25,1).onChange(function(e){r()}),Ve.controllerNameAndTitle(o.interval,s.interval,s.intervalTitle),Ve.controllerNameAndTitle(o.folder.add({defaultF:function(){n.zoomMultiplier=a.zoomMultiplier,o.scaleController.setValue(n.zoomMultiplier),n.offset=a.offset,o.positionController.setValue(n.offset),n.min=a.min,o.min.setValue(n.min),o.max&&(n.max=a.max,Tn(),o.max.setValue(n.max)),o.dt&&(n.dt=a.dt,o.dt.setValue(n.dt)),a.marks&&(n.marks=a.marks,o.marks.setValue(n.marks)),n.interval=a.interval,o.interval.setValue(n.interval),r()}},"defaultF"),s.defaultButton,s.defaultTitle)}()},this.createCanvasMenuItem=function(o){var e=this,t=(d=o).menu;t.push({name:wn.prevSymbol,title:wn.prevSymbolTitle,onclick:function(){e.prev()}}),t.push({name:wn.playSymbol,title:wn.playTitle,id:"menuButtonPlay",onclick:function(){e.play3DObject()}}),null!==Cn.max&&t.push({name:wn.repeat,title:this.getOptions().repeat?wn.repeatOff:wn.repeatOn,id:"menuButtonRepeat",onclick:function(){e.repeat()}}),t.push({name:wn.nextSymbol,title:wn.nextSymbolTitle,onclick:function(){e.next()}}),p.push({onRenamePlayButtons:function(e){var t,n=e?(t=wn.pause,wn.pauseTitle):(t=wn.playSymbol,wn.playTitle),e=o.querySelector("#menuButtonPlay");e.innerHTML=t,e.title=n},onChangeRepeat:function(){o.querySelector("#menuButtonRepeat").title=Cn.repeat?wn.repeatOff:wn.repeatOn}})},this.addSlider=function(){null!==Cn.max&&d.menu.push({name:'<input type="range" min="0" max="'+(An.getSettings().marks-1)+'" value="0" class="slider" id="sliderPosition">',style:"float: right;"})},this.addSliderEvents=function(){var t,n,o=_();return o&&(o.onchange=function(e){n.selectScene(parseInt(o.value))},o.oninput=function(e){n.selectScene(parseInt(o.value))},n=this,o.addEventListener("pointerdown",function(e){t=!0}),o.addEventListener("pointerup",function(e){t=!1}),o.addEventListener("mousemove",function(e){t&&n.selectScene((Cn.marks-1)*e.offsetX/o.clientWidth)})),o},this.setIndex=function(e,t){this.PlayController&&this.PlayController.setValue(a());var n=_();n&&(n.value=e,n.title=t)},this.onChangeScale=function(e){_().max=e.marks-1,this.selectScene(0)}}function kn(){var e;this.get=function(){return En&&En.palette?En.palette:e=e||new et.palette}}function Tn(){null===Cn.max?Cn.dt=Cn.dt||.1:Cn.dt=(Cn.max-Cn.min)/(Cn.marks-1)}function On(){null!==Cn.max&&(Cn.max=Cn.min+Cn.dt*(Cn.marks-1))}function Pn(){(Cn=Cn||{}).min=Cn.min||0,Cn.max===1/0&&(Cn.max=null),null!==Cn.max?(void 0===Cn.max&&(Cn.max=1),Cn.marks=Cn.marks||10):Cn.marks=null,Tn(),Cn.repeat=Cn.repeat||!1,Cn.interval=Cn.interval||1,Cn.zoomMultiplier=Cn.zoomMultiplier||1.1,Cn.offset=Cn.offset||.1,Cn.name=Cn.name||""}An.execFunc=function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=e[t],a=void 0===r?"undefined":y(r);switch(a){case"undefined":return;case"function":return r(n,o,i);case"number":return r;case"object":if(Array.isArray(r)){var s=function(e){return"function"==typeof l[e]?l[e](n,l,i):l[e]instanceof THREE.Color?l[e]:void 0};if(0===r.length)return void console.error('Player.execFunc: funcs["'+t+'"] array is empty');for(var l=r,c=r.length-1,d=null===Cn.max?1/0:Cn.max,u=Cn.min,p=(d-u)/c,f=u,h=d,_=0,m=c,g=0;g<r.length;g++)p*g+u<n&&(f=p*(_=g)+u,h=p*(m=g+1)+u);if("number"!=typeof l[_]){if("w"===t)return s(_);if("object"!==y(l[_]))return void console.error('Player.execFunc: funcs["'+t+'"] array item '+_+" typeof = "+y(l[_])+" is not number");for(g=0;g<r.length;g++){if(g===r.length-1)return l[g].v;if(m=(_=g)+1,f=l[_].t,h=l[m].t,f<=n&&n<h){var b=(l[m].v-l[_].v)/(h-f),v=l[_].v-b*f;return b*n+v}}return void console.error("Player.execFunc: value is not detected")}if(m>=r.length&&(m=_),"number"!=typeof l[m]){if("w"===t)return s(m);if("object"!==y(l[m]))return void console.error('Player.execFunc: funcs["'+t+'"] array item '+m+" typeof = "+y(l[m])+" is not number")}b=(l[m]-l[_])/(h-f),v=l[_]-b*f;return(isNaN(b)||isNaN(v))&&console.error("Player.execFunc: invalid x = "+b+" or y = "+v),b*n+v}return r.func?r.func instanceof Function?r.func(n,o,i):r.func:void("w"!==t&&console.error('Player.execFunc: funcs["'+t+'"] object is not array'));default:console.error('Player.execFunc: Invalud typeof funcs["'+t+'"]: '+a)}},kn=new kn,An.selectMeshPlayScene=function(u,p,f,h,_){var e;void 0===f&&(f=An.getSettings().min),h=h||0,_=_||En,!p.userData.player||_&&_.boPlayer&&p.userData.boFrustumPoints||(p.geometry&&(delete p.geometry.boundingSphere,p.geometry.boundingSphere=null),p.userData.player.selectPlayScene&&p.userData.player.selectPlayScene(f),function(n,o){if(p.geometry){var e,t,i=p.geometry.attributes,r=p.userData.player.arrayFuncs;if(void 0!==r){void 0===f&&console.error("setPosition: t = "+f),_&&void 0!==_.scales.w?(e=_.scales.w.min,t=_.scales.w.max):e=(t=d)-1;for(var a=0;a<r.length;a++){var s=function(e,t){e=An.execFunc(l,e,f,n,o);void 0!==e&&(i.position[t](a,e),c=!0)},l=r[a],c=!1;s("x","setX"),s("y","setY"),s("z","setZ");var d,s=void 0;"function"==typeof l.w?(d=l.w(f,n,o),i.position.setW(a,d),c=!0,p.userData.player.palette?s=p.userData.player.palette.toColor(d,e,t):_.palette&&(s=_.palette.toColor(d,e,t))):"object"===y(l.w)?l.w instanceof u.Color?s=l.w:_.palette&&("object"===y(l.w)&&(l.w.min&&(e=l.w.min),l.w.max&&(t=l.w.max)),s=_.palette.toColor(An.execFunc(l,"w",f,n,o),e,t)):"number"==typeof l.w&&_.palette&&(s=_.palette.toColor(l.w,e,t)),s&&(!p.material instanceof u.ShaderMaterial&&p.material.vertexColors!==u.VertexColors&&console.error("Player.selectPlayScene: Please set the vertexColors parameter of the THREE.PointsMaterial of your points to THREE.VertexColors. Example: vertexColors: THREE.VertexColors"),!An.setColorAttribute(i,a,s)&&l instanceof u.Vector4&&(p.geometry.setAttribute("color",new u.Float32BufferAttribute(An.getColors(u,r,{positions:p.geometry.attributes.position,scale:{min:e,max:t},palette:_.palette}),3)),An.setColorAttribute(i,a,s)||console.error('Player.selectPlayScene: the color attribute is not exists. Please use THREE.Vector3 instead THREE.Vector4 in the arrayFuncs or add "color" attribute'))),c&&(i.position.needsUpdate=!0),void 0!==l.line&&l.line.addPoint(it(p,a),h,s),l.cameraTarget&&function(){var t=l.cameraTarget.camera;t.userData.cameraTarget.setCameraPosition=function(e){t.position.copy(t.userData.cameraTarget.distanceToCameraCur),t.userData.cameraTarget.rotation&&t.position.applyAxisAngle(t.userData.cameraTarget.rotation.axis,An.execFunc(t.userData.cameraTarget.rotation,"angle",f)),t.position.add(e),t.lookAt(e),t.userData.cameraTarget.orbitControls&&(t.userData.cameraTarget.orbitControls.target.copy(e),t.userData.cameraTarget.orbitControlsGui&&t.userData.cameraTarget.orbitControlsGui.setTarget(e))},t.userData.cameraTarget.distanceToCameraCur||(t.userData.cameraTarget.distanceToCameraCur=new u.Vector3),t.userData.cameraTarget.distanceToCameraCur.set(An.execFunc(t.userData.cameraTarget.distanceToCamera,"x",f),An.execFunc(t.userData.cameraTarget.distanceToCamera,"y",f),An.execFunc(t.userData.cameraTarget.distanceToCamera,"z",f));var e=ot(p,(new u.Vector3).fromArray(p.geometry.attributes.position.array,a*p.geometry.attributes.position.itemSize));t.userData.cameraTarget.target=e,t.userData.cameraTarget.setCameraPosition(e),t.userData.cameraTarget.cameraGui&&t.userData.cameraTarget.cameraGui.update()}()}}}}(_?_.a:1,_?_.b:0),e="Player.selectPlayScene: invalid mesh.scale.",p.scale.x<=0&&console.error(e+"x = "+p.scale.x),p.scale.y<=0&&console.error(e+"y = "+p.scale.y),p.scale.z<=0&&console.error(e+"z = "+p.scale.z),_.guiSelectPoint&&(_.guiSelectPoint.setMesh(),-1!==(e=_.guiSelectPoint.getSelectedPointIndex())&&_.guiSelectPoint.isSelectedMesh(p)&&_.guiSelectPoint.setPosition(it(p,e),{object:p,index:e})))},An.selectPlayScene=function(t,e,n,o,i){et.palette.setTHREE(t),e.userData.t=n,An.selectMeshPlayScene(t,e,n,o),e.children.forEach(function(e){An.selectMeshPlayScene(t,e,n,o)})},An.setColorAttribute=function(e,t,n){"string"==typeof n&&(n=new THREE.Color(n));e=e.color||e.ca;return void 0!==e&&(e.setX(t,n.r),e.setY(t,n.g),e.setZ(t,n.b),e.needsUpdate=!0)},An.getPoints=function(n,o,i){tt.setTHREE(n),void 0===(i=i||{}).t&&(i.t=0);for(var r=i.options||{},a=r.a||1,s=r.b||0,l=0;l<o.length;l++){var e=o[l];Array.isArray(e)?o[l]=new n.Vector4(void 0===e[0]?0:e[0],void 0===e[1]?0:e[1],void 0===e[2]?0:e[2],void 0===e[3]?0:e[3]):"object"===(void 0===e?"undefined":y(e))&&e instanceof n.Vector2==!1&&e instanceof n.Vector3==!1&&e instanceof n.Vector4==!1&&(void 0===e.vector?o[l]=new n.Vector4(void 0===e.x?0:e.x,void 0===e.y?0:e.y,void 0===e.z?0:e.z,void 0===e.w?0:e.w):e.vector instanceof n.Vector2==!0||e.vector instanceof n.Vector3==!0||e.vector instanceof n.Vector4==!0?e.vector instanceof n.Vector2==!0&&(o[l].vector=new n.Vector3(void 0===e.vector.x?0:e.vector.x,void 0===e.vector.y?0:e.vector.y,void 0===e.vector.z?0:e.vector.z)):4===e.vector.length?o[l].vector=new n.Vector4(void 0===e.vector[0]?0:e.vector[0],void 0===e.vector[1]?0:e.vector[1],void 0===e.vector[2]?0:e.vector[2],void 0===e.vector[3]?0:e.vector[3]):3===e.vector.length?o[l].vector=new n.Vector3(void 0===e.vector[0]?0:e.vector[0],void 0===e.vector[1]?0:e.vector[1],void 0===e.vector[2]?0:e.vector[2]):console.error("options.getPoints(...) falied! item.vector.length = "+e.vector.length))}for(var t=[],l=0;l<o.length;l++){var c=function(e){return"number"==typeof d&&(d=new n.Vector4(d,0,0,0)),d instanceof n.Vector2||d instanceof n.Vector3||d instanceof n.Vector4?An.execFunc(d,e,i.t,a,s):void 0!==d.vector?(void 0!==d.name&&(d.vector.name=d.name),d.trace&&(d.vector.line=new An.traceLine(n,i.group,r)),d.cameraTarget&&(d.vector.cameraTarget=d.cameraTarget,(t=d.vector.cameraTarget.camera).userData.cameraTarget=t.userData.cameraTarget||{},t.userData.cameraTarget.ready&&console.warn("Player.getPoints: duplicate cameraTarget"),t.userData.cameraTarget.ready=!0,t.userData.cameraTarget.distanceToCamera=d.vector.cameraTarget.distanceToCamera||t.userData.cameraTarget.distanceToCamera||(new n.Vector3).copy(t.position),t.userData.cameraTarget.rotation=d.cameraTarget.rotation||t.userData.cameraTarget.rotation,t.userData.cameraTarget.rotation&&(void 0===t.userData.cameraTarget.rotation.angle&&(t.userData.cameraTarget.rotation.angle=new Function("t","return t")),t.userData.cameraTarget.rotation.axis=t.userData.cameraTarget.rotation.axis||new n.Vector3(0,1,0))),o[l]=d.vector,d=d.vector,An.execFunc(d,e,i.t,a,s)):void console.error("options.getPoints: funcs.vector = "+d.vector);var t},d=o[l],c=d.vector instanceof n.Vector3==!0?new n.Vector3(c("x"),c("y"),c("z")):new n.Vector4(c("x"),c("y"),c("z"),c("w"));void 0===d.w&&(c.w={}),t.push(c)}return t},An.getColors=function(o,e,i){if(et.palette.setTHREE(o),(i=i||{}).palette=i.palette||kn.get(),void 0!==i.positions&&Array.isArray(e)&&e.length!==i.positions.count)return console.error("getColors failed! arrayFuncs.length: "+e.length+" != positions.count: "+i.positions.count),i.colors;i.colors=i.colors||[];for(var t=Array.isArray(e)?e.length:i.positions.count,r=0;r<t;r++){var n,a,s,l=Array.isArray(e)?e[r]:void 0;if(l instanceof o.Vector4||i.positions&&4===i.positions.itemSize){var c=void 0,d=void 0,u=l.w;if(l.w instanceof Object&&l.w.func?(l.w.max&&(d=l.w.max),l.w.min&&(c=l.w.min),u=l.w.func):void 0!==i.scale?(c=i.scale.min,d=i.scale.max):l instanceof o.Vector4&&(c="function"==typeof l.w?(d=100,0):(console.warn("  .       0  100"),(d=l.w)-1)),u instanceof Function&&!Cn)return console.error("Player.getColors: remove all functions from all THREE.Vector4.w items of the arrayFuncs."),console.error(" \tOr create Player."),void console.error("\tIf you use MyPoints for create of the points, please add Player: Player into settings parameter of the MyPoints function after creating of the Player.");d=i.palette.toColor(void 0===l?(new o.Vector4).fromBufferAttribute(i.positions,r).w:u instanceof Function?u(Cn.min):u,c,d);i.colors.push(d.r,d.g,d.b)}else i.colors instanceof o.Float32BufferAttribute?n=new o.Vector3(1,1,1):i.colors.push(1,1,1);void 0!==i.opacity?(a=0,s=getStandardNormalDistribution(0),group.children.forEach(function(e){if(e.userData.cloud)for(var t=0;t<e.geometry.attributes.position.count;t++){var n=it(e,t);a+=getStandardNormalDistribution(5*ot(camera,(new o.Vector3).fromBufferAttribute(i.positions,r)).distanceTo(n))/s}}),void 0!==debug.opacity&&(a=debug.opacity),i.colors instanceof o.Float32BufferAttribute?i.colors.setXYZW(r,n.x,n.y,n.z,a):i.colors.push(a)):i.colors.push(1)}return i.colors},An.traceLine=function(a,s,l){if(s){if(!Cn)return console.error("Player.traceLine: Remove all trace: true from arrayFunc parameter of the MyPoints or getShaderMaterialPoints method."),console.error("\tOr call Player(...)."),void console.error("\tIf you use getShaderMaterialPoints or MyPoints for create of the points, please add Player: Player into settings parameter of the getShaderMaterialPoints or MyPoints method after creating of the Player.");var c,d=[];this.addPoint=function(e,t,n){if(null===Cn.max){if((t=Math.abs(t))<d.length-1){for(;t<d.length-1;)s.remove(d[d.length-1]),d.pop();return}var o=new a.BufferGeometry,i=new Float32Array(6);o.setAttribute("position",new a.BufferAttribute(i,3));i=new Float32Array(6);o.setAttribute("color",new a.Float32BufferAttribute(i,3));i=new a.Line(o,new a.LineBasicMaterial({vertexColors:a.VertexColors}));s.add(i),e=(new a.Vector3).copy(e);o=i.geometry.attributes.position.itemSize;return e.toArray(i.geometry.attributes.position.array,+o),(0===d.length?e:(new a.Vector3).fromArray(d[d.length-1].geometry.attributes.position.array,+o)).toArray(i.geometry.attributes.position.array,0*o),i.geometry.attributes.position.needsUpdate=!0,void 0===n&&(n=new a.Color(1,1,1)),An.setColorAttribute(i.geometry.attributes,0,0===d.length?n:(new a.Color).fromArray(d[d.length-1].geometry.attributes.color.array,+o)),An.setColorAttribute(i.geometry.attributes,1,n),void d.push(i)}if(void 0===c){o=new a.BufferGeometry;if(null!==Cn.max)if(Cn&&Cn.marks)r=Cn.marks;else{if(!l.player||!l.player.marks)return void console.error("Player.traceLine: MAX_POINTS = "+r+". Create Player first or remove all trace = true from all items of the arrayFuncs");r=l.player.marks}else r=t+1;i=new Float32Array(3*r);o.setAttribute("position",new a.BufferAttribute(i,3));var r=new Float32Array(3*r);o.setAttribute("color",new a.Float32BufferAttribute(r,3)),o.setDrawRange(t,t),(c=new a.Line(o,new a.LineBasicMaterial({vertexColors:a.VertexColors}))).visible=!0,s.add(c)}c.geometry&&(delete c.geometry.boundingSphere,c.geometry.boundingSphere=null),c.geometry&&(delete c.geometry.boundingSphere,c.geometry.boundingSphere=null),(e=(new a.Vector3).copy(e)).toArray(c.geometry.attributes.position.array,t*c.geometry.attributes.position.itemSize),c.geometry.attributes.position.needsUpdate=!0,void 0===n&&(n=new a.Color(1,1,1)),An.setColorAttribute(c.geometry.attributes,t,n);e=c.geometry.drawRange.start,n=t+1-e;t<e&&(n=e+c.geometry.drawRange.count-(e=t)),c.geometry.setDrawRange(e,n)},this.visible=function(e){c.visible=e},this.isVisible=function(){return c.visible},this.remove=function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),s.remove(c))}}else console.error("Player.traceLine: Define optionsPoints.group of the Player.getPoints first.")},An.getSettings=function(){return Cn||Pn(),Cn},e.default=An,Object.defineProperty(e,"__esModule",{value:!0})});
