/**
 * @module Player
 * @description 3D objects animation.
 *
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.player={})}(this,function(e){"use strict";
/**
 * @module cookie
 * @description node.js version of the cookie.
 * Cookies let you store user information in web pages.
 * @see {@link https://www.w3schools.com/js/js_cookies.asp}
 *
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */function o(){return navigator.cookieEnabled}function n(e,t,n){o()?(t=t.toString(),void 0===n&&(n=new Date).setTime(n.getTime()+31536e6),document.cookie=e+"="+t+("undefined"==typeof settings?"":settings)+"; expires="+n.toGMTString(),""===document.cookie&&console.error("document.cookie is empty")):a()}function i(e,t){if(o()){e=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return e?unescape(e[2]):void 0===t?"":t}a()}function r(e,t){return JSON.parse(i(e,JSON.stringify(t)))}function a(){console.error("navigator.cookieEnabled = "+navigator.cookieEnabled)}function s(e){this.get=function(e){return e},this.set=function(){},this.getObject=function(e,n,o){o&&Object.keys(o).forEach(function(e){var t=o[e];void 0!==t&&(n[e]=JSON.parse(JSON.stringify(t)))})},this.copyObject=function(e,t){return JSON.parse(JSON.stringify(t))},this.setObject=function(){},this.isTrue=function(e){return e}}
/**
* node.js version of the cookie.
*
* @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
*
* @copyright 2011 Data Arts Team, Google Creative Lab
*
* @license under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*/var h={set:n,setObject:function(e,t){n(e,JSON.stringify(t))},get:i,getObject:function(e,t,n){(new s).getObject(e,t,r(e,n))},copyObject:r,defaultCookie:s},ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e};function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var oe=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},u=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t};function p(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),i=Math.round(e.g),r=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var d=e.hex.toString(16);d.length<6;)d="0"+d;return"#"+d}return"CSS_RGB"===n?"rgb("+o+","+i+","+r+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+r+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+r+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+r+","+a+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+",a:"+a+"}":"unknown format"}var f,m=Array.prototype.forEach,_=Array.prototype.slice,g={BREAK:{},extend:function(n){return this.each(_.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(t[e])||(n[e]=t[e])}.bind(this))},this),n},defaults:function(n){return this.each(_.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(n[e])&&(n[e]=t[e])}.bind(this))},this),n},compose:function(){var n=_.call(arguments);return function(){for(var e=_.call(arguments),t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},each:function(e,t,n){if(e)if(m&&e.forEach&&e.forEach===m)e.forEach(t,n);else if(e.length===e.length+0){for(var o=void 0,o=0,i=e.length;o<i;o++)if(o in e&&t.call(n,e[o],o)===this.BREAK)return}else for(var r in e)if(t.call(n,e[r],r)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(o,i,r){var a=void 0;return function(){var e=this,t=arguments;var n=r||!a;clearTimeout(a),a=setTimeout(function(){a=null,r||o.apply(e,t)},i),n&&o.apply(e,t)}},toArray:function(e){return e.toArray?e.toArray():_.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:(f=function(e){return isNaN(e)},b.toString=function(){return f.toString()},b),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};function b(e){return f.apply(this,arguments)}var v,y=[{litmus:g.isString,conversions:{THREE_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:p},SIX_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:p},CSS_RGB:{read:function(e){e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:p},CSS_RGBA:{read:function(e){e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:p}}},{litmus:g.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:g.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:g.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(g.isNumber(e.r)&&g.isNumber(e.g)&&g.isNumber(e.b)&&g.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(g.isNumber(e.r)&&g.isNumber(e.g)&&g.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(g.isNumber(e.h)&&g.isNumber(e.s)&&g.isNumber(e.v)&&g.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(g.isNumber(e.h)&&g.isNumber(e.s)&&g.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],w=void 0,x=void 0,C=function(e){x=!1;var n=1<arguments.length?g.toArray(arguments):e;return g.each(y,function(e){if(e.litmus(n))return g.each(e.conversions,function(e,t){if(w=e.read(n),!1===x&&!1!==w)return(x=w).conversionName=t,w.conversion=e,g.BREAK}),g.BREAK}),x},E={hsv_to_rgb:function(e,t,n){var o=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),r=n*(1-t),e=n*(1-i*t),t=n*(1-(1-i)*t),o=[[n,t,r],[e,n,r],[r,n,t],[r,e,n],[t,r,n],[n,r,e]][o];return{r:255*o[0],g:255*o[1],b:255*o[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),i=Math.max(e,t,n),r=i-o,o=void 0;return 0===i?{h:NaN,s:0,v:0}:(o=e===i?(t-n)/r:t===i?2+(n-e)/r:4+(e-t)/r,(o/=6)<0&&(o+=1),{h:360*o,s:r/i,v:i/255})},rgb_to_hex:function(e,t,n){e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t);return e=this.hex_with_component(e,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(v=8*t)|e&~(255<<v)}},S="function"==typeof Symbol&&"symbol"===ne(Symbol.iterator)?function(e){return void 0===e?"undefined":ne(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":ne(e)},A=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},k=function(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),e};function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function O(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0!==o){if("value"in o)return o.value;o=o.get;return void 0!==o?o.call(n):void 0}if(e=Object.getPrototypeOf(e),null!==e)return O(e,t,n)}var P=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":ne(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},R=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":ne(t))&&"function"!=typeof t?e:t},L=(k(F,[{key:"toString",value:function(){return p(this)}},{key:"toHexString",value:function(){return p(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),F);function F(){if(A(this,F),this.__state=C.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}function V(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||L.recalculateRGB(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(L.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function N(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||L.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(L.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}L.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=E.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");g.extend(e.__state,E.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},L.recalculateHSV=function(e){var t=E.rgb_to_hsv(e.r,e.g,e.b);g.extend(e.__state,{s:t.s,v:t.v}),g.isNaN(t.h)?g.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},L.COMPONENTS=["r","g","b","h","s","v","hex","a"],V(L.prototype,"r",2),V(L.prototype,"g",1),V(L.prototype,"b",0),N(L.prototype,"h"),N(L.prototype,"s"),N(L.prototype,"v"),Object.defineProperty(L.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(L.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=E.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var j=(k(D,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),D);function D(e,t){A(this,D),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}var H={};g.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){g.each(e,function(e){H[e]=t})});var B=/(\d+(\.\d+)?)px/;function z(e){if("0"===e||g.isUndefined(e))return 0;e=e.match(B);return g.isNull(e)?0:parseFloat(e[1])}var M={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){g.isUndefined(t)&&(t=!0),g.isUndefined(n)&&(n=!0),e.style.position="absolute",t&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var i=n||{},n=H[t];if(!n)throw new Error("Event type "+t+" not supported.");var r=document.createEvent(n);switch(n){case"MouseEvents":var a=i.x||i.clientX||0,s=i.y||i.clientY||0;r.initMouseEvent(t,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,a,s,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":s=r.initKeyboardEvent||r.initKeyEvent;g.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),s(t,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:r.initEvent(t,i.bubbles||!1,i.cancelable||!0)}g.defaults(r,o),e.dispatchEvent(r)},bind:function(e,t,n,o){o=o||!1;return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n),M},unbind:function(e,t,n,o){o=o||!1;return e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n),M},addClass:function(e,t){var n;return void 0===e.className?e.className=t:e.className===t||-1===(n=e.className.split(/ +/)).indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")),M},removeClass:function(e,t){var n;return t?e.className===t?e.removeAttribute("class"):-1!==(t=(n=e.className.split(/ +/)).indexOf(t))&&(n.splice(t,1),e.className=n.join(" ")):e.className=void 0,M},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){e=getComputedStyle(e);return z(e["border-left-width"])+z(e["border-right-width"])+z(e["padding-left"])+z(e["padding-right"])+z(e.width)},getHeight:function(e){e=getComputedStyle(e);return z(e["border-top-width"])+z(e["border-bottom-width"])+z(e["padding-top"])+z(e["padding-bottom"])+z(e.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)for(;n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent,t;);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},I=(P(G,j),k(G,[{key:"setValue",value:function(e){e=O(G.prototype.__proto__||Object.getPrototypeOf(G.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),O(G.prototype.__proto__||Object.getPrototypeOf(G.prototype),"updateDisplay",this).call(this)}}]),G);function G(e,t){A(this,G);var t=R(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,e,t)),n=t;return t.__prev=t.getValue(),t.__checkbox=document.createElement("input"),t.__checkbox.setAttribute("type","checkbox"),M.bind(t.__checkbox,"change",function(){n.setValue(!n.__prev)},!1),t.domElement.appendChild(t.__checkbox),t.updateDisplay(),t}var X=(P(U,j),k(U,[{key:"setValue",value:function(e){e=O(U.prototype.__proto__||Object.getPrototypeOf(U.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e}},{key:"updateDisplay",value:function(){return M.isActive(this.__select)?this:(this.__select.value=this.getValue(),O(U.prototype.__proto__||Object.getPrototypeOf(U.prototype),"updateDisplay",this).call(this))}}]),U);function U(e,t,n){A(this,U);var o,t=R(this,(U.__proto__||Object.getPrototypeOf(U)).call(this,e,t)),n=n,i=t;return t.__select=document.createElement("select"),g.isArray(n)&&(o={},g.each(n,function(e){o[e]=e}),n=o),g.each(n,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),i.__select.appendChild(n)}),t.updateDisplay(),M.bind(t.__select,"change",function(){var e=this.options[this.selectedIndex].value;i.setValue(e)}),t.domElement.appendChild(t.__select),t}var q=(P(W,j),k(W,[{key:"updateDisplay",value:function(){return M.isActive(this.__input)||(this.__input.value=this.getValue()),O(W.prototype.__proto__||Object.getPrototypeOf(W.prototype),"updateDisplay",this).call(this)}}]),W);function W(e,t){A(this,W);var t=R(this,(W.__proto__||Object.getPrototypeOf(W)).call(this,e,t)),n=t;function o(){n.setValue(n.__input.value)}return t.__input=document.createElement("input"),t.__input.setAttribute("type","text"),M.bind(t.__input,"keyup",o),M.bind(t.__input,"change",o),M.bind(t.__input,"blur",function(){n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())}),M.bind(t.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),t.updateDisplay(),t.domElement.appendChild(t.__input),t}function Y(e){e=e.toString();return-1<e.indexOf(".")?e.length-e.indexOf(".")-1:0}var J=(P(K,j),k(K,[{key:"setValue",value:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),O(K.prototype.__proto__||Object.getPrototypeOf(K.prototype),"setValue",this).call(this,e)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=Y(e),this}}]),K);function K(e,t,n){A(this,K);t=R(this,(K.__proto__||Object.getPrototypeOf(K)).call(this,e,t)),n=n||{};return t.__min=n.min,t.__max=n.max,t.__step=n.step,g.isUndefined(t.__step)?0===t.initialValue?t.__impliedStep=1:t.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(t.initialValue))/Math.LN10))/10:t.__impliedStep=t.__step,t.__precision=Y(t.__impliedStep),t}var Q=(P(Z,J),k(Z,[{key:"updateDisplay",value:function(){var e,t;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),t=this.__precision,t=Math.pow(10,t),Math.round(e*t)/t),O(Z.prototype.__proto__||Object.getPrototypeOf(Z.prototype),"updateDisplay",this).call(this)}}]),Z);function Z(e,t,n){A(this,Z);n=R(this,(Z.__proto__||Object.getPrototypeOf(Z)).call(this,e,t,n));n.__truncationSuspended=!1;var o=n,i=void 0;function r(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function a(e){var t=i-e.clientY;o.setValue(o.getValue()+t*o.__impliedStep),i=e.clientY}function s(){M.unbind(window,"mousemove",a),M.unbind(window,"mouseup",s),r()}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),M.bind(n.__input,"change",function(){var e=parseFloat(o.__input.value);g.isNaN(e)||o.setValue(e)}),M.bind(n.__input,"blur",function(){r()}),M.bind(n.__input,"mousedown",function(e){M.bind(window,"mousemove",a),M.bind(window,"mouseup",s),i=e.clientY}),M.bind(n.__input,"keydown",function(e){13===e.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,r())}),n.updateDisplay(),n.domElement.appendChild(n.__input),n}function $(e,t,n,o,i){return o+(e-t)/(n-t)*(i-o)}var ee=(P(te,J),k(te,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",O(te.prototype.__proto__||Object.getPrototypeOf(te.prototype),"updateDisplay",this).call(this)}}]),te);function te(e,t,n,o,i){A(this,te);var i=R(this,(te.__proto__||Object.getPrototypeOf(te)).call(this,e,t,{min:n,max:o,step:i})),r=i;function a(e){e.preventDefault();var t=r.__background.getBoundingClientRect();return r.setValue($(e.clientX,t.left,t.right,r.__min,r.__max)),!1}function s(){M.unbind(window,"mousemove",a),M.unbind(window,"mouseup",s),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function l(e){var t=e.touches[0].clientX,e=r.__background.getBoundingClientRect();r.setValue($(t,e.left,e.right,r.__min,r.__max))}function c(){M.unbind(window,"touchmove",l),M.unbind(window,"touchend",c),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}return i.__background=document.createElement("div"),i.__foreground=document.createElement("div"),M.bind(i.__background,"mousedown",function(e){document.activeElement.blur(),M.bind(window,"mousemove",a),M.bind(window,"mouseup",s),a(e)}),M.bind(i.__background,"touchstart",function(e){if(1!==e.touches.length)return;M.bind(window,"touchmove",l),M.bind(window,"touchend",c),l(e)}),M.addClass(i.__background,"slider"),M.addClass(i.__foreground,"slider-fg"),i.updateDisplay(),i.__background.appendChild(i.__foreground),i.domElement.appendChild(i.__background),i}var ie=(P(re,j),k(re,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),re);function re(e,t,n){A(this,re);var t=R(this,(re.__proto__||Object.getPrototypeOf(re)).call(this,e,t)),o=t;return t.__button=document.createElement("div"),t.__button.innerHTML=void 0===n?"Fire":n,M.bind(t.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),M.addClass(t.__button,"button"),t.domElement.appendChild(t.__button),t}var ae=(P(se,j),k(se,[{key:"updateDisplay",value:function(){var t,n=C(this.getValue());!1!==n&&(t=!1,g.each(L.COMPONENTS,function(e){if(!g.isUndefined(n[e])&&!g.isUndefined(this.__color.__state[e])&&n[e]!==this.__color.__state[e])return t=!0,{}},this),t&&g.extend(this.__color.__state,n)),g.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var e=this.__color.v<.5||.5<this.__color.s?255:0,o=255-e;g.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+e+","+e+","+e+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,ce(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),g.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+e+","+e+","+e+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),se);function se(e,t){A(this,se);var n=R(this,(se.__proto__||Object.getPrototypeOf(se)).call(this,e,t));n.__color=new L(n.getValue()),n.__temp=new L(0);var o=n;n.domElement=document.createElement("div"),M.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",M.bind(n.__input,"keydown",function(e){13===e.keyCode&&l.call(this)}),M.bind(n.__input,"blur",l),M.bind(n.__selector,"mousedown",function(){M.addClass(this,"drag").bind(window,"mouseup",function(){M.removeClass(o.__selector,"drag")})}),M.bind(n.__selector,"touchstart",function(){M.addClass(this,"drag").bind(window,"touchend",function(){M.removeClass(o.__selector,"drag")})});e=document.createElement("div");function i(e){d(e),M.bind(window,"mousemove",d),M.bind(window,"touchmove",d),M.bind(window,"mouseup",a),M.bind(window,"touchend",a)}function r(e){u(e),M.bind(window,"mousemove",u),M.bind(window,"touchmove",u),M.bind(window,"mouseup",s),M.bind(window,"touchend",s)}function a(){M.unbind(window,"mousemove",d),M.unbind(window,"touchmove",d),M.unbind(window,"mouseup",a),M.unbind(window,"touchend",a),c()}function s(){M.unbind(window,"mousemove",u),M.unbind(window,"touchmove",u),M.unbind(window,"mouseup",s),M.unbind(window,"touchend",s),c()}function l(){var e=C(this.value);!1!==e?(o.__color.__state=e,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function c(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function d(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,e=n.clientX,n=n.clientY,e=(e-t.left)/(t.right-t.left),t=1-(n-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),1<e?e=1:e<0&&(e=0),o.__color.v=t,o.__color.s=e,o.setValue(o.__color.toOriginal()),!1}function u(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__hue_field.getBoundingClientRect(),t=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),o.__color.h=360*t,o.setValue(o.__color.toOriginal()),!1}return g.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),g.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),g.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),g.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),g.extend(e.style,{width:"100%",height:"100%",background:"none"}),ce(e,"top","rgba(0,0,0,0)","#000"),g.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(t=n.__hue_field).style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",g.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),M.bind(n.__saturation_field,"mousedown",i),M.bind(n.__saturation_field,"touchstart",i),M.bind(n.__field_knob,"mousedown",i),M.bind(n.__field_knob,"touchstart",i),M.bind(n.__hue_field,"mousedown",r),M.bind(n.__hue_field,"touchstart",r),n.__saturation_field.appendChild(e),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}var le=["-moz-","-o-","-webkit-","-ms-",""];function ce(t,n,o,i){t.style.background="",g.each(le,function(e){t.style.cssText+="background: "+e+"linear-gradient("+n+", "+o+" 0%, "+i+" 100%); "})}var de=function(e,t,n,o,i){var r=e[t];return g.isArray(n)||g.isObject(n)?new X(e,t,n):g.isNumber(r)?g.isNumber(n)&&g.isNumber(o)?g.isNumber(i)?new ee(e,t,n,o,i):new ee(e,t,n,o):g.isNumber(i)?new Q(e,t,{min:n,max:o,step:i}):new Q(e,t,{min:n,max:o}):g.isString(r)?new q(e,t):g.isFunction(r)?new ie(e,t,""):g.isBoolean(r)?new I(e,t):null},ue=(P(pe,j),k(pe,[{key:"controller",set:function(e){this._controller=e},get:function(){return this._controller}}]),pe);function pe(e,t){A(this,pe);var n=R(this,(pe.__proto__||Object.getPrototypeOf(pe)).call(this,e,t));return n.arguments={object:e,property:t,opts:Array.prototype.slice.call(arguments,2)},e.property&&(n.property=e.property(n)),n}P=function(e,t){var t=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var o=t.getElementsByTagName("head")[0];try{o.appendChild(n)}catch(e){}};var fe=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},he=(k(me,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),g.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",M.unbind(t.domElement,"webkitTransitionEnd",e),M.unbind(t.domElement,"transitionend",e),M.unbind(t.domElement,"oTransitionEnd",e)}var t=this;M.bind(this.domElement,"webkitTransitionEnd",e),M.bind(this.domElement,"transitionend",e),M.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-M.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-M.getHeight(this.domElement)/2+"px"}}]),me);function me(){A(this,me),this.backgroundElement=document.createElement("div"),g.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),M.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),g.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;M.bind(this.backgroundElement,"click",function(){e.hide()})}P(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var _e="Default",ge=function(){try{return!!window.localStorage}catch(e){return!1}}(),be=void 0,ve=!0,ye=void 0,we=!1,xe=[],Ce=function t(e){var n=this,o=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),M.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=g.defaults(o,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),o=g.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),g.isUndefined(o.load)?o.load={preset:_e}:o.preset&&(o.load.preset=o.preset),g.isUndefined(o.parent)&&o.hideable&&xe.push(this),o.resizable=g.isUndefined(o.parent)&&o.resizable,o.autoPlace&&g.isUndefined(o.scrollable)&&(o.scrollable=!0);var i,r,a,s,l=ge&&"true"===localStorage.getItem(Oe(0,"isLocal")),c=void 0,d=void 0;function u(e){return e.preventDefault(),r.width+=a-e.clientX,r.onResize(),a=e.clientX,!1}function p(){M.removeClass(r.__closeButton,Ce.CLASS_DRAG),M.unbind(window,"mousemove",u),M.unbind(window,"mouseup",p)}function f(e){return e.preventDefault(),a=e.clientX,M.addClass(r.__closeButton,Ce.CLASS_DRAG),M.bind(window,"mousemove",u),M.bind(window,"mouseup",p),!1}Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return(n.parent?n.getRoot():o.load).preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,Le(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,d&&(d.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(e){o.closed=e,o.closed?M.addClass(n.__ul,t.CLASS_CLOSED):M.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return l},set:function(e){ge&&((l=e)?M.bind(window,"unload",c):M.unbind(window,"unload",c),localStorage.setItem(Oe(0,"isLocal"),e))}}}),g.isUndefined(o.parent)?(this.closed=o.closed||!1,M.addClass(this.domElement,t.CLASS_MAIN),M.makeSelectable(this.domElement,!1),ge&&l&&(n.useLocalStorage=!0,(i=localStorage.getItem(Oe(0,"gui")))&&(o.load=JSON.parse(i))),this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,M.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),o.closeOnTop?(M.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(M.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),M.bind(this.__closeButton,"click",function(){n.closed=!n.closed})):(void 0===o.closed&&(o.closed=!0),i=document.createTextNode(o.name),M.addClass(i,"controller-name"),d=Ee(n,i),M.addClass(this.__ul,t.CLASS_CLOSED),M.addClass(d,"title"),M.bind(d,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),o.closed||(this.closed=!1)),o.autoPlace&&(g.isUndefined(o.parent)&&(ve&&(ye=document.createElement("div"),M.addClass(ye,"dg"),M.addClass(ye,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(ye),ve=!1),ye.appendChild(this.domElement),M.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||Le(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},M.bind(window,"resize",this.__resizeHandler),M.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),M.bind(this.__ul,"transitionend",this.__resizeHandler),M.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&(a=void 0,(r=this).__resize_handle=document.createElement("div"),g.extend(r.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),M.bind(r.__resize_handle,"mousedown",f),M.bind(r.__closeButton,"mousedown",f),r.domElement.insertBefore(r.__resize_handle,r.domElement.firstElementChild)),c=function(){ge&&"true"===localStorage.getItem(Oe(0,"isLocal"))&&localStorage.setItem(Oe(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=c,o.parent||((s=n.getRoot()).width+=1,g.defer(function(){--s.width}))};function Ee(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o),e.onResize(),o}function Se(e){M.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&M.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function Ae(e,t){e=e.__preset_select[e.__preset_select.selectedIndex];e.innerHTML=t?e.value+"*":e.value}function ke(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[t.property]=t,n.load&&n.load.remembered){i=n.load.remembered,n=void 0;if(i[e.preset])n=i[e.preset];else{if(!i[_e])return;n=i[_e]}n[o]&&void 0!==n[o][t.property]&&(o=n[o][t.property],t.initialValue=o,t.setValue(o))}}}function Te(e,t,n,o){var i;if(t.arguments&&(t=(i=t).arguments.object,n=i.arguments.property,o={factoryArgs:i.arguments.opts}),void 0===i&&void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var r=void 0;null===(r=o.color?new ae(t,n):void 0!==i&&"string"==typeof i.property?i:(l=[t,n].concat(o.factoryArgs),de.apply(e,l)))?r=i:void 0!==i&&(i.controller=r),o.before instanceof j&&(o.before=o.before.__li),ke(e,r),M.addClass(r.domElement,"c");var a=document.createElement("span");if(M.addClass(a,"property-name"),void 0!==i&&"object"===S(i.property))for(var s in i.property)a.appendChild(i.property[s]);else a.innerHTML=r.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(r.domElement);var c,d,u,p,o=Ee(e,l,o.before);return M.addClass(o,Ce.CLASS_CONTROLLER_ROW),r instanceof ae?M.addClass(o,"color"):M.addClass(o,S(r.getValue())),c=e,d=o,(u=r).__li=d,u.__gui=c,g.extend(u,{options:function(e){if(1<arguments.length){var t=u.__li.nextElementSibling;return u.remove(),Te(c,u.object,u.property,{before:t,factoryArgs:[g.toArray(arguments)]})}if(g.isArray(e)||g.isObject(e)){t=u.__li.nextElementSibling;return u.remove(),Te(c,u.object,u.property,{before:t,factoryArgs:[e]})}},name:function(e){return u.__li.firstElementChild.firstElementChild.innerHTML=e,u},listen:function(){return u.__gui.listen(u),u},remove:function(){return u.__gui.remove(u),u}}),u instanceof ee?(p=new Q(u.object,u.property,{min:u.__min,max:u.__max,step:u.__step}),g.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(e){var t=u[e],n=p[e];u[e]=p[e]=function(){var e=Array.prototype.slice.call(arguments);return n.apply(p,e),t.apply(u,e)}}),M.addClass(d,"has-slider"),u.domElement.insertBefore(p.domElement,u.domElement.firstElementChild)):u instanceof Q?(o=function(e){if(g.isNumber(u.__min)&&g.isNumber(u.__max)){var t=u.__li.firstElementChild.firstElementChild.innerHTML,n=-1<u.__gui.__listening.indexOf(u);u.remove();var o=Te(c,u.object,u.property,{before:u.__li.nextElementSibling,factoryArgs:[u.__min,u.__max,u.__step]});return o.name(t),n&&o.listen(),o}return e},u.min=g.compose(o,u.min),u.max=g.compose(o,u.max)):u instanceof I?(M.bind(d,"click",function(){M.fakeEvent(u.__checkbox,"click")}),M.bind(u.__checkbox,"click",function(e){e.stopPropagation()})):u instanceof ie?(M.bind(d,"click",function(){M.fakeEvent(u.__button,"click")}),M.bind(d,"mouseover",function(){M.addClass(u.__button,"hover")}),M.bind(d,"mouseout",function(){M.removeClass(u.__button,"hover")})):u instanceof ae&&(M.addClass(d,"color"),u.updateDisplay=g.compose(function(e){return d.style.borderLeftColor=u.__color.toString(),e},u.updateDisplay),u.updateDisplay()),u.setValue=g.compose(function(e){return c.getRoot().__preset_select&&u.isModified()&&Ae(c.getRoot(),!0),e},u.setValue),e.__controllers.push(r),r}function Oe(e,t){return document.location.href+"."+t}function Pe(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function Re(e,t){t.style.display=e.useLocalStorage?"block":"none"}function Le(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function Fe(i,r){var a={};return g.each(i.__rememberedObjects,function(e,t){var n={},o=i.__rememberedObjectIndecesToControllers[t];g.each(o,function(e,t){n[t]=r?e.initialValue:e.getValue()}),a[t]=n}),a}Ce.toggleHide=function(){we=!we,g.each(xe,function(e){e.domElement.style.display=we?"none":""})},Ce.CLASS_AUTO_PLACE="a",Ce.CLASS_AUTO_PLACE_CONTAINER="ac",Ce.CLASS_MAIN="main",Ce.CLASS_CONTROLLER_ROW="cr",Ce.CLASS_TOO_TALL="taller-than-window",Ce.CLASS_CLOSED="closed",Ce.CLASS_CLOSE_BUTTON="close-button",Ce.CLASS_CLOSE_TOP="close-top",Ce.CLASS_CLOSE_BOTTOM="close-bottom",Ce.CLASS_DRAG="drag",Ce.DEFAULT_WIDTH=245,Ce.TEXT_CLOSED="Close Controls",Ce.TEXT_OPEN="Open Controls",Ce._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||Ce.toggleHide()},M.bind(window,"keydown",Ce._keydownHandler,!1),g.extend(Ce.prototype,{add:function(e,t){return Te(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Te(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;g.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&ye.removeChild(this.domElement);var t=this;g.each(this.__folders,function(e){t.removeFolder(e)}),M.unbind(window,"keydown",Ce._keydownHandler,!1),Se(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);t=new Ce(t);this.__folders[e]=t;e=Ee(this,t.domElement);return M.addClass(e,"folder"),t},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],Se(t);var e=this;g.each(t.__folders,function(e){t.removeFolder(e)}),g.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e,t,n=this.getRoot();n.scrollable&&(e=M.getOffset(n.__ul).top,t=0,g.each(n.__ul.childNodes,function(e){n.autoPlace&&e===n.__save_row||(t+=M.getHeight(e))}),window.innerHeight-e-20<t?(M.addClass(n.domElement,Ce.CLASS_TOO_TALL),n.__ul.style.height=window.innerHeight-e-20+"px"):(M.removeClass(n.domElement,Ce.CLASS_TOO_TALL),n.__ul.style.height="auto")),n.__resize_handle&&g.defer(function(){n.__resize_handle.style.height=n.__ul.offsetHeight+"px"}),n.__closeButton&&(n.__closeButton.style.width=n.width+"px")},onResizeDebounced:g.debounce(function(){this.onResize()},50),remember:function(){if(g.isUndefined(be)&&((be=new he).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;g.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(n){var e=n.__save_row=document.createElement("li");M.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),M.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",M.addClass(t,"button gears");var o=document.createElement("span");o.innerHTML="Save",M.addClass(o,"button"),M.addClass(o,"save");var i=document.createElement("span");i.innerHTML="New",M.addClass(i,"button"),M.addClass(i,"save-as");var r=document.createElement("span");r.innerHTML="Revert",M.addClass(r,"button"),M.addClass(r,"revert");var a=n.__preset_select=document.createElement("select");n.load&&n.load.remembered?g.each(n.load.remembered,function(e,t){Pe(n,t,t===n.preset)}):Pe(n,_e,!1);{var s;M.bind(a,"change",function(){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].innerHTML=n.__preset_select[e].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(o),e.appendChild(i),e.appendChild(r),ge&&(s=document.getElementById("dg-local-explain"),e=document.getElementById("dg-local-storage"),document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(Oe(0,"isLocal"))&&e.setAttribute("checked","checked"),Re(n,s),M.bind(e,"change",function(){n.useLocalStorage=!n.useLocalStorage,Re(n,s)}))}var l=document.getElementById("dg-new-constructor");M.bind(l,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||be.hide()}),M.bind(t,"click",function(){l.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),be.show(),l.focus(),l.select()}),M.bind(o,"click",function(){n.save()}),M.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&n.saveAs(e)}),M.bind(r,"click",function(){n.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&Le(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var n=this.load;return n.closed=this.closed,0<this.__rememberedObjects.length&&(n.preset=this.preset,n.remembered||(n.remembered={}),n.remembered[this.preset]=Fe(this)),n.folders={},g.each(this.__folders,function(e,t){n.folders[t]=e.getSaveObject()}),n},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Fe(this),Ae(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[_e]=Fe(this,!0)),this.load.remembered[e]=Fe(this),this.preset=e,Pe(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(t){g.each(this.__controllers,function(e){this.getRoot().load.remembered?ke(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),g.each(this.__folders,function(e){e.revert(e)}),t||Ae(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&fe.call(window,function(){e(t)});g.each(t,function(e){e.updateDisplay()})}(this.__listening)},updateDisplay:function(){g.each(this.__controllers,function(e){e.updateDisplay()}),g.each(this.__folders,function(e){e.updateDisplay()})}});var Ve,k={Controller:j,BooleanController:I,OptionController:X,StringController:q,NumberController:J,NumberControllerBox:Q,NumberControllerSlider:ee,FunctionController:ie,ColorController:ae,CustomController:ue};
/**
 * Modify of the dat object.
 * @see {@link https://github.com/dataarts/dat.gui} about dat.gui
 *
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
function Ne(){}void 0!==Ne&&(Ve=function(e,t,n){void 0===t&&console.warn("elNameAndTitle: name = "+t),e.innerHTML=t,void 0!==n&&(e.title=n)},Ne.GUI=Ce,void 0===Ne.controllerNameAndTitle?Ne.controllerNameAndTitle=function(e,t,n){Ve(e.__li.querySelector(".property-name"),t,n)}:console.error("Duplicate dat.controllerNameAndTitle method."),void 0===Ne.folderNameAndTitle?Ne.folderNameAndTitle=function(e,t,n){Ve(e.__ul.querySelector("li.title"),t,n)}:console.error("Duplicate dat.folderNameAndTitle method."),void 0===Ne.controllerZeroStep?Ne.controllerZeroStep=function(e,t,n,o){var e=e.add(t,n),i=e.__input;return e.__input=document.createElement("input"),i.value=t[n],i.onchange=function(e){t[n]=parseFloat(i.value),void 0!==o&&o(t[n])},e.setValue=function(e){i.value=t[n]=e},e}:console.error("Duplicate dat.controllerZeroStep method."),void 0===Ne.controllerSetValue?Ne.controllerSetValue=function(e,t){e.setValue(t),e.__li.querySelector("select").selectedIndex=t}:console.error("Duplicate dat.controllerSetValue method.")
/**
* custom controller, allow to user to change a value step by step.
*
* @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
*
* @copyright 2011 Data Arts Team, Google Creative Lab
*
* @license under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*/);var je={addButton:function(e,t){t=t||{};var n=document.createElement("span");return n.innerHTML=e,void 0!==t.title&&(n.title=t.title),void 0!==t.onclick&&(n.style.cursor="pointer",n.onclick=t.onclick),void 0!==t.onwheel&&(e=function(e){e=(e=e||window.event).deltaY||e.detail||e.wheelDelta;t.onwheel(e)},n.style.cursor="n-resize",n.addEventListener?"onwheel"in document?n.addEventListener("wheel",e):"onmousewheel"in document?n.addEventListener("mousewheel",e):n.addEventListener("MozMousePixelScroll",e):n.attachEvent("onmousewheel",e)),n.style.margin="0px 2px",n}},De=(c(He,k.CustomController),He);
/**
 * @module ScaleController
 * @description is dat.GUI graphical user interface controller for control of the scale of threejs 3D object
 *
 * @see {@link https://threejs.org/} about threejs
 * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI
 *
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */function He(r,a){d(this,He),(a=a||{}).settings=a.settings||{},a.settings.zoomMultiplier=a.settings.zoomMultiplier||1.1;var e=u(this,(He.__proto__||Object.getPrototypeOf(He)).call(this,{multiplier:a.settings.zoomMultiplier,property:function(e){var t={zoom:"Zoom",in:"in",out:"out",wheelZoom:"Scroll the mouse wheel to zoom"},n=void 0===a.getLanguageCode?"en":a.getLanguageCode();switch(n){case"ru":t.zoom="",t.in="",t.out="",t.wheelZoom="     ";break;default:if(void 0===a.lang||a.lang.languageCode!=n)break;Object.keys(a.lang).forEach(function(e){void 0!==t[e]&&(t[e]=a.lang[e])})}var o={},i=je.addButton;return o.zoomLabel=i(t.zoom,{title:t.wheelZoom,onwheel:function(n){r(e,function(e,t){return 0<n?e*=t:e/=t,e})}}),o.in=i("",{title:t.in,onclick:function(){r(e,function(e,t){return e*=t})}}),o.out=i("",{title:t.out,onclick:function(){r(e,function(e,t){return e/=t})}}),o}},"multiplier",1.1,10,.1));return void 0===e.property&&console.error("init() returns "+e.property),e}
/**
 * PositionController is dat.GUI graphical user interface controller for control of the position of threejs 3D object
 *
 * @see {@link https://threejs.org/} about threejs
 * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI
 *
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var Be=(c(ze,k.CustomController),ze);
/**
* node.js version of the synchronous download of the file.
* @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
*
* @copyright 2011 Data Arts Team, Google Creative Lab
*
* @license under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*/function ze(r,a){d(this,ze),(a=a||{}).settings=a.settings||{};var e=a.settings;a.min=a.min||.1,a.max=a.max||10,e.offset=e.offset||.1,a.step=a.step||.1;e=u(this,(ze.__proto__||Object.getPrototypeOf(ze)).call(this,{offset:e.offset,property:function(n){var t={offset:"Offset",add:"add",subtract:"subtract",wheelPosition:"Scroll the mouse wheel to change the position"},e=void 0===a.getLanguageCode?"en":a.getLanguageCode();switch(e){case"ru":t.offset="",t.add="",t.subtract="",t.wheelPosition="     ";break;default:if(void 0===a.lang||a.lang.languageCode!=e)break;Object.keys(a.lang).forEach(function(e){void 0!==t[e]&&(t[e]=a.lang[e])})}var o={},i=je.addButton;return o.Label=i(t.offset,{title:t.wheelPosition,onwheel:function(e){var t=n.controller.getValue();r(0<e?t:-t)}}),o.in=i("",{title:t.add,onclick:function(){r(n.controller.getValue())}}),o.out=i("",{title:t.subtract,onclick:function(){r(-n.controller.getValue())}}),o}},"offset",a.min,a.max,a.step));return void 0===e.property&&console.error("init() returns "+e.property),e}function Me(t){if(this.loadXMLDoc=function(){var e;if(window.XMLHttpRequest){if(!(e=new XMLHttpRequest))throw"new XMLHttpRequest() failed!"}else{if(!window.ActiveXObject)throw"myRequest.loadXMLDoc(...) failed!";if(!(e=this.NewActiveXObject()))throw"NewActiveXObject() failed!"}return e},this.NewActiveXObject=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}return a('This browser does not support XMLHttpRequest. Probably, your security settings do not allow Web sites to use ActiveX controls installed on your computer. Refresh your Web page to find out the current status of your Web page or enable the "Initialize and script ActiveX controls not marked as safe" and "Run Active X controls and plug-ins" of the Security settings of the Internet zone of your browser.'),null},this.XMLHttpRequestStart=function(e,t){this.XMLHttpRequestStop(),this.req.onreadystatechange=e,"onerror"in this.req&&(this.req.onerror=function(e){a("XMLHttpRequest error. url: "+this.url)}),this.XMLHttpRequestReStart(t)},this.getUrl=function(){return void 0!==this.url&&null!=this.url||(this.url="XMLHttpRequest.xml"),this.url+(this.params||"")},this.XMLHttpRequestReStart=function(e){try{void 0===e&&(e=!0),this.req.open("GET",this.getUrl(),e),e&&("timeout"in this.req&&(this.req.timeout=9e4),"ontimeout"in this.req?this.req.ontimeout=function(){a("XMLHttpRequest timeout")}:(clearTimeout(this.timeout_id_SendReq),this.timeout_id_SendReq=setTimeout(function(){a("XMLHttpRequest timeout 2")},9e4))),this.req.send(null)}catch(e){a(e.message+" url: "+this.url)}},this.XMLHttpRequestStop=function(){null!=this.req&&this.req.abort()},this.ProcessReqChange=function(e){var t=this.req;switch(t.readyState){case 4:if("unknown"==typeof t.status)return consoleError('typeof XMLHttpRequest status == "unknown"'),!0;if(200==t.status)return clearTimeout(this.timeout_id_SendReq),e(this);a("Invalid XMLHttpRequest status : "+t.status+" url: "+this.url);break;case 1:case 2:case 3:break;case 0:default:throw"processReqChange(); req.readyState = "+t.readyState}return!0},this.processStatus200Error=function(){var e=this.GetElementText("error",!0);return!!e&&(a(e),!0)},this.GetElementText=function(e,t){var n=this.req;if(!n.responseXML)return 1!=t&&a("GetXMLElementText(xmlhttp, "+e+"); xmlhttp.responseXML is null.\nxmlhttp.responseText:\n"+n.responseText),null;var o=n.responseXML.getElementsByTagName(e);if(0==o.length)return 1!=t&&a('GetXMLElementText(xmlhttp, "'+e+'"); element.length == '+o.length),"";for(var i="",r=0;r<o.length;r++)if(void 0===o[r].textContent){if(void 0===o[r].text)return a("GetXMLElementText(xmlhttp, "+e+"); element["+r+"].text) == undefined"),"";""!=i&&(i+=" "),i+=o[r].text}else i+=o[r].textContent;return i},t.data)this.req=t.data.req,this.url=t.data.url,this.params=t.data.params;else try{this.req=this.loadXMLDoc()}catch(e){var n=void 0===e.message?e:e.message;return void a("Your browser is too old and is not compatible with our site.\n\n"+window.navigator.appName+" "+window.navigator.appVersion+"\n\n"+n)}function a(e){console.error(e),t.onerror(e)}this.req||consoleError("Invalid myRequest.req: "+this.req)}function Ie(t,n){(n=n||{}).onload=n.onload||function(){},n.onerror=n.onerror||function(){};var o,e=new Me(n);return e.url=t,e.XMLHttpRequestStart(function(){e.ProcessReqChange(function(e){e.processStatus200Error()||(o=e.req.responseText,n.onload(o,t))})},!1),o}
/**
 * node.js version of the load JavaScript file
 * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
 *
 * Thanks to:
 *http://javascript.ru/forum/events/21439-dinamicheskaya-zagruzka-skriptov.html
 *https://learn.javascript.ru/onload-onerror
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */function Ge(e,t){if(t.tag=t.tag||{},"string"==typeof t.tag){if("style"!==t.tag)return void console.error("Invalid options.tag: "+t.tag);t.tag={name:"style",attribute:{name:"rel",value:"stylesheet"}}}t.tag.name=t.tag.name||"script";var n=document.createElement(t.tag.name);t.tag.attribute=t.tag.attribute||{},t.tag.attribute.name=t.tag.attribute.name||"type",t.tag.attribute.value=t.tag.attribute.value||"text/javascript",n.setAttribute(t.tag.attribute.name,t.tag.attribute.value),e(n),t.appendTo.appendChild(n)}function Xe(e,t){for(var n=e.querySelectorAll("script"),o=0;o<n.length;o++)if(n[o].id===t)return 1}var Ue,P={sync:function(t,n){if((n=n||{}).onload=n.onload||function(){},n.onerror=n.onerror||function(){},n.appendTo=n.appendTo||document.getElementsByTagName("head")[0],Xe(n.appendTo,t))n.onload();else if(t instanceof Array){for(var o,i={appendTo:n.appendTo,tag:n.tag,onload:function(e,t){console.log("loadScript.sync.onload: "+t)},onerror:function(e){n.onerror(e),o=e}},e=0;e<t.length;e++){var r=t[e];if(Ge(function(e){e.setAttribute("id",r),e.innerHTML=Ie(r,i)},i),void 0!==o)break}void 0===o&&n.onload()}else Ge(function(e){e.setAttribute("id",t),e.innerHTML=Ie(t,n)},n)},async:function(e,o){var i;function r(t){function n(){e instanceof Array&&i<e.length-1?r(e[++i]):o.onload()}Xe(o.appendTo,t,o.onload)?n():Ge(function(e){e.setAttribute("id",t),e.readyState&&!e.onload?e.onreadystatechange=function(){"complete"==e.readyState&&void 0!==o.onload&&o.onload(),"loaded"==e.readyState&&(setTimeout(o.onload,0),this.onreadystatechange=null)}:(e.onload=function(){console.log("loadScript.async.onload() "+t),void 0!==o.onload&&n()},e.onerror=function(e){var t='loadScript: "'+this.src+'" failed';void 0!==o.onerror&&o.onerror(t,e),console.error(t)}),e.src=t},o)}(o=o||{}).appendTo=o.appendTo||document.getElementsByTagName("head")[0],o.onload=o.onload||function(){},e instanceof Array?r(e[i=0]):r(e)}},J=(Ue=function(){if(document.currentScript&&""!==document.currentScript.src)return document.currentScript.src;var e=document.getElementsByTagName("script");return""!==e[e.length-1].src?src:(new Error).stack.match(/(https?:[^:]*)/)[0]}()).substring(0,Ue.lastIndexOf("/"));
/**
 * @module ColorPicker
 * @description Pure JavaScript color picker.
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 * @See Thanks to [FlexiColorPicker]{@link https://github.com/DavidDurman/FlexiColorPicker}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */P.sync(J+"/colorpicker.css",{tag:"style"});var qe,We=window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",Ye="http://www.w3.org/2000/svg",Je=0,Ke={BGRW:0,monochrome:1,bidirectional:2,rainbow:3};function Qe(e,t,n){for(var o in e=document.createElementNS(Ye,e),t)e.setAttribute(o,t[o]);"[object Array]"!=Object.prototype.toString.call(n)&&(n=[n]);for(var i=0,r=n[0]&&n.length||0;i<r;i++)e.appendChild(n[i]);return e}function Ze(p){function e(e,t,n,o){return{percent:e,r:t,g:n,b:o}}void 0===(p=p||{}).palette&&(p.palette=Ke.BGRW);var f=[new e(0,0,0,255),new e(33,0,255,0),new e(66,255,255,0),new e(100,255,255,255)];switch(ne(p.palette)){case"number":switch(p.palette){case Ke.BGRW:break;case Ke.monochrome:f=[new e(0,0,0,0),new e(100,255,255,255)];break;case Ke.bidirectional:f=[new e(0,255,48,48),new e(50,48,48,48),new e(100,48,255,48)];break;case Ke.rainbow:f=[new e(0,255,50,50),new e(16,252,245,40),new e(32,40,252,40),new e(50,40,252,248),new e(66,39,46,249),new e(82,255,40,251),new e(100,255,50,50)];break;default:console.error("ColorPicker.create.Palette: invalid options.palette = "+p.palette)}break;case"object":if(Array.isArray(p.palette)){f=p.palette;break}default:var t="invalid options.palette = "+p.palette;console.error("ColorPicker.create.Palette: "+t),p.onError(t)}this.getPalette=function(){var t=[];return f.forEach(function(e){t.unshift(Qe("stop",{offset:100-e.percent+"%","stop-color":"#"+("0"+Number(e.r).toString(16)).slice(-2).toUpperCase()+("0"+Number(e.g).toString(16)).slice(-2).toUpperCase()+("0"+Number(e.b).toString(16)).slice(-2).toUpperCase(),"stop-opacity":"1"}))}),t},this.hsv2rgb=function(e,t,n){var i=parseFloat(e);void 0!==t&&void 0!==n&&(i=100/(n-t)*(i-t));var o,r,a=f[f.length-1];100!==a.percent&&(o={},Object.keys(a).forEach(function(e){o[e]=a[e]}),o.percent=100,f.push(o));for(var s=0;s<f.length;s++){var l=f[s];if(void 0===r&&(r=l),i>=r.percent&&i<=l.percent){var c=function(e,t,n,o){n-=e;return 0==n?t:Math.round(t+(o-t)/n*(i-e))},d=c(r.percent,r.r,l.percent,l.r),u=c(r.percent,r.g,l.percent,l.g),c=c(r.percent,r.b,l.percent,l.b);return{r:d,g:u,b:c,hex:"#"+(16777216|c|u<<8|d<<16).toString(16).slice(1),percent:i}}r=l}void 0!==p.onError&&p.onError("Invalid color value of the ColorPicker: "+e)},this.toColor=function(e,t,n){if(void 0!==qe){if(e instanceof qe.Color)return e;n=this.hsv2rgb(e,t,n);return void 0===n&&(n={r:255,g:255,b:255}),new qe.Color("rgb("+n.r+", "+n.g+", "+n.b+")")}console.error("Call ColorPicker.palette.setTHREE(THREE) first.")}}Ze.setTHREE=function(e){qe?Object.is(qe,e)||console.error("Palette.setTHREE: duplicate THREE. Please use one instance of the THREE library."):qe=e};
/**
* @module ColorPicker
* @description Pure JavaScript color picker.
* @author Andrej Hristoliubov https://anhr.github.io/AboutMe/
*
* Thanks to https://github.com/DavidDurman/FlexiColorPicker
*
* @copyright 2011 Data Arts Team, Google Creative Lab
*
* @license under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
*/
var $e,et={create:function(e,i){function r(){return"horizontal"===i.orientation}if((i=i||{}).orientation=i.orientation||"horizontal",void 0===i.direction&&(i.direction=!0),i.style=i.style||{},i.style.width=i.style.width||(r()?200:30),i.style.height=i.style.height||(r()?30:200),i.onError=i.onError||function(){},e instanceof HTMLElement!=!0){if("string"!=typeof e)return void console.error("ColorPicker.create: invalid elSliderWrapper = "+e);if(null===(e=document.getElementById(e)))return void console.error("ColorPicker.create: invalid elSliderWrapper = "+e)}for(var t in e.classList.add("slider-wrapper"),i.style)e.style[t]=i.style[t];var o,n,a,s,l,c=i.palette instanceof Ze?i.palette:new Ze(i);function d(){return"string"==typeof i.style.height?parseInt(i.style.height):i.style.height}function u(){return f.clientWidth}function p(e,t){var n;void 0!==o?void 0!==(n=c.hsv2rgb(e))?(e=n.percent,void 0===t&&(t=r()?u()*e/100:d()-d()*(i.direction?e:100-e)/100),function(e){if(void 0===o)return;r()?e<0||e>u()?console.error("ColorPicker.positionIndicators: Invalid position = "+e):(o.style.top="0px",o.style.left=(i.direction?e:u()-e)-o.offsetWidth/2+"px"):e<0||e>d()?console.error("ColorPicker.positionIndicators: Invalid position = "+e):(o.style.left="0px",o.style.top=e-o.offsetHeight/2+"px")}(t),void 0!==i.sliderIndicator.callback&&i.sliderIndicator.callback(n)):console.error("ColorPicker.setValue: invalud c = "+n):console.error("Set value of this instance of the ColorPicker is impossible because options.sliderIndicator is not defined.")}if(void 0!==i.sliderIndicator&&((o=document.createElement("div")).className="slider-indicator",r()?o.style.width="10px":o.style.height="10px",e.appendChild(o),o.style.pointerEvents="none"),"SVG"==We){try{var f=Qe("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:r()?"100%":i.style.width,height:i.style.height},[Qe("defs",{},Qe("linearGradient",{id:"gradient-hsv-"+Je,x1:r()&&i.direction?"100%":"0%",y1:r()||i.direction?"0%":"100%",x2:r()&&!i.direction?"100%":"0%",y2:!r()&&i.direction?"100%":"0%"},c.getPalette())),Qe("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv-"+Je+")"})]);void 0!==o&&(f.style.cursor=r()?"e-resize":"s-resize",o.style.cursor=f.style.cursor)}catch(e){console.error("Create SVG element failed! "+e.message)}e.appendChild(f),e.style.height=d()+"px",void 0!==o&&(r()?o.style.height=parseInt(i.style.height)-2+"px":o.style.width=parseInt(i.style.width)-2+"px",i.sliderIndicator.value=i.sliderIndicator.value||0,p(i.sliderIndicator.value)),Je++}else console.error("Under constraction");function h(e){var t,n,o;e.x=parseInt(e.x),e.y=parseInt(e.y),r()?(t=e.x,n=u()-1,t>=u()&&(t=n),o=100*t/n,i.direction||(o=100-o,t=n-t)):(t=e.y,n=d()-1,t>=d()&&(t=n),o=100*(1-t/n),i.direction||(o=100-o)),p(o,t)}return void 0!==o&&(n=function(){return function(e){l||h(function(e){if(window.event&&void 0!==window.event.contentOverflow)return{x:window.event.offsetX,y:window.event.offsetY};if(void 0!==e.offsetX&&void 0!==e.offsetY)return{x:e.offsetX,y:e.offsetY};var t=e.target.parentNode.parentNode;return{x:e.layerX-t.offsetLeft,y:e.layerY-t.offsetTop}}(e=e||window.event))}},l=!(s=function(e,i){var t=f;a(t,"touchstart",function(e){}),a(t,"touchmove",function(e){e.preventDefault();var t=e.srcElement.getBoundingClientRect(),n=e.touches[0].clientX-t.left,t=e.touches[0].clientY-t.top;n<0&&(n=0),t<0&&(t=0),h({x:n,y:t})}),a(t,"touchend",function(e){}),a(t,"mousedown",function(e){var n="mouseup",o="mousemove";a(window,n,function e(){function t(e,t,n){null!==e&&(e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener&&e.removeEventListener(t,n,!1))}t(window,n,e),t(window,o,i)}),a(window,o,i)}),a(t,"mouseout",function(e){l=!0}),a(t,"mouseover",function(e){l=!1})}),(a=function(e,t,n){null!==e&&(e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,!1))})(f,"click",n()),s(0,n())),{setValue:p}},paletteIndexes:Ke,palette:Ze},tt=function(e,t,s,l,n){var o=4<arguments.length&&void 0!==n?n:{},c=this,d=!1,n=o.getLanguageCode||function(){return"en"},i={functions:"Functions",defaultButton:"Default",defaultTitle:"Restore default functions."},r=n();switch(r){case"ru":i.functions="",i.defaultButton="",i.defaultTitle=" .";break;default:if(void 0===o.lang||o.lang.languageCode!=r)break;Object.keys(o.lang).forEach(function(e){void 0!==i[e]&&(i[e]=o.lang[e])})}var a=e.addFolder(i.functions),u={x:o.vector?g(o.vector.x):"",y:o.vector?g(o.vector.y):"",z:o.vector?g(o.vector.z):"",w:o.vector?g(o.vector.w):""},p={x:u.x,y:u.y,z:u.z,w:u.w},f={};function h(t){void 0!==u[t]&&(f[t]=a.add(u,t).onFinishChange(function(e){b(e,t,p)}),Ne.controllerNameAndTitle(f[t],m(t)))}function m(e){return t[e]&&t[e].name?t[e].name:e}h("x"),h("y"),h("z"),h("w");var _=a.add({defaultF:function(){}},"defaultF");function g(e){if(void 0!==e){if("object"===(void 0===e?"undefined":ne(e))){if(e instanceof s.Color)return e.getStyle();if(Array.isArray(e))return JSON.stringify(e);e=e.func||e}var t=void 0===e?"undefined":ne(e);switch(t){case"number":e=e.toString();case"string":return e;case"function":return e.toString().split(/return (.*)/)[1];default:return void console.error("functionsFolder.getFuncText(...): typeof func = "+t)}}}function b(t,n,e){if(e[n]!==t||d)try{var o;d=!1;var i=void 0===(e[n]=t)?"undefined":ne(t);switch(i){case"string":var r,a=parseFloat(t);if(a.toString()!==t)if(5===t.replace(/\s/g,"").split(/rgb\((\d+),(\d+),(\d+)\)/).length)o=new s.Color(t);else{try{r=JSON.parse(t)}catch(e){}o=Array.isArray(r)?r:new Function("t","a","b","return "+t)}else o=a;break;case"number":o=t;break;default:return void console.error("onFinishChange( "+t+" ): invalid type = "+i)}l(o,n)}catch(e){alert("Axis: "+m(n)+'. Function: "'+t+'". '+e),c.setFocus(n)}}Ne.controllerNameAndTitle(_,i.defaultButton,i.defaultTitle),this.setFunction=function(n){var e={x:n?g(n.x):"",y:n?g(n.y):"",z:n?g(n.z):"",w:n?g(n.w):""},o={x:e.x,y:e.y,z:e.z,w:e.w};function t(t){void 0!==n[t]&&(f[t].__onFinishChange=function(e){b(e,t,o)},e[t]=g(n[t]),f[t].setValue(e[t]),o[t]=e[t])}n.vectorDefault||(n.vectorDefault={x:e.x,y:e.y,z:e.z,w:e.w}),t("x"),t("y");var i=!1;n.z&&(t("z"),i=!0),_.object.defaultF=function(e){function t(e){f[e]&&(f[e].setValue(n.vectorDefault[e]),f[e].__onFinishChange(n.vectorDefault[e]))}t("x"),t("y"),t("z"),t("w")},function(e,t){if(void 0!==e){"boolean"==typeof t&&(t=t?"block":"none");for(var n=e.domElement;"LI"!==n.tagName.toUpperCase();)n=n.parentElement;n.style.display=t}}(f.z,i),t("w")},this.displayFolder=function(e){a.domElement.style.display=e},this.setFocus=function(e){f[e].domElement.childNodes[0].focus(),d=!0}};
/**
 * @module functionsFolder
 * @description Adds the [Functions]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} folder into [dat.gui]{@link https://github.com/anhr/dat.gui}.
 *
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */function nt(e,h){nt.setTHREE(e);var m,_=(h=h||{}).axesHelper,g=h.options||(_?_.options:void 0)||{},o=this;function t(e){g.scales[e]=g.scales[e]||{},g.scales[e].name=g.scales[e].name||e,g.scales[e].min=void 0===g.scales[e].min?-1:g.scales[e].min,g.scales[e].max=void 0===g.scales[e].max?1:g.scales[e].max}g.guiSelectPoint=o,g.scales=g.scales||{},t("x"),t("y"),t("z"),void 0===g.a&&(g.a=1),void 0===g.b&&(g.b=0);var s=h.getLanguageCode||function(){return"en"},b={meshs:"Meshes",notSelected:"Not selected",select:"Select",position:"Position",rotation:"Rotation",points:"Points",cameraTarget:"Look",cameraTargetTitle:"Choose this point the camera is looking at.",point:"Point Local Position",pointTitle:"The position attribute of the selected point",trace:"Trace",traceTitle:"Display the trace of the point movement.",traceAllTitle:"Display the trace of the movement of all points of the mesh.",pointWorld:"Point World Position",pointWorldTitle:"The position of the selected point after scaling, moving and rotation of the mesh",mesh:"Mesh",scale:"Scale",color:"olor",opacity:"Opacity",opacityTitle:"Float in the range of 0.0 - 1.0 indicating how transparent the material is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.",defaultButton:"Default",defaultScaleTitle:"Restore default 3d object scale.",defaultPositionTitle:"Restore default 3d object position.",default3DObjectTitle:"Restore default settings of all 3d objects.",defaultRotationTitle:"Restore default 3d object rotation.",defaultLocalPositionTitle:"Restore default local position.",moveGroup:"Move Scene"},n=s();switch(n){case"ru":b.meshs="3D ",b.notSelected=" ",b.select="",b.position="",b.rotation="",b.points="",b.cameraTarget="",b.cameraTargetTitle="  ,    .",b.point="  ",b.pointTitle="Position attribute  ",b.trace="",b.traceTitle="   .",b.traceAllTitle="      3D .",b.pointWorld="  ",b.pointWorldTitle="    ,    3D ",b.mesh="3D ",b.scale="",b.color="",b.opacity="",b.opacityTitle="   0,0 - 1,0, ,   .  0.0   , 1.0 -  .",b.defaultButton="",b.defaultScaleTitle="  3D   .",b.defaultPositionTitle="  3D   .",b.default3DObjectTitle="   3D   .",b.defaultRotationTitle="  3D   .",b.defaultLocalPositionTitle="     .";break;default:if(void 0===h.lang||h.lang.languageCode!=n)break;Object.keys(h.lang).forEach(function(e){void 0!==b[e]&&(b[e]=h.lang[e])})}var v,y,w,x,C,E,S,A,k,T,O,P,R,L,F,V,N,j,D,H,B,z,u,M=this,I=new $e.Vector3,G=new $e.Vector3,X=new $e.Vector3,U=!1;function q(e){x.domElement.style.display=e,y.domElement.style.display=e,B&&(B.domElement.parentElement.parentElement.style.display=e)}function W(e,t){if(void 0!==e){"boolean"==typeof t&&(t=t?"block":"none");for(var n=e.domElement;"LI"!==n.tagName.toUpperCase();)n=n.parentElement;n.style.display=t}}function Y(e){var t,n;void 0===e&&(e=o.getSelectedPointIndex()),-1!==e&&(n=rt(t=E.__select.options[E.__select.options.selectedIndex].mesh,e),void 0!==_&&_.exposePosition({object:t,index:e}),X.x&&X.x.setValue(n.x),X.y&&X.y.setValue(n.y),X.z&&X.z.setValue(n.z))}function J(e,t){if(e){var n=e.domElement.querySelector("input"),o=n.readOnly;return n.readOnly=!1,e.object[e.property]=t,e.__onChange&&e.__onChange.call(e,t),e.initialValue=t,e.updateDisplay(),n.readOnly=o,e}}function i(e){var t=e.object.userData.player;t&&z.setFunction(t.arrayFuncs[e.index]),B&&(On.cameraTarget.changeTarget(e.object,e.index),B.updateDisplay());var n=ot(e.object,e.index);J(R,n.x),J(L,n.y),J(F,n.z);var o=rt(e.object,e.index);J(X.x,o.x),J(X.y,o.y),J(X.z,o.z);n="none",o="block";"function"==typeof A.object.userData.player.arrayFuncs&&console.error('arrayFuncs === "function" under constraction');var i=t&&t.arrayFuncs?t.arrayFuncs[e.index]:void 0;function r(){return"object"===ne(i.w)&&i.w instanceof $e.Color==!1}var a,s,l,c,d,t=void 0===i?void 0:Array.isArray(i.w)||"function"==typeof i.w?On.execFunc(i,"w",On.getTime(),g.a,g.b):r()?On.execFunc(i.w,"func",On.getTime(),g.a,g.b):i.w;void 0===t&&(void 0===e.object.geometry.attributes.ca||(s=(new $e.Vector4).fromArray(e.object.geometry.attributes.ca.array,e.index*e.object.geometry.attributes.ca.itemSize),t=new $e.Color(s.x,s.y,s.z),a=s.w)),t instanceof $e.Color?(l=n,d=c=o,void 0===e.object.userData.player.arrayFuncs?d=c=n:(s="#"+t.getHexString(),D.initialValue=s,D.setValue(s),D.userData={intersection:e},void 0!==a?J(H,a):d=n,H.userData={intersection:e})):(l=void 0===V||void 0===t?n:(u=u||{min:V.__min,max:V.__max},r()?(V.min(("undefined"!==i.w.min?i.w:u).min),V.max(("undefined"!==i.w.max?i.w:u).max),"undefined"!==V.__min&&"undefined"!==V.__max&&V.step((V.__max-V.__min)/100)):(V.min(u.min),V.max(u.max)),J(V,t),o),d=c=n),W(V,l),W(D,c),W(H,d);e=!0===e.object.userData.boFrustumPoints;R&&(R.domElement.querySelector("input").readOnly=e),L&&(L.domElement.querySelector("input").readOnly=e),F&&(F.domElement.querySelector("input").readOnly=e),V&&(V.domElement.querySelector("input").readOnly=e),D.domElement.querySelector("input").readOnly=e,H.domElement.querySelector("input").readOnly=e}g.arrayCloud&&(m=new g.arrayCloud.cFrustumPointsF(M)),this.setMesh=function(){U=!0,Z(),$(),ee(),Y(),U=!1},this.setPosition=function(e,t){for(var n=0;n<E.__select.length;n++){var o=E.__select[n];o.selected&&Object.is(o.mesh,t.object)&&i(t)}},this.update=function(){var e,t=E.__select.options[E.__select.options.selectedIndex].mesh;!t||-1!==(e=this.getSelectedPointIndex())&&(e=rt(t,e),X.x.setValue(e.x),X.y.setValue(e.y),X.z.setValue(e.z))},this.getMeshIndex=function(e){if(void 0===e)return e;for(var t=0;t<E.__select.options.length;t++){var n=E.__select.options[t];if(Object.is(n.mesh,e))return t}},this.setIndexMesh=function(e,t){void 0!==e&&(E.__select.options[e].mesh=t,this.selectPoint(-1))},this.selectPoint=function(e){P.__onChange(e),P.__select[e+1].selected=!0},this.removeMesh=function(e){var t=this.getMeshIndex(e),e=E.__select.selectedIndex;E.__select.remove(t),e===t&&(P.__onChange(-1),M.removePoints())};var K=[];function Q(){if(E)return-1!==E.__select.options.selectedIndex?E.__select.options[E.__select.options.selectedIndex].mesh:void 0;console.error("GuiSelectPoint().getSelectedPointIndex().getMesh(): call GuiSelectPoint.add( gui ); first.")}function r(){return void 0===Q()}function Z(){var e;r()||(e=Q(),k&&k.setValue(e.scale.x),T&&T.setValue(e.scale.y),O&&O.setValue(e.scale.z))}function $(){var e;r()||(e=Q(),I.x&&I.x.setValue(e.position.x),I.y&&I.y.setValue(e.position.y),I.z&&I.z.setValue(e.position.z))}function ee(){var e;r()||(e=Q(),G.x&&G.x.setValue(e.rotation.x),G.y&&G.y.setValue(e.rotation.y),G.z&&G.z.setValue(e.rotation.z))}function te(e,t,n){var o,i,r;e&&void 0!==e.object.userData.player.arrayFuncs&&(o=e.index||0,void 0!==(r=void 0===(i=e.object.userData.player.arrayFuncs[o])?void 0:i.line)&&r.visible(t),t&&void 0===i.line&&(i.line=new On.traceLine(g),t=void 0===(t=e.object.geometry.attributes.color)?new $e.Color(16777215):(e=(new $e.Vector3).fromArray(t.array,o*t.itemSize),new $e.Color(e.x,e.y,e.z)),i.line.addPoint(n(),o,t)))}return this.addMesh=function(e){if(E){for(o=0;o<E.__select.options.length;o++){var t=E.__select.options[o];if(e.userData.boFrustumPoints&&void 0!==t.mesh&&t.mesh.userData.boFrustumPoints)return;if(void 0!==t.mesh&&t.mesh.uuid===e.uuid)return void console.error("guiSelectPoint.addMesh(...): Duplicate mesh.")}var n=document.createElement("option");n.innerHTML=E.__select.length+" "+(""===e.name?e.constructor:e).name,(n.mesh=e).userData.default=e.userData.default||{scale:(new $e.Vector3).copy(e.scale),position:e.position instanceof $e.Vector3?(new $e.Vector3).copy(e.position):e.position instanceof $e.Vector4?(new $e.Vector4).copy(e.position):void 0,rotation:(new $e.Euler).copy(e.rotation)},E.__select.appendChild(n)}else{for(var o=0;o<K.length;o++)if(K[o].uuid===e.uuid)return;K.push(e)}},this.select=function(t){ot(t.object,t.index);void 0===v&&console.error("    ");var e=this.getMeshIndex(t.object);e&&(!1===E.__select[e].selected&&(E.__select[e].selected=!0,E.__onChange(e-1)),this.selectPoint2=function(e){void 0===t.index||isNaN(t.index)||void 0!==e&&!Object.is(t.object,e)||(t.object.userData.boFrustumPoints?m.pointIndexes(t.object.userData.pointIndexes(t.index)):P.__select[t.index+1].selected=!0,q("block"),A=t,h.setIntersection&&h.setIntersection(t),i(t),e=void 0===(e=Q()).userData.player.arrayFuncs||"function"==typeof A.object.userData.player.arrayFuncs?void 0:e.userData.player.arrayFuncs[t.index].line,N&&N.setValue(void 0!==e&&e.isVisible()),w.domElement.parentElement.parentElement.style.display=void 0===A.object.userData.player.arrayFuncs?"none":"block")},this.selectPoint2(void 0))},this.isSelectedMesh=function(e){return Q()===e},this.getSelectedPointIndex=function(){if(void 0!==m&&m.isDisplay()&&g.arrayCloud.frustumPoints&&g.arrayCloud.frustumPoints.isDisplay()){var e=m.getSelectedIndex();return null===e?-1:e}return void 0===P?-1:P.__select.selectedOptions[0].index-1},this.add=function(e){var c,d,u,p;v=e.addFolder(b.meshs),E=v.add({Meshs:b.notSelected},"Meshs",oe({},b.notSelected,-1)).onChange(function(e){e=parseInt(e);var t,n="none",o="block";if(void 0===(c=Q()))t=n,(c=void 0)!==_&&_.exposePosition(rt(Q(),e));else{var i=void 0===c.userData.default?n:o;d.domElement.parentElement.parentElement.style.display=i,u.domElement.parentElement.parentElement.style.display=i,p.domElement.parentElement.parentElement.style.display=i;var r=n,e=n,i=t=o;if(P.__onChange(-1),M.removePoints(),void 0!==c.userData.controllers)c.userData.controllers();else if(r=o,i=n,c.geometry.attributes){e=o;for(var a=0;a<c.geometry.attributes.position.count;a++){var s=document.createElement("option"),l=c.userData.player&&c.userData.player.arrayFuncs?c.userData.player.arrayFuncs[a].name:"";s.innerHTML=a+(void 0===l?"":" "+l),s.setAttribute("value",a),P.__select.appendChild(s)}}C.domElement.parentElement.style.display=e,W(P,r),j&&W(j,!!On.isCreated()&&r),void 0!==m&&m.display(i),Z(),$(),ee()}S.domElement.style.display=t,void 0!==c&&void 0!==c.userData.traceAll&&j.setValue(c.userData.traceAll)}),Ne.controllerNameAndTitle(E,b.select),(S=v.addFolder(b.mesh)).domElement.style.display="none",S.open();var t=S.addFolder(b.scale);t.add(new De(function(e,t){e=e.controller.getValue();c.scale.x=t(c.scale.x,e),c.scale.y=t(c.scale.y,e),c.scale.z=t(c.scale.z,e),c.needsUpdate=!0,Z(),Y(),void 0!==g.arrayCloud&&void 0!==g.arrayCloud.frustumPoints&&g.arrayCloud.frustumPoints.updateCloudPoint(c)},{settings:{zoomMultiplier:1.1},getLanguageCode:s}));e=new $e.Vector3;function n(e,t){c.scale[e]=t,c.needsUpdate=!0,Y(),void 0!==g.arrayCloud&&void 0!==g.arrayCloud.frustumPoints&&g.arrayCloud.frustumPoints.updateCloudPoint(c)}g.scales.x&&(k=Ne.controllerZeroStep(t,e,"x",function(e){n("x",e)}),Ne.controllerNameAndTitle(k,g.scales.x.name)),g.scales.y&&(T=Ne.controllerZeroStep(t,e,"y",function(e){n("y",e)}),Ne.controllerNameAndTitle(T,g.scales.y.name)),g.scales.z&&(O=Ne.controllerZeroStep(t,e,"z",function(e){n("z",e)}),Ne.controllerNameAndTitle(O,g.scales.z.name)),d=t.add({defaultF:function(){c.scale.copy(c.userData.default.scale),c.needsUpdate=!0,Z(),Y()}},"defaultF"),Ne.controllerNameAndTitle(d,b.defaultButton,b.defaultScaleTitle);var i=S.addFolder(b.position);function o(t){var e,n,o=g.scales[t];o&&(e=o.name,(n=i.addFolder(e)).add(new Be(function(e){c.position[t]+=e,c.needsUpdate=!0,$(),Y(),void 0!==g.arrayCloud&&void 0!==g.arrayCloud.frustumPoints&&g.arrayCloud.frustumPoints.updateCloudPoint(c)},{getLanguageCode:s})),o=new $e.Vector3,I[t]=Ne.controllerZeroStep(n,o,t,function(e){e=e,c.position[t]=e,c.needsUpdate=!0,Y()}),Ne.controllerNameAndTitle(I[t],e))}o("x"),o("y"),o("z"),u=i.add({defaultF:function(){c.position.copy(c.userData.default.position),c.needsUpdate=!0,$(),Y()}},"defaultF"),Ne.controllerNameAndTitle(u,b.defaultButton,b.defaultPositionTitle);var l,r=S.addFolder(b.rotation);function a(n){var e=g.scales[n];e&&(G[n]=r.add(new $e.Vector3,n,0,2*Math.PI,1/360).onChange(function(e){var t=Q();t.userData.boFrustumPoints||(t.rotation[n]=e,t.needsUpdate=!0),U||Y(),void 0!==g.arrayCloud&&void 0!==g.arrayCloud.frustumPoints&&g.arrayCloud.frustumPoints.updateCloudPoint(t)}),Ne.controllerNameAndTitle(G[n],e.name))}a("x"),a("y"),a("z"),p=r.add({defaultF:function(){c.rotation.copy(c.userData.default.rotation),c.needsUpdate=!0,ee(),Y()}},"defaultF"),Ne.controllerNameAndTitle(p,b.defaultButton,b.defaultRotationTitle),C=S.addFolder(b.points),(P=C.add({Points:b.notSelected},"Points",oe({},b.notSelected,-1)).onChange(function(e){var t;-1===(e=parseInt(e))?t="none":(t="block",M.select({object:Q(),index:e})),void 0!==_&&_.exposePosition(rt(Q(),e)),q(t)})).__select[0].selected=!0,Ne.controllerNameAndTitle(P,b.select),void 0!==m&&m.create(C,s()),h.myThreejs&&(h.myThreejs.cFrustumPoints=m),h.cameraTarget&&On.cameraTarget.init(h.cameraTarget);var f=On.cameraTarget.get();for(f&&(B=C.add(f,"boLook").onChange(function(e){var t=Q();if(!t.userData.player){t.userData.player={arrayFuncs:[]};for(var n=0;n<t.geometry.attributes.position.count;n++)t.userData.player.arrayFuncs.push((new $e.Vector3).fromArray(t.geometry.attributes.position.array,n*t.geometry.attributes.position.itemSize))}for(var o=P.__select.options.selectedIndex-1,i=t.userData.player.arrayFuncs[o],n=0;n<E.__select.options.length;n++){var r=E.__select.options[n].mesh;if(r&&r.userData.player&&r.userData.player.arrayFuncs)for(var a=r.userData.player.arrayFuncs,s=0;s<a.length;s++)a[s].cameraTarget&&(a[s].cameraTarget.boLook=!1)}if(i.cameraTarget.boLook=e,On.player&&On.player.selectScene(),e)return On.cameraGui&&On.cameraGui.look(),void(i.cameraTarget||(getCameraTarget(),void 0===f.boLook&&(On.cameraTarget2.boLook=!1),(l=l||{}).target||(l.target=new $e.Vector3),On.orbitControls&&l.target.copy(On.orbitControls.target),On.cameraTarget.changeTarget(t,o)));h.cameraTarget&&(h.cameraTarget.camera.userData.cameraTargetPoint=i.cameraTarget),On.orbitControls&&On.orbitControls.reset(),l&&(getCameraTarget()||(On.orbitControls&&On.orbitControls.target.copy(l.target),h.cameraTarget.camera.lookAt(l.target),i.cameraTarget=void 0))}),Ne.controllerNameAndTitle(B,b.cameraTarget,b.cameraTargetTitle)),y=C.addFolder(b.point),Ne.folderNameAndTitle(y,b.point,b.pointTitle),x=C.addFolder(b.pointWorld),Ne.folderNameAndTitle(x,b.pointWorld,b.pointWorldTitle),x.open(),q("none"),h.pointsControls&&h.pointsControls(C,W,Q),j=C.add({trace:!1},"trace").onChange(function(e){var t=Q();t.userData.traceAll=e;for(var n=0;n<t.geometry.attributes.position.count;n++)te({object:t,index:n},e,Q);N.setValue(e)}),Ne.controllerNameAndTitle(j,b.trace,b.traceAllTitle),W(j,On.isCreated()),Ne.controllerNameAndTitle(v.add({defaultF:function(){for(var e=0;e<E.__select.options.length;e++){var t=E.__select.options[e].mesh;t&&(t.scale.copy(t.userData.default.scale),t.position.copy(t.userData.default.position),t.rotation.copy(t.userData.default.rotation),t.needsUpdate=!0)}Z(),$(),ee(),Y()}},"defaultF"),b.defaultButton,b.default3DObjectTitle),function(){function r(e){return e.domElement.querySelector("input").readOnly&&(e.getValue()!==e.initialValue&&void 0===e.boSetValue&&(e.boSetValue=!0,J(e,e.initialValue),e.boSetValue=void 0,e.initialValue=e.getValue()),1)}function e(o){var t,e,i,n;return"w"===o?(t=function(e){var t,n=A.object.geometry.attributes,o=A.index;n.position.itemSize<4?console.error("guiSelectPoint.addPointControllers().axesGui().controller.onChange(): attributes.position.itemSize = "+n.position.itemSize):(g.palette&&(t=g.palette.toColor(e,i.__min,i.__max),M.setColorAttribute(n,o,t)),n.position.setW(o,e),void 0!==g.arrayCloud&&void 0!==g.arrayCloud.frustumPoints&&g.arrayCloud.frustumPoints.updateCloudPointItem(A.object,A.index))},(n=(n=g.scales.w)||{}).name=n.name||o,g.palette instanceof et.palette&&(n.min=void 0===n.min?0:n.min,n.max=void 0===n.max?100:n.max),void 0!==n.min&&void 0!==n.max?(i=y.add({value:n.min},"value",n.min,n.max,(n.max-n.min)/100).onChange(function(e){t(e)}),g.palette instanceof et.palette&&(i.domElement.querySelector(".slider-fg").style.height="40%",e=i.domElement.querySelector(".slider"),et.create(e,{palette:g.palette,style:{}}))):i=y.add({value:0},"value").onChange(function(e){t(e)})):(n=void 0===_?g.scales[o]:_.options?_.options.scales[o]:void 0)&&(i=y.add({value:n.min},"value",n.min,n.max,(n.max-n.min)/100).onChange(function(e){var t,n;r(i)||(t=A.object,n="x"===o?0:"y"===o?1:"z"===o?2:"w"===o?3:console.error("axisName:"+o),t.geometry.attributes.position.array[n+A.index*t.geometry.attributes.position.itemSize]=e,t.geometry.attributes.position.needsUpdate=!0,Y(A.index),void 0!==g.arrayCloud&&void 0!==g.arrayCloud.frustumPoints&&g.arrayCloud.frustumPoints.updateCloudPointItem(t,A.index))})),n&&Ne.controllerNameAndTitle(i,n.name),i}R=e("x"),L=e("y"),F=e("z"),V=e("w"),D=y.addColor({color:"#FFFFFF"},"color").onChange(function(e){var t;r(D)||void 0!==D.userData&&(t=D.userData.intersection,M.setColorAttribute(t.object.geometry.attributes,t.index,e))}),Ne.controllerNameAndTitle(D,g.scales.w?g.scales.w.name:b.color),H=y.add({opasity:1},"opasity",0,1,.01).onChange(function(e){var t,n;r(H)||void 0===D.userData||void 0!==(n=(t=D.userData.intersection).object).geometry.attributes.ca&&(n.geometry.attributes.ca.array[3+t.index*n.geometry.attributes.ca.itemSize]=e,n.geometry.attributes.ca.needsUpdate=!0)}),Ne.controllerNameAndTitle(H,b.opacity,b.opacityTitle),N=y.add({trace:!1},"trace").onChange(function(e){te(A,e,Q)}),Ne.controllerNameAndTitle(N,b.trace,b.traceTitle),W(N,On.isCreated()),h.pointControls&&h.pointControls(y,W,Q,A);function t(e){var t=void 0===_?g.scales[e]:_.options?_.options.scales[e]:void 0;if(t){e=Ne.controllerZeroStep(x,{value:t.min},"value");return e.domElement.querySelector("input").readOnly=!0,Ne.controllerNameAndTitle(e,t.name),e}}X.x=t("x"),X.y=t("y"),X.z=t("z"),w=y.add({defaultF:function(){var e=A.object.userData.player.arrayFuncs[A.index],t=On.getTime();if(R.setValue("function"==typeof e.x?e.x(t,g.a,g.b):e.x),L.setValue("function"==typeof e.y?e.y(t,g.a,g.b):e.y),F.setValue("function"==typeof e.z?e.z(t,g.a,g.b):void 0===e.z?0:e.z),void 0!==e.w){if(void 0!==e.w.r)D.setValue("#"+new $e.Color(e.w.r,e.w.g,e.w.b).getHexString());else if("function"==typeof e.w)J(V,e.w(t));else if(e.w.func)return void J(V,e.w.func(t));parseFloat(e.w)===e.w?J(V,e.w):console.error("Restore default local position: Invalid W axis.")}else D.setValue(D.initialValue),H.setValue(H.initialValue)}},"defaultF"),Ne.controllerNameAndTitle(w,b.defaultButton,b.defaultLocalPositionTitle),z=new tt(y,g.scales,$e,function(e,t){var n=Q(),o=P.__select.options.selectedIndex-1,o=n.userData.player.arrayFuncs[o];o[t]=e;for(var i=n.parent,r=0;i;){if(i.userData.t){r=i.userData.t;break}i=i.parent}var a;n.geometry.attributes.position.itemSize;switch(t){case"x":a=R;break;case"y":a=L;break;case"z":a=F;break;case"w":if(e instanceof $e.Color)return void D.setValue("#"+e.getHexString());a=V;break;default:return void console.error("GuiSelectPoint new functionsFolder onFinishChange: axisName = "+t)}J(a,On.execFunc(o,t,r))},{getLanguageCode:s,THREE:$e})}();0<K.length;)this.addMesh(K[K.length-1]),K.pop()},this.setColorAttribute=function(e,t,n){"string"==typeof n&&(n=new $e.Color(n));e=e.color||e.ca;void 0!==e&&(e.setX(t,n.r),e.setY(t,n.g),e.setZ(t,n.b),e.needsUpdate=!0)},this.removePoints=function(){P.domElement.querySelectorAll("select option").forEach(function(e){return e.remove()});var e=document.createElement("option");e.innerHTML=b.notSelected,e.setAttribute("value",-1),P.__select.appendChild(e)},this.getFrustumPoints=function(){return m},this.windowRange=function(e){pointLight1.windowRange(e.scales),pointLight2.windowRange(e.scales),R.min(e.scales.x.min),R.max(e.scales.x.max),R.updateDisplay(),L.min(e.scales.y.min),L.max(e.scales.y.max),L.updateDisplay(),F.min(e.scales.z.min),F.max(e.scales.z.max),F.updateDisplay(),void 0!==V&&(V.min(e.scales.w.min),V.max(e.scales.w.max),V.updateDisplay())},this}function ot(e,t){if($e){var n=e.geometry.attributes.position,e=4<=n.itemSize?new $e.Vector4(0,0,0,0):new $e.Vector3;return e.fromArray(n.array,t*n.itemSize),e}console.error("getObjectLocalPosition: call GuiSelectPoint.setTHREE( THREE ); first")}function it(e,t){var n,o,i,r,a=t.clone();for(;n=e,o=a,r=i=void 0,i=new $e.Vector3,r=new $e.Vector3,(i=o.clone()).multiply(n.scale),r.copy(i),r.applyEuler(n.rotation),i.x=r.x,i.y=r.y,i.z=r.z,i.add(n.position),a=i,e=e.parent,e.parent;);return a}function rt(e,t){if(-1!==t)return void 0===t?e.position:it(e,ot(e,t))}function at(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),i=Math.round(e.g),r=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var d=e.hex.toString(16);d.length<6;)d="0"+d;return"#"+d}return"CSS_RGB"===n?"rgb("+o+","+i+","+r+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+r+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+r+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+r+","+a+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+",a:"+a+"}":"unknown format"}nt.setTHREE=function(e){$e?Object.is($e,e)||console.error("GuiSelectPoint.setTHREE: duplicate THREE. Please use one instance of the THREE library."):$e=e};var st,lt=Array.prototype.forEach,ct=Array.prototype.slice,dt={BREAK:{},extend:function(n){return this.each(ct.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(t[e])||(n[e]=t[e])}.bind(this))},this),n},defaults:function(n){return this.each(ct.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(n[e])&&(n[e]=t[e])}.bind(this))},this),n},compose:function(){var n=ct.call(arguments);return function(){for(var e=ct.call(arguments),t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},each:function(e,t,n){if(e)if(lt&&e.forEach&&e.forEach===lt)e.forEach(t,n);else if(e.length===e.length+0){for(var o=void 0,o=0,i=e.length;o<i;o++)if(o in e&&t.call(n,e[o],o)===this.BREAK)return}else for(var r in e)if(t.call(n,e[r],r)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(o,i,r){var a=void 0;return function(){var e=this,t=arguments;var n=r||!a;clearTimeout(a),a=setTimeout(function(){a=null,r||o.apply(e,t)},i),n&&o.apply(e,t)}},toArray:function(e){return e.toArray?e.toArray():ct.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:(st=function(e){return isNaN(e)},ut.toString=function(){return st.toString()},ut),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};function ut(e){return st.apply(this,arguments)}var pt,ft=[{litmus:dt.isString,conversions:{THREE_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:at},SIX_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:at},CSS_RGB:{read:function(e){e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:at},CSS_RGBA:{read:function(e){e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:at}}},{litmus:dt.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:dt.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:dt.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(dt.isNumber(e.r)&&dt.isNumber(e.g)&&dt.isNumber(e.b)&&dt.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(dt.isNumber(e.r)&&dt.isNumber(e.g)&&dt.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(dt.isNumber(e.h)&&dt.isNumber(e.s)&&dt.isNumber(e.v)&&dt.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(dt.isNumber(e.h)&&dt.isNumber(e.s)&&dt.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],ht=void 0,mt=void 0,_t=function(e){mt=!1;var n=1<arguments.length?dt.toArray(arguments):e;return dt.each(ft,function(e){if(e.litmus(n))return dt.each(e.conversions,function(e,t){if(ht=e.read(n),!1===mt&&!1!==ht)return(mt=ht).conversionName=t,ht.conversion=e,dt.BREAK}),dt.BREAK}),mt},gt={hsv_to_rgb:function(e,t,n){var o=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),r=n*(1-t),e=n*(1-i*t),t=n*(1-(1-i)*t),o=[[n,t,r],[e,n,r],[r,n,t],[r,e,n],[t,r,n],[n,r,e]][o];return{r:255*o[0],g:255*o[1],b:255*o[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),i=Math.max(e,t,n),r=i-o,o=void 0;return 0===i?{h:NaN,s:0,v:0}:(o=e===i?(t-n)/r:t===i?2+(n-e)/r:4+(e-t)/r,(o/=6)<0&&(o+=1),{h:360*o,s:r/i,v:i/255})},rgb_to_hex:function(e,t,n){e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t);return e=this.hex_with_component(e,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(pt=8*t)|e&~(255<<pt)}},bt="function"==typeof Symbol&&"symbol"===ne(Symbol.iterator)?function(e){return void 0===e?"undefined":ne(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":ne(e)},vt=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ue=function(e,t,n){return t&&yt(e.prototype,t),n&&yt(e,n),e};function yt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function wt(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0!==o){if("value"in o)return o.value;o=o.get;return void 0!==o?o.call(n):void 0}if(e=Object.getPrototypeOf(e),null!==e)return wt(e,t,n)}var k=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":ne(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},xt=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":ne(t))&&"function"!=typeof t?e:t},Ct=(ue(Et,[{key:"toString",value:function(){return at(this)}},{key:"toHexString",value:function(){return at(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),Et);function Et(){if(vt(this,Et),this.__state=_t.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}function St(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||Ct.recalculateRGB(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(Ct.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function At(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||Ct.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(Ct.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}Ct.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=gt.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");dt.extend(e.__state,gt.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},Ct.recalculateHSV=function(e){var t=gt.rgb_to_hsv(e.r,e.g,e.b);dt.extend(e.__state,{s:t.s,v:t.v}),dt.isNaN(t.h)?dt.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},Ct.COMPONENTS=["r","g","b","h","s","v","hex","a"],St(Ct.prototype,"r",2),St(Ct.prototype,"g",1),St(Ct.prototype,"b",0),At(Ct.prototype,"h"),At(Ct.prototype,"s"),At(Ct.prototype,"v"),Object.defineProperty(Ct.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(Ct.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=gt.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var kt=(ue(Tt,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),Tt);function Tt(e,t){vt(this,Tt),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}var Ot={};dt.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){dt.each(e,function(e){Ot[e]=t})});var Pt=/(\d+(\.\d+)?)px/;function Rt(e){if("0"===e||dt.isUndefined(e))return 0;e=e.match(Pt);return dt.isNull(e)?0:parseFloat(e[1])}var Lt={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){dt.isUndefined(t)&&(t=!0),dt.isUndefined(n)&&(n=!0),e.style.position="absolute",t&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var i=n||{},n=Ot[t];if(!n)throw new Error("Event type "+t+" not supported.");var r=document.createEvent(n);switch(n){case"MouseEvents":var a=i.x||i.clientX||0,s=i.y||i.clientY||0;r.initMouseEvent(t,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,a,s,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":s=r.initKeyboardEvent||r.initKeyEvent;dt.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),s(t,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:r.initEvent(t,i.bubbles||!1,i.cancelable||!0)}dt.defaults(r,o),e.dispatchEvent(r)},bind:function(e,t,n,o){o=o||!1;return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n),Lt},unbind:function(e,t,n,o){o=o||!1;return e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n),Lt},addClass:function(e,t){var n;return void 0===e.className?e.className=t:e.className===t||-1===(n=e.className.split(/ +/)).indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")),Lt},removeClass:function(e,t){var n;return t?e.className===t?e.removeAttribute("class"):-1!==(t=(n=e.className.split(/ +/)).indexOf(t))&&(n.splice(t,1),e.className=n.join(" ")):e.className=void 0,Lt},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){e=getComputedStyle(e);return Rt(e["border-left-width"])+Rt(e["border-right-width"])+Rt(e["padding-left"])+Rt(e["padding-right"])+Rt(e.width)},getHeight:function(e){e=getComputedStyle(e);return Rt(e["border-top-width"])+Rt(e["border-bottom-width"])+Rt(e["padding-top"])+Rt(e["padding-bottom"])+Rt(e.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)for(;n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent,t;);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},Ft=(k(Vt,kt),ue(Vt,[{key:"setValue",value:function(e){e=wt(Vt.prototype.__proto__||Object.getPrototypeOf(Vt.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),wt(Vt.prototype.__proto__||Object.getPrototypeOf(Vt.prototype),"updateDisplay",this).call(this)}}]),Vt);function Vt(e,t){vt(this,Vt);var t=xt(this,(Vt.__proto__||Object.getPrototypeOf(Vt)).call(this,e,t)),n=t;return t.__prev=t.getValue(),t.__checkbox=document.createElement("input"),t.__checkbox.setAttribute("type","checkbox"),Lt.bind(t.__checkbox,"change",function(){n.setValue(!n.__prev)},!1),t.domElement.appendChild(t.__checkbox),t.updateDisplay(),t}var Nt=(k(jt,kt),ue(jt,[{key:"setValue",value:function(e){e=wt(jt.prototype.__proto__||Object.getPrototypeOf(jt.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e}},{key:"updateDisplay",value:function(){return Lt.isActive(this.__select)?this:(this.__select.value=this.getValue(),wt(jt.prototype.__proto__||Object.getPrototypeOf(jt.prototype),"updateDisplay",this).call(this))}}]),jt);function jt(e,t,n){vt(this,jt);var o,t=xt(this,(jt.__proto__||Object.getPrototypeOf(jt)).call(this,e,t)),n=n,i=t;return t.__select=document.createElement("select"),dt.isArray(n)&&(o={},dt.each(n,function(e){o[e]=e}),n=o),dt.each(n,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),i.__select.appendChild(n)}),t.updateDisplay(),Lt.bind(t.__select,"change",function(){var e=this.options[this.selectedIndex].value;i.setValue(e)}),t.domElement.appendChild(t.__select),t}var Dt=(k(Ht,kt),ue(Ht,[{key:"updateDisplay",value:function(){return Lt.isActive(this.__input)||(this.__input.value=this.getValue()),wt(Ht.prototype.__proto__||Object.getPrototypeOf(Ht.prototype),"updateDisplay",this).call(this)}}]),Ht);function Ht(e,t){vt(this,Ht);var t=xt(this,(Ht.__proto__||Object.getPrototypeOf(Ht)).call(this,e,t)),n=t;function o(){n.setValue(n.__input.value)}return t.__input=document.createElement("input"),t.__input.setAttribute("type","text"),Lt.bind(t.__input,"keyup",o),Lt.bind(t.__input,"change",o),Lt.bind(t.__input,"blur",function(){n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())}),Lt.bind(t.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),t.updateDisplay(),t.domElement.appendChild(t.__input),t}function Bt(e){e=e.toString();return-1<e.indexOf(".")?e.length-e.indexOf(".")-1:0}k(zt,kt),ue(zt,[{key:"setValue",value:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),wt(zt.prototype.__proto__||Object.getPrototypeOf(zt.prototype),"setValue",this).call(this,e)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=Bt(e),this}}]),P=zt;function zt(e,t,n){vt(this,zt);t=xt(this,(zt.__proto__||Object.getPrototypeOf(zt)).call(this,e,t)),n=n||{};return t.__min=n.min,t.__max=n.max,t.__step=n.step,dt.isUndefined(t.__step)?0===t.initialValue?t.__impliedStep=1:t.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(t.initialValue))/Math.LN10))/10:t.__impliedStep=t.__step,t.__precision=Bt(t.__impliedStep),t}var Mt=(k(It,P),ue(It,[{key:"updateDisplay",value:function(){var e,t;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),t=this.__precision,t=Math.pow(10,t),Math.round(e*t)/t),wt(It.prototype.__proto__||Object.getPrototypeOf(It.prototype),"updateDisplay",this).call(this)}}]),It);function It(e,t,n){vt(this,It);n=xt(this,(It.__proto__||Object.getPrototypeOf(It)).call(this,e,t,n));n.__truncationSuspended=!1;var o=n,i=void 0;function r(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function a(e){var t=i-e.clientY;o.setValue(o.getValue()+t*o.__impliedStep),i=e.clientY}function s(){Lt.unbind(window,"mousemove",a),Lt.unbind(window,"mouseup",s),r()}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),Lt.bind(n.__input,"change",function(){var e=parseFloat(o.__input.value);dt.isNaN(e)||o.setValue(e)}),Lt.bind(n.__input,"blur",function(){r()}),Lt.bind(n.__input,"mousedown",function(e){Lt.bind(window,"mousemove",a),Lt.bind(window,"mouseup",s),i=e.clientY}),Lt.bind(n.__input,"keydown",function(e){13===e.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,r())}),n.updateDisplay(),n.domElement.appendChild(n.__input),n}function Gt(e,t,n,o,i){return o+(e-t)/(n-t)*(i-o)}var Xt=(k(Ut,P),ue(Ut,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",wt(Ut.prototype.__proto__||Object.getPrototypeOf(Ut.prototype),"updateDisplay",this).call(this)}}]),Ut);function Ut(e,t,n,o,i){vt(this,Ut);var i=xt(this,(Ut.__proto__||Object.getPrototypeOf(Ut)).call(this,e,t,{min:n,max:o,step:i})),r=i;function a(e){e.preventDefault();var t=r.__background.getBoundingClientRect();return r.setValue(Gt(e.clientX,t.left,t.right,r.__min,r.__max)),!1}function s(){Lt.unbind(window,"mousemove",a),Lt.unbind(window,"mouseup",s),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function l(e){var t=e.touches[0].clientX,e=r.__background.getBoundingClientRect();r.setValue(Gt(t,e.left,e.right,r.__min,r.__max))}function c(){Lt.unbind(window,"touchmove",l),Lt.unbind(window,"touchend",c),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}return i.__background=document.createElement("div"),i.__foreground=document.createElement("div"),Lt.bind(i.__background,"mousedown",function(e){document.activeElement.blur(),Lt.bind(window,"mousemove",a),Lt.bind(window,"mouseup",s),a(e)}),Lt.bind(i.__background,"touchstart",function(e){if(1!==e.touches.length)return;Lt.bind(window,"touchmove",l),Lt.bind(window,"touchend",c),l(e)}),Lt.addClass(i.__background,"slider"),Lt.addClass(i.__foreground,"slider-fg"),i.updateDisplay(),i.__background.appendChild(i.__foreground),i.domElement.appendChild(i.__background),i}var qt=(k(Wt,kt),ue(Wt,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),Wt);function Wt(e,t,n){vt(this,Wt);var t=xt(this,(Wt.__proto__||Object.getPrototypeOf(Wt)).call(this,e,t)),o=t;return t.__button=document.createElement("div"),t.__button.innerHTML=void 0===n?"Fire":n,Lt.bind(t.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),Lt.addClass(t.__button,"button"),t.domElement.appendChild(t.__button),t}var Yt=(k(Jt,kt),ue(Jt,[{key:"updateDisplay",value:function(){var t,n=_t(this.getValue());!1!==n&&(t=!1,dt.each(Ct.COMPONENTS,function(e){if(!dt.isUndefined(n[e])&&!dt.isUndefined(this.__color.__state[e])&&n[e]!==this.__color.__state[e])return t=!0,{}},this),t&&dt.extend(this.__color.__state,n)),dt.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var e=this.__color.v<.5||.5<this.__color.s?255:0,o=255-e;dt.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+e+","+e+","+e+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,Qt(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),dt.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+e+","+e+","+e+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),Jt);function Jt(e,t){vt(this,Jt);var n=xt(this,(Jt.__proto__||Object.getPrototypeOf(Jt)).call(this,e,t));n.__color=new Ct(n.getValue()),n.__temp=new Ct(0);var o=n;n.domElement=document.createElement("div"),Lt.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",Lt.bind(n.__input,"keydown",function(e){13===e.keyCode&&l.call(this)}),Lt.bind(n.__input,"blur",l),Lt.bind(n.__selector,"mousedown",function(){Lt.addClass(this,"drag").bind(window,"mouseup",function(){Lt.removeClass(o.__selector,"drag")})}),Lt.bind(n.__selector,"touchstart",function(){Lt.addClass(this,"drag").bind(window,"touchend",function(){Lt.removeClass(o.__selector,"drag")})});e=document.createElement("div");function i(e){d(e),Lt.bind(window,"mousemove",d),Lt.bind(window,"touchmove",d),Lt.bind(window,"mouseup",a),Lt.bind(window,"touchend",a)}function r(e){u(e),Lt.bind(window,"mousemove",u),Lt.bind(window,"touchmove",u),Lt.bind(window,"mouseup",s),Lt.bind(window,"touchend",s)}function a(){Lt.unbind(window,"mousemove",d),Lt.unbind(window,"touchmove",d),Lt.unbind(window,"mouseup",a),Lt.unbind(window,"touchend",a),c()}function s(){Lt.unbind(window,"mousemove",u),Lt.unbind(window,"touchmove",u),Lt.unbind(window,"mouseup",s),Lt.unbind(window,"touchend",s),c()}function l(){var e=_t(this.value);!1!==e?(o.__color.__state=e,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function c(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function d(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,e=n.clientX,n=n.clientY,e=(e-t.left)/(t.right-t.left),t=1-(n-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),1<e?e=1:e<0&&(e=0),o.__color.v=t,o.__color.s=e,o.setValue(o.__color.toOriginal()),!1}function u(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__hue_field.getBoundingClientRect(),t=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),o.__color.h=360*t,o.setValue(o.__color.toOriginal()),!1}return dt.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),dt.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),dt.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),dt.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),dt.extend(e.style,{width:"100%",height:"100%",background:"none"}),Qt(e,"top","rgba(0,0,0,0)","#000"),dt.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(t=n.__hue_field).style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",dt.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),Lt.bind(n.__saturation_field,"mousedown",i),Lt.bind(n.__saturation_field,"touchstart",i),Lt.bind(n.__field_knob,"mousedown",i),Lt.bind(n.__field_knob,"touchstart",i),Lt.bind(n.__hue_field,"mousedown",r),Lt.bind(n.__hue_field,"touchstart",r),n.__saturation_field.appendChild(e),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}var Kt=["-moz-","-o-","-webkit-","-ms-",""];function Qt(t,n,o,i){t.style.background="",dt.each(Kt,function(e){t.style.cssText+="background: "+e+"linear-gradient("+n+", "+o+" 0%, "+i+" 100%); "})}var Zt=function(e,t,n,o,i){var r=e[t];return dt.isArray(n)||dt.isObject(n)?new Nt(e,t,n):dt.isNumber(r)?dt.isNumber(n)&&dt.isNumber(o)?dt.isNumber(i)?new Xt(e,t,n,o,i):new Xt(e,t,n,o):dt.isNumber(i)?new Mt(e,t,{min:n,max:o,step:i}):new Mt(e,t,{min:n,max:o}):dt.isString(r)?new Dt(e,t):dt.isFunction(r)?new qt(e,t,""):dt.isBoolean(r)?new Ft(e,t):null},J=(k($t,kt),ue($t,[{key:"controller",set:function(e){this._controller=e},get:function(){return this._controller}}]),$t);function $t(e,t){vt(this,$t);var n=xt(this,($t.__proto__||Object.getPrototypeOf($t)).call(this,e,t));return n.arguments={object:e,property:t,opts:Array.prototype.slice.call(arguments,2)},e.property&&(n.property=e.property(n)),n}k=function(e,t){var t=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var o=t.getElementsByTagName("head")[0];try{o.appendChild(n)}catch(e){}};var en=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},tn=(ue(nn,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),dt.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",Lt.unbind(t.domElement,"webkitTransitionEnd",e),Lt.unbind(t.domElement,"transitionend",e),Lt.unbind(t.domElement,"oTransitionEnd",e)}var t=this;Lt.bind(this.domElement,"webkitTransitionEnd",e),Lt.bind(this.domElement,"transitionend",e),Lt.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Lt.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Lt.getHeight(this.domElement)/2+"px"}}]),nn);function nn(){vt(this,nn),this.backgroundElement=document.createElement("div"),dt.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Lt.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),dt.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;Lt.bind(this.backgroundElement,"click",function(){e.hide()})}k(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var on="Default",rn=function(){try{return!!window.localStorage}catch(e){return!1}}(),an=void 0,sn=!0,ln=void 0,cn=!1,dn=[],un=function t(e){var n=this,o=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Lt.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=dt.defaults(o,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),o=dt.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),dt.isUndefined(o.load)?o.load={preset:on}:o.preset&&(o.load.preset=o.preset),dt.isUndefined(o.parent)&&o.hideable&&dn.push(this),o.resizable=dt.isUndefined(o.parent)&&o.resizable,o.autoPlace&&dt.isUndefined(o.scrollable)&&(o.scrollable=!0);var i,r,a,s,l=rn&&"true"===localStorage.getItem(gn(0,"isLocal")),c=void 0,d=void 0;function u(e){return e.preventDefault(),r.width+=a-e.clientX,r.onResize(),a=e.clientX,!1}function p(){Lt.removeClass(r.__closeButton,un.CLASS_DRAG),Lt.unbind(window,"mousemove",u),Lt.unbind(window,"mouseup",p)}function f(e){return e.preventDefault(),a=e.clientX,Lt.addClass(r.__closeButton,un.CLASS_DRAG),Lt.bind(window,"mousemove",u),Lt.bind(window,"mouseup",p),!1}Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return(n.parent?n.getRoot():o.load).preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,yn(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,d&&(d.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(e){o.closed=e,o.closed?Lt.addClass(n.__ul,t.CLASS_CLOSED):Lt.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return l},set:function(e){rn&&((l=e)?Lt.bind(window,"unload",c):Lt.unbind(window,"unload",c),localStorage.setItem(gn(0,"isLocal"),e))}}}),dt.isUndefined(o.parent)?(this.closed=o.closed||!1,Lt.addClass(this.domElement,t.CLASS_MAIN),Lt.makeSelectable(this.domElement,!1),rn&&l&&(n.useLocalStorage=!0,(i=localStorage.getItem(gn(0,"gui")))&&(o.load=JSON.parse(i))),this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,Lt.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),o.closeOnTop?(Lt.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Lt.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Lt.bind(this.__closeButton,"click",function(){n.closed=!n.closed})):(void 0===o.closed&&(o.closed=!0),i=document.createTextNode(o.name),Lt.addClass(i,"controller-name"),d=pn(n,i),Lt.addClass(this.__ul,t.CLASS_CLOSED),Lt.addClass(d,"title"),Lt.bind(d,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),o.closed||(this.closed=!1)),o.autoPlace&&(dt.isUndefined(o.parent)&&(sn&&(ln=document.createElement("div"),Lt.addClass(ln,"dg"),Lt.addClass(ln,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(ln),sn=!1),ln.appendChild(this.domElement),Lt.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||yn(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},Lt.bind(window,"resize",this.__resizeHandler),Lt.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Lt.bind(this.__ul,"transitionend",this.__resizeHandler),Lt.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&(a=void 0,(r=this).__resize_handle=document.createElement("div"),dt.extend(r.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Lt.bind(r.__resize_handle,"mousedown",f),Lt.bind(r.__closeButton,"mousedown",f),r.domElement.insertBefore(r.__resize_handle,r.domElement.firstElementChild)),c=function(){rn&&"true"===localStorage.getItem(gn(0,"isLocal"))&&localStorage.setItem(gn(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=c,o.parent||((s=n.getRoot()).width+=1,dt.defer(function(){--s.width}))};function pn(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o),e.onResize(),o}function fn(e){Lt.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&Lt.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function hn(e,t){e=e.__preset_select[e.__preset_select.selectedIndex];e.innerHTML=t?e.value+"*":e.value}function mn(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[t.property]=t,n.load&&n.load.remembered){i=n.load.remembered,n=void 0;if(i[e.preset])n=i[e.preset];else{if(!i[on])return;n=i[on]}n[o]&&void 0!==n[o][t.property]&&(o=n[o][t.property],t.initialValue=o,t.setValue(o))}}}function _n(e,t,n,o){var i;if(t.arguments&&(t=(i=t).arguments.object,n=i.arguments.property,o={factoryArgs:i.arguments.opts}),void 0===i&&void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var r=void 0;null===(r=o.color?new Yt(t,n):void 0!==i&&"string"==typeof i.property?i:(l=[t,n].concat(o.factoryArgs),Zt.apply(e,l)))?r=i:void 0!==i&&(i.controller=r),o.before instanceof kt&&(o.before=o.before.__li),mn(e,r),Lt.addClass(r.domElement,"c");var a=document.createElement("span");if(Lt.addClass(a,"property-name"),void 0!==i&&"object"===bt(i.property))for(var s in i.property)a.appendChild(i.property[s]);else a.innerHTML=r.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(r.domElement);var c,d,u,p,o=pn(e,l,o.before);return Lt.addClass(o,un.CLASS_CONTROLLER_ROW),r instanceof Yt?Lt.addClass(o,"color"):Lt.addClass(o,bt(r.getValue())),c=e,d=o,(u=r).__li=d,u.__gui=c,dt.extend(u,{options:function(e){if(1<arguments.length){var t=u.__li.nextElementSibling;return u.remove(),_n(c,u.object,u.property,{before:t,factoryArgs:[dt.toArray(arguments)]})}if(dt.isArray(e)||dt.isObject(e)){t=u.__li.nextElementSibling;return u.remove(),_n(c,u.object,u.property,{before:t,factoryArgs:[e]})}},name:function(e){return u.__li.firstElementChild.firstElementChild.innerHTML=e,u},listen:function(){return u.__gui.listen(u),u},remove:function(){return u.__gui.remove(u),u}}),u instanceof Xt?(p=new Mt(u.object,u.property,{min:u.__min,max:u.__max,step:u.__step}),dt.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(e){var t=u[e],n=p[e];u[e]=p[e]=function(){var e=Array.prototype.slice.call(arguments);return n.apply(p,e),t.apply(u,e)}}),Lt.addClass(d,"has-slider"),u.domElement.insertBefore(p.domElement,u.domElement.firstElementChild)):u instanceof Mt?(o=function(e){if(dt.isNumber(u.__min)&&dt.isNumber(u.__max)){var t=u.__li.firstElementChild.firstElementChild.innerHTML,n=-1<u.__gui.__listening.indexOf(u);u.remove();var o=_n(c,u.object,u.property,{before:u.__li.nextElementSibling,factoryArgs:[u.__min,u.__max,u.__step]});return o.name(t),n&&o.listen(),o}return e},u.min=dt.compose(o,u.min),u.max=dt.compose(o,u.max)):u instanceof Ft?(Lt.bind(d,"click",function(){Lt.fakeEvent(u.__checkbox,"click")}),Lt.bind(u.__checkbox,"click",function(e){e.stopPropagation()})):u instanceof qt?(Lt.bind(d,"click",function(){Lt.fakeEvent(u.__button,"click")}),Lt.bind(d,"mouseover",function(){Lt.addClass(u.__button,"hover")}),Lt.bind(d,"mouseout",function(){Lt.removeClass(u.__button,"hover")})):u instanceof Yt&&(Lt.addClass(d,"color"),u.updateDisplay=dt.compose(function(e){return d.style.borderLeftColor=u.__color.toString(),e},u.updateDisplay),u.updateDisplay()),u.setValue=dt.compose(function(e){return c.getRoot().__preset_select&&u.isModified()&&hn(c.getRoot(),!0),e},u.setValue),e.__controllers.push(r),r}function gn(e,t){return document.location.href+"."+t}function bn(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function vn(e,t){t.style.display=e.useLocalStorage?"block":"none"}function yn(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function wn(i,r){var a={};return dt.each(i.__rememberedObjects,function(e,t){var n={},o=i.__rememberedObjectIndecesToControllers[t];dt.each(o,function(e,t){n[t]=r?e.initialValue:e.getValue()}),a[t]=n}),a}un.toggleHide=function(){cn=!cn,dt.each(dn,function(e){e.domElement.style.display=cn?"none":""})},un.CLASS_AUTO_PLACE="a",un.CLASS_AUTO_PLACE_CONTAINER="ac",un.CLASS_MAIN="main",un.CLASS_CONTROLLER_ROW="cr",un.CLASS_TOO_TALL="taller-than-window",un.CLASS_CLOSED="closed",un.CLASS_CLOSE_BUTTON="close-button",un.CLASS_CLOSE_TOP="close-top",un.CLASS_CLOSE_BOTTOM="close-bottom",un.CLASS_DRAG="drag",un.DEFAULT_WIDTH=245,un.TEXT_CLOSED="Close Controls",un.TEXT_OPEN="Open Controls",un._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||un.toggleHide()},Lt.bind(window,"keydown",un._keydownHandler,!1),dt.extend(un.prototype,{add:function(e,t){return _n(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return _n(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;dt.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&ln.removeChild(this.domElement);var t=this;dt.each(this.__folders,function(e){t.removeFolder(e)}),Lt.unbind(window,"keydown",un._keydownHandler,!1),fn(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);t=new un(t);this.__folders[e]=t;e=pn(this,t.domElement);return Lt.addClass(e,"folder"),t},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],fn(t);var e=this;dt.each(t.__folders,function(e){t.removeFolder(e)}),dt.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e,t,n=this.getRoot();n.scrollable&&(e=Lt.getOffset(n.__ul).top,t=0,dt.each(n.__ul.childNodes,function(e){n.autoPlace&&e===n.__save_row||(t+=Lt.getHeight(e))}),window.innerHeight-e-20<t?(Lt.addClass(n.domElement,un.CLASS_TOO_TALL),n.__ul.style.height=window.innerHeight-e-20+"px"):(Lt.removeClass(n.domElement,un.CLASS_TOO_TALL),n.__ul.style.height="auto")),n.__resize_handle&&dt.defer(function(){n.__resize_handle.style.height=n.__ul.offsetHeight+"px"}),n.__closeButton&&(n.__closeButton.style.width=n.width+"px")},onResizeDebounced:dt.debounce(function(){this.onResize()},50),remember:function(){if(dt.isUndefined(an)&&((an=new tn).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;dt.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(n){var e=n.__save_row=document.createElement("li");Lt.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),Lt.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",Lt.addClass(t,"button gears");var o=document.createElement("span");o.innerHTML="Save",Lt.addClass(o,"button"),Lt.addClass(o,"save");var i=document.createElement("span");i.innerHTML="New",Lt.addClass(i,"button"),Lt.addClass(i,"save-as");var r=document.createElement("span");r.innerHTML="Revert",Lt.addClass(r,"button"),Lt.addClass(r,"revert");var a=n.__preset_select=document.createElement("select");n.load&&n.load.remembered?dt.each(n.load.remembered,function(e,t){bn(n,t,t===n.preset)}):bn(n,on,!1);{var s;Lt.bind(a,"change",function(){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].innerHTML=n.__preset_select[e].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(o),e.appendChild(i),e.appendChild(r),rn&&(s=document.getElementById("dg-local-explain"),e=document.getElementById("dg-local-storage"),document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(gn(0,"isLocal"))&&e.setAttribute("checked","checked"),vn(n,s),Lt.bind(e,"change",function(){n.useLocalStorage=!n.useLocalStorage,vn(n,s)}))}var l=document.getElementById("dg-new-constructor");Lt.bind(l,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||an.hide()}),Lt.bind(t,"click",function(){l.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),an.show(),l.focus(),l.select()}),Lt.bind(o,"click",function(){n.save()}),Lt.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&n.saveAs(e)}),Lt.bind(r,"click",function(){n.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&yn(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var n=this.load;return n.closed=this.closed,0<this.__rememberedObjects.length&&(n.preset=this.preset,n.remembered||(n.remembered={}),n.remembered[this.preset]=wn(this)),n.folders={},dt.each(this.__folders,function(e,t){n.folders[t]=e.getSaveObject()}),n},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=wn(this),hn(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[on]=wn(this,!0)),this.load.remembered[e]=wn(this),this.preset=e,bn(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(t){dt.each(this.__controllers,function(e){this.getRoot().load.remembered?mn(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),dt.each(this.__folders,function(e){e.revert(e)}),t||hn(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&en.call(window,function(){e(t)});dt.each(t,function(e){e.updateDisplay()})}(this.__listening)},updateDisplay:function(){dt.each(this.__controllers,function(e){e.updateDisplay()}),dt.each(this.__folders,function(e){e.updateDisplay()})}});J={Controller:kt,BooleanController:Ft,OptionController:Nt,StringController:Dt,NumberController:P,NumberControllerBox:Mt,NumberControllerSlider:Xt,FunctionController:qt,ColorController:Yt,CustomController:J};
/**
 * @module Localization.
 *
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
/**
 * @module PlayController
 * @description PlayController class for using in my version of dat.gui(https://github.com/anhr/dat.gui) for playing of 3D objects in my projects.
 *
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var xn={prevSymbol:"",prevSymbolTitle:"Go to previous animation scene",nextSymbol:"",nextSymbolTitle:"Go to next animation scene",playSymbol:"",playTitle:"Play",pause:"",pauseTitle:"Pause",repeat:"",repeatOn:"Turn repeat on",repeatOff:"Turn repeat off",controllerTitle:"Current time.",fullScreen:"Full Screen",nonFullScreen:"Non Full Screen",stereoEffects:"Stereo effects",mono:"Mono",sideBySide:"Side by side",topAndBottom:"Top and bottom"};function Cn(e,t,n){var o=document.createElement("span");return o.innerHTML=e,o.title=t,o.style.cursor="pointer",o.style.margin="0px 2px",o.onclick=n,o}"ru"===(navigator?void 0!==navigator.languages&&"unknown"!=typeof navigator.languages&&0<navigator.languages.length?navigator.languages[0]:navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||(console.error("getLocale() failed!"),""):(console.error("getLocale() failed! !navigator"),"")).toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/)[1]&&(xn.prevSymbolTitle=" ",xn.playTitle="",xn.nextSymbolTitle=" ",xn.pauseTitle="",xn.repeatOn=" ",xn.repeatOff="  ",xn.controllerTitle=" .",xn.fullScreen="  ",xn.nonFullScreen="  ",xn.stereoEffects=" ",xn.mono="",xn.sideBySide=" ",xn.topAndBottom=" ");var En,Sn,An;
/**
 * @module CameraGui
 * @description [Camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera} graphical user interface.
 *
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 *
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
/**
 * @module Player
 * @description 3D objects animation.
 * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}
 * @copyright 2011 Data Arts Team, Google Creative Lab
 *
 * @license under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */c(kn,J.CustomController),t(kn,[{key:"controller",set:function(e){this._controller=e;var t=this;this._controller.onChange(function(e){t.onChange(e)}),this._controller.domElement.title=xn.controllerTitle},get:function(){return this._controller}}]);function kn(i,e){var r,a,s;d(this,kn);var l="rgb(255,255,255)",c="rgb(128,128,128)",t=u(this,(kn.__proto__||Object.getPrototypeOf(kn)).call(this,{playRate:1,property:function(){var e,t,n,o={};return a=function(e,t){o.buttonPlay.innerHTML=e,o.buttonPlay.title=t},o.buttonPrev=Cn(xn.prevSymbol,xn.prevSymbolTitle,i.prev),o.buttonPlay=Cn(xn.playSymbol,xn.playTitle,i.play3DObject),null!==i.getOptions().settings.max&&(s=e=function(e){var t,n=e?(t=xn.repeatOff,l):(t=xn.repeatOn,c);o.buttonRepeat.title!==t&&(o.buttonRepeat.title=t,o.buttonRepeat.style.color=n,i.onChangeRepeat(e))},n=i.getOptions().repeat?(t=xn.repeatOff,l):(t=xn.repeatOn,c),o.buttonRepeat=Cn(xn.repeat,t,function(){e(o.buttonRepeat.title===xn.repeatOn)}),o.buttonRepeat.style.color=n),o.buttonNext=Cn(xn.nextSymbol,xn.nextSymbolTitle,i.next),r=function(){return group},o}},"playRate"));return(i.PlayController=t).onRenamePlayButtons=function(e){var t,e=e?(t=xn.pause,xn.pauseTitle):(t=xn.playSymbol,xn.playTitle);a(t,e,!0)},t.onChangeRepeat=function(){s(i.getOptions().settings.repeat)},i.pushController(t),t.onChange=function(e){i.setTime(e)},t.getGroup=function(){return r()},t.selectScene=function(e){(void 0)(parseInt(e))},t.setValue=function(e){this._controller.domElement.childNodes[0].value=e},e.add(t).__truncationSuspended=!0,t}var Tn=!1;function On(r,d){var t,a,n,o,i,s,l;function c(e){e=e||0;var t,n,o,i=a.getTime();t=r,n=i,o=e,d.selectPlaySceneOptions,et.palette.setTHREE(An),t.userData.t=n,On.selectMeshPlayScene(t,n,o),t.children.forEach(function(e){On.selectMeshPlayScene(e,n,o)}),On.cameraTarget.setCameraTarget(),(t=On.cameraTarget.get())&&t.setCameraPosition&&t.setCameraPosition(),On.cameraGui&&On.cameraGui.update(),a.setIndex(e,(""===En.name?"":En.name+": ")+i),d.onSelectScene&&d.onSelectScene(e,i)}function e(){s.forEach(function(e){e.onRenamePlayButtons&&e.onRenamePlayButtons(n)})}function u(){n=!1,e(),o=void 0}function p(){if(t++,null!==En.max&&t>=En.marks){if(!En.repeat)return t=En.marks-1,void u();t=0}(-1===t||t===En.marks&&null!==En.max)&&(t=0),c(t)}function f(){if(l)return l.querySelector("#sliderPosition")}void 0!==An?(et.palette.setTHREE(An),On.isCreated()?console.error("Player: duplicate player."):(On.player=this,(Sn=(Sn=(d=d||{}).selectPlaySceneOptions)||{}).boPlayer=Sn.boPlayer||!1,Sn.a=d.a||1,Sn.b=d.b||0,En=d.settings||{},Ln(),d.cameraTarget=d.cameraTarget||{},setTimeout(function(){c()},0),t=0,(a=this).getTime=function(){var e=En.min+t*En.dt;return isNaN(e)&&console.error("Player.getTime(): t = "+e),null!==En.max&&e>En.max&&console.error("Player.getTime(): t = "+e+" settings.max = "+En.max),e<En.min&&null!==En.max&&console.error("Player.getTime(): t = "+e+" settings.min = "+En.min),e},this.setTime=function(e){this.selectScene(parseInt((e-En.min)/En.dt))},this.selectScene=function(e){if(void 0!==e)for(e=parseInt(e),null!==En.max&&(e>=En.marks?e=0:e<0&&(e=En.marks-1),t>En.marks&&(t=En.marks));t!==e;)t<e?t++:t--,c(t);else c(t)},this.next=function(){a.selectScene(t+1)},this.prev=function(){a.selectScene(t-1)},this.pushController=function(e){void 0!==e.object&&void 0!==e.object.playRate&&(e.object.playRate=En.min),s.push(e)},n=!(this.controllers=[]),s=this.controllers,this.play3DObject=function(){n?u():(n=!0,null!==En.max&&t>=En.marks-1&&(t=0),p(),e(),window.requestAnimationFrame(function e(t){if(n?window.requestAnimationFrame(e):o=void 0,void 0===o&&(i=(o=t)+1e3/En.interval),!isNaN(i)&&i!==1/0||(console.error("Player.animate: timeNext = "+i),n=!1),!(t<i)){for(;i<t;)i+=1e3/En.interval;p()}}))},this.repeat=function(){En.repeat=!En.repeat,this.onChangeRepeat(En.repeat)},this.getOptions=function(){return d},this.getSelectSceneIndex=function(){return t},this.onChangeRepeat=function(e){En.repeat=e,this.controllers.forEach(function(e){e.onChangeRepeat&&e.onChangeRepeat()})},this.gui=function(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i.getLanguageCode=i.getLanguageCode||function(){return"en"},i.cookie=i.cookie||new h.defaultCookie,i.cookieName=i.cookieName||"";var t=i.cookie,n="Player"+i.cookieName;function r(){Pn(),t.setObject(n,En),d.onChangeScaleT&&d.onChangeScaleT(En)}Rn();var a=JSON.parse(JSON.stringify(En)),s=function(t){var e={player:"Player",playerTitle:"3D objects animation.",min:"Min",max:"Max",dt:"Step",dtTitle:"Time between frames",marks:"Frames",marksTitle:"Player frames count",interval:"Rate",intervalTitle:"Rate of changing of animation scenes per second.",time:"Time",defaultButton:"Default",defaultTitle:"Restore default player settings."},n=void 0===(t=t||{}).getLanguageCode?"en":t.getLanguageCode();switch(n){case"ru":e.player="",e.playerTitle=" 3D .",e.min="",e.max="",e.dt="",e.dtTitle="  ",e.marks="",e.marksTitle="  ",e.interval="",e.intervalTitle="    .",e.time="",e.defaultButton="",e.defaultTitle="    .";break;default:if(void 0===t.lang||t.lang._languageCode!=n)break;Object.keys(t.lang).forEach(function(e){void 0!==_lang[e]&&(_lang[e]=t.lang[e])})}return e}({getLanguageCode:i.getLanguageCode});Object.freeze(a);var o=En.max,l=En.marks;t.getObject(n,En,En),null!==o&&o!==1/0&&null!==En.max||(En.max=o,En.marks=l);var c=e.addFolder(s.player);Ne.folderNameAndTitle(c,s.player,s.playerTitle),function(){var n=En,o={};function e(e,t){e=e.controller.getValue();n.min=t(n.min,e),o.min.setValue(n.min),n.max&&(n.max=t(n.max,e),Pn(),o.max.setValue(n.max)),r()}o.folder=c.addFolder(""!==n.name?n.name:s.time),o.scaleController=o.folder.add(new De(e,{settings:d.settings,getLanguageCode:i.getLanguageCode})).onChange(function(e){n.zoomMultiplier=e,r()});var t=new Be(function(n){e(t,function(e,t){return e+=n})},{settings:d.settings,getLanguageCode:i.getLanguageCode});o.positionController=o.folder.add(t).onChange(function(e){n.offset=e,r()}),o.min=Ne.controllerZeroStep(o.folder,n,"min",function(e){r()}),Ne.controllerNameAndTitle(o.min,s.min),Rn(),null!==n.max?(o.max=Ne.controllerZeroStep(o.folder,n,"max",function(e){r()}),Ne.controllerNameAndTitle(o.max,s.max)):(o.dt=Ne.controllerZeroStep(o.folder,n,"dt",function(e){r()}),Ne.controllerNameAndTitle(o.dt,s.dt,s.dtTitle)),n.marks&&(o.marks=o.folder.add(n,"marks").onChange(function(e){n.marks=parseInt(n.marks),r();var t=f();t&&(t.max=En.marks-1)}),Ne.controllerNameAndTitle(o.marks,void 0===n.marksName?s.marks:n.marksName,(void 0===n.marksTitle?s:n).marksTitle)),o.interval=o.folder.add(d.settings,"interval",1,25,1).onChange(function(e){r()}),Ne.controllerNameAndTitle(o.interval,s.interval,s.intervalTitle),Ne.controllerNameAndTitle(o.folder.add({defaultF:function(){n.zoomMultiplier=a.zoomMultiplier,o.scaleController.setValue(n.zoomMultiplier),n.offset=a.offset,o.positionController.setValue(n.offset),n.min=a.min,o.min.setValue(n.min),o.max&&(n.max=a.max,Pn(),o.max.setValue(n.max)),o.dt&&(n.dt=a.dt,o.dt.setValue(n.dt)),a.marks&&(n.marks=a.marks,o.marks&&o.marks.setValue(n.marks)),n.interval=a.interval,o.interval.setValue(n.interval),r()}},"defaultF"),s.defaultButton,s.defaultTitle)}()},this.createCanvasMenuItem=function(o){var e=this,t=(l=o).menu;t.push({name:xn.prevSymbol,title:xn.prevSymbolTitle,onclick:function(){e.prev()}}),t.push({name:xn.playSymbol,title:xn.playTitle,id:"menuButtonPlay",onclick:function(){e.play3DObject()}}),null!==En.max&&t.push({name:xn.repeat,title:this.getOptions().repeat?xn.repeatOff:xn.repeatOn,id:"menuButtonRepeat",onclick:function(){e.repeat()}}),t.push({name:xn.nextSymbol,title:xn.nextSymbolTitle,onclick:function(){e.next()}}),s.push({onRenamePlayButtons:function(e){var t,n=e?(t=xn.pause,xn.pauseTitle):(t=xn.playSymbol,xn.playTitle),e=o.querySelector("#menuButtonPlay");e.innerHTML=t,e.title=n},onChangeRepeat:function(){o.querySelector("#menuButtonRepeat").title=En.repeat?xn.repeatOff:xn.repeatOn}})},this.addSlider=function(){null!==En.max&&l.menu.push({name:'<input type="range" min="0" max="'+(On.getSettings().marks-1)+'" value="0" class="slider" id="sliderPosition">',style:"float: right;"})},this.addSliderEvents=function(){var t,n,o=f();return o&&(o.onchange=function(e){n.selectScene(parseInt(o.value))},o.oninput=function(e){n.selectScene(parseInt(o.value))},n=this,o.addEventListener("pointerdown",function(e){t=!0}),o.addEventListener("pointerup",function(e){t=!1}),o.addEventListener("mousemove",function(e){t&&n.selectScene((En.marks-1)*e.offsetX/o.clientWidth)})),o},this.setIndex=function(e,t){this.PlayController&&this.PlayController.setValue(this.getTime());var n=f();n&&(n.value=e,n.title=t)},this.onChangeScale=function(e){f().max=e.marks-1,this.selectScene(0)},Tn=!0)):console.error("Call Player.setTHREE(THREE) first.")}function Pn(){null===En.max?En.dt=En.dt||.1:En.dt=(En.max-En.min)/(En.marks-1)}function Rn(){null!==En.max&&(En.max=En.min+En.dt*(En.marks-1))}function Ln(){(En=En||{}).min=En.min||0,En.max===1/0&&(En.max=null),null!==En.max?(void 0===En.max&&(En.max=1),En.marks=En.marks||10):En.marks=null,Pn(),En.repeat=En.repeat||!1,En.interval=En.interval||1,En.zoomMultiplier=En.zoomMultiplier||1.1,En.offset=En.offset||.1,En.name=En.name||""}On.isCreated=function(){return Tn},On.cameraTarget=new function(){var t={boLook:!1},n={boLook:t.boLook};t.rotation={};var o,i=!(n.rotation={}),e=!1;function r(e){void 0!==(e=e||t).boLook?n.boLook=e.boLook:n.boLook=t.boLook,n.camera=e.camera||t.camera,n.distanceToCamera=e.distanceToCamera||t.distanceToCamera||n.distanceToCamera||(new An.Vector3).copy(t.camera.position),e.rotation||(e.rotation={}),n.rotation.angle=e.rotation.angle||t.rotation.angle||0,n.rotation.axis=e.rotation.axis||t.rotation.axis||new An.Vector3(0,1,0)}this.get=function(){if(n.camera||e||!On.player||(t.camera=On.player.getOptions().cameraTarget.camera,t.camera&&r(),e=!0),n.camera)return n},this.init=function(e){if(!1!==e.bodefault){if(i)return;void 0!==e.boLook&&(t.boLook=e.boLook,o=e.boLook)}else{if(!0!==e.boLook)return;i&&console.warn("playerCameraTarget().init(...): duplicate target point"),i=!0,void 0===o&&(t.boLook=!0)}t.camera=t.camera||e.camera,t.camera?(t.distanceToCamera=t.distanceToCamera||e.distanceToCamera,e.rotation=e.rotation||{},t.rotation.angle=t.rotation.angle||e.rotation.angle,t.rotation.axis=t.rotation.axis||e.rotation.axis,r(e)):console.error("playerCameraTarget().init(...): cameraTargetDefault.camera = "+t.camera)},this.setTarget=function(e){if(e.geometry)if(void 0!==An){var t=e.userData.player.arrayFuncs;if(void 0!==t)for(var n=0;n<t.length;n++){t[n];On.cameraTarget.changeTarget(e,n)}}else console.error("Call Player.setTHREE(THREE) first.")},this.changeTarget=function(e,t){var n,o;void 0!==An?(n=On.cameraTarget.get(),(o=e.userData.player.arrayFuncs[t]).cameraTarget||(o.cameraTarget={boLook:!1}),r(o.cameraTarget),n&&n.boLook?(e=it(e,(new An.Vector3).fromArray(e.geometry.attributes.position.array,t*e.geometry.attributes.position.itemSize)),n.target=e):delete n.target):console.error("Call Player.setTHREE(THREE) first.")},this.setCameraTarget=function(n){var e,t,o,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];void 0!==An?(o=(o=On.cameraTarget.get())||o||{},(n=n||o.camera)&&(o.distanceToCamera||(o.distanceToCamera=(new An.Vector3).copy(n.position)),o.distanceToCameraCur||(o.distanceToCameraCur=new An.Vector3),e=On.getTime(),t=o.distanceToCamera,o.distanceToCameraCur.set(On.execFunc(t,"x",e),On.execFunc(t,"y",e),On.execFunc(t,"z",e)),o.setCameraPosition&&!i||(o.setCameraPosition=function(){var e,t=o.target;On.cameraGui&&!On.cameraGui.isLook()||!t||(e=On.getTime(),n.position.copy(o.distanceToCameraCur),n.position.applyAxisAngle(o.rotation.axis,On.execFunc(o.rotation,"angle",e)),n.position.add(t),n.lookAt(t),On.orbitControls&&(On.orbitControls.target.copy(t),On.orbitControlsGui&&On.orbitControlsGui.setTarget(t)))}))):console.error("Call Player.setTHREE(THREE) first.")}},On.execFunc=function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=e[t],a=void 0===r?"undefined":ne(r);switch(void 0===n&&(n=En.min),a){case"undefined":return;case"string":r=new Function("t","a","b","return "+r);case"function":try{var s=r(n,o,i);if(void 0===s)throw"function returns "+s;return s}catch(e){throw console.error(e),e}case"number":return r;case"object":if(Array.isArray(r)){var l=function(e){return"function"==typeof c[e]?c[e](n,c,i):c[e]instanceof An.Color?c[e]:void 0};if(0===r.length)return void console.error('Player.execFunc: funcs["'+t+'"] array is empty');for(var c=r,d=r.length-1,u=null===En.max?1/0:En.max,p=En.min,f=(u-p)/d,h=p,m=u,_=0,g=d,b=0;b<r.length;b++)f*b+p<n&&(h=f*(_=b)+p,m=f*(g=b+1)+p);if("number"!=typeof c[_]){if("w"===t)return l(_);if("object"!==ne(c[_]))return void console.error('Player.execFunc: funcs["'+t+'"] array item '+_+" typeof = "+ne(c[_])+" is not number");for(b=0;b<r.length;b++){if(b===r.length-1)return c[b].v;if(g=(_=b)+1,h=c[_].t,m=c[g].t,h<=n&&n<m){var v=(c[g].v-c[_].v)/(m-h),y=c[_].v-v*h;return v*n+y}}return void console.error("Player.execFunc: value is not detected")}if(g>=r.length&&(g=_),"number"!=typeof c[g]){if("w"===t)return l(g);if("object"!==ne(c[g]))return void console.error('Player.execFunc: funcs["'+t+'"] array item '+g+" typeof = "+ne(c[g])+" is not number")}v=(c[g]-c[_])/(m-h),y=c[_]-v*h;return(isNaN(v)||isNaN(y))&&console.error("Player.execFunc: invalid x = "+v+" or y = "+y),v*n+y}return r.func?r.func instanceof Function?r.func(n,o,i):r.func:("w"!==t&&console.error('Player.execFunc: funcs["'+t+'"] object is not array'),r);default:console.error('Player.execFunc: Invalud typeof funcs["'+t+'"]: '+a)}},new function(){var e;this.get=function(){return Sn&&Sn.palette?Sn.palette:e=e||new et.palette}},On.selectMeshPlayScene=function(f,h,e,m){var t;void 0!==An?(void 0===h&&(h=On.getSettings().min),(m=m||Sn||{}).scales=m.scales||{},!f.userData.player||m&&m.boPlayer&&f.userData.boFrustumPoints||(f.geometry&&(delete f.geometry.boundingSphere,f.geometry.boundingSphere=null),f.userData.player.selectPlayScene&&(t=function(e){for(;f.rotation[e]<0;)f.rotation[e]+=2*Math.PI;for(;f.rotation[e]>2*Math.PI;)f.rotation[e]-=2*Math.PI},f.userData.player.selectPlayScene(h),t("x"),t("y"),t("z")),function(n,i){if(f.geometry){var r,a,s=f.geometry.attributes,l=f.userData.player.arrayFuncs;if(void 0!==l){void 0===h&&console.error("setPosition: t = "+h),m&&void 0!==m.scales.w?(r=m.scales.w.min,a=m.scales.w.max):r=(a=u)-1;for(var c,d,u,p=0;p<l.length;p++)!function(){function e(e,t){e=On.execFunc(c,e,h,n,i);void 0!==e&&(s.position[t](p,e),d=!0)}c=l[p],d=!1,e("x","setX"),e("y","setY"),e("z","setZ");var o=void 0;function t(){if(f.userData.player.palette)o=f.userData.player.palette.toColor(u,r,a);else{if(!m.palette){var e=255,t=255,n=255;return o=new An.Color("rgb("+e+", "+t+", "+n+")")}o=m.palette.toColor(u,r,a)}}"function"==typeof c.w?(u=c.w(h,n,i),a=m.scales.w?(r=m.scales.w.min,m.scales.w.max):(r=0,100),4<=s.position.itemSize&&s.position.setW(p,u),d=!0,t()):"object"===ne(c.w)?c.w instanceof An.Color?o=c.w:(u=c.w.func(h,n,i),"undefined"!==c.w.min&&(r=c.w.min),"undefined"!==c.w.max&&(a=c.w.max),t()):"number"==typeof c.w&&m.palette&&(o=m.palette.toColor(c.w,r,a)),o&&(!f.material instanceof An.ShaderMaterial&&f.material.vertexColors!==An.VertexColors&&console.error("Player.selectPlayScene: Please set the vertexColors parameter of the THREE.PointsMaterial of your points to THREE.VertexColors. Example: vertexColors: THREE.VertexColors"),!On.setColorAttribute(s,p,o)&&c instanceof An.Vector4&&(f.geometry.setAttribute("color",new An.Float32BufferAttribute(On.getColors(l,{positions:f.geometry.attributes.position,scale:{min:r,max:a},palette:m.palette}),4)),On.setColorAttribute(s,p,o)||console.error('Player.selectPlayScene: the color attribute is not exists. Please use THREE.Vector3 instead THREE.Vector4 in the arrayFuncs or add "color" attribute'))),d&&(s.position.needsUpdate=!0),void 0!==c.line&&c.line.addPoint(f,p,o),c.cameraTarget&&!0===c.cameraTarget.boLook&&On.cameraTarget.changeTarget(f,p)}()}}}(m?m.a:1,m?m.b:0),t="Player.selectPlayScene: invalid mesh.scale.",f.scale.x<=0&&console.error(t+"x = "+f.scale.x),f.scale.y<=0&&console.error(t+"y = "+f.scale.y),f.scale.z<=0&&console.error(t+"z = "+f.scale.z),m&&m.guiSelectPoint&&(m.guiSelectPoint.setMesh(),-1!==(t=m.guiSelectPoint.getSelectedPointIndex())&&m.guiSelectPoint.isSelectedMesh(f)&&m.guiSelectPoint.setPosition(rt(f,t),{object:f,index:t})))):console.error("Call Player.setTHREE(THREE) first.")},On.setColorAttribute=function(e,t,n){"string"==typeof n&&(n=new An.Color(n));e=e.color||e.ca;return void 0!==e&&(e.setX(t,n.r),e.setY(t,n.g),e.setZ(t,n.b),e.needsUpdate=!0)},On.getPoints=function(t,n){if(void 0!==An){nt.setTHREE(An),void 0===(n=n||{}).t&&(n.t=n.options?n.options.player.player.getOptions().settings.min:0);for(var o=n.options||{},i=o.a||1,r=o.b||0,a=0;a<t.length;a++){var e=t[a];Array.isArray(e)?t[a]=new An.Vector4(void 0===e[0]?0:e[0],void 0===e[1]?0:e[1],void 0===e[2]?0:e[2],void 0===e[3]?0:e[3]):"object"===(void 0===e?"undefined":ne(e))&&e instanceof An.Vector2==!1&&e instanceof An.Vector3==!1&&e instanceof An.Vector4==!1&&(void 0===e.vector?t[a]=new An.Vector4(void 0===e.x?0:e.x,void 0===e.y?0:e.y,void 0===e.z?0:e.z,void 0===e.w?0:e.w):e.vector instanceof An.Vector2==!0||e.vector instanceof An.Vector3==!0||e.vector instanceof An.Vector4==!0?e.vector instanceof An.Vector2==!0&&(t[a].vector=new An.Vector3(void 0===e.vector.x?0:e.vector.x,void 0===e.vector.y?0:e.vector.y,void 0===e.vector.z?0:e.vector.z)):4===e.vector.length?t[a].vector=new An.Vector4(void 0===e.vector[0]?0:e.vector[0],void 0===e.vector[1]?0:e.vector[1],void 0===e.vector[2]?0:e.vector[2],void 0===e.vector[3]?0:e.vector[3]):3===e.vector.length?t[a].vector=new An.Vector3(void 0===e.vector[0]?0:e.vector[0],void 0===e.vector[1]?0:e.vector[1],void 0===e.vector[2]?0:e.vector[2]):console.error("options.getPoints(...) falied! item.vector.length = "+e.vector.length))}for(var s=[],a=0;a<t.length;a++){var l=function(e){return"number"==typeof c&&(c=new An.Vector4(c,0,0,0)),c instanceof An.Vector2||c instanceof An.Vector3||c instanceof An.Vector4?On.execFunc(c,e,n.t,i,r):void 0!==c.vector?(void 0!==c.name&&(c.vector.name=c.name),c.trace&&(c.vector.line=new On.traceLine(o)),c.cameraTarget&&(c.vector.cameraTarget=c.cameraTarget,delete c.cameraTarget,c.vector.cameraTarget.bodefault=!1,void 0===c.vector.cameraTarget.boLook&&(c.vector.cameraTarget.boLook=!0),On.cameraTarget.init(c.vector.cameraTarget)),t[a]=c.vector,c=c.vector,On.execFunc(c,e,n.t,i,r)):void console.error("options.getPoints: funcs.vector = "+c.vector)},c=t[a],l=c.vector instanceof An.Vector3==!0?new An.Vector3(l("x"),l("y"),l("z")):new An.Vector4(l("x"),l("y"),l("z"),l("w"));c.w,s.push(l)}return s}console.error("Call Player.setTHREE(THREE) first.")},On.getColors=function(e,o){if(void 0!==An){if(et.palette.setTHREE(An),void 0!==(o=o||{}).positions&&Array.isArray(e)&&e.length!==o.positions.count)return console.error("getColors failed! arrayFuncs.length: "+e.length+" != positions.count: "+o.positions.count),o.colors;var t=Array.isArray(e)?e.length:o.positions.count;if(o.colors=o.colors||[],!o.palette){for(var i=0;i<t;i++)o.colors.push(1,1,1,1);return o.colors}for(i=0;i<t;i++){var n,r,a,s=Array.isArray(e)?e[i]:void 0;if(s instanceof An.Vector4||o.positions&&4===o.positions.itemSize){var l=void 0,c=void 0,d=s.w;if(s.w instanceof Object&&s.w.func?(s.w.max&&(c=s.w.max),s.w.min&&(l=s.w.min),d=s.w.func):void 0!==o.scale?(l=o.scale.min,c=o.scale.max):s instanceof An.Vector4&&"function"==typeof s.w&&(c=100,l=0),d instanceof Function&&!En)return console.error("Player.getColors: remove all functions from all THREE.Vector4.w items of the arrayFuncs."),console.error(" \tOr create Player."),void console.error("\tIf you use MyPoints for create of the points, please add Player: Player into settings parameter of the MyPoints function after creating of the Player.");c=o.palette.toColor(void 0===s?(new An.Vector4).fromBufferAttribute(o.positions,i).w:d instanceof Function?d(En.min):d,l,c);o.colors.push(c.r,c.g,c.b)}else o.colors instanceof An.Float32BufferAttribute?n=new An.Vector3(1,1,1):o.colors.push(1,1,1);void 0!==o.opacity?(r=0,a=getStandardNormalDistribution(0),group.children.forEach(function(e){if(e.userData.cloud)for(var t=0;t<e.geometry.attributes.position.count;t++){var n=rt(e,t);r+=getStandardNormalDistribution(5*it(camera,(new An.Vector3).fromBufferAttribute(o.positions,i)).distanceTo(n))/a}}),void 0!==debug.opacity&&(r=debug.opacity),o.colors instanceof An.Float32BufferAttribute?o.colors.setXYZW(i,n.x,n.y,n.z,r):o.colors.push(r)):o.colors.push(1)}return o.colors}console.error("Call Player.setTHREE(THREE) first.")},On.traceLine=function(c){if(void 0!==An){if(!En)return console.error("Player.traceLine: Remove all trace: true from arrayFunc parameter of the MyPoints or getShaderMaterialPoints method."),console.error("\tOr call Player(...)."),void console.error("\tIf you use getShaderMaterialPoints or MyPoints for create of the points, please add Player: Player into settings parameter of the getShaderMaterialPoints or MyPoints method after creating of the Player.");var d,u=[];this.addPoint=function(e,t,n){var o=e.geometry.attributes.position,i=4<=o.itemSize?new An.Vector4(0,0,0,0):new An.Vector3;i.fromArray(o.array,t*o.itemSize);var r=On.getSelectSceneIndex();if(null===En.max){if((r=Math.abs(r))<u.length-1){for(;r<u.length-1;)e.remove(u[u.length-1]),u.pop();return}var a=new An.BufferGeometry,s=new Float32Array(6);a.setAttribute("position",new An.BufferAttribute(s,3));s=new Float32Array(6);a.setAttribute("color",new An.Float32BufferAttribute(s,3));s=new An.Line(a,new An.LineBasicMaterial({vertexColors:An.VertexColors}));e.add(s),u[0]&&(s.visible=u[0].visible),i=(new An.Vector3).copy(i);a=s.geometry.attributes.position.itemSize;return i.toArray(s.geometry.attributes.position.array,+a),(0===u.length?i:(new An.Vector3).fromArray(u[u.length-1].geometry.attributes.position.array,+a)).toArray(s.geometry.attributes.position.array,0*a),s.geometry.attributes.position.needsUpdate=!0,void 0===n&&(n=new An.Color(1,1,1)),On.setColorAttribute(s.geometry.attributes,0,0===u.length?n:(new An.Color).fromArray(u[u.length-1].geometry.attributes.color.array,+a)),On.setColorAttribute(s.geometry.attributes,1,n),void u.push(s)}if(void 0===d){a=new An.BufferGeometry;if(null!==En.max)if(En&&En.marks)l=En.marks;else{if(!c.player||!c.player.marks)return void console.error("Player.traceLine: MAX_POINTS = "+l+". Create Player first or remove all trace = true from all items of the arrayFuncs");l=c.player.marks}else l=r+1;s=new Float32Array(3*l);a.setAttribute("position",new An.BufferAttribute(s,3));var l=new Float32Array(3*l);a.setAttribute("color",new An.Float32BufferAttribute(l,3)),a.setDrawRange(r,r),(d=new An.Line(a,new An.LineBasicMaterial({vertexColors:An.VertexColors}))).visible=!0,e.add(d)}d.geometry&&(delete d.geometry.boundingSphere,d.geometry.boundingSphere=null),(i=(new An.Vector3).copy(i)).toArray(d.geometry.attributes.position.array,r*d.geometry.attributes.position.itemSize),d.geometry.attributes.position.needsUpdate=!0,void 0===n&&(n=new An.Color(1,1,1)),On.setColorAttribute(d.geometry.attributes,r,n);i=d.geometry.drawRange.start,n=r+1-i;r<i&&(n=i+d.geometry.drawRange.count-(i=r)),d.geometry.setDrawRange(i,n)},this.visible=function(t){d?d.visible=t:u.forEach(function(e){e.visible=t})},this.isVisible=function(){return(d||u[0]).visible},this.remove=function(){void 0!==d&&(d.geometry.dispose(),d.material.dispose(),group.remove(d))}}else console.error("Call Player.setTHREE(THREE) first.")},On.getSettings=function(){return En||Ln(),En},On.getSelectSceneIndex=function(){return On.player?On.player.getSelectSceneIndex():0},On.getTime=function(){return On.player?On.player.getTime():0},On.getItemSize=function(e){if(void 0!==An){for(var t=0;t<e.length;t++)if(e[t]instanceof An.Vector4)return 4;return 3}console.error("Call Player.setTHREE(THREE) first.")},On.setTHREE=function(e){An?Object.is(An,e)||console.error("Player.setTHREE: duplicate THREE. Please use one instance of the THREE library."):(An||(An=e,Object.assign(An.BufferGeometry.prototype,{setFromPoints:function(e,t){t=t||3;for(var n=[],o=0,i=e.length;o<i;o++){var r=e[o];n.push(r.x,r.y,r.z||0),4<=t&&n.push(r.w||0)}return this.setAttribute("position",new An.Float32BufferAttribute(n,t)),this}}),Object.assign(An.Vector4.prototype,{multiply:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,void 0!==e.w&&(this.w*=e.w),this}}),Object.assign(An.Vector4.prototype,{add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,void 0!==e.w&&(this.w+=e.w),this)}})),Object.assign(An.Points.prototype,{raycast:function(e,t){var n=new An.Matrix4,l=new An.Ray,o=new An.Sphere,i=new An.Vector3;function r(e,t,n,o,i,r,a){var s=l.distanceSqToPoint(e);s<n&&(n=new An.Vector3,l.closestPointToPoint(e,n),n.applyMatrix4(o),(o=i.ray.origin.distanceTo(n))<i.near||o>i.far||r.push({distance:o,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,object:a}))}var a=this.geometry,s=this.matrixWorld,c=e.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),o.copy(a.boundingSphere),o.applyMatrix4(s),o.radius+=c,!1!==e.ray.intersectsSphere(o)){n.copy(s).invert(),l.copy(e.ray).applyMatrix4(n);var n=c/((this.scale.x+this.scale.y+this.scale.z)/3),d=n*n;if(a.isBufferGeometry){var c=a.index,n=a.attributes,u=n.position.array,p=n.position.itemSize;if(null!==c)for(var f=c.array,h=0,m=f.length;h<m;h++){var _=f[h];i.fromArray(u,_*p),r(i,_,d,s,e,t,this)}else for(var g=0,b=u.length/p;g<b;g++)i.fromArray(u,g*p),r(i,g,d,s,e,t,this)}else for(var v=a.vertices,y=0,w=v.length;y<w;y++)r(v[y],y,d,s,e,t,this)}}}))},e.default=On,Object.defineProperty(e,"__esModule",{value:!0})});
