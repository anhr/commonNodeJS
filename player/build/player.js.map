{"version":3,"file":"player.js","sources":["../../cookieNodeJS/index.js","../../cookieNodeJS/cookie.js","../../dat/dat.gui.module.js","../../dat/dat.module.js","../../UpDownController.js","../../ScaleController.js","../../PositionController.js","../../loadFileNodeJS/index.js","../../loadScriptNodeJS/index.js","../../loadScriptNodeJS/loadScript.js","../../colorpicker/index.js","../../colorpicker/colorpicker.js","../../functionsFolder.js","../../guiSelectPoint/guiSelectPoint.js","../../dat.gui/CustomController/build/dat.gui.module.js","../../lang.js","../../controllerPlay/index.js","../../CameraGui.js","../player.js"],"sourcesContent":["/**\r\n * @module cookie\r\n * @description node.js version of the cookie.\r\n * Cookies let you store user information in web pages.\r\n * @see {@link https://www.w3schools.com/js/js_cookies.asp}\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nexport { isEnabled, set, setObject, get, getObject, copyObject, remove, defaultCookie };\r\n\r\n/**\r\n * Is the cookie enabled in your web browser?\r\n * @returns {boolean} true if cookie enabled\r\n * \r\n * @example\r\n\tvar isCookieEnabled = cookie.isEnabled('age', 25);\r\n */\r\nfunction isEnabled() {\r\n\r\n\treturn navigator.cookieEnabled;\r\n\t//Enable cookie\r\n\t//Chrome: Settings/Show advanced settings.../Privacy/Content settings.../Cookies/Allow local data to be set\r\n\r\n}\r\n\r\n/**\r\n * Set a cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} value cookie value.\r\n * @param {Date} [cookie_date] expiry date (in UTC time). Optional.\r\n * @example\r\n\tcookie.set('age', 25);\r\n */\r\nfunction set( name, value, cookie_date ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\tvalue = value.toString();\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tif ( cookie_date === undefined ) {\r\n\r\n\t\tcookie_date = new Date();  // Curent date and time\r\n\t\tcookie_date.setTime( cookie_date.getTime() + 1000 * 60 * 60 * 24 * 365 );//expiry date is one year\r\n\r\n\t}\r\n\tdocument.cookie = name + \"=\" + value + ( ( typeof settings == 'undefined' ) ? '' : settings ) + \"; expires=\" + cookie_date.toGMTString();\r\n\tif ( document.cookie === '' )\r\n\t\tconsole.error( 'document.cookie is empty' );\r\n\r\n}\r\n\r\n/**\r\n * sets an object into cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} object an object for saving into cookie\r\n */\r\nfunction setObject( name, object ) {\r\n\r\n\tset( name, JSON.stringify( object ) );\r\n\r\n};\r\n\r\n/**\r\n * Get a cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} [defaultValue] cookie default value. Optional.\r\n * @returns {string} cookie value or defaultValue if cookie was not found.\r\n * @example\r\n\tvar age = cookie.get('age', 25);\r\n */\r\nfunction get( name, defaultValue ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tvar results = document.cookie.match( '(^|;) ?' + name + '=([^;]*)(;|$)' );\r\n\r\n\tif ( results )\r\n\t\treturn ( unescape( results[2] ) );\r\n\tif ( typeof defaultValue == 'undefined' )\r\n\t\treturn '';\r\n\treturn defaultValue;\r\n\r\n}\r\n\r\n/**\r\n * gets an object from cookie.\r\n * @param {string} name name of the object\r\n * @param {any} options load an object from cookie into options\r\n * @param {Object} optionsDefault copy to options this default object if named object is not exists in the cookie.\r\n */\r\nfunction getObject( name, options, optionsDefault ) {\r\n\r\n//\tnew defaultCookie().getObject( name, options, JSON.parse( get( name, JSON.stringify( optionsDefault ) ) ) );\r\n\tnew defaultCookie().getObject( name, options, copyObject( name, optionsDefault ) );\r\n\r\n};\r\n\r\n/**\r\n * gets an object from cookie and returns a copy of object.\r\n * @param {string} name name of the object\r\n * @param {Object} objectDefault copy to options this default object if named object is not exists in the cookie.\r\n * @returns copy of object from cookie\r\n */\r\nfunction copyObject( name, objectDefault ) {\r\n\r\n\treturn JSON.parse( get( name, JSON.stringify( objectDefault ) ) );\r\n\r\n}\r\n\r\n/**\r\n * Remove cookie\r\n * @param {string} name cookie name.\r\n */\r\nfunction remove( name ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tvar cookie_date = new Date();  // ������� ���� � �����\r\n\tcookie_date.setTime( cookie_date.getTime() - 1 );\r\n\tdocument.cookie = name += \"=; expires=\" + cookie_date.toGMTString();\r\n\r\n}\r\n\r\nfunction consoleCookieEnabled() {\r\n\r\n\tconsole.error( 'navigator.cookieEnabled = ' + navigator.cookieEnabled );\r\n\r\n}\r\n\r\n/**\r\n * Default cookie is not saving settings\r\n * @param {any} name is not using\r\n */\r\nfunction defaultCookie( name ) {\r\n\r\n\t/**\r\n\t * Default cookie is not loading settings\r\n\t * @param {any} defaultValue\r\n\t * @returns defaultValue\r\n\t */\r\n\tthis.get = function ( defaultValue ) {\r\n\r\n\t\treturn defaultValue;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * Default cookie is not saving settings\r\n\t */\r\n\tthis.set = function () {\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * Default cookie is not loading objects\r\n\t * @param {string} name is not using\r\n\t * @param {any} options load an object from optionsDefault into options\r\n\t * @param {Object} optionsDefault source object\r\n\t */\r\n\tthis.getObject = function ( name, options, optionsDefault ) {\r\n\r\n\t\t// \r\n\t\tif ( !optionsDefault )\r\n\t\t\treturn;//object's settings is not saving\r\n\t\tObject.keys( optionsDefault ).forEach( function ( key ) {\r\n\r\n\t\t\t//I cannot modify options[key] if optionsDefault is read only and options[key] is not copy of optionsDefault[key]\r\n\t\t\t//options[key] = optionsDefault[key];\r\n\t\t\t//copy key\r\n\t\t\tvar option = optionsDefault[key];\r\n\t\t\tif ( option !== undefined )\r\n\t\t\t\toptions[key] = JSON.parse( JSON.stringify( option ) );\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * copy and returns an object from objectDefault\r\n\t * @param {string} name is not using\r\n\t * @param {any} objectDefault source object\r\n\t */\r\n\tthis.copyObject = function ( name, objectDefault ){\r\n\r\n\t\treturn JSON.parse( JSON.stringify( objectDefault ) );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Default cookie is not saving object's settings\r\n\t */\r\n\tthis.setObject = function () {\r\n\r\n\t};\r\n\r\n\tthis.isTrue = function ( defaultValue ) {\r\n\r\n\t\treturn defaultValue;\r\n\r\n\t};\r\n\r\n};\r\n","﻿/**\r\n * node.js version of the cookie.\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\nimport { set as setCookie, get as getCookie, getObject, copyObject, setObject, defaultCookie } from './index.js';\r\nvar cookie = {\r\n\r\n\tset: setCookie,\r\n\tsetObject: setObject,\r\n\tget: getCookie,\r\n\tgetObject: getObject,\r\n\tcopyObject: copyObject,\r\n\tdefaultCookie: defaultCookie,\r\n\r\n}\r\n\r\nexport default cookie;","/**\r\n * dat-gui JavaScript Controller Library\r\n * http://code.google.com/p/dat-gui\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nfunction ___$insertStyle(css) {\r\n  if (!css) {\r\n    return;\r\n  }\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  var style = document.createElement('style');\r\n\r\n  style.setAttribute('type', 'text/css');\r\n  style.innerHTML = css;\r\n  document.head.appendChild(style);\r\n\r\n  return css;\r\n}\r\n\r\nfunction colorToString (color, forceCSSHex) {\r\n  var colorFormat = color.__state.conversionName.toString();\r\n  var r = Math.round(color.r);\r\n  var g = Math.round(color.g);\r\n  var b = Math.round(color.b);\r\n  var a = color.a;\r\n  var h = Math.round(color.h);\r\n  var s = color.s.toFixed(1);\r\n  var v = color.v.toFixed(1);\r\n  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\r\n    var str = color.hex.toString(16);\r\n    while (str.length < 6) {\r\n      str = '0' + str;\r\n    }\r\n    return '#' + str;\r\n  } else if (colorFormat === 'CSS_RGB') {\r\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n  } else if (colorFormat === 'CSS_RGBA') {\r\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\r\n  } else if (colorFormat === 'HEX') {\r\n    return '0x' + color.hex.toString(16);\r\n  } else if (colorFormat === 'RGB_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ']';\r\n  } else if (colorFormat === 'RGBA_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\r\n  } else if (colorFormat === 'RGB_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\r\n  } else if (colorFormat === 'RGBA_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\r\n  } else if (colorFormat === 'HSV_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\r\n  } else if (colorFormat === 'HSVA_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\r\n  }\r\n  return 'unknown format';\r\n}\r\n\r\nvar ARR_EACH = Array.prototype.forEach;\r\nvar ARR_SLICE = Array.prototype.slice;\r\nvar Common = {\r\n  BREAK: {},\r\n  extend: function extend(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (!this.isUndefined(obj[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  defaults: function defaults(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (this.isUndefined(target[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  compose: function compose() {\r\n    var toCall = ARR_SLICE.call(arguments);\r\n    return function () {\r\n      var args = ARR_SLICE.call(arguments);\r\n      for (var i = toCall.length - 1; i >= 0; i--) {\r\n        args = [toCall[i].apply(this, args)];\r\n      }\r\n      return args[0];\r\n    };\r\n  },\r\n  each: function each(obj, itr, scope) {\r\n    if (!obj) {\r\n      return;\r\n    }\r\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\r\n      obj.forEach(itr, scope);\r\n    } else if (obj.length === obj.length + 0) {\r\n      var key = void 0;\r\n      var l = void 0;\r\n      for (key = 0, l = obj.length; key < l; key++) {\r\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    } else {\r\n      for (var _key in obj) {\r\n        if (itr.call(scope, obj[_key], _key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  defer: function defer(fnc) {\r\n    setTimeout(fnc, 0);\r\n  },\r\n  debounce: function debounce(func, threshold, callImmediately) {\r\n    var timeout = void 0;\r\n    return function () {\r\n      var obj = this;\r\n      var args = arguments;\r\n      function delayed() {\r\n        timeout = null;\r\n        if (!callImmediately) func.apply(obj, args);\r\n      }\r\n      var callNow = callImmediately || !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(delayed, threshold);\r\n      if (callNow) {\r\n        func.apply(obj, args);\r\n      }\r\n    };\r\n  },\r\n  toArray: function toArray(obj) {\r\n    if (obj.toArray) return obj.toArray();\r\n    return ARR_SLICE.call(obj);\r\n  },\r\n  isUndefined: function isUndefined(obj) {\r\n    return obj === undefined;\r\n  },\r\n  isNull: function isNull(obj) {\r\n    return obj === null;\r\n  },\r\n  isNaN: function (_isNaN) {\r\n    function isNaN(_x) {\r\n      return _isNaN.apply(this, arguments);\r\n    }\r\n    isNaN.toString = function () {\r\n      return _isNaN.toString();\r\n    };\r\n    return isNaN;\r\n  }(function (obj) {\r\n    return isNaN(obj);\r\n  }),\r\n  isArray: Array.isArray || function (obj) {\r\n    return obj.constructor === Array;\r\n  },\r\n  isObject: function isObject(obj) {\r\n    return obj === Object(obj);\r\n  },\r\n  isNumber: function isNumber(obj) {\r\n    return obj === obj + 0;\r\n  },\r\n  isString: function isString(obj) {\r\n    return obj === obj + '';\r\n  },\r\n  isBoolean: function isBoolean(obj) {\r\n    return obj === false || obj === true;\r\n  },\r\n  isFunction: function isFunction(obj) {\r\n    return Object.prototype.toString.call(obj) === '[object Function]';\r\n  }\r\n};\r\n\r\nvar INTERPRETATIONS = [\r\n{\r\n  litmus: Common.isString,\r\n  conversions: {\r\n    THREE_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    SIX_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9]{6})$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGB: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3])\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGBA: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3]),\r\n          a: parseFloat(test[4])\r\n        };\r\n      },\r\n      write: colorToString\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isNumber,\r\n  conversions: {\r\n    HEX: {\r\n      read: function read(original) {\r\n        return {\r\n          space: 'HEX',\r\n          hex: original,\r\n          conversionName: 'HEX'\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return color.hex;\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isArray,\r\n  conversions: {\r\n    RGB_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 3) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b];\r\n      }\r\n    },\r\n    RGBA_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 4) return false;\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2],\r\n          a: original[3]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b, color.a];\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isObject,\r\n  conversions: {\r\n    RGBA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    RGB_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b\r\n        };\r\n      }\r\n    },\r\n    HSVA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    HSV_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v\r\n        };\r\n      }\r\n    }\r\n  }\r\n}];\r\nvar result = void 0;\r\nvar toReturn = void 0;\r\nvar interpret = function interpret() {\r\n  toReturn = false;\r\n  var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\r\n  Common.each(INTERPRETATIONS, function (family) {\r\n    if (family.litmus(original)) {\r\n      Common.each(family.conversions, function (conversion, conversionName) {\r\n        result = conversion.read(original);\r\n        if (toReturn === false && result !== false) {\r\n          toReturn = result;\r\n          result.conversionName = conversionName;\r\n          result.conversion = conversion;\r\n          return Common.BREAK;\r\n        }\r\n      });\r\n      return Common.BREAK;\r\n    }\r\n  });\r\n  return toReturn;\r\n};\r\n\r\nvar tmpComponent = void 0;\r\nvar ColorMath = {\r\n  hsv_to_rgb: function hsv_to_rgb(h, s, v) {\r\n    var hi = Math.floor(h / 60) % 6;\r\n    var f = h / 60 - Math.floor(h / 60);\r\n    var p = v * (1.0 - s);\r\n    var q = v * (1.0 - f * s);\r\n    var t = v * (1.0 - (1.0 - f) * s);\r\n    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\r\n    return {\r\n      r: c[0] * 255,\r\n      g: c[1] * 255,\r\n      b: c[2] * 255\r\n    };\r\n  },\r\n  rgb_to_hsv: function rgb_to_hsv(r, g, b) {\r\n    var min = Math.min(r, g, b);\r\n    var max = Math.max(r, g, b);\r\n    var delta = max - min;\r\n    var h = void 0;\r\n    var s = void 0;\r\n    if (max !== 0) {\r\n      s = delta / max;\r\n    } else {\r\n      return {\r\n        h: NaN,\r\n        s: 0,\r\n        v: 0\r\n      };\r\n    }\r\n    if (r === max) {\r\n      h = (g - b) / delta;\r\n    } else if (g === max) {\r\n      h = 2 + (b - r) / delta;\r\n    } else {\r\n      h = 4 + (r - g) / delta;\r\n    }\r\n    h /= 6;\r\n    if (h < 0) {\r\n      h += 1;\r\n    }\r\n    return {\r\n      h: h * 360,\r\n      s: s,\r\n      v: max / 255\r\n    };\r\n  },\r\n  rgb_to_hex: function rgb_to_hex(r, g, b) {\r\n    var hex = this.hex_with_component(0, 2, r);\r\n    hex = this.hex_with_component(hex, 1, g);\r\n    hex = this.hex_with_component(hex, 0, b);\r\n    return hex;\r\n  },\r\n  component_from_hex: function component_from_hex(hex, componentIndex) {\r\n    return hex >> componentIndex * 8 & 0xFF;\r\n  },\r\n  hex_with_component: function hex_with_component(hex, componentIndex, value) {\r\n    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\r\n  }\r\n};\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\r\n  return typeof obj;\r\n} : function (obj) {\r\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar get = function get(object, property, receiver) {\r\n  if (object === null) object = Function.prototype;\r\n  var desc = Object.getOwnPropertyDescriptor(object, property);\r\n\r\n  if (desc === undefined) {\r\n    var parent = Object.getPrototypeOf(object);\r\n\r\n    if (parent === null) {\r\n      return undefined;\r\n    } else {\r\n      return get(parent, property, receiver);\r\n    }\r\n  } else if (\"value\" in desc) {\r\n    return desc.value;\r\n  } else {\r\n    var getter = desc.get;\r\n\r\n    if (getter === undefined) {\r\n      return undefined;\r\n    }\r\n\r\n    return getter.call(receiver);\r\n  }\r\n};\r\n\r\nvar inherits = function (subClass, superClass) {\r\n  if (typeof superClass !== \"function\" && superClass !== null) {\r\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\r\n  }\r\n\r\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n    constructor: {\r\n      value: subClass,\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true\r\n    }\r\n  });\r\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar possibleConstructorReturn = function (self, call) {\r\n  if (!self) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n\r\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\r\n};\r\n\r\nvar Color = function () {\r\n  function Color() {\r\n    classCallCheck(this, Color);\r\n    this.__state = interpret.apply(this, arguments);\r\n    if (this.__state === false) {\r\n      throw new Error('Failed to interpret color arguments');\r\n    }\r\n    this.__state.a = this.__state.a || 1;\r\n  }\r\n  createClass(Color, [{\r\n    key: 'toString',\r\n    value: function toString() {\r\n      return colorToString(this);\r\n    }\r\n  }, {\r\n    key: 'toHexString',\r\n    value: function toHexString() {\r\n      return colorToString(this, true);\r\n    }\r\n  }, {\r\n    key: 'toOriginal',\r\n    value: function toOriginal() {\r\n      return this.__state.conversion.write(this);\r\n    }\r\n  }]);\r\n  return Color;\r\n}();\r\nfunction defineRGBComponent(target, component, componentHexIndex) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'RGB') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateRGB(this, component, componentHexIndex);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'RGB') {\r\n        Color.recalculateRGB(this, component, componentHexIndex);\r\n        this.__state.space = 'RGB';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nfunction defineHSVComponent(target, component) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'HSV') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateHSV(this);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'HSV') {\r\n        Color.recalculateHSV(this);\r\n        this.__state.space = 'HSV';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nColor.recalculateRGB = function (color, component, componentHexIndex) {\r\n  if (color.__state.space === 'HEX') {\r\n    color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\r\n  } else if (color.__state.space === 'HSV') {\r\n    Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\r\n  } else {\r\n    throw new Error('Corrupted color state');\r\n  }\r\n};\r\nColor.recalculateHSV = function (color) {\r\n  var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\r\n  Common.extend(color.__state, {\r\n    s: result.s,\r\n    v: result.v\r\n  });\r\n  if (!Common.isNaN(result.h)) {\r\n    color.__state.h = result.h;\r\n  } else if (Common.isUndefined(color.__state.h)) {\r\n    color.__state.h = 0;\r\n  }\r\n};\r\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\r\ndefineRGBComponent(Color.prototype, 'r', 2);\r\ndefineRGBComponent(Color.prototype, 'g', 1);\r\ndefineRGBComponent(Color.prototype, 'b', 0);\r\ndefineHSVComponent(Color.prototype, 'h');\r\ndefineHSVComponent(Color.prototype, 's');\r\ndefineHSVComponent(Color.prototype, 'v');\r\nObject.defineProperty(Color.prototype, 'a', {\r\n  get: function get$$1() {\r\n    return this.__state.a;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.a = v;\r\n  }\r\n});\r\nObject.defineProperty(Color.prototype, 'hex', {\r\n  get: function get$$1() {\r\n    if (!this.__state.space !== 'HEX') {\r\n      this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\r\n    }\r\n    return this.__state.hex;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.space = 'HEX';\r\n    this.__state.hex = v;\r\n  }\r\n});\r\n\r\nvar Controller = function () {\r\n  function Controller(object, property) {\r\n    classCallCheck(this, Controller);\r\n    this.initialValue = object[property];\r\n    this.domElement = document.createElement('div');\r\n    this.object = object;\r\n    this.property = property;\r\n    this.__onChange = undefined;\r\n    this.__onFinishChange = undefined;\r\n  }\r\n  createClass(Controller, [{\r\n    key: 'onChange',\r\n    value: function onChange(fnc) {\r\n      this.__onChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'onFinishChange',\r\n    value: function onFinishChange(fnc) {\r\n      this.__onFinishChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'setValue',\r\n    value: function setValue(newValue) {\r\n      this.object[this.property] = newValue;\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this, newValue);\r\n      }\r\n      this.updateDisplay();\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'getValue',\r\n    value: function getValue() {\r\n      return this.object[this.property];\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'isModified',\r\n    value: function isModified() {\r\n      return this.initialValue !== this.getValue();\r\n    }\r\n  }]);\r\n  return Controller;\r\n}();\r\n\r\nvar EVENT_MAP = {\r\n  HTMLEvents: ['change'],\r\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\r\n  KeyboardEvents: ['keydown']\r\n};\r\nvar EVENT_MAP_INV = {};\r\nCommon.each(EVENT_MAP, function (v, k) {\r\n  Common.each(v, function (e) {\r\n    EVENT_MAP_INV[e] = k;\r\n  });\r\n});\r\nvar CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\r\nfunction cssValueToPixels(val) {\r\n  if (val === '0' || Common.isUndefined(val)) {\r\n    return 0;\r\n  }\r\n  var match = val.match(CSS_VALUE_PIXELS);\r\n  if (!Common.isNull(match)) {\r\n    return parseFloat(match[1]);\r\n  }\r\n  return 0;\r\n}\r\nvar dom = {\r\n  makeSelectable: function makeSelectable(elem, selectable) {\r\n    if (elem === undefined || elem.style === undefined) return;\r\n    elem.onselectstart = selectable ? function () {\r\n      return false;\r\n    } : function () {};\r\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\r\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\r\n    elem.unselectable = selectable ? 'on' : 'off';\r\n  },\r\n  makeFullscreen: function makeFullscreen(elem, hor, vert) {\r\n    var vertical = vert;\r\n    var horizontal = hor;\r\n    if (Common.isUndefined(horizontal)) {\r\n      horizontal = true;\r\n    }\r\n    if (Common.isUndefined(vertical)) {\r\n      vertical = true;\r\n    }\r\n    elem.style.position = 'absolute';\r\n    if (horizontal) {\r\n      elem.style.left = 0;\r\n      elem.style.right = 0;\r\n    }\r\n    if (vertical) {\r\n      elem.style.top = 0;\r\n      elem.style.bottom = 0;\r\n    }\r\n  },\r\n  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\r\n    var params = pars || {};\r\n    var className = EVENT_MAP_INV[eventType];\r\n    if (!className) {\r\n      throw new Error('Event type ' + eventType + ' not supported.');\r\n    }\r\n    var evt = document.createEvent(className);\r\n    switch (className) {\r\n      case 'MouseEvents':\r\n        {\r\n          var clientX = params.x || params.clientX || 0;\r\n          var clientY = params.y || params.clientY || 0;\r\n          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0,\r\n          0,\r\n          clientX,\r\n          clientY,\r\n          false, false, false, false, 0, null);\r\n          break;\r\n        }\r\n      case 'KeyboardEvents':\r\n        {\r\n          var init = evt.initKeyboardEvent || evt.initKeyEvent;\r\n          Common.defaults(params, {\r\n            cancelable: true,\r\n            ctrlKey: false,\r\n            altKey: false,\r\n            shiftKey: false,\r\n            metaKey: false,\r\n            keyCode: undefined,\r\n            charCode: undefined\r\n          });\r\n          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\r\n          break;\r\n        }\r\n      default:\r\n        {\r\n          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\r\n          break;\r\n        }\r\n    }\r\n    Common.defaults(evt, aux);\r\n    elem.dispatchEvent(evt);\r\n  },\r\n  bind: function bind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.addEventListener) {\r\n      elem.addEventListener(event, func, bool);\r\n    } else if (elem.attachEvent) {\r\n      elem.attachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  unbind: function unbind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.removeEventListener) {\r\n      elem.removeEventListener(event, func, bool);\r\n    } else if (elem.detachEvent) {\r\n      elem.detachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  addClass: function addClass(elem, className) {\r\n    if (elem.className === undefined) {\r\n      elem.className = className;\r\n    } else if (elem.className !== className) {\r\n      var classes = elem.className.split(/ +/);\r\n      if (classes.indexOf(className) === -1) {\r\n        classes.push(className);\r\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n      }\r\n    }\r\n    return dom;\r\n  },\r\n  removeClass: function removeClass(elem, className) {\r\n    if (className) {\r\n      if (elem.className === className) {\r\n        elem.removeAttribute('class');\r\n      } else {\r\n        var classes = elem.className.split(/ +/);\r\n        var index = classes.indexOf(className);\r\n        if (index !== -1) {\r\n          classes.splice(index, 1);\r\n          elem.className = classes.join(' ');\r\n        }\r\n      }\r\n    } else {\r\n      elem.className = undefined;\r\n    }\r\n    return dom;\r\n  },\r\n  hasClass: function hasClass(elem, className) {\r\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\r\n  },\r\n  getWidth: function getWidth(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\r\n  },\r\n  getHeight: function getHeight(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\r\n  },\r\n  getOffset: function getOffset(el) {\r\n    var elem = el;\r\n    var offset = { left: 0, top: 0 };\r\n    if (elem.offsetParent) {\r\n      do {\r\n        offset.left += elem.offsetLeft;\r\n        offset.top += elem.offsetTop;\r\n        elem = elem.offsetParent;\r\n      } while (elem);\r\n    }\r\n    return offset;\r\n  },\r\n  isActive: function isActive(elem) {\r\n    return elem === document.activeElement && (elem.type || elem.href);\r\n  }\r\n};\r\n\r\nvar BooleanController = function (_Controller) {\r\n  inherits(BooleanController, _Controller);\r\n  function BooleanController(object, property) {\r\n    classCallCheck(this, BooleanController);\r\n    var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__prev = _this2.getValue();\r\n    _this2.__checkbox = document.createElement('input');\r\n    _this2.__checkbox.setAttribute('type', 'checkbox');\r\n    function onChange() {\r\n      _this.setValue(!_this.__prev);\r\n    }\r\n    dom.bind(_this2.__checkbox, 'change', onChange, false);\r\n    _this2.domElement.appendChild(_this2.__checkbox);\r\n    _this2.updateDisplay();\r\n    return _this2;\r\n  }\r\n  createClass(BooleanController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      this.__prev = this.getValue();\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (this.getValue() === true) {\r\n        this.__checkbox.setAttribute('checked', 'checked');\r\n        this.__checkbox.checked = true;\r\n        this.__prev = true;\r\n      } else {\r\n        this.__checkbox.checked = false;\r\n        this.__prev = false;\r\n      }\r\n      return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return BooleanController;\r\n}(Controller);\r\n\r\nvar OptionController = function (_Controller) {\r\n  inherits(OptionController, _Controller);\r\n  function OptionController(object, property, opts) {\r\n    classCallCheck(this, OptionController);\r\n    var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\r\n    var options = opts;\r\n    var _this = _this2;\r\n    _this2.__select = document.createElement('select');\r\n    if (Common.isArray(options)) {\r\n      var map = {};\r\n      Common.each(options, function (element) {\r\n        map[element] = element;\r\n      });\r\n      options = map;\r\n    }\r\n    Common.each(options, function (value, key) {\r\n      var opt = document.createElement('option');\r\n      opt.innerHTML = key;\r\n      opt.setAttribute('value', value);\r\n      _this.__select.appendChild(opt);\r\n    });\r\n    _this2.updateDisplay();\r\n    dom.bind(_this2.__select, 'change', function () {\r\n      var desiredValue = this.options[this.selectedIndex].value;\r\n      _this.setValue(desiredValue);\r\n    });\r\n    _this2.domElement.appendChild(_this2.__select);\r\n    return _this2;\r\n  }\r\n  createClass(OptionController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (dom.isActive(this.__select)) return this;\r\n      this.__select.value = this.getValue();\r\n      return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return OptionController;\r\n}(Controller);\r\n\r\nvar StringController = function (_Controller) {\r\n  inherits(StringController, _Controller);\r\n  function StringController(object, property) {\r\n    classCallCheck(this, StringController);\r\n    var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\r\n    var _this = _this2;\r\n    function onChange() {\r\n      _this.setValue(_this.__input.value);\r\n    }\r\n    function onBlur() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'keyup', onChange);\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        this.blur();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(StringController, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (!dom.isActive(this.__input)) {\r\n        this.__input.value = this.getValue();\r\n      }\r\n      return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return StringController;\r\n}(Controller);\r\n\r\nfunction numDecimals(x) {\r\n  var _x = x.toString();\r\n  if (_x.indexOf('.') > -1) {\r\n    return _x.length - _x.indexOf('.') - 1;\r\n  }\r\n  return 0;\r\n}\r\nvar NumberController = function (_Controller) {\r\n  inherits(NumberController, _Controller);\r\n  function NumberController(object, property, params) {\r\n    classCallCheck(this, NumberController);\r\n    var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\r\n    var _params = params || {};\r\n    _this.__min = _params.min;\r\n    _this.__max = _params.max;\r\n    _this.__step = _params.step;\r\n    if (Common.isUndefined(_this.__step)) {\r\n      if (_this.initialValue === 0) {\r\n        _this.__impliedStep = 1;\r\n      } else {\r\n        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\r\n      }\r\n    } else {\r\n      _this.__impliedStep = _this.__step;\r\n    }\r\n    _this.__precision = numDecimals(_this.__impliedStep);\r\n    return _this;\r\n  }\r\n  createClass(NumberController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var _v = v;\r\n      if (this.__min !== undefined && _v < this.__min) {\r\n        _v = this.__min;\r\n      } else if (this.__max !== undefined && _v > this.__max) {\r\n        _v = this.__max;\r\n      }\r\n      if (this.__step !== undefined && _v % this.__step !== 0) {\r\n        _v = Math.round(_v / this.__step) * this.__step;\r\n      }\r\n      return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\r\n    }\r\n  }, {\r\n    key: 'min',\r\n    value: function min(minValue) {\r\n      this.__min = minValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'max',\r\n    value: function max(maxValue) {\r\n      this.__max = maxValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'step',\r\n    value: function step(stepValue) {\r\n      this.__step = stepValue;\r\n      this.__impliedStep = stepValue;\r\n      this.__precision = numDecimals(stepValue);\r\n      return this;\r\n    }\r\n  }]);\r\n  return NumberController;\r\n}(Controller);\r\n\r\nfunction roundToDecimal(value, decimals) {\r\n  var tenTo = Math.pow(10, decimals);\r\n  return Math.round(value * tenTo) / tenTo;\r\n}\r\nvar NumberControllerBox = function (_NumberController) {\r\n  inherits(NumberControllerBox, _NumberController);\r\n  function NumberControllerBox(object, property, params) {\r\n    classCallCheck(this, NumberControllerBox);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\r\n    _this2.__truncationSuspended = false;\r\n    var _this = _this2;\r\n    var prevY = void 0;\r\n    function onChange() {\r\n      var attempted = parseFloat(_this.__input.value);\r\n      if (!Common.isNaN(attempted)) {\r\n        _this.setValue(attempted);\r\n      }\r\n    }\r\n    function onFinish() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onBlur() {\r\n      onFinish();\r\n    }\r\n    function onMouseDrag(e) {\r\n      var diff = prevY - e.clientY;\r\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\r\n      prevY = e.clientY;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      onFinish();\r\n    }\r\n    function onMouseDown(e) {\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      prevY = e.clientY;\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        _this.__truncationSuspended = true;\r\n        this.blur();\r\n        _this.__truncationSuspended = false;\r\n        onFinish();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerBox, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\r\n      return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerBox;\r\n}(NumberController);\r\n\r\nfunction map(v, i1, i2, o1, o2) {\r\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\r\n}\r\nvar NumberControllerSlider = function (_NumberController) {\r\n  inherits(NumberControllerSlider, _NumberController);\r\n  function NumberControllerSlider(object, property, min, max, step) {\r\n    classCallCheck(this, NumberControllerSlider);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, { min: min, max: max, step: step }));\r\n    var _this = _this2;\r\n    _this2.__background = document.createElement('div');\r\n    _this2.__foreground = document.createElement('div');\r\n    dom.bind(_this2.__background, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__background, 'touchstart', onTouchStart);\r\n    dom.addClass(_this2.__background, 'slider');\r\n    dom.addClass(_this2.__foreground, 'slider-fg');\r\n    function onMouseDown(e) {\r\n      document.activeElement.blur();\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      onMouseDrag(e);\r\n    }\r\n    function onMouseDrag(e) {\r\n      e.preventDefault();\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n      return false;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onTouchStart(e) {\r\n      if (e.touches.length !== 1) {\r\n        return;\r\n      }\r\n      dom.bind(window, 'touchmove', onTouchMove);\r\n      dom.bind(window, 'touchend', onTouchEnd);\r\n      onTouchMove(e);\r\n    }\r\n    function onTouchMove(e) {\r\n      var clientX = e.touches[0].clientX;\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n    }\r\n    function onTouchEnd() {\r\n      dom.unbind(window, 'touchmove', onTouchMove);\r\n      dom.unbind(window, 'touchend', onTouchEnd);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.updateDisplay();\r\n    _this2.__background.appendChild(_this2.__foreground);\r\n    _this2.domElement.appendChild(_this2.__background);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerSlider, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\r\n      this.__foreground.style.width = pct * 100 + '%';\r\n      return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerSlider;\r\n}(NumberController);\r\n\r\nvar FunctionController = function (_Controller) {\r\n  inherits(FunctionController, _Controller);\r\n  function FunctionController(object, property, text) {\r\n    classCallCheck(this, FunctionController);\r\n    var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__button = document.createElement('div');\r\n    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\r\n    dom.bind(_this2.__button, 'click', function (e) {\r\n      e.preventDefault();\r\n      _this.fire();\r\n      return false;\r\n    });\r\n    dom.addClass(_this2.__button, 'button');\r\n    _this2.domElement.appendChild(_this2.__button);\r\n    return _this2;\r\n  }\r\n  createClass(FunctionController, [{\r\n    key: 'fire',\r\n    value: function fire() {\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this);\r\n      }\r\n      this.getValue().call(this.object);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n    }\r\n  }]);\r\n  return FunctionController;\r\n}(Controller);\r\n\r\nvar ColorController = function (_Controller) {\r\n    inherits(ColorController, _Controller);\r\n    function ColorController(object, property) {\r\n        classCallCheck(this, ColorController);\r\n        var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\r\n        _this2.__color = new Color(_this2.getValue());\r\n        _this2.__temp = new Color(0);\r\n        var _this = _this2;\r\n        _this2.domElement = document.createElement('div');\r\n        dom.makeSelectable(_this2.domElement, false);\r\n        _this2.__selector = document.createElement('div');\r\n        _this2.__selector.className = 'selector';\r\n        _this2.__saturation_field = document.createElement('div');\r\n        _this2.__saturation_field.className = 'saturation-field';\r\n        _this2.__field_knob = document.createElement('div');\r\n        _this2.__field_knob.className = 'field-knob';\r\n        _this2.__field_knob_border = '2px solid ';\r\n        _this2.__hue_knob = document.createElement('div');\r\n        _this2.__hue_knob.className = 'hue-knob';\r\n        _this2.__hue_field = document.createElement('div');\r\n        _this2.__hue_field.className = 'hue-field';\r\n        _this2.__input = document.createElement('input');\r\n        _this2.__input.type = 'text';\r\n        _this2.__input_textShadow = '0 1px 1px ';\r\n        dom.bind(_this2.__input, 'keydown', function (e) {\r\n            if (e.keyCode === 13) {\r\n                onBlur.call(this);\r\n            }\r\n        });\r\n        dom.bind(_this2.__input, 'blur', onBlur);\r\n        dom.bind(_this2.__selector, 'mousedown', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'mouseup', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        dom.bind(_this2.__selector, 'touchstart', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'touchend', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        var valueField = document.createElement('div');\r\n        Common.extend(_this2.__selector.style, {\r\n            width: '122px',\r\n            height: '102px',\r\n            padding: '3px',\r\n            backgroundColor: '#222',\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\r\n        });\r\n        Common.extend(_this2.__field_knob.style, {\r\n            position: 'absolute',\r\n            width: '12px',\r\n            height: '12px',\r\n            border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\r\n            borderRadius: '12px',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__hue_knob.style, {\r\n            position: 'absolute',\r\n            width: '15px',\r\n            height: '2px',\r\n            borderRight: '4px solid #fff',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__saturation_field.style, {\r\n            width: '100px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            marginRight: '3px',\r\n            display: 'inline-block',\r\n            cursor: 'pointer'\r\n        });\r\n        Common.extend(valueField.style, {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: 'none'\r\n        });\r\n        linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\r\n        Common.extend(_this2.__hue_field.style, {\r\n            width: '15px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            cursor: 'ns-resize',\r\n            position: 'absolute',\r\n            top: '3px',\r\n            right: '3px'\r\n        });\r\n        hueGradient(_this2.__hue_field);\r\n        Common.extend(_this2.__input.style, {\r\n            outline: 'none',\r\n            textAlign: 'center',\r\n            color: '#fff',\r\n            border: 0,\r\n            fontWeight: 'bold',\r\n            textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\r\n        });\r\n        dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\r\n        dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\r\n        function fieldDown(e) {\r\n            setSV(e);\r\n            dom.bind(window, 'mousemove', setSV);\r\n            dom.bind(window, 'touchmove', setSV);\r\n            dom.bind(window, 'mouseup', fieldUpSV);\r\n            dom.bind(window, 'touchend', fieldUpSV);\r\n        }\r\n        function fieldDownH(e) {\r\n            setH(e);\r\n            dom.bind(window, 'mousemove', setH);\r\n            dom.bind(window, 'touchmove', setH);\r\n            dom.bind(window, 'mouseup', fieldUpH);\r\n            dom.bind(window, 'touchend', fieldUpH);\r\n        }\r\n        function fieldUpSV() {\r\n            dom.unbind(window, 'mousemove', setSV);\r\n            dom.unbind(window, 'touchmove', setSV);\r\n            dom.unbind(window, 'mouseup', fieldUpSV);\r\n            dom.unbind(window, 'touchend', fieldUpSV);\r\n            onFinish();\r\n        }\r\n        function fieldUpH() {\r\n            dom.unbind(window, 'mousemove', setH);\r\n            dom.unbind(window, 'touchmove', setH);\r\n            dom.unbind(window, 'mouseup', fieldUpH);\r\n            dom.unbind(window, 'touchend', fieldUpH);\r\n            onFinish();\r\n        }\r\n        function onBlur() {\r\n            var i = interpret(this.value);\r\n            if (i !== false) {\r\n                _this.__color.__state = i;\r\n                _this.setValue(_this.__color.toOriginal());\r\n            } else {\r\n                this.value = _this.__color.toString();\r\n            }\r\n        }\r\n        function onFinish() {\r\n            if (_this.__onFinishChange) {\r\n                _this.__onFinishChange.call(_this, _this.__color.toOriginal());\r\n            }\r\n        }\r\n        _this2.__saturation_field.appendChild(valueField);\r\n        _this2.__selector.appendChild(_this2.__field_knob);\r\n        _this2.__selector.appendChild(_this2.__saturation_field);\r\n        _this2.__selector.appendChild(_this2.__hue_field);\r\n        _this2.__hue_field.appendChild(_this2.__hue_knob);\r\n        _this2.domElement.appendChild(_this2.__input);\r\n        _this2.domElement.appendChild(_this2.__selector);\r\n        _this2.updateDisplay();\r\n        function setSV(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__saturation_field.getBoundingClientRect();\r\n            var _ref = e.touches && e.touches[0] || e,\r\n                clientX = _ref.clientX,\r\n                clientY = _ref.clientY;\r\n            var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\r\n            var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (v > 1) {\r\n                v = 1;\r\n            } else if (v < 0) {\r\n                v = 0;\r\n            }\r\n            if (s > 1) {\r\n                s = 1;\r\n            } else if (s < 0) {\r\n                s = 0;\r\n            }\r\n            _this.__color.v = v;\r\n            _this.__color.s = s;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        function setH(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__hue_field.getBoundingClientRect();\r\n            var _ref2 = e.touches && e.touches[0] || e,\r\n                clientY = _ref2.clientY;\r\n            var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (h > 1) {\r\n                h = 1;\r\n            } else if (h < 0) {\r\n                h = 0;\r\n            }\r\n            _this.__color.h = h * 360;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        return _this2;\r\n    }\r\n    createClass(ColorController, [{\r\n        key: 'updateDisplay',\r\n        value: function updateDisplay() {\r\n            var i = interpret(this.getValue());\r\n            if (i !== false) {\r\n                var mismatch = false;\r\n                Common.each(Color.COMPONENTS, function (component) {\r\n                    if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\r\n                        mismatch = true;\r\n                        return {};\r\n                    }\r\n                }, this);\r\n                if (mismatch) {\r\n                    Common.extend(this.__color.__state, i);\r\n                }\r\n            }\r\n            Common.extend(this.__temp.__state, this.__color.__state);\r\n            this.__temp.a = 1;\r\n            var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\r\n            var _flip = 255 - flip;\r\n            Common.extend(this.__field_knob.style, {\r\n                marginLeft: 100 * this.__color.s - 7 + 'px',\r\n                marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\r\n                backgroundColor: this.__temp.toHexString(),\r\n                border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\r\n            });\r\n            this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\r\n            this.__temp.s = 1;\r\n            this.__temp.v = 1;\r\n            linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\r\n            this.__input.value = this.__color.toString();\r\n            Common.extend(this.__input.style, {\r\n                backgroundColor: this.__color.toHexString(),\r\n                color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\r\n                textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\r\n            });\r\n        }\r\n    }]);\r\n    return ColorController;\r\n}(Controller);\r\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\r\nfunction linearGradient(elem, x, a, b) {\r\n    elem.style.background = '';\r\n    Common.each(vendors, function (vendor) {\r\n        elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\r\n    });\r\n}\r\nfunction hueGradient(elem) {\r\n    elem.style.background = '';\r\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\r\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n}\r\n\r\nvar ControllerFactory = function ControllerFactory(object, property) {\r\n  var initialValue = object[property];\r\n  if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\r\n    return new OptionController(object, property, arguments[2]);\r\n  }\r\n  if (Common.isNumber(initialValue)) {\r\n    if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\r\n      if (Common.isNumber(arguments[4])) {\r\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4]);\r\n      }\r\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\r\n    }\r\n    if (Common.isNumber(arguments[4])) {\r\n      return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });\r\n    }\r\n    return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\r\n  }\r\n  if (Common.isString(initialValue)) {\r\n    return new StringController(object, property);\r\n  }\r\n  if (Common.isFunction(initialValue)) {\r\n    return new FunctionController(object, property, '');\r\n  }\r\n  if (Common.isBoolean(initialValue)) {\r\n    return new BooleanController(object, property);\r\n  }\r\n  return null;\r\n};\r\n\r\nvar CustomController = function (_Controller) {\r\n  inherits(CustomController, _Controller);\r\n  function CustomController(object, property) {\r\n    classCallCheck(this, CustomController);\r\n    var _this = possibleConstructorReturn(this, (CustomController.__proto__ || Object.getPrototypeOf(CustomController)).call(this, object, property));\r\n    _this.arguments = {\r\n      object: object, property: property, opts: Array.prototype.slice.call(arguments, 2)\r\n    };\r\n    if (object.property) _this.property = object.property(_this);\r\n    return _this;\r\n  }\r\n  createClass(CustomController, [{\r\n    key: 'controller',\r\n    set: function set$$1(newController) {\r\n      this._controller = newController;\r\n    },\r\n    get: function get$$1() {\r\n      return this._controller;\r\n    }\r\n  }]);\r\n  return CustomController;\r\n}(Controller);\r\n\r\nvar css = {\r\n  load: function load(url, indoc) {\r\n    var doc = indoc || document;\r\n    var link = doc.createElement('link');\r\n    link.type = 'text/css';\r\n    link.rel = 'stylesheet';\r\n    link.href = url;\r\n    doc.getElementsByTagName('head')[0].appendChild(link);\r\n  },\r\n  inject: function inject(cssContent, indoc) {\r\n    var doc = indoc || document;\r\n    var injected = document.createElement('style');\r\n    injected.type = 'text/css';\r\n    injected.innerHTML = cssContent;\r\n    var head = doc.getElementsByTagName('head')[0];\r\n    try {\r\n      head.appendChild(injected);\r\n    } catch (e) {\r\n    }\r\n  }\r\n};\r\n\r\nvar saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\r\n\r\nfunction requestAnimationFrame(callback) {\r\n  setTimeout(callback, 1000 / 60);\r\n}\r\nvar requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\r\n\r\nvar CenteredDiv = function () {\r\n  function CenteredDiv() {\r\n    classCallCheck(this, CenteredDiv);\r\n    this.backgroundElement = document.createElement('div');\r\n    Common.extend(this.backgroundElement.style, {\r\n      backgroundColor: 'rgba(0,0,0,0.8)',\r\n      top: 0,\r\n      left: 0,\r\n      display: 'none',\r\n      zIndex: '1000',\r\n      opacity: 0,\r\n      WebkitTransition: 'opacity 0.2s linear',\r\n      transition: 'opacity 0.2s linear'\r\n    });\r\n    dom.makeFullscreen(this.backgroundElement);\r\n    this.backgroundElement.style.position = 'fixed';\r\n    this.domElement = document.createElement('div');\r\n    Common.extend(this.domElement.style, {\r\n      position: 'fixed',\r\n      display: 'none',\r\n      zIndex: '1001',\r\n      opacity: 0,\r\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\r\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\r\n    });\r\n    document.body.appendChild(this.backgroundElement);\r\n    document.body.appendChild(this.domElement);\r\n    var _this = this;\r\n    dom.bind(this.backgroundElement, 'click', function () {\r\n      _this.hide();\r\n    });\r\n  }\r\n  createClass(CenteredDiv, [{\r\n    key: 'show',\r\n    value: function show() {\r\n      var _this = this;\r\n      this.backgroundElement.style.display = 'block';\r\n      this.domElement.style.display = 'block';\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n      this.layout();\r\n      Common.defer(function () {\r\n        _this.backgroundElement.style.opacity = 1;\r\n        _this.domElement.style.opacity = 1;\r\n        _this.domElement.style.webkitTransform = 'scale(1)';\r\n      });\r\n    }\r\n  }, {\r\n    key: 'hide',\r\n    value: function hide() {\r\n      var _this = this;\r\n      var hide = function hide() {\r\n        _this.domElement.style.display = 'none';\r\n        _this.backgroundElement.style.display = 'none';\r\n        dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\r\n        dom.unbind(_this.domElement, 'transitionend', hide);\r\n        dom.unbind(_this.domElement, 'oTransitionEnd', hide);\r\n      };\r\n      dom.bind(this.domElement, 'webkitTransitionEnd', hide);\r\n      dom.bind(this.domElement, 'transitionend', hide);\r\n      dom.bind(this.domElement, 'oTransitionEnd', hide);\r\n      this.backgroundElement.style.opacity = 0;\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n    }\r\n  }, {\r\n    key: 'layout',\r\n    value: function layout() {\r\n      this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\r\n      this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\r\n    }\r\n  }]);\r\n  return CenteredDiv;\r\n}();\r\n\r\nvar styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\r\n\r\ncss.inject(styleSheet);\r\nvar CSS_NAMESPACE = 'dg';\r\nvar HIDE_KEY_CODE = 72;\r\nvar CLOSE_BUTTON_HEIGHT = 20;\r\nvar DEFAULT_DEFAULT_PRESET_NAME = 'Default';\r\nvar SUPPORTS_LOCAL_STORAGE = function () {\r\n  try {\r\n    return !!window.localStorage;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}();\r\nvar SAVE_DIALOGUE = void 0;\r\nvar autoPlaceVirgin = true;\r\nvar autoPlaceContainer = void 0;\r\nvar hide = false;\r\nvar hideableGuis = [];\r\nvar GUI = function GUI(pars) {\r\n  var _this = this;\r\n  var params = pars || {};\r\n  this.domElement = document.createElement('div');\r\n  this.__ul = document.createElement('ul');\r\n  this.domElement.appendChild(this.__ul);\r\n  dom.addClass(this.domElement, CSS_NAMESPACE);\r\n  this.__folders = {};\r\n  this.__controllers = [];\r\n  this.__rememberedObjects = [];\r\n  this.__rememberedObjectIndecesToControllers = [];\r\n  this.__listening = [];\r\n  params = Common.defaults(params, {\r\n    closeOnTop: false,\r\n    autoPlace: true,\r\n    width: GUI.DEFAULT_WIDTH\r\n  });\r\n  params = Common.defaults(params, {\r\n    resizable: params.autoPlace,\r\n    hideable: params.autoPlace\r\n  });\r\n  if (!Common.isUndefined(params.load)) {\r\n    if (params.preset) {\r\n      params.load.preset = params.preset;\r\n    }\r\n  } else {\r\n    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\r\n  }\r\n  if (Common.isUndefined(params.parent) && params.hideable) {\r\n    hideableGuis.push(this);\r\n  }\r\n  params.resizable = Common.isUndefined(params.parent) && params.resizable;\r\n  if (params.autoPlace && Common.isUndefined(params.scrollable)) {\r\n    params.scrollable = true;\r\n  }\r\n  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\r\n  var saveToLocalStorage = void 0;\r\n  var titleRow = void 0;\r\n  Object.defineProperties(this,\r\n  {\r\n    parent: {\r\n      get: function get$$1() {\r\n        return params.parent;\r\n      }\r\n    },\r\n    scrollable: {\r\n      get: function get$$1() {\r\n        return params.scrollable;\r\n      }\r\n    },\r\n    autoPlace: {\r\n      get: function get$$1() {\r\n        return params.autoPlace;\r\n      }\r\n    },\r\n    closeOnTop: {\r\n      get: function get$$1() {\r\n        return params.closeOnTop;\r\n      }\r\n    },\r\n    preset: {\r\n      get: function get$$1() {\r\n        if (_this.parent) {\r\n          return _this.getRoot().preset;\r\n        }\r\n        return params.load.preset;\r\n      },\r\n      set: function set$$1(v) {\r\n        if (_this.parent) {\r\n          _this.getRoot().preset = v;\r\n        } else {\r\n          params.load.preset = v;\r\n        }\r\n        setPresetSelectIndex(this);\r\n        _this.revert();\r\n      }\r\n    },\r\n    width: {\r\n      get: function get$$1() {\r\n        return params.width;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.width = v;\r\n        setWidth(_this, v);\r\n      }\r\n    },\r\n    name: {\r\n      get: function get$$1() {\r\n        return params.name;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.name = v;\r\n        if (titleRow) {\r\n          titleRow.innerHTML = params.name;\r\n        }\r\n      }\r\n    },\r\n    closed: {\r\n      get: function get$$1() {\r\n        return params.closed;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.closed = v;\r\n        if (params.closed) {\r\n          dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        } else {\r\n          dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        }\r\n        this.onResize();\r\n        if (_this.__closeButton) {\r\n          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\r\n        }\r\n      }\r\n    },\r\n    load: {\r\n      get: function get$$1() {\r\n        return params.load;\r\n      }\r\n    },\r\n    useLocalStorage: {\r\n      get: function get$$1() {\r\n        return useLocalStorage;\r\n      },\r\n      set: function set$$1(bool) {\r\n        if (SUPPORTS_LOCAL_STORAGE) {\r\n          useLocalStorage = bool;\r\n          if (bool) {\r\n            dom.bind(window, 'unload', saveToLocalStorage);\r\n          } else {\r\n            dom.unbind(window, 'unload', saveToLocalStorage);\r\n          }\r\n          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\r\n        }\r\n      }\r\n    }\r\n  });\r\n  if (Common.isUndefined(params.parent)) {\r\n    this.closed = params.closed || false;\r\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\r\n    dom.makeSelectable(this.domElement, false);\r\n    if (SUPPORTS_LOCAL_STORAGE) {\r\n      if (useLocalStorage) {\r\n        _this.useLocalStorage = true;\r\n        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\r\n        if (savedGui) {\r\n          params.load = JSON.parse(savedGui);\r\n        }\r\n      }\r\n    }\r\n    this.__closeButton = document.createElement('div');\r\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\r\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\r\n    if (params.closeOnTop) {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\r\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\r\n    } else {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\r\n      this.domElement.appendChild(this.__closeButton);\r\n    }\r\n    dom.bind(this.__closeButton, 'click', function () {\r\n      _this.closed = !_this.closed;\r\n    });\r\n  } else {\r\n    if (params.closed === undefined) {\r\n      params.closed = true;\r\n    }\r\n    var titleRowName = document.createTextNode(params.name);\r\n    dom.addClass(titleRowName, 'controller-name');\r\n    titleRow = addRow(_this, titleRowName);\r\n    var onClickTitle = function onClickTitle(e) {\r\n      e.preventDefault();\r\n      _this.closed = !_this.closed;\r\n      return false;\r\n    };\r\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\r\n    dom.addClass(titleRow, 'title');\r\n    dom.bind(titleRow, 'click', onClickTitle);\r\n    if (!params.closed) {\r\n      this.closed = false;\r\n    }\r\n  }\r\n  if (params.autoPlace) {\r\n    if (Common.isUndefined(params.parent)) {\r\n      if (autoPlaceVirgin) {\r\n        autoPlaceContainer = document.createElement('div');\r\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\r\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\r\n        document.body.appendChild(autoPlaceContainer);\r\n        autoPlaceVirgin = false;\r\n      }\r\n      autoPlaceContainer.appendChild(this.domElement);\r\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\r\n    }\r\n    if (!this.parent) {\r\n      setWidth(_this, params.width);\r\n    }\r\n  }\r\n  this.__resizeHandler = function () {\r\n    _this.onResizeDebounced();\r\n  };\r\n  dom.bind(window, 'resize', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\r\n  this.onResize();\r\n  if (params.resizable) {\r\n    addResizeHandle(this);\r\n  }\r\n  saveToLocalStorage = function saveToLocalStorage() {\r\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\r\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\r\n    }\r\n  };\r\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\r\n  function resetWidth() {\r\n    var root = _this.getRoot();\r\n    root.width += 1;\r\n    Common.defer(function () {\r\n      root.width -= 1;\r\n    });\r\n  }\r\n  if (!params.parent) {\r\n    resetWidth();\r\n  }\r\n};\r\nGUI.toggleHide = function () {\r\n  hide = !hide;\r\n  Common.each(hideableGuis, function (gui) {\r\n    gui.domElement.style.display = hide ? 'none' : '';\r\n  });\r\n};\r\nGUI.CLASS_AUTO_PLACE = 'a';\r\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\r\nGUI.CLASS_MAIN = 'main';\r\nGUI.CLASS_CONTROLLER_ROW = 'cr';\r\nGUI.CLASS_TOO_TALL = 'taller-than-window';\r\nGUI.CLASS_CLOSED = 'closed';\r\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\r\nGUI.CLASS_CLOSE_TOP = 'close-top';\r\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\r\nGUI.CLASS_DRAG = 'drag';\r\nGUI.DEFAULT_WIDTH = 245;\r\nGUI.TEXT_CLOSED = 'Close Controls';\r\nGUI.TEXT_OPEN = 'Open Controls';\r\nGUI._keydownHandler = function (e) {\r\n  if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\r\n    GUI.toggleHide();\r\n  }\r\n};\r\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\r\nCommon.extend(GUI.prototype,\r\n{\r\n  add: function add(object, property) {\r\n    return _add(this, object, property, {\r\n      factoryArgs: Array.prototype.slice.call(arguments, 2)\r\n    });\r\n  },\r\n  addColor: function addColor(object, property) {\r\n    return _add(this, object, property, {\r\n      color: true\r\n    });\r\n  },\r\n  remove: function remove(controller) {\r\n    this.__ul.removeChild(controller.__li);\r\n    this.__controllers.splice(this.__controllers.indexOf(controller), 1);\r\n    var _this = this;\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  destroy: function destroy() {\r\n    if (this.parent) {\r\n      throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\r\n    }\r\n    if (this.autoPlace) {\r\n      autoPlaceContainer.removeChild(this.domElement);\r\n    }\r\n    var _this = this;\r\n    Common.each(this.__folders, function (subfolder) {\r\n      _this.removeFolder(subfolder);\r\n    });\r\n    dom.unbind(window, 'keydown', GUI._keydownHandler, false);\r\n    removeListeners(this);\r\n  },\r\n  addFolder: function addFolder(name) {\r\n    if (this.__folders[name] !== undefined) {\r\n      throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\r\n    }\r\n    var newGuiParams = { name: name, parent: this };\r\n    newGuiParams.autoPlace = this.autoPlace;\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[name]) {\r\n      newGuiParams.closed = this.load.folders[name].closed;\r\n      newGuiParams.load = this.load.folders[name];\r\n    }\r\n    var gui = new GUI(newGuiParams);\r\n    this.__folders[name] = gui;\r\n    var li = addRow(this, gui.domElement);\r\n    dom.addClass(li, 'folder');\r\n    return gui;\r\n  },\r\n  removeFolder: function removeFolder(folder) {\r\n    this.__ul.removeChild(folder.domElement.parentElement);\r\n    delete this.__folders[folder.name];\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[folder.name]) {\r\n      delete this.load.folders[folder.name];\r\n    }\r\n    removeListeners(folder);\r\n    var _this = this;\r\n    Common.each(folder.__folders, function (subfolder) {\r\n      folder.removeFolder(subfolder);\r\n    });\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  open: function open() {\r\n    this.closed = false;\r\n  },\r\n  close: function close() {\r\n    this.closed = true;\r\n  },\r\n  hide: function hide() {\r\n    this.domElement.style.display = 'none';\r\n  },\r\n  show: function show() {\r\n    this.domElement.style.display = '';\r\n  },\r\n  onResize: function onResize() {\r\n    var root = this.getRoot();\r\n    if (root.scrollable) {\r\n      var top = dom.getOffset(root.__ul).top;\r\n      var h = 0;\r\n      Common.each(root.__ul.childNodes, function (node) {\r\n        if (!(root.autoPlace && node === root.__save_row)) {\r\n          h += dom.getHeight(node);\r\n        }\r\n      });\r\n      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\r\n        dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\r\n      } else {\r\n        dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = 'auto';\r\n      }\r\n    }\r\n    if (root.__resize_handle) {\r\n      Common.defer(function () {\r\n        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\r\n      });\r\n    }\r\n    if (root.__closeButton) {\r\n      root.__closeButton.style.width = root.width + 'px';\r\n    }\r\n  },\r\n  onResizeDebounced: Common.debounce(function () {\r\n    this.onResize();\r\n  }, 50),\r\n  remember: function remember() {\r\n    if (Common.isUndefined(SAVE_DIALOGUE)) {\r\n      SAVE_DIALOGUE = new CenteredDiv();\r\n      SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\r\n    }\r\n    if (this.parent) {\r\n      throw new Error('You can only call remember on a top level GUI.');\r\n    }\r\n    var _this = this;\r\n    Common.each(Array.prototype.slice.call(arguments), function (object) {\r\n      if (_this.__rememberedObjects.length === 0) {\r\n        addSaveMenu(_this);\r\n      }\r\n      if (_this.__rememberedObjects.indexOf(object) === -1) {\r\n        _this.__rememberedObjects.push(object);\r\n      }\r\n    });\r\n    if (this.autoPlace) {\r\n      setWidth(this, this.width);\r\n    }\r\n  },\r\n  getRoot: function getRoot() {\r\n    var gui = this;\r\n    while (gui.parent) {\r\n      gui = gui.parent;\r\n    }\r\n    return gui;\r\n  },\r\n  getSaveObject: function getSaveObject() {\r\n    var toReturn = this.load;\r\n    toReturn.closed = this.closed;\r\n    if (this.__rememberedObjects.length > 0) {\r\n      toReturn.preset = this.preset;\r\n      if (!toReturn.remembered) {\r\n        toReturn.remembered = {};\r\n      }\r\n      toReturn.remembered[this.preset] = getCurrentPreset(this);\r\n    }\r\n    toReturn.folders = {};\r\n    Common.each(this.__folders, function (element, key) {\r\n      toReturn.folders[key] = element.getSaveObject();\r\n    });\r\n    return toReturn;\r\n  },\r\n  save: function save() {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n    }\r\n    this.load.remembered[this.preset] = getCurrentPreset(this);\r\n    markPresetModified(this, false);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  saveAs: function saveAs(presetName) {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\r\n    }\r\n    this.load.remembered[presetName] = getCurrentPreset(this);\r\n    this.preset = presetName;\r\n    addPresetOption(this, presetName, true);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  revert: function revert(gui) {\r\n    Common.each(this.__controllers, function (controller) {\r\n      if (!this.getRoot().load.remembered) {\r\n        controller.setValue(controller.initialValue);\r\n      } else {\r\n        recallSavedValue(gui || this.getRoot(), controller);\r\n      }\r\n      if (controller.__onFinishChange) {\r\n        controller.__onFinishChange.call(controller, controller.getValue());\r\n      }\r\n    }, this);\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.revert(folder);\r\n    });\r\n    if (!gui) {\r\n      markPresetModified(this.getRoot(), false);\r\n    }\r\n  },\r\n  listen: function listen(controller) {\r\n    var init = this.__listening.length === 0;\r\n    this.__listening.push(controller);\r\n    if (init) {\r\n      updateDisplays(this.__listening);\r\n    }\r\n  },\r\n  updateDisplay: function updateDisplay() {\r\n    Common.each(this.__controllers, function (controller) {\r\n      controller.updateDisplay();\r\n    });\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.updateDisplay();\r\n    });\r\n  }\r\n});\r\nfunction addRow(gui, newDom, liBefore) {\r\n  var li = document.createElement('li');\r\n  if (newDom) {\r\n    li.appendChild(newDom);\r\n  }\r\n  if (liBefore) {\r\n    gui.__ul.insertBefore(li, liBefore);\r\n  } else {\r\n    gui.__ul.appendChild(li);\r\n  }\r\n  gui.onResize();\r\n  return li;\r\n}\r\nfunction removeListeners(gui) {\r\n  dom.unbind(window, 'resize', gui.__resizeHandler);\r\n  if (gui.saveToLocalStorageIfPossible) {\r\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\r\n  }\r\n}\r\nfunction markPresetModified(gui, modified) {\r\n  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\r\n  if (modified) {\r\n    opt.innerHTML = opt.value + '*';\r\n  } else {\r\n    opt.innerHTML = opt.value;\r\n  }\r\n}\r\nfunction augmentController(gui, li, controller) {\r\n  controller.__li = li;\r\n  controller.__gui = gui;\r\n  Common.extend(controller,                                   {\r\n    options: function options(_options) {\r\n      if (arguments.length > 1) {\r\n        var nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: nextSibling,\r\n          factoryArgs: [Common.toArray(arguments)]\r\n        });\r\n      }\r\n      if (Common.isArray(_options) || Common.isObject(_options)) {\r\n        var _nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: _nextSibling,\r\n          factoryArgs: [_options]\r\n        });\r\n      }\r\n    },\r\n    name: function name(_name) {\r\n      controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\r\n      return controller;\r\n    },\r\n    listen: function listen() {\r\n      controller.__gui.listen(controller);\r\n      return controller;\r\n    },\r\n    remove: function remove() {\r\n      controller.__gui.remove(controller);\r\n      return controller;\r\n    }\r\n  });\r\n  if (controller instanceof NumberControllerSlider) {\r\n    var box = new NumberControllerBox(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });\r\n    Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function (method) {\r\n      var pc = controller[method];\r\n      var pb = box[method];\r\n      controller[method] = box[method] = function () {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        pb.apply(box, args);\r\n        return pc.apply(controller, args);\r\n      };\r\n    });\r\n    dom.addClass(li, 'has-slider');\r\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\r\n  } else if (controller instanceof NumberControllerBox) {\r\n    var r = function r(returned) {\r\n      if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\r\n        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\r\n        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\r\n        controller.remove();\r\n        var newController = _add(gui, controller.object, controller.property, {\r\n          before: controller.__li.nextElementSibling,\r\n          factoryArgs: [controller.__min, controller.__max, controller.__step]\r\n        });\r\n        newController.name(oldName);\r\n        if (wasListening) newController.listen();\r\n        return newController;\r\n      }\r\n      return returned;\r\n    };\r\n    controller.min = Common.compose(r, controller.min);\r\n    controller.max = Common.compose(r, controller.max);\r\n  } else if (controller instanceof BooleanController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__checkbox, 'click');\r\n    });\r\n    dom.bind(controller.__checkbox, 'click', function (e) {\r\n      e.stopPropagation();\r\n    });\r\n  } else if (controller instanceof FunctionController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__button, 'click');\r\n    });\r\n    dom.bind(li, 'mouseover', function () {\r\n      dom.addClass(controller.__button, 'hover');\r\n    });\r\n    dom.bind(li, 'mouseout', function () {\r\n      dom.removeClass(controller.__button, 'hover');\r\n    });\r\n  } else if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n    controller.updateDisplay = Common.compose(function (val) {\r\n      li.style.borderLeftColor = controller.__color.toString();\r\n      return val;\r\n    }, controller.updateDisplay);\r\n    controller.updateDisplay();\r\n  }\r\n  controller.setValue = Common.compose(function (val) {\r\n    if (gui.getRoot().__preset_select && controller.isModified()) {\r\n      markPresetModified(gui.getRoot(), true);\r\n    }\r\n    return val;\r\n  }, controller.setValue);\r\n}\r\nfunction recallSavedValue(gui, controller) {\r\n  var root = gui.getRoot();\r\n  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\r\n  if (matchedIndex !== -1) {\r\n    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\r\n    if (controllerMap === undefined) {\r\n      controllerMap = {};\r\n      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\r\n    }\r\n    controllerMap[controller.property] = controller;\r\n    if (root.load && root.load.remembered) {\r\n      var presetMap = root.load.remembered;\r\n      var preset = void 0;\r\n      if (presetMap[gui.preset]) {\r\n        preset = presetMap[gui.preset];\r\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\r\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\r\n      } else {\r\n        return;\r\n      }\r\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\r\n        var value = preset[matchedIndex][controller.property];\r\n        controller.initialValue = value;\r\n        controller.setValue(value);\r\n      }\r\n    }\r\n  }\r\n}\r\nfunction _add(gui, object, property, params) {\r\n  var customObject;\r\n  if (object.arguments) {\r\n    customObject = object;\r\n    object = customObject.arguments.object;\r\n    property = customObject.arguments.property;\r\n    params = {\r\n      factoryArgs: customObject.arguments.opts\r\n    };\r\n  }\r\n  if (customObject === undefined && object[property] === undefined) {\r\n    throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\r\n  }\r\n  var controller = void 0;\r\n  if (params.color) {\r\n    controller = new ColorController(object, property);\r\n  } else if (customObject !== undefined && typeof customObject.property === \"string\") {\r\n    controller = customObject;\r\n  } else {\r\n    var factoryArgs = [object, property].concat(params.factoryArgs);\r\n    controller = ControllerFactory.apply(gui, factoryArgs);\r\n  }\r\n  if (controller === null) controller = customObject;else if (customObject !== undefined) customObject.controller = controller;\r\n  if (params.before instanceof Controller) {\r\n    params.before = params.before.__li;\r\n  }\r\n  recallSavedValue(gui, controller);\r\n  dom.addClass(controller.domElement, 'c');\r\n  var name = document.createElement('span');\r\n  dom.addClass(name, 'property-name');\r\n  if (customObject !== undefined && _typeof(customObject.property) === \"object\") {\r\n    for (var propertyName in customObject.property) {\r\n      name.appendChild(customObject.property[propertyName]);\r\n    }\r\n  } else name.innerHTML = controller.property;\r\n  var container = document.createElement('div');\r\n  container.appendChild(name);\r\n  container.appendChild(controller.domElement);\r\n  var li = addRow(gui, container, params.before);\r\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\r\n  if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n  } else {\r\n    dom.addClass(li, _typeof(controller.getValue()));\r\n  }\r\n  augmentController(gui, li, controller);\r\n  gui.__controllers.push(controller);\r\n  return controller;\r\n}\r\nfunction getLocalStorageHash(gui, key) {\r\n  return document.location.href + '.' + key;\r\n}\r\nfunction addPresetOption(gui, name, setSelected) {\r\n  var opt = document.createElement('option');\r\n  opt.innerHTML = name;\r\n  opt.value = name;\r\n  gui.__preset_select.appendChild(opt);\r\n  if (setSelected) {\r\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\r\n  }\r\n}\r\nfunction showHideExplain(gui, explain) {\r\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\r\n}\r\nfunction addSaveMenu(gui) {\r\n  var div = gui.__save_row = document.createElement('li');\r\n  dom.addClass(gui.domElement, 'has-save');\r\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\r\n  dom.addClass(div, 'save-row');\r\n  var gears = document.createElement('span');\r\n  gears.innerHTML = '&nbsp;';\r\n  dom.addClass(gears, 'button gears');\r\n  var button = document.createElement('span');\r\n  button.innerHTML = 'Save';\r\n  dom.addClass(button, 'button');\r\n  dom.addClass(button, 'save');\r\n  var button2 = document.createElement('span');\r\n  button2.innerHTML = 'New';\r\n  dom.addClass(button2, 'button');\r\n  dom.addClass(button2, 'save-as');\r\n  var button3 = document.createElement('span');\r\n  button3.innerHTML = 'Revert';\r\n  dom.addClass(button3, 'button');\r\n  dom.addClass(button3, 'revert');\r\n  var select = gui.__preset_select = document.createElement('select');\r\n  if (gui.load && gui.load.remembered) {\r\n    Common.each(gui.load.remembered, function (value, key) {\r\n      addPresetOption(gui, key, key === gui.preset);\r\n    });\r\n  } else {\r\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\r\n  }\r\n  dom.bind(select, 'change', function () {\r\n    for (var index = 0; index < gui.__preset_select.length; index++) {\r\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\r\n    }\r\n    gui.preset = this.value;\r\n  });\r\n  div.appendChild(select);\r\n  div.appendChild(gears);\r\n  div.appendChild(button);\r\n  div.appendChild(button2);\r\n  div.appendChild(button3);\r\n  if (SUPPORTS_LOCAL_STORAGE) {\r\n    var explain = document.getElementById('dg-local-explain');\r\n    var localStorageCheckBox = document.getElementById('dg-local-storage');\r\n    var saveLocally = document.getElementById('dg-save-locally');\r\n    saveLocally.style.display = 'block';\r\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\r\n      localStorageCheckBox.setAttribute('checked', 'checked');\r\n    }\r\n    showHideExplain(gui, explain);\r\n    dom.bind(localStorageCheckBox, 'change', function () {\r\n      gui.useLocalStorage = !gui.useLocalStorage;\r\n      showHideExplain(gui, explain);\r\n    });\r\n  }\r\n  var newConstructorTextArea = document.getElementById('dg-new-constructor');\r\n  dom.bind(newConstructorTextArea, 'keydown', function (e) {\r\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\r\n      SAVE_DIALOGUE.hide();\r\n    }\r\n  });\r\n  dom.bind(gears, 'click', function () {\r\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\r\n    SAVE_DIALOGUE.show();\r\n    newConstructorTextArea.focus();\r\n    newConstructorTextArea.select();\r\n  });\r\n  dom.bind(button, 'click', function () {\r\n    gui.save();\r\n  });\r\n  dom.bind(button2, 'click', function () {\r\n    var presetName = prompt('Enter a new preset name.');\r\n    if (presetName) {\r\n      gui.saveAs(presetName);\r\n    }\r\n  });\r\n  dom.bind(button3, 'click', function () {\r\n    gui.revert();\r\n  });\r\n}\r\nfunction addResizeHandle(gui) {\r\n  var pmouseX = void 0;\r\n  gui.__resize_handle = document.createElement('div');\r\n  Common.extend(gui.__resize_handle.style, {\r\n    width: '6px',\r\n    marginLeft: '-3px',\r\n    height: '200px',\r\n    cursor: 'ew-resize',\r\n    position: 'absolute'\r\n  });\r\n  function drag(e) {\r\n    e.preventDefault();\r\n    gui.width += pmouseX - e.clientX;\r\n    gui.onResize();\r\n    pmouseX = e.clientX;\r\n    return false;\r\n  }\r\n  function dragStop() {\r\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.unbind(window, 'mousemove', drag);\r\n    dom.unbind(window, 'mouseup', dragStop);\r\n  }\r\n  function dragStart(e) {\r\n    e.preventDefault();\r\n    pmouseX = e.clientX;\r\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.bind(window, 'mousemove', drag);\r\n    dom.bind(window, 'mouseup', dragStop);\r\n    return false;\r\n  }\r\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\r\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\r\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\r\n}\r\nfunction setWidth(gui, w) {\r\n  gui.domElement.style.width = w + 'px';\r\n  if (gui.__save_row && gui.autoPlace) {\r\n    gui.__save_row.style.width = w + 'px';\r\n  }\r\n  if (gui.__closeButton) {\r\n    gui.__closeButton.style.width = w + 'px';\r\n  }\r\n}\r\nfunction getCurrentPreset(gui, useInitialValues) {\r\n  var toReturn = {};\r\n  Common.each(gui.__rememberedObjects, function (val, index) {\r\n    var savedValues = {};\r\n    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\r\n    Common.each(controllerMap, function (controller, property) {\r\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\r\n    });\r\n    toReturn[index] = savedValues;\r\n  });\r\n  return toReturn;\r\n}\r\nfunction setPresetSelectIndex(gui) {\r\n  for (var index = 0; index < gui.__preset_select.length; index++) {\r\n    if (gui.__preset_select[index].value === gui.preset) {\r\n      gui.__preset_select.selectedIndex = index;\r\n    }\r\n  }\r\n}\r\nfunction updateDisplays(controllerArray) {\r\n  if (controllerArray.length !== 0) {\r\n    requestAnimationFrame$1.call(window, function () {\r\n      updateDisplays(controllerArray);\r\n    });\r\n  }\r\n  Common.each(controllerArray, function (c) {\r\n    c.updateDisplay();\r\n  });\r\n}\r\n\r\nvar color = {\r\n  Color: Color,\r\n  math: ColorMath,\r\n  interpret: interpret\r\n};\r\nvar controllers = {\r\n  Controller: Controller,\r\n  BooleanController: BooleanController,\r\n  OptionController: OptionController,\r\n  StringController: StringController,\r\n  NumberController: NumberController,\r\n  NumberControllerBox: NumberControllerBox,\r\n  NumberControllerSlider: NumberControllerSlider,\r\n  FunctionController: FunctionController,\r\n  ColorController: ColorController,\r\n  CustomController: CustomController\r\n};\r\nvar dom$1 = { dom: dom };\r\nvar gui = { GUI: GUI };\r\nvar GUI$1 = GUI;\r\nvar index = {\r\n  color: color,\r\n  controllers: controllers,\r\n  dom: dom$1,\r\n  gui: gui,\r\n  GUI: GUI$1\r\n};\r\n\r\nexport { color, controllers, dom$1 as dom, gui, GUI$1 as GUI };\r\nexport default index;\r\n//# sourceMappingURL=dat.gui.module.js.map\r\n","/**\r\n * Modify of the dat object.\r\n * @see {@link https://github.com/dataarts/dat.gui} about dat.gui\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n//import { GUI } from '../../three.js/dev/examples/jsm/libs/dat.gui.module.js';\r\n//import { GUI } from '../../dat.gui/CustomController/build/dat.gui.module.js';\r\nimport { GUI } from './dat.gui.module.js';\r\nexport function dat() { };\r\nif ( typeof dat !== 'undefined' ) {\r\n\r\n\t//dat.GUI is included into current project\r\n\t//See https://github.com/dataarts/dat.gui/blob/master/API.md about dat.GUI API.\r\n\tdat.GUI = GUI;\r\n\r\n\tfunction elNameAndTitle( el, name, title ) {\r\n\r\n\t\tif ( name === undefined )\r\n\t\t\tconsole.warn( 'elNameAndTitle: name = ' + name );\r\n\t\tel.innerHTML = name;\r\n\t\tif ( title !== undefined )\r\n\t\t\tel.title = title;\r\n\r\n\t}\r\n\r\n\tif ( dat.controllerNameAndTitle === undefined ) {\r\n\r\n\t\tdat.controllerNameAndTitle = function ( controller, name, title ) {\r\n\r\n\t\t\telNameAndTitle( controller.__li.querySelector( \".property-name\" ), name, title );\r\n\r\n\t\t};\r\n\r\n\t} else console.error( 'Duplicate dat.controllerNameAndTitle method.' );\r\n\r\n\tif ( dat.folderNameAndTitle === undefined ) {\r\n\r\n\t\tdat.folderNameAndTitle = function ( folder, name, title ) {\r\n\r\n\t\t\telNameAndTitle( folder.__ul.querySelector( \"li.title\" ), name, title );\r\n\r\n\t\t};\r\n\r\n\t} else console.error( 'Duplicate dat.folderNameAndTitle method.' );\r\n\r\n\tif ( dat.controllerZeroStep === undefined ) {\r\n\r\n\t\t//Solving of dat.gui NumberController Step bug.\r\n\t\t//See https://github.com/dataarts/dat.gui/issues/48 for details.\r\n\t\t//\r\n\t\t//folder: GUI or folder for new Controller.\r\n\t\t//object: The object to be manipulated. See https://github.com/dataarts/dat.gui/blob/master/API.md#GUI+add for details\r\n\t\t//property: The name of the property to be manipulated. See https://github.com/dataarts/dat.gui/blob/master/API.md#GUI+add for details\r\n\t\t//onchange: Callback function will be called if controller value was changed. Can be undefined.\r\n\t\t//\r\n\t\t//Example of using\r\n\t\t/*\r\n\t\tvar gui = new dat.GUI();\r\n\t\tvar object = { min: 123.456 }\r\n\t\tdat.controllerZeroStep( gui, object, 'min', function ( value ) {\r\n\r\n\t\t\tconsole.log( 'object.min = ' + object.min + ' value = ' + value );\r\n\r\n\t\t} );\r\n\t\t*/\r\n\t\tdat.controllerZeroStep = function ( folder, object, property, onchange ) {\r\n\r\n\t\t\tvar controller = folder.add( object, property ),\r\n\t\t\t\tinput = controller.__input;\r\n\t\t\tcontroller.__input = document.createElement( 'input' );\r\n\t\t\tinput.value = object[property];\r\n\t\t\tinput.onchange = function ( value ) {\r\n\r\n\t\t\t\tobject[property] = parseFloat( input.value );\r\n\r\n\t\t\t\tif ( onchange !== undefined )\r\n\t\t\t\t\tonchange( object[property] );\r\n\r\n\t\t\t};\r\n\t\t\tcontroller.setValue = function ( value ) {\r\n\r\n\t\t\t\tinput.value = object[property] = value;\r\n\r\n\t\t\t};\r\n\t\t\treturn controller;\r\n\r\n\t\t};\r\n\r\n\t} else console.error( 'Duplicate dat.controllerZeroStep method.' );\r\n\r\n\tif ( dat.controllerSetValue === undefined ) {\r\n\r\n\t\t//for resolving of the bug\r\n\t\t//Testing:\r\n\t\t//select Surface in the Examples drop down menu of the webgl_math.html page.\r\n\t\t//Click mouse over any point.\r\n\t\t//Now you can see number of selected line in the Select Line drop down menu\r\n\t\t//\tand number of selected point in the Select Point drop down menu.\r\n\t\t//Select \"no select\" in the Select Line drop down menu.\r\n\t\t//Click mouse over any point again.\r\n\t\t//Now you can see a bug: You see \"no select\" instead of number of selected line in the Select Line drop down menu.\r\n\t\tdat.controllerSetValue = function ( controller, index ) {\r\n\r\n\t\t\tcontroller.setValue( index );\r\n\t\t\tcontroller.__li.querySelector( 'select' ).selectedIndex = index;\r\n\r\n\t\t};\r\n\r\n\t} else console.error( 'Duplicate dat.controllerSetValue method.' );\r\n\r\n}\r\n/*\r\nvar datModifier = {\r\n}\r\nexport default datModifier;\r\n*/\r\n","﻿/**\r\n * custom controller, allow to user to change a value step by step.\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nvar UpDownController = {\r\n\r\n\t/**\r\n\t * adds new button into controller\r\n\t * @param {string} innerHTML button name\r\n\t * @param {object} [options] the following options are available\r\n\t * @param {String} [options.title] title of the button\r\n\t * @param {Event} [options.onclick] onclick event\r\n\t * @param {Event} [options.onWheel] onWheel event\r\n\t */\r\n\taddButton: function ( innerHTML, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\tvar button = document.createElement( 'span' );\r\n\t\tbutton.innerHTML = innerHTML;\r\n\t\tif ( options.title !== undefined )\r\n\t\t\tbutton.title = options.title;\r\n\t\tif ( options.onclick !== undefined ) {\r\n\r\n\t\t\tbutton.style.cursor = 'pointer';\r\n\t\t\tbutton.onclick = options.onclick;\r\n\r\n\t\t}\r\n\t\tif ( options.onwheel !== undefined ) {\r\n\r\n\t\t\tbutton.style.cursor = 'n-resize';\r\n\r\n\t\t\t//https://learn.javascript.ru/mousewheel\r\n\t\t\tif ( button.addEventListener ) {\r\n\t\t\t\tif ( 'onwheel' in document ) {\r\n\t\t\t\t\t// IE9+, FF17+, Ch31+\r\n\t\t\t\t\tbutton.addEventListener( \"wheel\", onWheel );\r\n\t\t\t\t} else if ( 'onmousewheel' in document ) {\r\n\t\t\t\t\t// устаревший вариант события\r\n\t\t\t\t\tbutton.addEventListener( \"mousewheel\", onWheel );\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Firefox < 17\r\n\t\t\t\t\tbutton.addEventListener( \"MozMousePixelScroll\", onWheel );\r\n\t\t\t\t}\r\n\t\t\t} else { // IE8-\r\n\t\t\t\tbutton.attachEvent( \"onmousewheel\", onWheel );\r\n\t\t\t}\r\n\r\n\t\t\tfunction onWheel( e ) {\r\n\t\t\t\te = e || window.event;\r\n\r\n\t\t\t\t// wheelDelta не дает возможность узнать количество пикселей\r\n\t\t\t\tvar delta = e.deltaY || e.detail || e.wheelDelta;\r\n\t\t\t\toptions.onwheel( delta );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tbutton.style.margin = '0px 2px';\r\n\t\treturn button;\r\n\r\n\t},\r\n\r\n}\r\n\r\nexport default UpDownController;\r\n","/**\r\n * @module ScaleController\r\n * @description is dat.GUI graphical user interface controller for control of the scale of threejs 3D object\r\n * \r\n * @see {@link https://threejs.org/} about threejs\r\n * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import { controllers } from '../../dat.gui/CustomController/build/dat.gui.module.js';\r\nimport { controllers } from './dat/dat.gui.module.js';\r\nimport { dat } from './dat/dat.module.js';\r\nimport UpDownController from './UpDownController.js';\r\n\r\nclass ScaleController extends controllers.CustomController {\r\n\r\n\t/**\r\n\t* @callback onclick\r\n\t* @param {ScaleController} customController this controller\r\n\t* @param {Function} action action( value, zoom ) function for multiply or divide value to zoom\r\n\t*/\r\n\r\n\t/**\r\n\t * @description dat.GUI graphical user interface controller for control of the scale of threejs 3D object\r\n\t * @param {onclick} onclick Called whenever user has clicked this controller.\r\n\t * @param {object} [options] the following options are available:\r\n\t * @param {object} [options.settings] settings.\r\n\t * @param {number} [options.settings.zoomMultiplier] control value. Default is 1.1\r\n\t * @param {Function} [options.getLanguageCode] returns the \"primary language\" subtag of the version of the browser. Default returns \"en\" is English\r\n\t * @example \r\n//Add new ScaleController to the dat.GUI folder\r\nfolder.add( new ScaleController( function ( customController, action ) {\r\n\r\n\tvar zoom = customController.controller.getValue();\r\n\r\n\t//Scale a THREE.Mesh object\r\n\tmesh.scale.x = action( mesh.scale.x, zoom );\r\n\tmesh.scale.y = action( mesh.scale.y, zoom );\r\n\tmesh.scale.z = action( mesh.scale.z, zoom );\r\n\tmesh.needsUpdate = true;\r\n\r\n},\r\n\t{\r\n\r\n\t\tsettings: { zoomMultiplier: 1.1, },\r\n\t\tgetLanguageCode: getLanguageCode,\r\n\r\n\t} ) );\r\n\t */\r\n\tconstructor( onclick, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\toptions.settings = options.settings || {};\r\n\t\toptions.settings.zoomMultiplier = options.settings.zoomMultiplier || 1.1;\r\n\r\n\t\tsuper( {\r\n\r\n\t\t\tmultiplier: options.settings.zoomMultiplier,//1.1\r\n\t\t\tproperty: function ( customController ) {\r\n\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tvar lang = {\r\n\r\n\t\t\t\t\t//Zoom\r\n\t\t\t\t\tzoom: 'Zoom',\r\n\t\t\t\t\tin: 'in',\r\n\t\t\t\t\tout: 'out',\r\n\t\t\t\t\twheelZoom: 'Scroll the mouse wheel to zoom',\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t\t: options.getLanguageCode();\r\n\t\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t//Zoom\r\n\t\t\t\t\t\tlang.zoom = 'Изменить';\r\n\t\t\t\t\t\tlang.in = 'увеличить';\r\n\t\t\t\t\t\tlang.out = 'уменьшить';\r\n\t\t\t\t\t\tlang.wheelZoom = 'Прокрутите колесико мыши для изменения масштаба';\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault://Custom language\r\n\t\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar buttons = {},\r\n\t\t\t\t\taddButton = UpDownController.addButton;\r\n\t\t\t\tbuttons.zoomLabel = addButton( lang.zoom, {\r\n\r\n\t\t\t\t\ttitle: lang.wheelZoom,//Scroll the mouse wheel to zoom\r\n\t\t\t\t\tonwheel: function ( delta ) {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tif ( delta > 0 )\r\n\t\t\t\t\t\t\t\tvalue *= zoom;\r\n\t\t\t\t\t\t\telse value /= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.in = addButton( '↑', {\r\n\r\n\t\t\t\t\ttitle: lang.in,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tvalue *= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.out = addButton( '↓', {\r\n\r\n\t\t\t\t\ttitle: lang.out,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tvalue /= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn buttons;\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'multiplier', 1.1, 10, 0.1 );\r\n\t\tif ( this.property === undefined )\r\n\t\t\tconsole.error( 'init() returns ' + this.property );\r\n\r\n\t}\r\n\r\n}\r\nexport default ScaleController;\r\n\r\n/**\r\n * dat.GUI graphical user interface controllers for manipulate or multiplication of the object's property\r\n * @param {GUI} folder folder for new controllers\r\n * @param {Object} object The object to be manipulated\r\n * @param {String} property The name of the property to be manipulated\r\n * @param {function( value )} onChange Callback function that take the new  property of the object\r\n * @param {Object} [options] the following options are available\r\n * @param {object} [options.settings] settings.\r\n * @param {number} [options.settings.zoomMultiplier] control value. Default is 1.1\r\n * @param {Function} [options.getLanguageCode] returns the \"primary language\" subtag of the version of the browser. Default returns \"en\" is English\r\n * @param {String} [options.text] object's property name. Default is property name.\r\n * @param {String} [options.textTitle] object's property title. Default is not title,\r\n */\r\nfunction ScaleControllers( folder, object, property, onChange, options ) {\r\n\r\n\toptions = options || {};\r\n\tvar scaleController = folder.add( new ScaleController( function ( customController, action ) {\r\n\r\n\t\tvar value = action( controller.getValue(), scaleController.getValue() );\r\n\t\tcontroller.setValue( value );\r\n\t\tonChange( value );\r\n\r\n\t},\r\n\t\t{\r\n\r\n\t\t\tgetLanguageCode: options.getLanguageCode,\r\n\t\t\tsettings: options.settings,\r\n\r\n\t\t} ) ).onChange( function ( value ) { scaleController.zoomMultiplier = value; } );\r\n\tvar controller = dat.controllerZeroStep( folder, object, property, function ( value ) { onChange( value ); } );\r\n\tif ( options.text )\r\n\t\tdat.controllerNameAndTitle( controller, options.text, options.textTitle );\r\n\r\n}\r\nexport { ScaleControllers };\r\n","/**\r\n * PositionController is dat.GUI graphical user interface controller for control of the position of threejs 3D object\r\n * \r\n * @see {@link https://threejs.org/} about threejs\r\n * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import { controllers } from '../../dat.gui/CustomController/build/dat.gui.module.js';\r\nimport { controllers } from './dat/dat.gui.module.js';\r\nimport UpDownController from './UpDownController.js';\r\n\r\nclass PositionController extends controllers.CustomController {\r\n\r\n\t/**\r\n\t * dat.GUI graphical user interface for control of the position of threejs 3D object\r\n\t * @param {Event} onclickController\r\n\t * @param {object} [options] the following options are available:\r\n\t * @param {number} [options.settings] time settings.\r\n\t * @param {number} [options.settings.offset] offset. Default is 0.1\r\n\t * @param {number} [options.min] Minimal offset. Default is 0.1\r\n\t * @param {number} [options.max] Maximal offset. Default is 10\r\n\t * @param {number} [options.step] step of offset. Default is 0.1\r\n\t * @param {Function} [options.getLanguageCode] returns the \"primary language\" subtag of the version of the browser. Default returns \"en\" is English\r\n\t */\r\n\tconstructor( onclickController, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\toptions.settings = options.settings || {}; \r\n\t\tvar settings = options.settings; \r\n\r\n\t\toptions.min = options.min || 0.1;\r\n\t\toptions.max = options.max || 10;\r\n//\t\toptions.offset = options.offset || 0.1;\r\n\t\tsettings.offset = settings.offset || 0.1;\r\n\t\toptions.step = options.step || 0.1;\r\n\r\n\t\tsuper( {\r\n\r\n\t\t\toffset: settings.offset,\r\n\t\t\tproperty: function ( customController ) {\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tvar lang = {\r\n\r\n\t\t\t\t\t//Position\r\n\t\t\t\t\toffset: 'Offset',\r\n\t\t\t\t\tadd: 'add',\r\n\t\t\t\t\tsubtract: 'subtract',\r\n\t\t\t\t\twheelPosition: 'Scroll the mouse wheel to change the position',\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t\t: options.getLanguageCode();\r\n\t\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t//Position\r\n\t\t\t\t\t\tlang.offset = 'Сдвиг';\r\n\t\t\t\t\t\tlang.add = 'добавить';\r\n\t\t\t\t\t\tlang.subtract = 'вычесть';\r\n\t\t\t\t\t\tlang.wheelPosition = 'Прокрутите колесико мыши для изменения позиции';\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault://Custom language\r\n\t\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar buttons = {}, addButton = UpDownController.addButton;\r\n\t\t\t\tbuttons.Label = addButton( lang.offset, {\r\n\r\n\t\t\t\t\ttitle: lang.wheelPosition,\r\n\t\t\t\t\tonwheel: function ( delta ) {\r\n\r\n\t\t\t\t\t\tvar shift = customController.controller.getValue();\r\n\t\t\t\t\t\tonclickController( delta > 0 ? shift : - shift );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.in = addButton( '↑', {\r\n\r\n\t\t\t\t\ttitle: lang.add,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclickController( customController.controller.getValue() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.out = addButton( '↓', {\r\n\r\n\t\t\t\t\ttitle: lang.subtract,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclickController( - customController.controller.getValue() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn buttons;\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'offset', options.min, options.max, options.step );\r\n\t\tif ( this.property === undefined )\r\n\t\t\tconsole.error( 'init() returns ' + this.property );\r\n\r\n\t}\r\n\r\n}\r\nexport default PositionController;","﻿/**\r\n * node.js version of the synchronous download of the file.\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//The myRequest is cross-browser XMLHttpRequest wrapper.\r\nfunction myRequest( options ) {\r\n\r\n\tthis.loadXMLDoc = function () {\r\n\t\tvar req;\r\n\r\n\t\tif ( window.XMLHttpRequest ) {\r\n\t\t\treq = new XMLHttpRequest();\r\n\t\t\tif ( !req )\r\n\t\t\t\tthrow \"new XMLHttpRequest() failed!\"\r\n\t\t}\r\n\t\telse if ( window.ActiveXObject ) {\r\n\t\t\treq = this.NewActiveXObject();\r\n\t\t\tif ( !req )\r\n\t\t\t\tthrow \"NewActiveXObject() failed!\"\r\n\t\t}\r\n\t\telse throw \"myRequest.loadXMLDoc(...) failed!\";\r\n\t\treturn req;\r\n\t}\r\n\r\n\tthis.NewActiveXObject = function () {\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP.6.0\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP.3.0\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Microsoft.XMLHTTP\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\tErrorMessage( 'This browser does not support XMLHttpRequest. Probably, your security settings do not allow Web sites to use ActiveX controls installed on your computer. Refresh your Web page to find out the current status of your Web page or enable the \"Initialize and script ActiveX controls not marked as safe\" and \"Run Active X controls and plug-ins\" of the Security settings of the Internet zone of your browser.' );\r\n\t\treturn null;\r\n\t}\r\n\r\n\tthis.XMLHttpRequestStart = function ( onreadystatechange, async ) {\r\n\r\n\t\tthis.XMLHttpRequestStop();//For compatibility with IE Windows Phone\r\n\r\n\t\tthis.req.onreadystatechange = onreadystatechange;\r\n\r\n\t\t//ATTENTION!!! do not works in IE\r\n\t\tif ( \"onerror\" in this.req ) {\r\n\t\t\tthis.req.onerror = function ( event ) {\r\n\t\t\t\tErrorMessage( \"XMLHttpRequest error. url: \" + this.url, false, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.XMLHttpRequestReStart( async );\r\n\t}\r\n\r\n\tthis.getUrl = function () {\r\n\t\tif ( ( typeof this.url == 'undefined' ) || ( this.url == null ) ) {\r\n\t\t\tthis.url = \"XMLHttpRequest.xml\";\r\n\t\t}\r\n\t\treturn this.url + ( this.params ? this.params : \"\" );\r\n\t}\r\n\r\n\tthis.XMLHttpRequestReStart = function ( async ) {\r\n\t\ttry {\r\n\t\t\tif ( typeof async == 'undefined' )\r\n\t\t\t\tasync = true;\r\n\t\t\tthis.req.open( \"GET\", this.getUrl(), async );\r\n\t\t\tif ( async ) {\r\n\t\t\t\tvar timeout = ( 60 + 30 ) * 1000;//Внимание!!! Задержка должна быть больше CSocketWaitEvent::WaitResponse\r\n\t\t\t\tif ( \"timeout\" in this.req )//for IE6\r\n\t\t\t\t\tthis.req.timeout = timeout;\r\n\t\t\t\tif ( \"ontimeout\" in this.req )\r\n\t\t\t\t\tthis.req.ontimeout = function () {\r\n\t\t\t\t\t\tErrorMessage( 'XMLHttpRequest timeout', false, false );\r\n\t\t\t\t\t}\r\n\t\t\t\telse {//for Safari, IE6\r\n\t\t\t\t\tclearTimeout( this.timeout_id_SendReq );\r\n\t\t\t\t\tthis.timeout_id_SendReq = setTimeout( function () {\r\n\t\t\t\t\t\tErrorMessage( 'XMLHttpRequest timeout 2', false, false );\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t, timeout );\r\n\t\t\t\t\t//console.log(\"setTimeout this.req.timeout_id_SendReq = \" + this.req.timeout_id_SendReq);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.req.send( null );\r\n\t\t} catch ( e ) {\r\n\t\t\tErrorMessage( e.message + \" url: \" + this.url, false, false );\r\n\t\t}\r\n\t}\r\n\r\n\tthis.XMLHttpRequestStop = function () {\r\n\t\t//console.log(\"XMLHttpRequestStop(...)\");\r\n\t\tif ( this.req == null )\r\n\t\t\treturn;\r\n\t\tthis.req.abort();\r\n\t}\r\n\r\n\tthis.ProcessReqChange = function ( processStatus200 ) {\r\n\t\tvar req = this.req;\r\n\t\tif ( ( typeof isIE === 'undefined' ) || !isIE ) {\r\n\t\t\t//\tconsole.log(\"processReqChange(); req.statusText: \" + req.statusText + \". req.status = \" + req.status + \". req.readyState = \" + req.readyState + \". req.responseText: \" + req.responseText);\r\n\t\t}\r\n\t\t// only if req shows \"complete\"\r\n\t\t//http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp\r\n\t\t//http://xmlhttprequest.ru/w3c\r\n\t\tswitch ( req.readyState ) {\r\n\t\t\tcase 4://request finished and response is ready\r\n\t\t\t\t{\r\n\t\t\t\t\tif ( typeof req.status == \"unknown\" ) {//IE5 timeout\r\n\t\t\t\t\t\tconsoleError( 'typeof XMLHttpRequest status == \"unknown\"' );\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//Я не могу вставлять switch один в другой\r\n\t\t\t\t\tif ( req.status == 200 )//OK)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclearTimeout( this.timeout_id_SendReq );\r\n\t\t\t\t\t\treturn processStatus200( this );\r\n\t\t\t\t\t}//200://OK\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tErrorMessage( \"Invalid XMLHttpRequest status : \" + req.status + \" url: \" + this.url );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1://server connection established\r\n\t\t\tcase 2://request received\r\n\t\t\tcase 3://processing request\r\n\t\t\t\tbreak;\r\n\t\t\t//\t\tcase 404:\r\n\t\t\tcase 0://request not initialized\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"processReqChange(); req.readyState = \" + req.readyState;\r\n\t\t\t\tbreak;\r\n\t\t}//switch(req.readyState)\r\n\t\treturn true;\r\n\t}\r\n\r\n\tthis.processStatus200Error = function () {\r\n\t\tvar error = this.GetElementText( 'error', true );\r\n\t\tif ( error ) {\r\n\t\t\tErrorMessage( error );\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tthis.GetElementText = function ( tagName, noDisplayErrorMessage ) {\r\n\t\tvar xmlhttp = this.req;\r\n\t\tif ( !xmlhttp.responseXML ) {\r\n\t\t\tif ( noDisplayErrorMessage != true )\r\n\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, ' + tagName + '); xmlhttp.responseXML is null.\\nxmlhttp.responseText:\\n' + xmlhttp.responseText );\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar element = xmlhttp.responseXML.getElementsByTagName( tagName );\r\n\r\n\t\t//ATTENTION!!! For IE set the content-type m_HttpResponse.SetContentType(\"text/xml\");\r\n\r\n\t\tif ( element.length == 0 ) {\r\n\t\t\tif ( noDisplayErrorMessage != true )\r\n\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, \"' + tagName + '\"); element.length == ' + element.length );\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tvar text = \"\";\r\n\t\tfor ( var i = 0; i < element.length; i++ ) {\r\n\t\t\tif ( typeof ( element[i].textContent ) == 'undefined' ) {\r\n\t\t\t\tif ( typeof ( element[i].text ) == 'undefined' ) {\r\n\t\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, ' + tagName + '); element[' + i + '].text) == undefined' );\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t\tif ( text != \"\" )\r\n\t\t\t\t\ttext += \" \";\r\n\t\t\t\ttext += element[i].text;//IE\r\n\t\t\t}\r\n\t\t\telse text += element[i].textContent;//Chrome\r\n\t\t}\r\n\t\treturn text;\r\n\t}\r\n\r\n\tif ( options.data ) {\r\n\t\tthis.req = options.data.req;\r\n\t\tthis.url = options.data.url;\r\n\t\tthis.params = options.data.params;\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tthis.req = this.loadXMLDoc();\r\n\t\t} catch ( e ) {\r\n\t\t\tvar message;\r\n\t\t\tif ( typeof e.message == 'undefined' )\r\n\t\t\t\tmessage = e;\r\n\t\t\telse message = e.message;\r\n\t\t\tErrorMessage( \"Your browser is too old and is not compatible with our site.\\n\\n\"\r\n\t\t\t\t+ window.navigator.appName + \" \" + window.navigator.appVersion + \"\\n\\n\" + message );\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif ( !this.req ) {\r\n\t\tconsoleError( \"Invalid myRequest.req: \" + this.req );\r\n\t\treturn;\r\n\t}\r\n\r\n\tfunction ErrorMessage( error ) {\r\n\r\n\t\tconsole.error( error );\r\n\t\toptions.onerror( error );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @callback onerror\r\n * @param {string} str - error details\r\n */\r\n\r\n/**\r\n * Synchronous load file\r\n * @param {string} url URL of an external file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured. Optional.\r\n * @returns {string} file content\r\n * @example\r\n * \r\n\t//Simplest example.\r\n\tdocument.getElementById( \"elID\" ).innerHTML = loadFile.sync('element.html');\r\n *\r\n * @example\r\n *\r\n\t//onload, onerror events.\r\n\tdocument.getElementById( \"elID\").innerHTML = loadFile.sync( 'element.html',\r\n\t{\r\n\t\tonload: function ( response ) {\r\n\r\n\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\tconsole.log( str );\r\n\r\n\t\t},\r\n\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\tconsole.error( str );\r\n\r\n\t\t},\r\n\t}, );\r\n */\r\nfunction sync( url, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.onload = options.onload || function () { };\r\n\toptions.onerror = options.onerror || function () { };\r\n\r\n\tvar response,\r\n\t\trequest = new myRequest( options );\r\n\trequest.url = url;\r\n\trequest.XMLHttpRequestStart(\r\n\r\n\t\tfunction () {//onreadystatechange\r\n\r\n\t\t\trequest.ProcessReqChange( function ( myRequest ) {//processStatus200\r\n\r\n\t\t\t\tif ( myRequest.processStatus200Error() )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tresponse = myRequest.req.responseText;\r\n\t\t\t\t//console.log( 'loadFile.sync.onload() ' + url );\r\n\t\t\t\toptions.onload( response, url );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\t, false//Synchronous mode\r\n\r\n\t);\r\n\t//console.log( 'sync(' + url + ')' );\r\n\treturn response;\r\n\r\n}\r\n\r\n/**\r\n * display a text to HTML\r\n * @param {string} str source text\r\n * @returns {string} escaped text\r\n */\r\nfunction escapeHtml( str ) {\r\n\r\n\treturn str.replace( /[&<>\"'\\/]/g, function ( s ) {\r\n\r\n\t\tvar entityMap = {\r\n\r\n\t\t\t\"&\": \"&amp;\",\r\n\t\t\t\"<\": \"&lt;\",\r\n\t\t\t\">\": \"&gt;\",\r\n\t\t\t'\"': '&quot;',\r\n\t\t\t\"'\": '&#39;',\r\n\t\t\t\"/\": '&#x2F;'\r\n\r\n\t\t};\r\n\r\n\t\treturn entityMap[s];\r\n\r\n\t} );\r\n}\r\n\r\nexport { sync, escapeHtml };\r\n","/**\r\n * node.js version of the load JavaScript file\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Thanks to:\r\n *http://javascript.ru/forum/events/21439-dinamicheskaya-zagruzka-skriptov.html\r\n *https://learn.javascript.ru/onload-onerror\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//Please download https://github.com/anhr/loadFileNodeJS into ../loadFileNodeJS folder\r\nimport { sync as loadFileSync, escapeHtml } from '../loadFileNodeJS/index.js';\r\n\r\n/**\r\n * @callback onerror\r\n * @param {string} str - error details\r\n */\r\n\r\n/**\r\n * Synchronous load JavaScript file\r\n * @param {string} src URL of an external script file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured. Optional.\r\n * @param {string}[options.appendTo] The node to which the new script will be append. Optional. Default is head node\r\n * @param {Object|string}[options.tag] The script's tag attributes (Object) or tag type (string). Optional.\r\n * Available tag types:\r\n *\t'style' - load a style file (.css extension)\r\n * @param {string} [options.tag.name] tag name. Default is 'script'\r\n * @param {Object} [options.tag.attribute] tag attribute. Optional.\r\n * @param {string} options.tag.attribute.name attribute name. Default is 'type'\r\n * @param {string} options.tag.attribute.value attribute value. Default is 'text/javascript'\r\n *\r\n * @example\r\n * \r\n\t//Simplest example. Append script into head node.\r\n\tloadScript.sync( 'sync.js' );\r\n\r\n * @example\r\n * \r\n\t//onload, onerror events. Append script into \"appendto\" element\r\n\tloadScript.sync( 'sync.js',\r\n\t\t{\r\n\t\t\tonload: function ( response ) {\r\n\r\n\t\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\t\tconsole.log( str );\r\n\r\n\t\t\t},\r\n\t\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\t\telSync2Res.style.color = 'red';\r\n\r\n\t\t\t},\r\n\t\t\tappendTo: document.getElementById( \"appendto\" ),\r\n\t\t},\r\n\t);\r\n *\r\n * @example\r\n *\r\n\t//Append style into head node.\r\n\tloadScript.sync( \"controls.css\",\r\n\t{\r\n\t\t//style rel=\"stylesheet\"\r\n\t\ttag: {\r\n\r\n\t\t\tname: 'style',\r\n\t\t\tattribute: {\r\n\r\n\t\t\t\tname: 'rel',\r\n\t\t\t\tvalue: 'stylesheet',\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n */\r\nfunction sync( src, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.onload = options.onload || function () { };\r\n\toptions.onerror = options.onerror || function () { };\r\n\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[0];\r\n\r\n\tif ( isScriptExists( options.appendTo, src ) ) {\r\n\r\n\t\t//options.onerror( 'duplicate downloading of the ' + src + ' file' );\r\n\t\toptions.onload();\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tif ( src instanceof Array ) {\r\n\r\n\t\tvar error,\r\n\t\t\toptionsItem = {\r\n\r\n\t\t\t\tappendTo: options.appendTo,\r\n\t\t\t\ttag: options.tag,\r\n\t\t\t\tonload: function ( response, url ) {\r\n\t\t\t\t\r\n\t\t\t\t\tconsole.log( 'loadScript.sync.onload: ' + url );\r\n\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tonerror: function ( str ) {\r\n\r\n\t\t\t\t\toptions.onerror( str );\r\n\t\t\t\t\terror = str;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t};\r\n\t\tfor ( var i = 0; i < src.length; i++ ) {\r\n\r\n\t\t\tvar item = src[ i ];\r\n\t\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\t\tscript.setAttribute( \"id\", item );\r\n\t\t\t\tscript.innerHTML = loadFileSync( item, optionsItem );\r\n\r\n\t\t\t}, optionsItem );\r\n\t\t\tif ( error !== undefined )\r\n\t\t\t\tbreak;\r\n\r\n\t\t};\r\n\t\tif ( error === undefined )\r\n\t\t\toptions.onload();\r\n\r\n\t} else loadScriptBase( function ( script ) {\r\n\r\n\t\tscript.setAttribute( \"id\", src );\r\n\t\tscript.innerHTML = loadFileSync( src, options );\r\n\r\n\t}, options );\r\n\r\n}\r\n\r\n/**\r\n * @callback onerrorasync\r\n * @param {string} str - error details\r\n * @param {Object} e - event\r\n */\r\n\r\n/**\r\n * Asynchronous load JavaScript file\r\n * @param {string|string[]} src URL of an external script file or array of the script file names.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerrorasync} [options.onerror] function ( str, e ) The onerror event occurs when an error has been occured. Optional.\r\n * @param {string}[options.appendTo] The node to which the new script will be append. Optional. Default is head node\r\n * @param {Object}[options.tag] The script's tag attributes. Optional.\r\n * @param {string} options.tag.name tag name. Default is 'script'\r\n * @param {Object} [options.tag.attribute] tag attribute. Optional.\r\n * @param {string} options.tag.attribute.name attribute name. Default is 'type'\r\n * @param {string} options.tag.attribute.value attribute value. Default is 'text/javascript'\r\n*\r\n * @example\r\n * \r\n\t//Simplest example. Append script into head node.\r\n\tloadScript.async( \"JavaScript.js);\r\n * \r\n * @example\r\n *\r\n\t//onload, onerror events. Append script into \"appendto\" element\r\n\tloadScript.async( \"JavaScript.js\",\r\n\t{\r\n \t\tonload: function () {\r\n \r\n \t\t\tvar str = 'file has been loaded successfully';\r\n \t\t\tconsole.log( str );\r\n \r\n \t\t},\r\n \t\tonerror: function ( str, e ) {\r\n \r\n \t\t\tconsole.error( str );\r\n \r\n \t\t},\r\n \t\tappendTo: document.getElementById( \"appendto\" ),\r\n \r\n \t}\r\n \r\n  );\r\n *\r\n * @example\r\n *\r\n\t//loading of array of JavaScript files. Append script into head node.\r\n\tloadScript.async( [\r\n \t\t\"JavaScript1.js\",\r\n \t\t\"JavaScript2.js\",\r\n \t],\r\n \t{\r\n \t\tonload: function () {\r\n \r\n \t\t\tvar str = 'file has been loaded successfully';\r\n \t\t\tconsole.log( str );\r\n \r\n \t\t},\r\n \t\tonerror: function ( str, e ) {\r\n \r\n \t\t\tconsole.error( str );\r\n \r\n \t\t},\r\n \r\n \t}\r\n \r\n  );\r\n */\r\nfunction async( src, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[ 0 ];\r\n\toptions.onload = options.onload || function () {};\r\n\r\n\tvar isrc;\r\n\r\n\tfunction async( srcAsync ) {\r\n\r\n\t\tfunction next() {\r\n\r\n\t\t\tif ( src instanceof Array && ( isrc < ( src.length - 1 ) ) ) {\r\n\r\n\t\t\t\tisrc++;\r\n\t\t\t\tasync( src[isrc] );\r\n\r\n\t\t\t} else options.onload();\r\n\r\n\t\t}\r\n\r\n\t\tif ( isScriptExists( options.appendTo, srcAsync, options.onload ) ) {\r\n\r\n\t\t\tnext();\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\tscript.setAttribute( \"id\", srcAsync );\r\n\r\n\t\t\tfunction _onload() {\r\n\r\n\t\t\t\tconsole.log( 'loadScript.async.onload() ' + srcAsync );\r\n\t\t\t\tif ( options.onload !== undefined ) {\r\n\r\n\t\t\t\t\tnext();\r\n/*\r\n\t\t\t\t\tif ( src instanceof Array && ( isrc < ( src.length - 1 ) ) ) {\r\n\r\n\t\t\t\t\t\tisrc++;\r\n\t\t\t\t\t\tasync( src[isrc] );\r\n\r\n\t\t\t\t\t} else options.onload();\r\n*/\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( script.readyState && ! script.onload ) {\r\n\r\n\t\t\t\t// IE, Opera\r\n\t\t\t\tscript.onreadystatechange = function () {\r\n\r\n\t\t\t\t\tif ( script.readyState == \"complete\" ) {\r\n\r\n\t\t\t\t\t\t// �� ������ �������� loaded\r\n\t\t\t\t\t\tif ( options.onload !== undefined ) options.onload(); // (2)\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( script.readyState == \"loaded\" ) {\r\n\r\n\t\t\t\t\t\tsetTimeout( options.onload, 0 ); // (1)\r\n\r\n\t\t\t\t\t\t// ������� ����������, ����� �� �������� �� complete\r\n\t\t\t\t\t\tthis.onreadystatechange = null;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Rest\r\n\t\t\t\tscript.onload = _onload;\r\n\r\n\t\t\t\tscript.onerror = function ( e ) {\r\n\r\n\t\t\t\t\tvar str = 'loadScript: \"' + this.src + '\" failed';\r\n\t\t\t\t\tif ( options.onerror !== undefined )\r\n\t\t\t\t\t\toptions.onerror( str, e );\r\n\t\t\t\t\tconsole.error( str );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscript.src = srcAsync;\r\n\r\n\t\t}, options );\r\n\r\n\t}\r\n\r\n\tif ( src instanceof Array ) {\r\n\r\n\t\tisrc = 0;\r\n\t\tasync( src[ isrc ] );\r\n\r\n\t} else async( src );\r\n\r\n}\r\n\r\nfunction loadScriptBase( callback, options ) {\r\n\r\n\toptions.tag = options.tag || {};\r\n\tif ( typeof options.tag === \"string\" ) {\r\n\r\n\t\tswitch ( options.tag ) {\r\n\r\n\t\t\tcase 'style':\r\n\t\t\t\toptions.tag = {\r\n\r\n\t\t\t\t\tname: 'style',\r\n\t\t\t\t\tattribute: {\r\n\r\n\t\t\t\t\t\tname: 'rel',\r\n\t\t\t\t\t\tvalue: 'stylesheet',\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: console.error( 'Invalid options.tag: ' + options.tag );\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toptions.tag.name = options.tag.name || 'script';\r\n\tvar script = document.createElement( options.tag.name );\r\n\r\n\toptions.tag.attribute = options.tag.attribute || {};\r\n\toptions.tag.attribute.name = options.tag.attribute.name || \"type\";\r\n\toptions.tag.attribute.value = options.tag.attribute.value || 'text/javascript';\r\n\tscript.setAttribute( options.tag.attribute.name, options.tag.attribute.value );\r\n\r\n\tcallback( script );\r\n\toptions.appendTo.appendChild( script );\r\n\r\n}\r\n\r\nfunction isScriptExists( elParent, srcAsync, onload ) {\r\n\r\n\tvar scripts = elParent.querySelectorAll( 'script' );\r\n\tfor ( var i = 0; i < scripts.length; i++ ) {\r\n\r\n\t\tvar child = scripts[i];\r\n\t\tif ( child.id === srcAsync ) {\r\n\r\n/*\r\n\t\t\tif ( onload !== undefined )\r\n\t\t\t\tonload();\r\n*/\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\treturn false;\r\n\r\n}\r\n\r\nexport { async, sync, escapeHtml };\r\n","﻿/**\r\n * node.js version of download of the scripts.\r\n * \r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport { sync, async } from './index.js';\r\n\r\nvar loadScript = {\r\n\r\n\tsync: sync,\r\n\tasync: async,\r\n\r\n}\r\nexport default loadScript;\r\n","/**\r\n * @module ColorPicker\r\n * @description Pure JavaScript color picker.\r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n * @See Thanks to [FlexiColorPicker]{@link https://github.com/DavidDurman/FlexiColorPicker}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//Please download https://github.com/anhr/loadScriptNodeJS into ../loadScriptNodeJS folder\r\n\r\nimport loadScript from '../loadScriptNodeJS/loadScript.js';\r\n//import loadScript from 'https://raw.githack.com/anhr/commonNodeJS/master/loadScriptNodeJS/loadScript.js';\r\n//import loadScript from 'http://localhost/anhr/commonNodeJS/master/loadScriptNodeJS/loadScript.js';\r\n\r\nconst optionsStyle = {\r\n\r\n\t//style rel=\"stylesheet\"\r\n\ttag: 'style'\r\n\r\n}\r\n\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\n//Такая же функция есть в frustumPoints.js но если ее использовать то она будет возвращать путь на frustumPoints.js\r\nconst getCurrentScript = function () {\r\n\r\n\tif ( document.currentScript && ( document.currentScript.src !== '' ) )\r\n\t\treturn document.currentScript.src;\r\n\tconst scripts = document.getElementsByTagName( 'script' ),\r\n\t\tstr = scripts[scripts.length - 1].src;\r\n\tif ( str !== '' )\r\n\t\treturn src;\r\n\t//Thanks to https://stackoverflow.com/a/42594856/5175935\r\n\treturn new Error().stack.match( /(https?:[^:]*)/ )[0];\r\n\r\n};\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\nconst getCurrentScriptPath = function () {\r\n\tconst script = getCurrentScript(),\r\n\t\tpath = script.substring( 0, script.lastIndexOf( '/' ) );\r\n\treturn path;\r\n};\r\n//console.warn( 'getCurrentScriptPath = ' + getCurrentScriptPath() );\r\nconst currentScriptPath = getCurrentScriptPath();\r\n\r\n//loadScript.sync( 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.css', optionsStyle );\r\nloadScript.sync( currentScriptPath + '/colorpicker.css', optionsStyle );\r\n\r\nconst type = ( window.SVGAngle || document.implementation.hasFeature( \"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\" ) ? \"SVG\" : \"VML\" ),\r\n\tsvgNS = 'http://www.w3.org/2000/svg';\r\nvar uniqID = 0;\r\n\r\n/**\r\n * enumeration of available palettes.\r\n * @readonly\r\n * @enum {number}\r\n */\r\nconst paletteIndexes = {\r\n\t\r\n\r\n\t/** [blue, green, red, white]{@link https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/Example/index.html#BGRW} palette. This is the default palette*/\r\n\tBGRW: 0,\r\n\t/** [monochrome]{@link https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/Example/index.html#Monochrome} palette */\r\n\tmonochrome: 1,\r\n\t/** [red, black, green]{@link https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/Example/index.html#Bidirectional} palette */\r\n\tbidirectional: 2,//\r\n\t/** [rainbow]{@link https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/Example/index.html#rainbow} palette */\r\n\trainbow: 3,\r\n\r\n}\r\n/**\r\n * @callback callback\r\n * @description Called whenever the color is changed provided chosen color in RGB HEX format. See options.sliderIndicator.callback param of the create method.\r\n * @param {object} c color\r\n * @param {string} c.hex A hexadecimal color is specified with: #RRGGBB, where the RR (red), GG (green) and BB (blue)\r\n * <pre>\r\n * hexadecimal integers specify the components of the color. All values must be between 00 and FF.\r\n * Example #00ff00\r\n * </pre>\r\n * @param {number} c.r red of RGB color value. Must be between 0 and 255.\r\n * @param {number} c.g green of RGB color value. Must be between 0 and 255.\r\n * @param {number} c.b blue of RGB color value. Must be between 0 and 255.\r\n * @param {number} percent position of the mouse pointer in the percents. See details in options.direction param\r\n */\r\n\r\n/**\r\n * @callback onError\r\n * @param {string} message error message\r\n */\r\n\r\n/**\r\n * creates an instance of ColorPicker\r\n * @param {string|HTMLElement} elSliderWrapper id of the ColorPicker element or ColorPicker element\r\n * @param {object} [options] followed options is availablee\r\n * @param {paletteIndexes|object[]|Palette} [options.palette] Palette index or palette array or Palette. The following indexes are available:\r\n * <pre>\r\n * paletteIndexes.BGRW: 0 - blue, green, red, white palette.\r\n * paletteIndexes.monochrome: 1,\r\n * paletteIndexes.bidirectional: 2,//red, black, green\r\n * paletteIndexes.rainbow: 3,\r\n * Default is paletteIndexes.BGRW index.\r\n * Example of palette array:\r\n[\r\n\t{ percent: 0, r: 0, g: 0, b: 0, },\r\n\t{ percent: 10, r: 0xff, g: 255, b: 0xff, },\r\n\t{ percent: 100, r: 0xff, g: 255, b: 0xff, },\r\n]\r\n * Palette see function Palette( options ) for details\r\n * </pre>\r\n * @param {object} [options.orientation] orientation of the element. Available \"horizontal\" or \"vertical\" orientation\r\n * @param {object} [options.direction] true - position of the mouse pointer relative left side for 'horizontal' slider\r\n * or bottom side for 'vertical' slider in the percents.\r\n * <p>\r\n * false - position of the mouse pointer relative right side for 'horizontal' slider\r\n * or relative top side for 'vertical' slider in the percents.\r\n * </p>\r\n * Default is true.\r\n * @param {object} [options.style] style statements\r\n * @param {object} [options.style.width] width of the element. Default is 200px for options.orientation = \"horizontal\"\r\n * and 30px for options.orientation = \"vertical\".\r\n * @param {object} [options.style.height] height of the element. Default is 30px for options.orientation = \"horizontal\"\r\n * and 200px for options.orientation = \"vertical\".\r\n * @param {string} [options.style.border] elSliderWrapper border. Example: '1px solid black'\r\n * @param {object} [options.sliderIndicator] adds a slider-indicator element for choose by mouse a color from palette.\r\n * Default is undefuned\r\n * @param {callback} [options.sliderIndicator.callback] Called whenever the color is changed provided chosen color in RGB HEX format.\r\n * @param {number} [options.sliderIndicator.value] Initial position of the slider indicator in percent. Default is 0.\r\n * @param {onError} [options.onError] Called whenever an error has occurred.\r\n * @param {boolean} [options.duplicate] true - allow to create two or more palettes on your web page.\r\n */\r\nfunction create( elSliderWrapper, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.orientation = options.orientation || 'horizontal';\r\n\r\n\tfunction isHorizontal() { return options.orientation === \"horizontal\"; }\r\n\r\n\tif ( options.direction === undefined  )\r\n\t\toptions.direction = true;\r\n\toptions.style = options.style || {};\r\n\t//\t\toptions.style.width = options.style.width || ( isHorizontal() ? '200px' : '30px' );\r\n\toptions.style.width = options.style.width || ( isHorizontal() ? 200 : 30 );\r\n\toptions.style.height = options.style.height || ( isHorizontal() ? 30 : 200 );\r\n\r\n\toptions.onError = options.onError || function () {}\r\n\r\n\tif ( elSliderWrapper instanceof HTMLElement !== true ) {\r\n\r\n\t\tif ( typeof elSliderWrapper !== \"string\" ) {\r\n\r\n\t\t\tconsole.error( 'ColorPicker.create: invalid elSliderWrapper = ' + elSliderWrapper );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\telSliderWrapper = document.getElementById( elSliderWrapper );\r\n\t\tif ( elSliderWrapper === null ) {\r\n\r\n\t\t\tconsole.error( 'ColorPicker.create: invalid elSliderWrapper = ' + elSliderWrapper );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\telSliderWrapper.classList.add( 'slider-wrapper' );\r\n\tfor ( var style in options.style ) {\r\n\r\n\t\telSliderWrapper.style[style] = options.style[style];\r\n\r\n\t}\r\n\r\n\tconst palette = options.palette instanceof Palette ? options.palette : new Palette( options );\r\n\tvar slide;\r\n\tfunction getSlideHeight() {\r\n\r\n\t\tif ( typeof options.style.height === \"string\" )\r\n\t\t\treturn parseInt( options.style.height );\r\n\t\treturn options.style.height;\r\n\r\n\t}\r\n\tfunction getSlideWidth() { return slide.clientWidth; }\r\n\t/**\r\n\t * sets color from palette\r\n\t * @param {number} value coordinate of color from palette in percent\r\n\t * @param {number} position coordinate of color from palette\r\n\t */\r\n\tfunction setValue( value, position ) {\r\n\r\n\t\tif ( slideIndicator === undefined ) {\r\n\r\n\t\t\tconsole.error( 'Set value of this instance of the ColorPicker is impossible because options.sliderIndicator is not defined.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst c = palette.hsv2rgb( value );\r\n\t\tif ( c === undefined ) {\r\n\r\n\t\t\tconsole.error( 'ColorPicker.setValue: invalud c = ' + c );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvalue = c.percent;\r\n\t\tif ( position === undefined )\r\n\t\t\tposition = isHorizontal() ?\r\n\t\t\t\t( getSlideWidth() * value ) / 100 :\r\n\t\t\t\tgetSlideHeight() - ( getSlideHeight() * ( options.direction ? value : 100 - value ) ) / 100;\r\n\t\tpositionIndicators( position );\r\n\t\tif ( options.sliderIndicator.callback !== undefined ) {\r\n\r\n\t\t\t//console.warn( 'callback: ' + c.percent + ' percent c.hex = ' + c.hex );\r\n\t\t\toptions.sliderIndicator.callback( c );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar slideIndicator;\r\n\tif ( options.sliderIndicator !== undefined ) {\r\n\r\n\t\tslideIndicator = document.createElement( 'div' );\r\n\t\tslideIndicator.className = 'slider-indicator';\r\n\t\tif ( isHorizontal() )\r\n\t\t\tslideIndicator.style.width = '10px';\r\n\t\telse slideIndicator.style.height = '10px';\r\n\t\telSliderWrapper.appendChild( slideIndicator );\r\n\t\tslideIndicator.style.pointerEvents = 'none';\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Helper to position indicators.\r\n\t * @param {number} position Coordinates of the mouse cursor in the slide area.\r\n\t */\r\n\tfunction positionIndicators( position ) {\r\n\r\n\t\tif ( slideIndicator === undefined )\r\n\t\t\treturn;\r\n\r\n\t\tif ( isHorizontal() ) {\r\n\r\n\t\t\tif ( ( position < 0 ) || ( position > getSlideWidth() ) ) {\r\n\r\n\t\t\t\tconsole.error( 'ColorPicker.positionIndicators: Invalid position = ' + position );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tslideIndicator.style.top = '0px';\r\n\t\t\tslideIndicator.style.left = ( ( options.direction ? position : getSlideWidth() - position ) - slideIndicator.offsetWidth / 2 ) + 'px';\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( ( position < 0 ) || ( position > getSlideHeight() ) ) {\r\n\r\n\t\t\t\tconsole.error( 'ColorPicker.positionIndicators: Invalid position = ' + position );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tslideIndicator.style.left = '0px';\r\n\t\t\tslideIndicator.style.top = ( position - slideIndicator.offsetHeight / 2 ) + 'px';\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tif ( type == 'SVG' ) {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tconst linearGradient = 'linearGradient';\r\n\t\t\tslide = CreateSVGElement( 'svg', {\r\n\t\t\t\txmlns: 'http://www.w3.org/2000/svg',\r\n\t\t\t\tversion: '1.1',\r\n\t\t\t\twidth: isHorizontal() ? '100%' : options.style.width,\r\n\t\t\t\theight: options.style.height,\r\n\t\t\t},\r\n\t\t\t\t[\r\n\t\t\t\t\tCreateSVGElement( 'defs', {},\r\n\t\t\t\t\t\tCreateSVGElement( linearGradient, {\r\n\r\n\t\t\t\t\t\t\tid: 'gradient-hsv-' + uniqID,\r\n\t\t\t\t\t\t\tx1: isHorizontal() && options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\ty1: !isHorizontal() && !options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\tx2: isHorizontal() && !options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\ty2: !isHorizontal() && options.direction ? '100%' : '0%',\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tpalette.getPalette()\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\tCreateSVGElement( 'rect', { x: '0', y: '0', width: '100%', height: '100%', fill: 'url(#gradient-hsv-' + uniqID + ')' } )\r\n\t\t\t\t]\r\n\t\t\t);\r\n\t\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\t\tslide.style.cursor = isHorizontal() ? 'e-resize' : 's-resize';\r\n\t\t\t\tslideIndicator.style.cursor = slide.style.cursor;\r\n\r\n\t\t\t}\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\t//I can not get \r\n\t\t\t// slide.querySelector( linearGradient );\r\n\t\t\t//in Safari 5.1.7 browser for Windows\r\n\t\t\t//Instead I see the error message:\r\n\t\t\t// 'null' is not an object( evaluating 'hsvGradient.id = 'gradient - hsv - ' + uniqID' )\r\n\t\t\tconsole.error( 'Create SVG element failed! ' + e.message );\r\n\r\n\t\t}\r\n\r\n\t\telSliderWrapper.appendChild( slide );\r\n\t\telSliderWrapper.style.height = getSlideHeight() + 'px'; \r\n\r\n\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\tif ( isHorizontal() )\r\n\t\t\t\tslideIndicator.style.height = ( parseInt( options.style.height ) - 2 ) + 'px';\r\n\t\t\telse slideIndicator.style.width = ( parseInt( options.style.width ) - 2 ) + 'px';\r\n\r\n\t\t\toptions.sliderIndicator.value = options.sliderIndicator.value || 0;\r\n\t\t\tsetValue( options.sliderIndicator.value );\r\n\r\n\t\t}\r\n\t\tuniqID++;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.error( 'Under constraction' );\r\n\r\n\t}\r\n\r\n\tfunction mouseMove( mouse ) {\r\n\r\n\t\t//for IE\r\n\t\tmouse.x = parseInt( mouse.x );\r\n\t\tmouse.y = parseInt( mouse.y );\r\n\r\n\t\tvar position, size, value;\r\n\t\tif ( isHorizontal() ) {\r\n\r\n\t\t\tposition = mouse.x;\r\n\t\t\tsize = getSlideWidth() - 1;\r\n\r\n\t\t\tif ( position >= getSlideWidth() )\r\n\t\t\t\tposition = size;\r\n\t\t\tvalue = ( position * 100 ) / size;\r\n\t\t\tif ( !options.direction ) {\r\n\r\n\t\t\t\tvalue = 100 - value;\r\n\t\t\t\tposition = size - position;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tposition = mouse.y;\r\n\t\t\tsize = getSlideHeight() - 1;\r\n\r\n\t\t\tif ( position >= getSlideHeight() )\r\n\t\t\t\tposition = size;\r\n\t\t\tvalue = ( 1 - position / size ) * 100;\r\n\t\t\tif ( !options.direction ) {\r\n\r\n\t\t\t\tvalue = 100 - value;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tsetValue( value, position );\r\n\r\n\t}\r\n\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\tvar mouseout = false;\r\n\r\n\t\t/**\r\n\t\t * Return click event handler for the slider.\r\n\t\t * Sets picker background color and calls options.sliderIndicator.callback if provided.\r\n\t\t */\r\n\t\tfunction slideListener() {\r\n\r\n\t\t\treturn function ( evt ) {\r\n\r\n\t\t\t\tif ( mouseout )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tevt = evt || window.event;\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Return mouse position relative to the element el.\r\n\t\t\t\t */\r\n\t\t\t\tfunction mousePosition( evt ) {\r\n\t\t\t\t\t// IE:\r\n\t\t\t\t\tif ( window.event && window.event.contentOverflow !== undefined ) {\r\n\t\t\t\t\t\treturn { x: window.event.offsetX, y: window.event.offsetY };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Webkit:\r\n\t\t\t\t\tif ( evt.offsetX !== undefined && evt.offsetY !== undefined ) {\r\n\t\t\t\t\t\treturn { x: evt.offsetX, y: evt.offsetY };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Firefox:\r\n\t\t\t\t\tvar wrapper = evt.target.parentNode.parentNode;\r\n\t\t\t\t\treturn { x: evt.layerX - wrapper.offsetLeft, y: evt.layerY - wrapper.offsetTop };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmouseMove( mousePosition( evt ) );\r\n\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tfunction addEventListener( element, event, listener ) {\r\n\r\n\t\t\tif ( element === null )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif ( element.attachEvent ) {\r\n\r\n\t\t\t\telement.attachEvent( 'on' + event, listener );\r\n\r\n\t\t\t} else if ( element.addEventListener ) {\r\n\r\n\t\t\t\telement.addEventListener( event, listener, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddEventListener( slide, 'click', slideListener() );\r\n\r\n\t\t/**\r\n\t\t * @callback listener\r\n\t\t*/\r\n\r\n\t\t/**\r\n\t\t * Enable drag&drop color selection.\r\n\t\t * @param {object} ctx ColorPicker instance.\r\n\t\t * @param {listener} listener Function that will be called whenever mouse is dragged over the element with event object as argument.\r\n\t\t */\r\n\t\tfunction enableDragging( ctx, listener ) {\r\n\r\n\t\t\tvar element = slide;\r\n\r\n\t\t\t//Touchscreen support\r\n\r\n\t\t\taddEventListener( element, 'touchstart', function ( evt ) { } );\r\n\t\t\taddEventListener( element, 'touchmove', function ( evt ) {\r\n\r\n\t\t\t\tevt.preventDefault();\r\n\r\n\t\t\t\tvar rect = evt.srcElement.getBoundingClientRect(),\r\n\t\t\t\t\tx = ( evt.touches[0].clientX - rect.left ),\r\n\t\t\t\t\ty = ( evt.touches[0].clientY - rect.top );\r\n\t\t\t\tif ( x < 0 ) x = 0;\r\n\t\t\t\tif ( y < 0 ) y = 0;\r\n\t\t\t\tmouseMove( { x: x, y: y } );\r\n\r\n\t\t\t} );\r\n\t\t\taddEventListener( element, 'touchend', function ( evt ) {\r\n\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//mouse support\r\n\t\t\taddEventListener( element, 'mousedown', function ( evt ) {\r\n\r\n\t\t\t\tconst mouseup = 'mouseup', mousemove = 'mousemove';\r\n\t\t\t\tfunction onMouseUp() {\r\n\r\n\t\t\t\t\t//console.warn( mouseup );\r\n\t\t\t\t\tfunction removeEventListener( element, event, listener ) {\r\n\r\n\t\t\t\t\t\tif ( element === null )\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\tif ( element.detachEvent ) {\r\n\r\n\t\t\t\t\t\t\telement.detachEvent( 'on' + event, listener );\r\n\r\n\t\t\t\t\t\t} else if ( element.removeEventListener ) {\r\n\r\n\t\t\t\t\t\t\telement.removeEventListener( event, listener, false );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tremoveEventListener( window, mouseup, onMouseUp );\r\n\t\t\t\t\tremoveEventListener( window, mousemove, listener );\r\n\r\n\t\t\t\t}\r\n\t\t\t\taddEventListener( window, mouseup, onMouseUp );\r\n\t\t\t\taddEventListener( window, mousemove, listener );\r\n\r\n\t\t\t} );\r\n\t\t\taddEventListener( element, 'mouseout', function ( evt ) { mouseout = true; } );\r\n\t\t\taddEventListener( element, 'mouseover', function ( evt ) { mouseout = false; } );\r\n\t\t}\r\n\t\tenableDragging( this, slideListener() );\r\n\r\n\t}\r\n\r\n\treturn {\r\n\r\n\t\tsetValue: setValue,\r\n\r\n\t};\r\n}\r\n\r\nfunction CreateSVGElement( el, attrs, children ) {\r\n\r\n\tel = document.createElementNS( svgNS, el );\r\n\tfor ( var key in attrs )\r\n\t\tel.setAttribute( key, attrs[key] );\r\n\tif ( Object.prototype.toString.call( children ) != '[object Array]' ) children = [children];\r\n\tvar i = 0, len = ( children[0] && children.length ) || 0;\r\n\tfor ( ; i < len; i++ )\r\n\t\tel.appendChild( children[i] );\r\n\treturn el;\r\n}\r\n\r\nvar boCreated = false;\r\n\r\n/**\r\n * create palette\r\n * @param {object} [options] the following options are available\r\n * @param {paletteIndexes|object[]} [options.palette] Palette index or palette array. The following indexes are available:\r\n * <pre>\r\n * paletteIndexes.BGRW: 0 - blue, green, red, white palette.\r\n * paletteIndexes.monochrome: 1,\r\n * paletteIndexes.bidirectional: 2,//red, black, green\r\n * paletteIndexes.rainbow: 3,\r\n * Default is paletteIndexes.BGRW index.\r\n * Example of palette array:\r\n[\r\n\t{ percent: 0, r: 0, g: 0, b: 0, },\r\n\t{ percent: 10, r: 0xff, g: 255, b: 0xff, },\r\n\t{ percent: 100, r: 0xff, g: 255, b: 0xff, },\r\n]\r\n* </pre>\r\n*/\r\nfunction Palette( options ) {\r\n\r\n\r\n\tfunction paletteitem( percent, r, g, b ) {\r\n\r\n\t\treturn {\r\n\r\n\t\t\tpercent: percent,\r\n\t\t\tr: r,\r\n\t\t\tg: g,\r\n\t\t\tb: b,\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toptions = options || {};\r\n/*есть случай когда для каждой точки создается своя палитра\r\n\tif ( !options.duplicate && boCreated ) {\r\n\r\n\t\tconsole.warn( 'Palette: duplicate palette' );\r\n\t\treturn;\r\n\r\n\t}\r\n*/\t\r\n\tif ( options.palette === undefined )\r\n\t\toptions.palette = paletteIndexes.BGRW;\r\n\r\n\tvar arrayPalette = [\r\n\r\n\t\tnew paletteitem( 0, 0x00, 0x00, 0xFF ),//blue\r\n\t\tnew paletteitem( 33, 0x00, 0xFF, 0x00 ),//green\r\n\t\tnew paletteitem( 66, 0xFF, 0xFF, 0x00 ),//red\r\n\t\tnew paletteitem( 100, 0xFF, 0xFF, 0xFF ),//white\r\n\r\n\t];\r\n\tswitch ( typeof options.palette ) {\r\n\r\n\t\tcase 'number':\r\n\t\t\tswitch ( options.palette ) {\r\n\r\n\t\t\t\tcase paletteIndexes.BGRW:\r\n\t\t\t\t\tbreak;//default palette\r\n\t\t\t\tcase paletteIndexes.monochrome:\r\n\t\t\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\t\t\tnew paletteitem( 0, 0x00, 0x00, 0x00 ),//blach\r\n\t\t\t\t\t\tnew paletteitem( 100, 0xFF, 0xFF, 0xFF ),//white\r\n\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase paletteIndexes.bidirectional:\r\n\t\t\t\t\tvar arrayPalette = [\r\n\t\t\t\t\t\tnew paletteitem( 0, 0xff, 0x30, 0x30 ),//red\r\n\t\t\t\t\t\tnew paletteitem( 50, 0x30, 0x30, 0x30 ),//gray\r\n\t\t\t\t\t\tnew paletteitem( 100, 0x30, 0xFF, 0x30 ),//green\r\n\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase paletteIndexes.rainbow:\r\n\t\t\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\t\t\tnew paletteitem( 0, 0xff, 0x32, 0x32 ),\r\n\t\t\t\t\t\tnew paletteitem( 16, 0xfc, 0xf5, 0x28 ),\r\n\t\t\t\t\t\tnew paletteitem( 32, 0x28, 0xfc, 0x28 ),\r\n\t\t\t\t\t\tnew paletteitem( 50, 0x28, 0xfc, 0xf8 ),\r\n\t\t\t\t\t\tnew paletteitem( 66, 0x27, 0x2e, 0xf9 ),\r\n\t\t\t\t\t\tnew paletteitem( 82, 0xff, 0x28, 0xfb ),\r\n\t\t\t\t\t\tnew paletteitem( 100, 0xff, 0x32, 0x32 ),\r\n\r\n\t\t\t\t\t];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error( 'ColorPicker.create.Palette: invalid options.palette = ' + options.palette );\r\n\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase \"object\":\r\n\t\t\tif ( Array.isArray( options.palette ) ) {\r\n\r\n\t\t\t\t//Custom palette\r\n\t\t\t\tarrayPalette = options.palette;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\tvar message = 'invalid options.palette = ' + options.palette;\r\n\t\t\tconsole.error( 'ColorPicker.create.Palette: ' + message );\r\n\t\t\toptions.onError( message );\r\n\r\n\t}\r\n\t/**\r\n\t* returns palette array.\r\n\t* @function Palette.\r\n\t* getPalette\r\n\t* @returns {object[]} palette array\r\n\t*/\r\n\tthis.getPalette = function () {\r\n\r\n\t\tconst palette = [];\r\n\t\tarrayPalette.forEach( function ( item ) {\r\n\r\n\t\t\tpalette.unshift( CreateSVGElement( 'stop', {\r\n\r\n\t\t\t\toffset: ( 100 - item.percent ) + '%', 'stop-color': '#'\r\n\t\t\t\t\t//Thanks to https://stackoverflow.com/a/13240395/5175935\r\n\t\t\t\t\t+ ( \"0\" + ( Number( item.r ).toString( 16 ) ) ).slice( -2 ).toUpperCase()\r\n\t\t\t\t\t+ ( \"0\" + ( Number( item.g ).toString( 16 ) ) ).slice( -2 ).toUpperCase()\r\n\t\t\t\t\t+ ( \"0\" + ( Number( item.b ).toString( 16 ) ) ).slice( -2 ).toUpperCase(),\r\n\t\t\t\t'stop-opacity': '1'\r\n\r\n\t\t\t} ) );\r\n\r\n\t\t} );\r\n\t\treturn palette;\r\n\r\n\t}\r\n\t/**\r\n\t* converts a percent or value from min to max  to object with r, g, b, hex and percent.\r\n\t* @function Palette.\r\n\t* hsv2rgb\r\n\t* @param {number} stringPercent coordinate of color from palette in percent or value from min to max\r\n\t* @param {number} [min] min stringPercent. Default is undefined.\r\n\t* @param {number} [max] max stringPercent. Default is undefined.\r\n\t* @returns {object} object with r, g, b, hex and percent\r\n\t*/\r\n\tthis.hsv2rgb = function ( stringPercent, min, max ) {\r\n\r\n\t\tvar percent = parseFloat( stringPercent );\r\n\t\tif ( min !== undefined && max !== undefined )\r\n\t\t\tpercent = ( 100 / ( max - min ) ) * ( percent - min );\r\n\t\tvar lastPalette = arrayPalette[arrayPalette.length - 1];\r\n\t\tif ( lastPalette.percent !== 100 ) {\r\n\r\n\t\t\t//not compatible with Safari for Windows\r\n\t\t\t//var lastItem = Object.assign( {}, arrayPalette[arrayPalette.length - 1] );\r\n\r\n\t\t\tconst lastItem = {};\r\n\t\t\tObject.keys( lastPalette ).forEach( function ( key ) {\r\n\r\n\t\t\t\tlastItem[key] = lastPalette[key];\r\n\r\n\t\t\t} );\r\n\t\t\tlastItem.percent = 100;\r\n\t\t\tarrayPalette.push( lastItem );\r\n\r\n\t\t}\r\n\t\tvar itemPrev;\r\n\t\tfor ( var i = 0; i < arrayPalette.length; i++ ) {\r\n\r\n\t\t\tconst item = arrayPalette[i];\r\n\t\t\tif ( itemPrev === undefined )\r\n\t\t\t\titemPrev = item;\r\n\t\t\tif ( ( ( percent >= itemPrev.percent ) && ( percent <= item.percent ) ) ) {\r\n\r\n\t\t\t\tfunction color( percentPrev, prev, percentItem, item ) {\r\n\r\n\t\t\t\t\tvar percentD = percentItem - percentPrev;\r\n\t\t\t\t\tif ( percentD === 0 )\r\n\t\t\t\t\t\treturn prev;\r\n\t\t\t\t\treturn Math.round( prev + ( ( item - prev ) / percentD ) * ( percent - percentPrev ) );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst r = color( itemPrev.percent, itemPrev.r, item.percent, item.r ),\r\n\t\t\t\t\tg = color( itemPrev.percent, itemPrev.g, item.percent, item.g ),\r\n\t\t\t\t\tb = color( itemPrev.percent, itemPrev.b, item.percent, item.b );\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tr: r,\r\n\t\t\t\t\tg: g,\r\n\t\t\t\t\tb: b,\r\n\t\t\t\t\thex: \"#\" + ( 16777216 | b | ( g << 8 ) | ( r << 16 ) ).toString( 16 ).slice( 1 ),\r\n\t\t\t\t\tpercent: percent\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\t\t\titemPrev = item;\r\n\r\n\t\t}\r\n\t\tif ( options.onError !== undefined )\r\n\t\t\toptions.onError( 'Invalid color value of the ColorPicker: ' + stringPercent );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t* converts a value in percentages to color.\r\n\t* @function Palette.\r\n\t* toColor\r\n\t* @param {number} value coordinate of color from palette in percent. Default value range from 0 to 100.\r\n\t* @param {number} min minimal value\r\n\t* @param {number} max maximal value\r\n\t* @returns {THREE.Color} color\r\n\t*/\r\n\tthis.toColor = function ( value, min, max ) {\r\n\r\n\t\tif ( typeof THREE === 'undefined' ){\r\n\r\n\t\t\tconsole.error( 'Call ColorPicker.palette.setTHREE(THREE) first.' );\r\n\t\t\treturn;\r\n\t\t\t\r\n\t\t}\r\n\t\tif ( value instanceof THREE.Color )\r\n\t\t\treturn value;\r\n\t\tvar c = this.hsv2rgb( value, min, max );\r\n\t\tif ( c === undefined )\r\n\t\t\tc = { r: 255, g: 255, b: 255 }\r\n\t\treturn new THREE.Color( \"rgb(\" + c.r + \", \" + c.g + \", \" + c.b + \")\" );\r\n\r\n\t}\r\n\r\n\tboCreated = true;\r\n\r\n}\r\n\r\nvar THREE;\r\n/**\r\n * set THREE\r\n * @function Palette.\r\n * setTHREE\r\n * @param {THREE} _THREE {@link https://github.com/anhr/three.js|THREE}\r\n */\r\nPalette.setTHREE = function ( _THREE ) {\r\n\r\n\tif ( THREE ) {\r\n\r\n\t\tif ( !Object.is( THREE, _THREE ) )\r\n\t\t\tconsole.error( 'Palette.setTHREE: duplicate THREE. Please use one instance of the THREE library.' )\r\n\t\treturn;\r\n\r\n\t}\r\n\tTHREE = _THREE;\r\n\r\n}\r\nexport { paletteIndexes, create, Palette };\r\n","﻿/**\r\n * @module ColorPicker\r\n * @description Pure JavaScript color picker.\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Thanks to https://github.com/DavidDurman/FlexiColorPicker\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n */\r\n\r\nimport { create, paletteIndexes, Palette } from './index.js';\r\n/**\r\n * pure JavaScript color picker without using images, external CSS or 1px divs.\r\n */\r\nvar ColorPicker = {\r\n\r\n\tcreate: create,\r\n\tpaletteIndexes: paletteIndexes,\r\n\tpalette: Palette,\r\n\r\n}\r\nexport default ColorPicker;\r\n","/**\r\n * @module functionsFolder\r\n * @description Adds the [Functions]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} folder into [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport { dat } from './dat/dat.module.js';\r\n\r\n/**\r\n * Adds the [Functions]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} folder into [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n * @param {GUI} fParent parent folder for functions folder.\r\n * @param {Object} scales [AxesHelper]{@link https://raw.githack.com/anhr/AxesHelper/master/jsdoc/module-AxesHelper.html} options.scales for details.\r\n * @param {THREE} THREE {@link https://github.com/anhr/three.js|THREE}\r\n * @param {Function} onFinishChange callback function is called every time, when user have entered new value of the function and the function controller is lost of the focus.\r\n * <pre>\r\n * parameter value is new value of the function.\r\n * </pre>\r\n * @param {object} [options] the following options are available:\r\n * @param {Function} [options.getLanguageCode=\"en\"] returns the \"primary language\" subtag of the version of the browser. Default returns \"en\" is English\r\n * @param {object} [options.vector] Vector with initial text of the function\r\n * @param {object} [options.vector.x] text of the x axis function\r\n * @param {object} [options.vector.y] text of the y axis function\r\n * @param {object} [options.vector.z] text of the z axis function\r\n*/\r\nconst functionsFolder = function ( fParent, scales, THREE, onFinishChange, options = {} ) {\r\n\r\n\tconst _this = this;\r\n\tvar boError = false;\r\n\r\n\t//Localization\r\n\r\n\tconst getLanguageCode = options.getLanguageCode || function () { return 'en'; };\r\n\r\n\tconst lang = {\r\n\r\n\t\tfunctions: 'Functions',\r\n\r\n\t\tdefaultButton: 'Default',\r\n\t\tdefaultTitle: 'Restore default functions.',\r\n\r\n\t};\r\n\r\n\tconst _languageCode = getLanguageCode();\r\n\r\n\tswitch ( _languageCode ) {\r\n\r\n\t\tcase 'ru'://Russian language\r\n\r\n\t\t\tlang.functions = 'Функции';\r\n\r\n\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\tlang.defaultTitle = 'Восстановить функции.';\r\n\r\n\t\t\tbreak;\r\n\t\tdefault://Custom language\r\n\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t} );\r\n\r\n\t}\r\n\r\n\tconst fFunctions = fParent.addFolder( lang.functions ),\r\n\t\tvector = {\r\n\r\n\t\t\tx: options.vector ? getFuncText( options.vector.x ) : '',\r\n\t\t\ty: options.vector ? getFuncText( options.vector.y ) : '',\r\n\t\t\tz: options.vector ? getFuncText( options.vector.z ) : '',\r\n\t\t\tw: options.vector ? getFuncText( options.vector.w ) : '',\r\n\r\n\t\t},\r\n\t\t//onFinishChange вызывается даже если vector не изменился. Поэтому такой onFinishChange пропускается\r\n\t\tvectorCur = {\r\n\r\n\t\t\tx: vector.x,\r\n\t\t\ty: vector.y,\r\n\t\t\tz: vector.z,\r\n\t\t\tw: vector.w,\r\n\r\n\t\t},\r\n\t\tcFunctions = { };\r\n\tfunction createControl( axisName ) {\r\n\r\n\t\tif ( vector[axisName] === undefined )\r\n\t\t\treturn;\r\n\t\tcFunctions[axisName] = fFunctions.add( vector, axisName ).onFinishChange( function ( value ) {\r\n\r\n\t\t\t__onFinishChange( value, axisName, vectorCur );\r\n\r\n\t\t} );\r\n\t\tdat.controllerNameAndTitle( cFunctions[axisName], getAxisName( axisName ) );\r\n\r\n\t}\r\n\tfunction getAxisName( axisName ) { return scales[axisName] && scales[axisName].name ? scales[axisName].name : axisName; }\r\n\tcreateControl( 'x' );\r\n\tcreateControl( 'y' );\r\n\tcreateControl( 'z' );\r\n\tcreateControl( 'w' );\r\n\r\n\t//Default scale button\r\n\tconst buttonDefault = fFunctions.add( {\r\n\r\n\t\tdefaultF: function ( value ) {\r\n\r\n\t\t},\r\n\r\n\t}, 'defaultF' );\r\n\tdat.controllerNameAndTitle( buttonDefault, lang.defaultButton, lang.defaultTitle );\r\n\r\n\tfunction getFuncText ( func ) {\r\n\r\n\t\tif ( func === undefined )\r\n\t\t\treturn;\r\n\t\tif ( typeof func === 'object' ) {\r\n\r\n\t\t\tif ( func instanceof THREE.Color ) return func.getStyle();\r\n\t\t\tif ( Array.isArray( func ) ) return JSON.stringify(func)\r\n\t\t\tfunc = func.func ? func.func : func;\r\n\r\n\t\t}\r\n\t\tconst typeofFunc = typeof func;\r\n\t\tswitch ( typeofFunc ) {\r\n\r\n\t\t\tcase 'number':\r\n\t\t\t\tfunc = func.toString();//если это не делать будет создан NumberControllerBox, ктороый не позволяет вводить float\r\n\t\t\tcase 'string':\r\n\t\t\t\treturn func;\r\n\t\t\tcase 'function':\r\n\t\t\t\treturn func.toString().split( /return (.*)/ )[1];\r\n\t\t\tdefault: console.error( 'functionsFolder.getFuncText(...): typeof func = ' + typeofFunc );\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t}\r\n\tfunction __onFinishChange( value, axisName, vectorCur ) {\r\n\r\n\t\tif ( ( vectorCur[axisName] === value ) && !boError )\r\n\t\t\treturn;\r\n\t\ttry {\r\n\r\n\t\t\tboError = false;\r\n\t\t\tvectorCur[axisName] = value;\r\n\t\t\tvar func;\r\n\t\t\tconst typeofValue = typeof value;\r\n\t\t\tswitch ( typeofValue ) {\r\n\r\n\t\t\t\tcase 'string':\r\n\r\n\t\t\t\t\tvar float = parseFloat( value );\r\n\t\t\t\t\tif ( float.toString() !== value ) {\r\n\r\n\t\t\t\t\t\t//\t\t\t\t\t\tconst color = value.replace(/\\s/g, \"\").toLowerCase().split( /rgb\\((\\d+),(\\d+),(\\d+)\\)/ );\r\n\t\t\t\t\t\tconst color = value.replace( /\\s/g, \"\" ).split( /rgb\\((\\d+),(\\d+),(\\d+)\\)/ );\r\n\t\t\t\t\t\tif ( color.length === 5 ) func = new THREE.Color( value );\r\n\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\tvar array;\r\n\t\t\t\t\t\t\ttry {\r\n\r\n\t\t\t\t\t\t\t\tarray = JSON.parse( value );\r\n\r\n\t\t\t\t\t\t\t} catch ( e ) { }\r\n\t\t\t\t\t\t\tif ( Array.isArray( array ) ) func = array;\r\n\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\tfunc = new Function( 't', 'a', 'b', 'return ' + value );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else func = float;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'number':\r\n\r\n\t\t\t\t\tfunc = value;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error( 'onFinishChange( ' + value + ' ): invalid type = ' + typeofValue );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tonFinishChange( func, axisName );\r\n\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\talert( 'Axis: ' + getAxisName( axisName ) + '. Function: \"' + value + '\". ' + e );\r\n\t\t\t_this.setFocus( axisName );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * set the function text\r\n\t * @function functionsFolder.\r\n\t * setFunction\r\n\t * @param {object} _vector vector of the axis functions.\r\n\t * @param {object} _vector.x x axis function.\r\n\t * @param {object} _vector.y y axis function.\r\n\t * @param {object} _vector.z z axis function.\r\n\t */\r\n\tthis.setFunction = function ( _vector/*, boDefault*/ ) {\r\n\r\n\t\tconst vector = {\r\n\r\n\t\t\tx: _vector ? getFuncText( _vector.x ) : '',\r\n\t\t\ty: _vector ? getFuncText( _vector.y ) : '',\r\n\t\t\tz: _vector ? getFuncText( _vector.z ) : '',\r\n\t\t\tw: _vector ? getFuncText( _vector.w ) : '',\r\n\r\n\t\t},\r\n\t\t//onFinishChange вызывается даже если vector не изменился. Поэтому такой onFinishChange пропускается\r\n\t\tvectorCur = {\r\n\r\n\t\t\tx: vector.x,\r\n\t\t\ty: vector.y,\r\n\t\t\tz: vector.z,\r\n\t\t\tw: vector.w,\r\n\r\n\t\t};\r\n\t\tif ( !_vector.vectorDefault )\r\n\t\t\t_vector.vectorDefault = {\r\n\r\n\t\t\t\tx: vector.x,\r\n\t\t\t\ty: vector.y,\r\n\t\t\t\tz: vector.z,\r\n\t\t\t\tw: vector.w,\r\n\r\n\t\t\t};\r\n\t\tfunction setVectorAxis( axisName ) {\r\n\r\n\t\t\tif ( _vector[axisName] === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tcFunctions[axisName].__onFinishChange = function( value ){\r\n\r\n\t\t\t\t__onFinishChange( value, axisName, vectorCur );\r\n\r\n\t\t\t}\r\n\t\t\tvector[axisName] = getFuncText( _vector[axisName] );\r\n\t\t\tcFunctions[axisName].setValue( vector[axisName] );\r\n\t\t\tvectorCur[axisName] = vector[axisName];\r\n\r\n\t\t}\r\n\t\tsetVectorAxis( 'x' );\r\n\t\tsetVectorAxis( 'y' );\r\n\t\tvar dislay = false;\r\n\t\tif ( _vector.z ) {\r\n\r\n\t\t\tsetVectorAxis( 'z' );\r\n\t\t\tdislay = true;\r\n\r\n\t\t}\r\n\t\tbuttonDefault.object.defaultF = function( value ) {\r\n\r\n\t\t\tfunction setValue( axisName ) {\r\n\r\n\t\t\t\tif ( !cFunctions[axisName] )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcFunctions[axisName].setValue( _vector.vectorDefault[axisName] );\r\n\t\t\t\tcFunctions[axisName].__onFinishChange( _vector.vectorDefault[axisName] );\r\n\r\n\t\t\t}\r\n\t\t\tsetValue( 'x' );\r\n\t\t\tsetValue( 'y' );\r\n\t\t\tsetValue( 'z' );\r\n\t\t\tsetValue( 'w' );\r\n\r\n\t\t}\r\n\t\tfunction dislayEl( controller, displayController ) {\r\n\r\n\t\t\tif ( controller === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tif ( typeof displayController === \"boolean\" )\r\n\t\t\t\tdisplayController = displayController ? 'block' : 'none';\r\n\t\t\tvar el = controller.domElement;\r\n\t\t\twhile ( el.tagName.toUpperCase() !== \"LI\" ) el = el.parentElement;\r\n\t\t\tel.style.display = displayController;\r\n\r\n\t\t}\r\n\t\tdislayEl( cFunctions.z, dislay );\r\n\t\tsetVectorAxis( 'w' );\r\n\r\n\t}\r\n\t/**\r\n\t * Display functions folder\r\n\t * @function functionsFolder.\r\n\t * displayFolder\r\n\t * @param {string} display display is 'block' - functions folder is visible.\r\n\t * <pre>\r\n\t * 'none' - functions folder is hide.\r\n\t * </pre>\r\n\t */\r\n\tthis.displayFolder = function ( display ) { fFunctions.domElement.style.display = display; }\r\n\t /**\r\n\t * set focus to controller\r\n\t * @function functionsFolder.\r\n\t * setFocus\r\n\t * @param {string} axisName Name of the axis of the controller\r\n\t */\r\n\tthis.setFocus = function ( axisName ) {\r\n\r\n\t\tcFunctions[axisName].domElement.childNodes[0].focus();\r\n\t\tboError = true;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default functionsFolder;","/**\r\n * @module GuiSelectPoint\r\n *\r\n * @description A dat.gui based graphical user interface for select a point from the mesh.\r\n * \r\n * @see {@link https://github.com/anhr/dat.gui|dat.gui}, {@link https://threejs.org/docs/index.html#api/en/objects/Mesh|three.js mesh}.\r\n *\r\n * @author Andrej Hristoliubov. {@link https://anhr.github.io/AboutMe/|AboutMe}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\n//import * as THREE from 'https://threejs.org/build/three.module.js';\r\n//import * as THREE from '../../three.js/dev/build/three.module.js';//https://github.com/anhr/three.js;\r\n//import * as THREE from 'https://raw.githack.com/anhr/three.js/dev/build/three.module.js';\r\n//import { THREE } from './three.js';\r\nvar THREE;\r\n\r\nimport { dat } from '../dat/dat.module.js';\r\n//import { dat } from 'https://raw.githack.com/anhr/commonNodeJS/master/dat/dat.module.js';\r\n\r\nimport ScaleController from '../ScaleController.js';\r\n//import ScaleController from 'https://raw.githack.com/anhr/commonNodeJS/master/ScaleController.js';\r\n\r\nimport PositionController from '../PositionController.js';\r\n//import PositionController from 'https://raw.githack.com/anhr/commonNodeJS/master/PositionController.js';\r\n\r\nimport ColorPicker from '../colorpicker/colorpicker.js';//https://github.com/anhr/commonNodeJS/tree/master/colorpicker\r\n//import ColorPicker from 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.js';\r\n\r\n//import Player from '../player/build/player.module.js';\r\n//import Player from '../player/build/player.module.min.js';\r\nimport Player from '../player/player.js';\r\n//import Player from 'https://raw.githack.com/anhr/commonNodeJS/master/player/player.js';\r\n//import Player from 'https://raw.githack.com/anhr/commonNodeJS/master/player/build/player.module.min.js';\r\n\r\nimport functionsFolder from '../functionsFolder.js';\r\n\r\n\r\n/**\r\n * A dat.gui based graphical user interface for select a point from the mesh.\r\n * @param {THREE} _THREE {@link https://github.com/anhr/three.js|THREE}\r\n * @param {object} [guiParams] Followed parameters is allowed. Default is no parameters\r\n * @param {AxesHelper} [guiParams.axesHelper] An axis object to visualize axes. Default is undefined.\r\n * See {@link https://github.com/anhr/AxesHelper|AxesHelper}.\r\n * @param {string} [guiParams.options] See {@link https://raw.githack.com/anhr/AxesHelper/master/jsdoc/index.html|axesHelper.options} for details. Default is axesHelper.options if axesHelper is defined or { scales: {...} }\r\n * @param {string} [guiParams.cFrustumPoints]\r\n * @param {string} [guiParams.myThreejs] See {@link https://github.com/anhr/myThreejs|myThreejs}.\r\n * @param {THREE.PerspectiveCamera} guiParams.cameraTarget.camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n * @param {Function} [guiParams.pointControls] pointControls( fPoint, dislayEl, getMesh ) Adds the trace \"Display the trace of the point movement\" control checkbox into gui.\r\n * <pre>\r\n * fPoint - parent folder for new control.\r\n * dislayEl( conrtol, true or false ) - function for dislay or hide of the control.\r\n * getMesh() returns the mesh, selected in the GuiSelectPoint.\r\n * Default is undefined.\r\n * </pre>\r\n * @param {Function} [guiParams.pointsControls] pointsControls( fPoints, dislayEl, getMesh ) Adds the trace \"Display the trace of the movement of all points of the mesh.\" control checkbox into gui.\r\n * <pre>\r\n * fPoints - parent folder for new control.\r\n * dislayEl( conrtol, true or false ) - function for dislay or hide of the control.\r\n * getMesh() returns the mesh, selected in the GuiSelectPoint.\r\n * Default is undefined.\r\n * </pre>\r\n * @param {Function} [guiParams.setIntersection] setIntersection( intersection ) sets the intersection value of myThreejs. Default is undefined\r\n * @param {Function} [guiParams.getLanguageCode] Your custom getLanguageCode() function.\r\n * <pre>\r\n * returns the \"primary language\" subtag of the language version of the browser.\r\n * Examples: \"en\" - English language, \"ru\" Russian.\r\n * See the \"Syntax\" paragraph of RFC 4646 {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n * Default returns the 'en' is English language.\r\n * You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n * </pre>\r\n * @param {object} [guiParams.lang] Object with localized language values\r\n * @example\r\nimport { GuiSelectPoint } from 'https://raw.githack.com/anhr/commonNodeJS/master/guiSelectPoint/guiSelectPoint.js';\r\n\r\nconst guiSelectPoint = new GuiSelectPoint( { axesHelper: axesHelper, } );\r\nguiSelectPoint.add( gui, { getLanguageCode: getLanguageCode, } );\r\nguiSelectPoint.addMesh( points );\r\n * @example //Using of guiParams.lang:\r\nguiParams = {\r\n\r\n\tgetLanguageCode: function() { return 'az'; },//Azerbaijani language\r\n\tlang: { textHeight: 'mətn boyu', languageCode: 'az' },\r\n\r\n}\r\n */\r\nfunction GuiSelectPoint( _THREE, guiParams ) {\r\n\r\n\tGuiSelectPoint.setTHREE( _THREE );\r\n\r\n\tguiParams = guiParams || {};\r\n\r\n\tconst axesHelper = guiParams.axesHelper,\r\n\t\toptions = guiParams.options || ( axesHelper ? axesHelper.options : undefined ) || {\r\n\t\t},\r\n\t\tguiSelectPoint = this;\r\n\r\n\t//Player changes the guiSelectPoint control's values during playing\r\n\toptions.guiSelectPoint = guiSelectPoint;\r\n\t\t\t\t\r\n\toptions.scales = options.scales || {};\r\n\tfunction setScale( axisName ) {\r\n\r\n\t\toptions.scales[axisName] = options.scales[axisName] || {};\r\n\t\toptions.scales[axisName].name = options.scales[axisName].name || axisName;\r\n\t\toptions.scales[axisName].min = options.scales[axisName].min === undefined ? -1 : options.scales[axisName].min;\r\n\t\toptions.scales[axisName].max = options.scales[axisName].max === undefined ?  1 : options.scales[axisName].max;\r\n\r\n\t}\r\n\tsetScale( 'x' );\r\n\tsetScale( 'y' );\r\n\tsetScale( 'z' );\r\n\tif ( options.a === undefined ) options.a = 1;\r\n\tif ( options.b === undefined ) options.b = 0;\r\n\tvar cFrustumPoints;\r\n\r\n\t//Localization\r\n\r\n\tconst getLanguageCode = guiParams.getLanguageCode || function () { return 'en'; };\r\n\r\n\tconst lang = {\r\n\r\n\t\tmeshs: 'Meshes',\r\n\t\tnotSelected: 'Not selected',\r\n\t\tselect: 'Select',\r\n\t\tposition: 'Position',\r\n\t\trotation: 'Rotation',\r\n\t\tpoints: 'Points',\r\n\r\n\t\tcameraTarget: 'Look',\r\n\t\tcameraTargetTitle: 'Choose this point the camera is looking at.',\r\n\r\n\t\tpoint: 'Point Local Position',\r\n\t\tpointTitle: 'The position attribute of the selected point',\r\n\r\n\t\ttrace: 'Trace',\r\n\t\ttraceTitle: 'Display the trace of the point movement.',\r\n\t\ttraceAllTitle: 'Display the trace of the movement of all points of the mesh.',\r\n\r\n\t\tpointWorld: 'Point World Position',\r\n\t\tpointWorldTitle: 'The position of the selected point after scaling, moving and rotation of the mesh',\r\n\r\n\t\tmesh: 'Mesh',\r\n\t\tscale: 'Scale',\r\n\t\tcolor: 'Сolor',\r\n\r\n\t\topacity: 'Opacity',\r\n\t\topacityTitle: 'Float in the range of 0.0 - 1.0 indicating how transparent the material is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.',\r\n\r\n\t\tdefaultButton: 'Default',\r\n\t\tdefaultScaleTitle: 'Restore default 3d object scale.',\r\n\t\tdefaultPositionTitle: 'Restore default 3d object position.',\r\n\t\tdefault3DObjectTitle: 'Restore default settings of all 3d objects.',\r\n\t\tdefaultRotationTitle: 'Restore default 3d object rotation.',\r\n\t\tdefaultLocalPositionTitle: 'Restore default local position.',\r\n\r\n\t\tmoveGroup: 'Move Scene',\r\n\r\n\t};\r\n\r\n\tconst _languageCode = getLanguageCode();\r\n\r\n\tswitch ( _languageCode ) {\r\n\r\n\t\tcase 'ru'://Russian language\r\n\r\n\t\t\tlang.meshs = '3D объекты';\r\n\t\t\tlang.notSelected = 'Не выбран';\r\n\t\t\tlang.select = 'Выбрать';\r\n\t\t\tlang.position = 'Позиция';\r\n\t\t\tlang.rotation = 'Вращение';\r\n\t\t\tlang.points = 'Точки';\r\n\r\n\t\t\tlang.cameraTarget = 'Следить';\r\n\t\t\tlang.cameraTargetTitle = 'Выберите эту точку, за которой следит камера.',\r\n\r\n\t\t\tlang.point = 'Локальная позиция точки';\r\n\t\t\tlang.pointTitle = 'Position attribute выбранной точки';\r\n\r\n\t\t\tlang.trace = 'Трек';\r\n\t\t\tlang.traceTitle = 'Показать трек перемещения точки.';\r\n\t\t\tlang.traceAllTitle = 'Показать трек перемещения всех точек выбранного 3D объекта.';\r\n\r\n\t\t\tlang.pointWorld = 'Абсолютная позиция точки';\r\n\t\t\tlang.pointWorldTitle = 'Позиция выбранной точки после масштабирования, перемещения и вращения 3D объекта';\r\n\r\n\t\t\tlang.mesh = '3D объект';\r\n\t\t\tlang.scale = 'Масштаб';\r\n\t\t\tlang.color = 'Цвет';\r\n\r\n\t\t\tlang.opacity = 'Непрозрачность';\r\n\t\t\tlang.opacityTitle = 'Число в диапазоне 0,0 - 1,0, указывающее, насколько прозрачен материал. Значение 0.0 означает полностью прозрачный, 1.0 - полностью непрозрачный.';\r\n\r\n\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\tlang.defaultScaleTitle = 'Восстановить масштаб 3D объекта по умолчанию.';\r\n\t\t\tlang.defaultPositionTitle = 'Восстановить позицию 3D объекта по умолчанию.';\r\n\t\t\tlang.default3DObjectTitle = 'Восстановить настройки всех 3D объектов по умолчанию.';\r\n\t\t\tlang.defaultRotationTitle = 'Восстановить поворот 3D объекта по умолчанию.';\r\n\t\t\tlang.defaultLocalPositionTitle = 'Восстановить локальную позицию точки по умолчанию.';\r\n\t\t\tbreak;\r\n\t\tdefault://Custom language\r\n\t\t\tif ( ( guiParams.lang === undefined ) || ( guiParams.lang.languageCode != _languageCode ) )\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tObject.keys( guiParams.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlang[key] = guiParams.lang[key];\r\n\r\n\t\t\t} );\r\n\r\n\t}\r\n\r\n\tvar f3DObjects, fPoint, cRestoreDefaultLocalPosition, fPointWorld, fPoints, cMeshs, fMesh,// mesh,\r\n\t\tintersection, _this = this,\r\n\t\tcScaleX, cScaleY, cScaleZ, cPosition = new THREE.Vector3(), cRotations = new THREE.Vector3(),\r\n\t\tcPoints, selectedPointIndex = -1,\r\n\t\tcX, cY, cZ, cW, cTrace, cTraceAll, cColor, cOpacity, cCameraTarget,\r\n\t\tfuncFolder,//cFunctions = new THREE.Vector3(),\r\n\t\tcWorld = new THREE.Vector3(),\r\n\t\tboSetMesh = false;//Для предотвращения лишних вызовов exposePosition если выбрать точку и передвинуть камеру с помошью OrbitControls,\r\n\tfunction displayPointControllers( display ) {\r\n\r\n\t\tfPointWorld.domElement.style.display = display;\r\n\t\tfPoint.domElement.style.display = display;\r\n\t\tif ( cCameraTarget )\r\n\t\t\tcCameraTarget.domElement.parentElement.parentElement.style.display = display;\r\n//\t\tfuncFolder.displayFolder( display );\r\n\r\n\t}\r\n\tif ( options.arrayCloud )//Array of points with cloud\r\n\t\tcFrustumPoints = new options.arrayCloud.cFrustumPointsF( _this );\r\n\t//сейчас exposePosition вызывается только один раз из this.setMesh\r\n\tfunction dislayEl( controller, displayController ) {\r\n\r\n\t\tif ( controller === undefined )\r\n\t\t\treturn;\r\n\t\tif ( typeof displayController === \"boolean\" )\r\n\t\t\tdisplayController = displayController ? 'block' : 'none';\r\n\t\tvar el = controller.domElement;\r\n\t\twhile ( el.tagName.toUpperCase() !== \"LI\" ) el = el.parentElement;\r\n\t\tel.style.display = displayController;\r\n\r\n\t}\r\n\tfunction exposePosition( selectedPointIndex ) {\r\n\r\n\t\tif ( selectedPointIndex === undefined )\r\n\t\t\tselectedPointIndex = guiSelectPoint.getSelectedPointIndex();//Эта строка слишком медленно выполняется если число точек frustumPoints велико\r\n\t\t//Поэтому selectedPointIndex беру из intersection.index индекс точки, над которй щелнул мышью\r\n\t\tif ( selectedPointIndex === -1 )\r\n\t\t\treturn;\r\n\r\n\t\tconst mesh = cMeshs.__select.options[cMeshs.__select.options.selectedIndex].mesh,\r\n\t\t\tposition = getObjectPosition( mesh, selectedPointIndex );\r\n\r\n\t\tif ( ( axesHelper !== undefined ) )\r\n\r\n\t\t\t// && ( ( mesh.userData.isInfo === undefined ) || ( mesh.userData.isInfo() ) ) )\r\n\t\t\t//если делать эту проверку, то будут неправильно отображаться пунктирные линии для frustumPoints точки\r\n\t\t\t//когда в настройках frustumPoints не стоит галочка info\r\n\t\t\t//когда в gui пользователь выбрал точку frustumPoints из списка '3D objects'(этот пункт будет недоступен когда я уберу frustumPoints из списка '3D objects' когда в настройках frustumPoints не стоит галочка info)\r\n\t\t\t//и когда пользователь передвигает камеру с помощью orbitControls\r\n\r\n\t\t\taxesHelper.exposePosition( { object: mesh, index: selectedPointIndex } );\r\n\r\n\t\tif ( cWorld.x ) cWorld.x.setValue( position.x );\r\n\t\tif ( cWorld.y ) cWorld.y.setValue( position.y );\r\n\t\tif ( cWorld.z ) cWorld.z.setValue( position.z );\r\n\r\n\t}\r\n\tfunction setValue( controller, v ) {\r\n\r\n\t\tif ( !controller )\r\n\t\t\treturn;\r\n\t\tconst input = controller.domElement.querySelector( 'input' ),\r\n\t\t\treadOnly = input.readOnly;\r\n\t\tinput.readOnly = false;\r\n\t\tcontroller.object[controller.property] = v;\r\n\t\tif ( controller.__onChange )\r\n\t\t\tcontroller.__onChange.call( controller, v );\r\n\t\tcontroller.initialValue = v;\r\n\t\tcontroller.updateDisplay();\r\n\t\tinput.readOnly = readOnly;\r\n\t\treturn controller;\r\n\r\n\t}\r\n\tvar wLimitsDefault;\r\n\tfunction setPosition( intersectionSelected/*, boDefault*/ ) {\r\n\r\n\t\tconst player = intersectionSelected.object.userData.player;\r\n\r\n\t\tif ( player ) {\r\n\r\n\t\t\tfuncFolder.setFunction( player.arrayFuncs[intersectionSelected.index]/*, boDefault*/ );\r\n\r\n\t\t}\r\n/*Для установки cCameraTarget после выбора точки. Если это оставить то неправильно учтанавливается галочка cCameraTarget если:\r\n1 устанвить cCameraTarget для выбранной точки\r\n2 запустить плеер\r\n3 уброать cCameraTarget\r\n4 запустить плеер. Снова установиться cCameraTarget\r\n*/\r\n\t\tif ( cCameraTarget ) {\r\n\r\n/*\r\n\t\t\tconst value = player && player.arrayFuncs[intersectionSelected.index].cameraTarget ? true : false;\r\n\t\t\tif ( cCameraTarget.getValue() !== value )//Если не делать эту проверку то будет бесконечный вызов cCameraTarget.onChange при выборе точки в guiSelectPoint\r\n\t\t\t\tcCameraTarget.setValue( value );\r\n*/\r\n//\t\t\tPlayer.cameraTarget.get();//Обновить cameraTarget\r\n\t\t\tPlayer.cameraTarget.changeTarget( intersectionSelected.object, intersectionSelected.index );\r\n\t\t\tcCameraTarget.updateDisplay();\r\n/*\r\n\t\t\tconst boLook = player && player.arrayFuncs[intersectionSelected.index].cameraTarget ? \r\n\t\t\t\tplayer.arrayFuncs[intersectionSelected.index].cameraTarget.boLook : false;\r\n\t\t\tif ( cCameraTarget.getValue() !== boLook )//Если не делать эту проверку то будет бесконечный вызов cCameraTarget.onChange при выборе точки в guiSelectPoint\r\n\t\t\t\tcCameraTarget.setValue( boLook );\r\n*/\t\t\t\t\r\n\r\n\t\t}\r\n\r\n\t\tconst positionLocal = getObjectLocalPosition( intersectionSelected.object, intersectionSelected.index );\r\n\t\tsetValue( cX, positionLocal.x );\r\n\t\tsetValue( cY, positionLocal.y );\r\n\t\tsetValue( cZ, positionLocal.z );\r\n\r\n\t\tconst position = getObjectPosition( intersectionSelected.object, intersectionSelected.index );\r\n\t\tsetValue( cWorld.x, position.x );\r\n\t\tsetValue( cWorld.y, position.y );\r\n\t\tsetValue( cWorld.z, position.z );\r\n\r\n\t\tvar displayControllerW, displayControllerColor, displayControllerOpacity;\r\n\t\tconst none = 'none', block = 'block';\r\n\t\tif ( typeof intersection.object.userData.player.arrayFuncs === \"function\" )\r\n\t\t\tconsole.error( 'arrayFuncs === \"function\" under constraction' );\r\n\t\tvar opasity;\r\n\t\tconst func = player && player.arrayFuncs ? player.arrayFuncs[intersectionSelected.index] : undefined;\r\n\t\tfunction isWObject() { return ( typeof func.w === 'object' ) && ( func.w instanceof THREE.Color === false ); }\r\n\t\tvar color = func === undefined ?\r\n\t\t\t\tundefined :\r\n\t\t\t\tArray.isArray( func.w ) || ( typeof func.w === \"function\" ) ?\r\n\t\t\t\t\tPlayer.execFunc( func, 'w', Player.getTime(), options.a, options.b ) :\r\n\t\t\t\t\tisWObject() ? \r\n\t\t\t\t\t\tPlayer.execFunc( func.w, 'func', Player.getTime(), options.a, options.b ) :\r\n\t\t\t\t\t\tfunc.w;\r\n\r\n\t\tif ( color === undefined ) {\r\n\r\n\t\t\tif ( intersectionSelected.object.geometry.attributes.ca === undefined ) {\r\n\r\n//\t\t\t\tconsole.warn( 'Under constraction. цвет frustumPoints не известен потому что он вычисляется в шейдере D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\myThreejs\\master\\frustumPoints\\vertex.c' )\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst vColor = new THREE.Vector4().fromArray(\r\n\t\t\t\t\tintersectionSelected.object.geometry.attributes.ca.array,\r\n\t\t\t\t\tintersectionSelected.index * intersectionSelected.object.geometry.attributes.ca.itemSize );\r\n\t\t\t\tcolor = new THREE.Color( vColor.x, vColor.y, vColor.z );\r\n\t\t\t\topasity = vColor.w;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( color instanceof THREE.Color ) {\r\n\r\n\t\t\tdisplayControllerW = none;\r\n\t\t\tdisplayControllerColor = block;\r\n\t\t\tdisplayControllerOpacity = block;\r\n\r\n\t\t\t//color\r\n\t\t\tif ( intersectionSelected.object.userData.player.arrayFuncs === undefined ) {\r\n\r\n\t\t\t\tdisplayControllerColor = none;\r\n\t\t\t\tdisplayControllerOpacity = none;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst strColor = '#' + color.getHexString();\r\n\t\t\t\t//Сначала надо установить initialValue потому что для FrustumPoints я устанвил readOnly для cColor.\r\n\t\t\t\t//В этом случае я не могу отобразить цвет следующей точки FrustumPoints потому что в режиме readOnly\r\n\t\t\t\t//при изменении цвета восстанвливается старый цвет из initialValue.\r\n\t\t\t\tcColor.initialValue = strColor;\r\n\t\t\t\tcColor.setValue( strColor );\r\n\t\t\t\tcColor.userData = { intersection: intersectionSelected, };\r\n\t\t\t\tif ( opasity !== undefined ) {\r\n\r\n\t\t\t\t\tsetValue( cOpacity, opasity );\r\n\r\n\t\t\t\t} else displayControllerOpacity = none;\r\n\t\t\t\tcOpacity.userData = { intersection: intersectionSelected, };\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( cW === undefined )\r\n\t\t\t\tdisplayControllerW = none;\r\n\t\t\telse {\r\n\r\n\t\t\t\tif ( color === undefined )\r\n\t\t\t\t\tdisplayControllerW = none;\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tif ( !wLimitsDefault ) {\r\n\r\n\t\t\t\t\t\twLimitsDefault = {\r\n\r\n\t\t\t\t\t\t\tmin: cW.__min,\r\n\t\t\t\t\t\t\tmax: cW.__max,\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( isWObject() ) {\r\n\r\n\t\t\t\t\t\tcW.min( func.w.min !== 'undefined' ? func.w.min : wLimitsDefault.min );\r\n\t\t\t\t\t\tcW.max( func.w.max !== 'undefined' ? func.w.max : wLimitsDefault.max );\r\n\t\t\t\t\t\tif ( ( cW.__min !== 'undefined' ) && ( cW.__max !== 'undefined' ) )\r\n\t\t\t\t\t\t\tcW.step( ( cW.__max - cW.__min ) / 100 )\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tcW.min( wLimitsDefault.min );\r\n\t\t\t\t\t\tcW.max( wLimitsDefault.max );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetValue( cW, color );\r\n\t\t\t\t\tdisplayControllerW = block;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tdisplayControllerColor = none;\r\n\t\t\tdisplayControllerOpacity = none;\r\n\r\n\t\t}\r\n\t\tdislayEl( cW, displayControllerW );\r\n\t\tdislayEl( cColor, displayControllerColor );\r\n\t\tdislayEl( cOpacity, displayControllerOpacity );\r\n\r\n\t\tvar boReadOnly = intersectionSelected.object.userData.boFrustumPoints === true ? true : false;\r\n\t\tif ( cX ) cX.domElement.querySelector( 'input' ).readOnly = boReadOnly;\r\n\t\tif ( cY ) cY.domElement.querySelector( 'input' ).readOnly = boReadOnly;\r\n\t\tif ( cZ ) cZ.domElement.querySelector( 'input' ).readOnly = boReadOnly;\r\n\t\tif ( cW ) cW.domElement.querySelector( 'input' ).readOnly = boReadOnly;\r\n\t\tcColor.domElement.querySelector( 'input' ).readOnly = boReadOnly;\r\n\t\tcOpacity.domElement.querySelector( 'input' ).readOnly = boReadOnly;\r\n\r\n\t}\r\n\t/**\r\n\t * Sets controllers to position, scale and rotation of the mesh.  If AxesHelper is exist, expose the mesh to the axes.\r\n\t * @function GuiSelectPoint.\r\n\t *setMesh\r\n\t */\r\n\tthis.setMesh = function () {\r\n\r\n\t\tboSetMesh = true;\r\n\t\tsetScaleControllers();\r\n\t\tsetPositionControllers();\r\n\t\tsetRotationControllers();\r\n\t\texposePosition();\r\n\t\tboSetMesh = false;\r\n\r\n\t}\r\n\t/**\r\n\t * Sets controllers to position, scale and rotation of the mesh.  If AxesHelper is exist, expose the mesh to the axes.\r\n\t * @function GuiSelectPoint.\r\n\t *setPosition\r\n\t * @param position deprecated\r\n\t * @param intersectionSelected [THREE.Raycaster.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject}\r\n\t */\r\n\tthis.setPosition = function ( position, intersectionSelected ) {\r\n\r\n\t\tfor ( var i = 0; i < cMeshs.__select.length; i++ ) {\r\n\r\n\t\t\tvar option = cMeshs.__select[i];\r\n\t\t\t//\t\t\t\t\t\tif ( option.selected && ( parseInt( option.getAttribute( 'value' ) ) === intersectionSelected.object.userData.index - 1 ) )\r\n\t\t\tif ( option.selected && Object.is( option.mesh, intersectionSelected.object ) ) {\r\n\r\n\t\t\t\tsetPosition( intersectionSelected );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\t/**\r\n\t * update the values of the controllers of the world position\r\n\t * @function GuiSelectPoint.\r\n\t *update \r\n\t */\r\n\tthis.update = function () {\r\n\r\n\t\tconst mesh = cMeshs.__select.options[cMeshs.__select.options.selectedIndex].mesh;\r\n\t\tif ( !mesh )\r\n\t\t\treturn;\r\n\t\tconst index = this.getSelectedPointIndex();\r\n\t\tif ( index === -1 )\r\n\t\t\treturn;\r\n\t\tconst position = getObjectPosition( mesh, index );\r\n\t\tcWorld.x.setValue( position.x );\r\n\t\tcWorld.y.setValue( position.y );\r\n\t\tcWorld.z.setValue( position.z );\r\n\r\n\t}\r\n\t/**\r\n\t * get index of the mesh in the cMeshs controller\r\n\t * @function GuiSelectPoint.\r\n\t *getMeshIndex\r\n\t * @param {THREE.Mesh} mesh\r\n\t * See {@link https://threejs.org/docs/index.html#api/en/objects/Mesh|THREE.Mesh}.\r\n\t * @returns index of selectred mesh.\r\n\t */\r\n\tthis.getMeshIndex = function ( mesh ) {\r\n\r\n\t\tif ( mesh === undefined )\r\n\t\t\treturn mesh;\r\n\t\tvar index;// = intersectionSelected.object.userData.index;\r\n\t\tfor ( index = 0; index < cMeshs.__select.options.length; index++ ) {\r\n\r\n\t\t\tvar option = cMeshs.__select.options[index];\r\n\t\t\tif ( Object.is( option.mesh, mesh ) )\r\n\t\t\t\treturn index;\r\n\r\n\t\t}\r\n//\t\tconsole.error( 'Invalid mesh \"' + mesh.name + '\" index' );\r\n\t\t//Сюда попадает когда Mesh проверяется с помощью THREE.Raycaster находится ли он под мышью, но этот Mesh не внесен в список GuiSelectPoint\r\n\r\n\t}\r\n\tthis.setIndexMesh = function ( index, mesh ) {\r\n\r\n\t\tif ( index === undefined )\r\n\t\t\treturn;\r\n\t\tcMeshs.__select.options[index].mesh = mesh;\r\n\t\tthis.selectPoint( -1 );\r\n\r\n\t}\r\n\tthis.selectPoint = function ( index ) {\r\n\r\n\t\tcPoints.__onChange( index );\r\n\t\tcPoints.__select[index + 1].selected = true;\r\n\r\n\t}\r\n\t/**\r\n\t * Removes a mesh from the select point GUI\r\n\t * @function GuiSelectPoint.\r\n\t *removeMesh\r\n\t * @param {THREE.Mesh} mesh mesh for removing.\r\n\t */\r\n\tthis.removeMesh = function ( mesh ) {\r\n\r\n\t\tconst index = this.getMeshIndex( mesh ),\r\n\t\t\tselectedIndex = cMeshs.__select.selectedIndex;\r\n\t\tcMeshs.__select.remove( index );\r\n\t\tif ( selectedIndex === index ) {\r\n\r\n\t\t\tcPoints.__onChange( -1 );\r\n\t\t\t_this.removePoints();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tconst arrayMeshs = [];//сюда попадают все mesh в случае, когда this.addMesh вызывается до вызова this.add\r\n\t\t\t\t\t\t\t//тоесть когда GuiSelectPoint еще не добавлен в dat.gui\r\n\r\n\t/**\r\n\t * Adds new mesh into select point GUI\r\n\t * @function GuiSelectPoint.\r\n\t *addMesh\r\n\t * @param {THREE.Mesh} mesh new mesh.\r\n\t */\r\n\tthis.addMesh = function ( mesh ) {\r\n\r\n\t\tif ( !cMeshs ) {\r\n\r\n\t\t\t//Test for duplicate item\r\n\t\t\tfor ( var i = 0; i < arrayMeshs.length; i++ ) {\r\n\r\n\t\t\t\tif ( arrayMeshs[i].uuid === mesh.uuid )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarrayMeshs.push( mesh );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\t//Test for duplicate item\r\n\t\tfor ( var i = 0; i < cMeshs.__select.options.length; i++ ) {\r\n\r\n\t\t\tvar option = cMeshs.__select.options[i];\r\n\t\t\tif ( mesh.userData.boFrustumPoints && ( option.mesh !== undefined ) && option.mesh.userData.boFrustumPoints )\r\n\t\t\t\treturn;//duplicate FrustumPoints. Сюда попадает когда пользователь меняет количество слоев или Y точек в FrustumPoints.\r\n\t\t\tif (\r\n\t\t\t\t( option.mesh !== undefined ) &&\r\n\t\t\t\t( option.mesh.uuid === mesh.uuid )\r\n\t\t\t) {\r\n\r\n\t\t\t\tconsole.error( 'guiSelectPoint.addMesh(...): Duplicate mesh.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n/*\t\t\t\t\r\n\t\t\tif (\r\n\t\t\t\t( option.mesh !== undefined ) &&\r\n\t\t\t\t( mesh.name !== '' ) && //если не делать эту проверку то невозможно вставить два mesh без имени\r\n\t\t\t\t( option.mesh.name === mesh.name )\r\n\t\t\t) {\r\n\r\n\t\t\t\t//Нельза добалять два mesh с одинаковым именем\r\n\t\t\t\treturn;//сюда попадает когда создаются точки без shaderMaterial\r\n\t\t\t\t//Сначала вызывается из myPoints create.Points function\r\n\t\t\t\t//Потом из guiSelectPointF.addControllers\r\n\r\n\t\t\t}\r\n*/\t\t\t\r\n\r\n\t\t}\r\n\t\tconst opt = document.createElement( 'option' );\r\n\t\topt.innerHTML = cMeshs.__select.length + ' ' + ( mesh.name === '' ? mesh.constructor.name : mesh.name );\r\n\t\topt.mesh = mesh;\r\n\t\tmesh.userData.default = mesh.userData.default || {\r\n\r\n\t\t\tscale: new THREE.Vector3().copy( mesh.scale ),\r\n\t\t\tposition: mesh.position instanceof THREE.Vector3 ?\r\n\t\t\t\tnew THREE.Vector3().copy( mesh.position ) :\r\n\t\t\t\tmesh.position instanceof THREE.Vector4 ? new THREE.Vector4().copy( mesh.position ) : undefined,\r\n\t\t\trotation: new THREE.Euler().copy( mesh.rotation ),\r\n\r\n\t\t}\r\n\t\tcMeshs.__select.appendChild( opt );\r\n\r\n\t}\r\n\tthis.select = function ( intersectionSelected ) {\r\n\r\n\t\tconst position = getObjectLocalPosition( intersectionSelected.object, intersectionSelected.index );\r\n\t\tif ( f3DObjects === undefined ) {\r\n\r\n\t\t\tconsole.error( 'Не знаю как сюда попасть' );\r\n\r\n\t\t}\r\n\r\n\t\t//f3DObjects.close();//если тут не закрывать папку, то ингода прорпадает скроллинг окна dat.GUI\r\n\t\t//for testing:\r\n\t\t//Open https://raw.githack.com/anhr/myThreejs/master/Examples/html/\r\n\t\t//Set browser window height about 500 pixels.\r\n\t\t//Click Full Screen button.\r\n\t\t//Open Controls\r\n\t\t//Click a point.The \"Meshes\" folder opens and you can see the scrolling of the dat.gui window.\r\n\r\n\t\t//select mesh\r\n\t\tconst index = this.getMeshIndex( intersectionSelected.object );\r\n\t\tif ( !index )\r\n\t\t\treturn;//Сюда попадает когда Mesh проверяется с помощью THREE.Raycaster находится ли он под мышью, но этот Mesh не внесен в список GuiSelectPoint\r\n\t\tif ( cMeshs.__select[index].selected === false ) {\r\n\r\n\t\t\tcMeshs.__select[index].selected = true;\r\n\t\t\tcMeshs.__onChange( index - 1 );\r\n\r\n\t\t}\r\n\r\n\t\tthis.selectPoint2 = function ( selectedMesh/*, boDefault*/ ) {\r\n\r\n\t\t\tif ( ( intersectionSelected.index === undefined ) || isNaN( intersectionSelected.index ) )\r\n\t\t\t\treturn;\r\n\r\n\t\t\t//сделал эту проверку потому что не могу придумать как удалить intersectionSelected.index когда пользователь врусную сменил mesh\r\n\t\t\tif ( ( selectedMesh !== undefined ) && !Object.is( intersectionSelected.object, selectedMesh ) )\r\n\t\t\t\treturn;//Сначала пользователь выбрал точку с помошщью мыши\r\n\t\t\t//Потом сменил Meshes/Select\r\n\r\n\t\t\tif ( !intersectionSelected.object.userData.boFrustumPoints ) {\r\n\r\n\t\t\t\t//fPoints.open();много времени на открытие когда много точек\r\n\t\t\t\tcPoints.__select[intersectionSelected.index + 1].selected = true;\r\n\r\n\t\t\t} else {//FrustumPoints\r\n\r\n\t\t\t\tcFrustumPoints.pointIndexes( intersectionSelected.object.userData.pointIndexes( intersectionSelected.index ) );\r\n\r\n\t\t\t}\r\n\t\t\tconst block = 'block';\r\n\t\t\tdisplayPointControllers( block );\r\n\t\t\tintersection = intersectionSelected;\r\n\t\t\tif ( guiParams.setIntersection )\r\n\t\t\t\tguiParams.setIntersection( intersectionSelected );\r\n\t\t\tsetPosition( intersectionSelected/*, boDefault*/ );\r\n\r\n\t\t\tconst mesh = getMesh();\r\n\t\t\tconst line = ( mesh.userData.player.arrayFuncs === undefined ) || ( typeof intersection.object.userData.player.arrayFuncs === \"function\" ) ?\r\n\t\t\t\tundefined :\r\n\t\t\t\tmesh.userData.player.arrayFuncs[intersectionSelected.index].line;//You can not trace points if you do not defined the mesh.userData.player.arrayFuncs\r\n\t\t\tif ( cTrace )\r\n\t\t\t\tcTrace.setValue( line === undefined ? false : line.isVisible() )\r\n\r\n\t\t\tcRestoreDefaultLocalPosition.domElement.parentElement.parentElement.style.display =\r\n\t\t\t\tintersection.object.userData.player.arrayFuncs === undefined ? 'none' : block;\r\n\r\n\t\t}\r\n\t\tthis.selectPoint2( undefined/*, true*/ );\r\n\r\n\t}\r\n\t/**\r\n\t * Is mesh selected in the GuiSelectPoint.\r\n\t * @function GuiSelectPoint.\r\n\t *isSelectedMesh\r\n\t * @param {THREE.Mesh} meshCur mesh to be tested\r\n\t * @returns true if meshCur is selected.\r\n\t */\r\n\tthis.isSelectedMesh = function ( meshCur ) { return getMesh() === meshCur }\r\n\t/**\r\n\t * Returns the index of the selected point.\r\n\t * @function GuiSelectPoint.\r\n\t *getSelectedPointIndex\r\n\t * @returns index of the selected point.\r\n\t */\r\n\tthis.getSelectedPointIndex = function () {\r\n\r\n\t\tif ( ( cFrustumPoints !== undefined ) &&\r\n\t\t\tcFrustumPoints.isDisplay() &&//FrustumPoints folder id not visible\r\n\t\t\toptions.arrayCloud.frustumPoints &&\r\n\t\t\toptions.arrayCloud.frustumPoints.isDisplay()//The cDisplay checkbox of the frustumPoints' is checked\r\n\t\t) {\r\n\r\n\t\t\tvar selectedIndex = cFrustumPoints.getSelectedIndex();\r\n\t\t\treturn selectedIndex === null ? - 1 : selectedIndex;\r\n\r\n\t\t}\r\n\t\tif ( cPoints === undefined ) {\r\n\r\n\t\t\tif ( selectedPointIndex === undefined )\r\n\t\t\t\tconsole.error( 'myThreejs.create.onloadScripts.init.guiSelectPoint.getSelectedPointIndex:  selectedPointIndex = ' + selectedPointIndex );\r\n\t\t\treturn selectedPointIndex;//options.dat !== true and gui === undefined. Do not use dat.gui\r\n\r\n\t\t}\r\n\t\tconst index = cPoints.__select.selectedOptions[0].index;\r\n\t\treturn index - 1;\r\n\r\n\t}\r\n\tfunction getMesh() {\r\n\r\n\t\tif ( !cMeshs ) {\r\n\r\n\t\t\tconsole.error( 'GuiSelectPoint().getSelectedPointIndex().getMesh(): call GuiSelectPoint.add( gui ); first.' );\r\n\t\t\treturn undefined;\r\n\t\t\t\r\n\t\t}\r\n\t\tconst selectedIndex = cMeshs.__select.options.selectedIndex;\r\n\t\tif ( selectedIndex !== -1 )\r\n\t\t\treturn cMeshs.__select.options[cMeshs.__select.options.selectedIndex].mesh;\r\n\t\treturn undefined;\r\n\r\n\t}\r\n\tfunction isNotSetControllers() {\r\n\r\n\t\treturn ( getMesh() === undefined );\r\n\r\n\t}\r\n\tfunction setScaleControllers() {\r\n\r\n\t\tif ( isNotSetControllers() )\r\n\t\t\treturn;\r\n\t\tconst mesh = getMesh();\r\n\t\tif ( cScaleX ) cScaleX.setValue( mesh.scale.x );\r\n\t\tif ( cScaleY ) cScaleY.setValue( mesh.scale.y );\r\n\t\tif ( cScaleZ ) cScaleZ.setValue( mesh.scale.z );\r\n\r\n\t}\r\n\tfunction setPositionControllers() {\r\n\r\n\t\tif ( isNotSetControllers() )\r\n\t\t\treturn;\r\n\t\tconst mesh = getMesh();\r\n\t\tif ( cPosition.x ) cPosition.x.setValue( mesh.position.x );\r\n\t\tif ( cPosition.y ) cPosition.y.setValue( mesh.position.y );\r\n\t\tif ( cPosition.z ) cPosition.z.setValue( mesh.position.z );\r\n\r\n\t}\r\n\tfunction setRotationControllers() {\r\n\r\n\t\tif ( isNotSetControllers() )\r\n\t\t\treturn;\r\n\t\tconst mesh = getMesh();\r\n\t\tif ( cRotations.x ) cRotations.x.setValue( mesh.rotation.x );\r\n\t\tif ( cRotations.y ) cRotations.y.setValue( mesh.rotation.y );\r\n\t\tif ( cRotations.z ) cRotations.z.setValue( mesh.rotation.z );\r\n\r\n\t}\r\n\tfunction visibleTraceLine( intersection, value, getMesh ) {\r\n\r\n\t\tif ( !intersection || intersection.object.userData.player.arrayFuncs === undefined )\r\n\t\t\treturn;\r\n\t\tvar index = intersection.index || 0,\r\n\t\t\tpoint = intersection.object.userData.player.arrayFuncs[index],\r\n\t\t\tline = point === undefined ? undefined : point.line;\r\n\t\tif ( line !== undefined )\r\n\t\t\tline.visible( value );\r\n\t\tif ( !value )\r\n\t\t\treturn;\r\n\t\tif ( point.line !== undefined )\r\n\t\t\treturn;\r\n\t\tpoint.line = new Player.traceLine( /*THREE, intersection.object, */options );\r\n\r\n\t\t//color\r\n\t\tvar color = intersection.object.geometry.attributes.color;\r\n\t\tif ( color === undefined )\r\n\t\t\tcolor = new THREE.Color( 0xffffff );//white\r\n\t\telse {\r\n\r\n\t\t\tvar vector = new THREE.Vector3().fromArray( color.array, index * color.itemSize )\r\n\t\t\tcolor = new THREE.Color( vector.x, vector.y, vector.z );\r\n\r\n\t\t}\r\n\r\n\t\tpoint.line.addPoint(\r\n\r\n//\t\t\tgetObjectPosition( getMesh(), index ),\r\n\t\t\tgetMesh(), index,\r\n//\t\t\tPlayer.getSelectSceneIndex(),\r\n\t\t\tcolor\r\n\r\n\t\t);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adds select point GUI into dat.gui folder\r\n\t * @function GuiSelectPoint.\r\n\t *add\r\n\t * @param {GUI} folder dat.gui folder.\r\n\t */\r\n\tthis.add = function ( folder ) {\r\n\r\n\t\tf3DObjects = folder.addFolder( lang.meshs );\r\n\t\tvar mesh, buttonScaleDefault, buttonPositionDefault, buttonRotationDefault;\r\n\r\n\t\tcMeshs = f3DObjects.add( { Meshs: lang.notSelected }, 'Meshs', { [lang.notSelected]: -1 } ).onChange( function ( value ) {\r\n\r\n\t\t\tvalue = parseInt( value );\r\n\t\t\tmesh = getMesh();\r\n\r\n\t\t\tconst none = 'none', block = 'block';\r\n\t\t\tvar display;\r\n\t\t\tif ( mesh === undefined ) {\r\n\r\n\t\t\t\tdisplay = none;\r\n\t\t\t\tmesh = undefined;\r\n\t\t\t\tif ( axesHelper !== undefined )\r\n\t\t\t\t\taxesHelper.exposePosition( getObjectPosition( getMesh(), value ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst displayDefaultButtons = mesh.userData.default === undefined ? none : block;\r\n\t\t\t\tbuttonScaleDefault.domElement.parentElement.parentElement.style.display = displayDefaultButtons;\r\n\t\t\t\tbuttonPositionDefault.domElement.parentElement.parentElement.style.display = displayDefaultButtons;\r\n\t\t\t\tbuttonRotationDefault.domElement.parentElement.parentElement.style.display = displayDefaultButtons;\r\n\r\n\t\t\t\tdisplay = block;\r\n\t\t\t\tvar displayPoints = none, displayfPoints = none, displayFrustumPoints = block;\r\n\r\n\t\t\t\tcPoints.__onChange( -1 );\r\n\t\t\t\t_this.removePoints();\r\n\r\n\t\t\t\tif ( mesh.userData.controllers !== undefined ) {\r\n\r\n\t\t\t\t\t//FrustumPoints\r\n\t\t\t\t\tmesh.userData.controllers();// cFrustumPoints );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tdisplayPoints = block;\r\n\t\t\t\t\tdisplayFrustumPoints = none;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( mesh.geometry.attributes ) {\r\n\r\n\t\t\t\t\t\tdisplayfPoints = block;\r\n\t\t\t\t\t\tfor ( var iPosition = 0; iPosition < mesh.geometry.attributes.position.count; iPosition++ ) {\r\n\r\n\t\t\t\t\t\t\tconst opt = document.createElement( 'option' ),\r\n\t\t\t\t\t\t\t\tname = mesh.userData.player && mesh.userData.player.arrayFuncs ? mesh.userData.player.arrayFuncs[iPosition].name : '';\r\n\t\t\t\t\t\t\topt.innerHTML = iPosition + ( name === undefined ? '' : ' ' + name );\r\n\t\t\t\t\t\t\topt.setAttribute( 'value', iPosition );//Эта строка нужна в случае когда пользователь отменил выбор точки. Иначе при движении камеры будут появляться пунктирные линии, указвающие на несуществующую точку\r\n\t\t\t\t\t\t\tcPoints.__select.appendChild( opt );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfPoints.domElement.parentElement.style.display = displayfPoints;\r\n//\t\t\t\tcPoints.domElement.parentElement.parentElement.style.display = displayPoints;\r\n\t\t\t\tdislayEl( cPoints, displayPoints );\r\n\t\t\t\tif ( cTraceAll ) {\r\n\r\n//\t\t\t\t\tcTraceAll.domElement.parentElement.parentElement.style.display = displayPoints;\r\n\t\t\t\t\tdislayEl( cTraceAll, Player.isCreated() ? displayPoints : false );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( cFrustumPoints !== undefined )\r\n\t\t\t\t\tcFrustumPoints.display( displayFrustumPoints );\r\n\r\n\t\t\t\tsetScaleControllers();\r\n\t\t\t\tsetPositionControllers();\r\n\t\t\t\tsetRotationControllers();\r\n\r\n\t\t\t}\r\n\t\t\tfMesh.domElement.style.display = display;\r\n\r\n\t\t\tif ( ( mesh !== undefined ) && ( mesh.userData.traceAll !== undefined ) )\r\n\t\t\t\tcTraceAll.setValue( mesh.userData.traceAll );\r\n\r\n\t\t} );\r\n\t\tdat.controllerNameAndTitle( cMeshs, lang.select );\r\n\r\n\t\tfMesh = f3DObjects.addFolder( lang.mesh );\r\n\t\tfMesh.domElement.style.display = 'none';\r\n\t\tfMesh.open();\r\n\r\n\t\t//Scale\r\n\r\n\t\tconst fScale = fMesh.addFolder( lang.scale );\r\n\t\tfScale.add( new ScaleController( function ( customController, action ) {\r\n\r\n\t\t\tconst zoom = customController.controller.getValue();\r\n\t\t\tmesh.scale.x = action( mesh.scale.x, zoom );\r\n\t\t\tmesh.scale.y = action( mesh.scale.y, zoom );\r\n\t\t\tmesh.scale.z = action( mesh.scale.z, zoom );\r\n\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\tsetScaleControllers();\r\n\t\t\texposePosition();\r\n\t\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\t\toptions.arrayCloud.frustumPoints.updateCloudPoint( mesh );\r\n\r\n\t\t},\r\n\t\t\t{\r\n\r\n\t\t\t\tsettings: { zoomMultiplier: 1.1, },\r\n\t\t\t\tgetLanguageCode: getLanguageCode,\r\n\r\n\t\t\t} ) );\r\n\t\tconst scale = new THREE.Vector3();\r\n\t\tfunction setScale( axesName, value ) {\r\n\r\n\t\t\tmesh.scale[axesName] = value;\r\n\t\t\tmesh.needsUpdate = true;\r\n\t\t\texposePosition();\r\n\t\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\t\toptions.arrayCloud.frustumPoints.updateCloudPoint( mesh );\r\n\r\n\t\t}\r\n\t\tif ( options.scales.x ) {\r\n\r\n\t\t\tcScaleX = dat.controllerZeroStep( fScale, scale, 'x', function ( value ) { setScale( 'x', value ); } );\r\n\t\t\tdat.controllerNameAndTitle( cScaleX, options.scales.x.name );\r\n\r\n\t\t}\r\n\t\tif ( options.scales.y ) {\r\n\r\n\t\t\tcScaleY = dat.controllerZeroStep( fScale, scale, 'y', function ( value ) { setScale( 'y', value ); } );\r\n\t\t\tdat.controllerNameAndTitle( cScaleY, options.scales.y.name );\r\n\r\n\t\t}\r\n\t\tif ( options.scales.z ) {\r\n\r\n\t\t\tcScaleZ = dat.controllerZeroStep( fScale, scale, 'z', function ( value ) { setScale( 'z', value ); } );\r\n\t\t\tdat.controllerNameAndTitle( cScaleZ, options.scales.z.name );\r\n\r\n\t\t}\r\n\r\n\t\t//Default scale button\r\n\t\tbuttonScaleDefault = fScale.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\tmesh.scale.copy( mesh.userData.default.scale );\r\n\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\tsetScaleControllers();\r\n\t\t\t\texposePosition();\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' );\r\n\t\tdat.controllerNameAndTitle( buttonScaleDefault, lang.defaultButton, lang.defaultScaleTitle );\r\n\r\n\t\t//Position\r\n\r\n\t\tconst fPosition = fMesh.addFolder( lang.position );\r\n\r\n\t\tfunction addAxisControllers( name ) {\r\n\r\n\t\t\tconst scale = options.scales[name];\r\n\t\t\tif ( !scale )\r\n\t\t\t\treturn;\r\n\t\t\tconst axesName = scale.name,\r\n\t\t\t\tf = fPosition.addFolder( axesName );\r\n\t\t\tf.add( new PositionController( function ( shift ) {\r\n\r\n\t\t\t\tmesh.position[name] += shift;\r\n\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\tsetPositionControllers();\r\n\t\t\t\texposePosition();\r\n\t\t\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\t\t\toptions.arrayCloud.frustumPoints.updateCloudPoint( mesh );\r\n\r\n\t\t\t}, { getLanguageCode: getLanguageCode, } ) );\r\n\r\n\t\t\tfunction setPosition( value ) {\r\n\r\n\t\t\t\tmesh.position[name] = value;\r\n\t\t\t\tmesh.needsUpdate = true;\r\n\t\t\t\texposePosition();\r\n\r\n\t\t\t}\r\n\t\t\tconst position = new THREE.Vector3();\r\n\r\n\t\t\tcPosition[name] = dat.controllerZeroStep( f, position, name, function ( value ) { setPosition( value ); } );\r\n\t\t\tdat.controllerNameAndTitle( cPosition[name], axesName );\r\n\r\n\t\t}\r\n\t\taddAxisControllers( 'x' );\r\n\t\taddAxisControllers( 'y' );\r\n\t\taddAxisControllers( 'z' );\r\n\r\n\t\t//Restore default position.\r\n\t\tbuttonPositionDefault = fPosition.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\tmesh.position.copy( mesh.userData.default.position );\r\n\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\tsetPositionControllers();\r\n\t\t\t\texposePosition();\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' );\r\n\t\tdat.controllerNameAndTitle( buttonPositionDefault, lang.defaultButton, lang.defaultPositionTitle );\r\n\r\n\t\t//rotation\r\n\r\n\t\tvar fRotation = fMesh.addFolder( lang.rotation );\r\n\t\tfunction addRotationControllers( name ) {\r\n\r\n\t\t\tconst scale = options.scales[name];\r\n\t\t\tif ( !scale )\r\n\t\t\t\treturn;\r\n\t\t\tcRotations[name] = fRotation.add( new THREE.Vector3(), name, 0, Math.PI * 2, 1 / 360 ).\r\n\t\t\t\tonChange( function ( value ) {\r\n\r\n\t\t\t\t\tconst mesh = getMesh();\r\n\t\t\t\t\tif ( !mesh.userData.boFrustumPoints ) {\r\n\r\n\t\t\t\t\t\tmesh.rotation[name] = value;\r\n\t\t\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( !boSetMesh )\r\n\t\t\t\t\t\texposePosition();\r\n\t\t\t\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\t\t\t\toptions.arrayCloud.frustumPoints.updateCloudPoint( mesh );\r\n\r\n\t\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cRotations[name], scale.name );\r\n\r\n\t\t}\r\n\t\taddRotationControllers( 'x' );\r\n\t\taddRotationControllers( 'y' );\r\n\t\taddRotationControllers( 'z' );\r\n\r\n\t\t//Default rotation button\r\n\t\tbuttonRotationDefault = fRotation.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\tmesh.rotation.copy( mesh.userData.default.rotation );\r\n\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\tsetRotationControllers();\r\n\t\t\t\texposePosition();\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' );\r\n\t\tdat.controllerNameAndTitle( buttonRotationDefault, lang.defaultButton, lang.defaultRotationTitle );\r\n\r\n\t\t//Points\r\n\r\n\t\tfPoints = fMesh.addFolder( lang.points );\r\n\r\n\t\tcPoints = fPoints.add( { Points: lang.notSelected }, 'Points', { [lang.notSelected]: -1 } ).onChange( function ( value ) {\r\n\r\n\t\t\tvalue = parseInt( value );\r\n\t\t\tvar display, position;\r\n\t\t\tif ( value === -1 ) {\r\n\r\n\t\t\t\tdisplay = 'none';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdisplay = 'block';\r\n\t\t\t\t_this.select( { object: getMesh(), index: value } );\r\n\r\n\t\t\t}\r\n\t\t\tif ( axesHelper !== undefined )\r\n\t\t\t\taxesHelper.exposePosition( getObjectPosition( getMesh(), value ) );\r\n\t\t\tdisplayPointControllers( display );\r\n\r\n\t\t} );\r\n\t\tcPoints.__select[0].selected = true;\r\n\t\tdat.controllerNameAndTitle( cPoints, lang.select );\r\n\r\n\t\tif ( cFrustumPoints !== undefined )\r\n\t\t\tcFrustumPoints.create( fPoints, getLanguageCode() );\r\n\t\tif ( guiParams.myThreejs )\r\n\t\t\tguiParams.myThreejs.cFrustumPoints = cFrustumPoints;\r\n\r\n\t\t//Camera target\r\n\t\tvar orbitControlsOptions,\r\n\t\t\tcameraTarget;//здесь хранится cameraTarget когда ни одна точка не выбрана как camera target\r\n\t\tif ( guiParams.cameraTarget ) Player.cameraTarget.init( guiParams.cameraTarget );\r\n\t\tconst playerCameraTarget = Player.cameraTarget.get();\r\n//\t\tif ( guiParams.cameraTarget )\r\n//\t\tif ( Player.cameraTarget2\r\n\t\tif ( playerCameraTarget ) {\r\n\r\n\t\t\tcCameraTarget = fPoints.add( playerCameraTarget, 'boLook' ).onChange( function ( boLook ) {\r\n\r\n\t\t\t\tconst mesh = getMesh();\r\n\t\t\t\tif ( !mesh.userData.player ) {\r\n\r\n\t\t\t\t\tmesh.userData.player = { arrayFuncs: [] }\r\n\t\t\t\t\tfor( var i = 0; i < mesh.geometry.attributes.position.count; i++ ) {\r\n\r\n\t\t\t\t\t\tmesh.userData.player.arrayFuncs.push( new THREE.Vector3().fromArray( mesh.geometry.attributes.position.array,\r\n\t\t\t\t\t\t\ti * mesh.geometry.attributes.position.itemSize ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst index = cPoints.__select.options.selectedIndex-1,\r\n\t\t\t\t\tpoint = mesh.userData.player.arrayFuncs[index];\r\n/*\r\n\t\t\t\tfunction getCameraTarget(){\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < cMeshs.__select.options.length; i++ ) {\r\n\r\n\t\t\t\t\t\tconst mesh = cMeshs.__select.options[i].mesh;\r\n\t\t\t\t\t\tif( !mesh || !mesh.userData.player || !mesh.userData.player.arrayFuncs )\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\tconst arrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\t\t\t\t\tfor ( var j = 0; j < arrayFuncs.length; j++ ) {\r\n\r\n\t\t\t\t\t\t\tconst CT = cameraTarget = arrayFuncs[j].cameraTarget;\r\n\t\t\t\t\t\t\tif ( CT ) {\r\n\r\n\t\t\t\t\t\t\t\tcameraTarget = CT;\r\n\t\t\t\t\t\t\t\treturn cameraTarget;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n*/\t\t\t\t\r\n\t\t\t\t//remove boLook from all points\r\n\t\t\t\tfor ( var i = 0; i < cMeshs.__select.options.length; i++ ) {\r\n\r\n\t\t\t\t\tconst mesh = cMeshs.__select.options[i].mesh;\r\n\t\t\t\t\tif( !mesh || !mesh.userData.player || !mesh.userData.player.arrayFuncs )\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tconst arrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\t\t\t\tfor ( var j = 0; j < arrayFuncs.length; j++ )\r\n\t\t\t\t\t\tif ( arrayFuncs[j].cameraTarget ) arrayFuncs[j].cameraTarget.boLook = false;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tpoint.cameraTarget.boLook = boLook;\r\n\t\t\t\tif ( Player.player ) Player.player.selectScene();\r\n\t\t\t\tif ( boLook ) {\r\n\r\n\t\t\t\t\tif ( Player.cameraGui ) Player.cameraGui.look();\r\n\t\t\t\t\tif ( !point.cameraTarget ) {\r\n\r\n\t\t\t\t\t\tgetCameraTarget();// true );\r\n//\t\t\t\t\t\tif ( guiParams.cameraTarget.boLook === undefined ) guiParams.cameraTarget.boLook = true;\r\n//\t\t\t\t\t\tif ( Player.cameraTarget2.boLook === undefined ) Player.cameraTarget2.boLook = false;\r\n\t\t\t\t\t\tif ( playerCameraTarget.boLook === undefined ) Player.cameraTarget2.boLook = false;\r\n\t\t\t\t\t\t\r\n//не помню зачем вставил эту строку\r\n//Но если оставить эту строку то неверно будет устанавливаться дистанция и угол камеры когда порльзователь меняет точку, за которой наблюдает камера\r\n//\t\t\t\t\t\tguiParams.cameraTarget.camera.userData.cameraTarget = guiParams.cameraTarget;\r\n\r\n//\t\t\t\t\t\tpoint.cameraTarget = { camera: guiParams.cameraTarget.camera, }\r\n//\t\t\t\t\t\tpoint.cameraTarget = { camera: Player.cameraTarget2.camera, }\r\n//\t\t\t\t\t\tpoint.cameraTarget = { camera: playerCameraTarget.camera, }\r\n//\t\t\t\t\t\tPlayer.cameraTarget.init(  );\r\n\r\n\t\t\t\t\t\tif ( !orbitControlsOptions ) orbitControlsOptions = {}\r\n\t\t\t\t\t\tif ( !orbitControlsOptions.target )\r\n\t\t\t\t\t\t\torbitControlsOptions.target = new THREE.Vector3();\r\n\t\t\t\t\t\tif ( Player.orbitControls )\r\n\t\t\t\t\t\t\torbitControlsOptions.target.copy( Player.orbitControls.target );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tcameraTarget = undefined;\r\n//\t\t\t\t\t\tPlayer.setCameraTarget( mesh );\r\n//\t\t\t\t\t\tPlayer.setMeshCameraTarget( mesh );\r\n//\t\t\t\t\t\tPlayer.cameraTarget.setTarget( mesh );\r\n\t\t\t\t\t\tPlayer.cameraTarget.changeTarget( mesh, index );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n/*\t\t\t\t\r\n\t\t\t\tcameraTarget = point.cameraTarget;\r\n\t\t\t\tif ( point.cameraTarget ) point.cameraTarget = undefined;\r\n*/\r\n\t\t\t\t//Если точка имеет индивидуальную cameraTarget, то камера будет следить по этим настройкам\r\n\t\t\t\tif ( guiParams.cameraTarget ) guiParams.cameraTarget.camera.userData.cameraTargetPoint = point.cameraTarget;\r\n\r\n\t\t\t\tif ( Player.orbitControls ) Player.orbitControls.reset();\r\n\r\n\t\t\t\tif ( orbitControlsOptions ) {\r\n\r\n\t\t\t\t\tif ( getCameraTarget() )\r\n\t\t\t\t\t\treturn;\r\n\r\n/*\r\n\t\t\t\t\tif ( guiParams.cameraTarget.orbitControls )\r\n\t\t\t\t\t\tguiParams.cameraTarget.orbitControls.target.copy( orbitControlsOptions.target );\r\n*/\t\t\t\t\t\t\r\n\t\t\t\t\tif ( Player.orbitControls )\r\n\t\t\t\t\t\tPlayer.orbitControls.target.copy( orbitControlsOptions.target );\r\n\t\t\t\t\tguiParams.cameraTarget.camera.lookAt( orbitControlsOptions.target );\r\n\t\t\t\t\tpoint.cameraTarget = undefined;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cCameraTarget, lang.cameraTarget, lang.cameraTargetTitle );\r\n\r\n\t\t}\r\n\r\n\t\t//Points attribute position\r\n\t\tfPoint = fPoints.addFolder( lang.point );\r\n\t\tdat.folderNameAndTitle( fPoint, lang.point, lang.pointTitle );\r\n\r\n\t\t//Points world position\r\n\t\tfPointWorld = fPoints.addFolder( lang.pointWorld );\r\n\t\tdat.folderNameAndTitle( fPointWorld, lang.pointWorld, lang.pointWorldTitle );\r\n\t\tfPointWorld.open();\r\n\r\n\t\tdisplayPointControllers( 'none' );\r\n\r\n\t\tif ( guiParams.pointsControls ) {\r\n\r\n//\t\t\tcTraceAll = guiParams.pointsControls( fPoints, dislayEl, getMesh );\r\n\t\t\tguiParams.pointsControls( fPoints, dislayEl, getMesh );\r\n\r\n\t\t}\r\n\t\tcTraceAll = fPoints.add( { trace: false }, 'trace' ).onChange( function ( value ) {\r\n\r\n\t\t\tvar mesh = getMesh();\r\n\t\t\tmesh.userData.traceAll = value;\r\n\t\t\tfor ( var i = 0; i < mesh.geometry.attributes.position.count; i++ )\r\n\t\t\t\tvisibleTraceLine( { object: mesh, index: i }, value, getMesh );\r\n\t\t\tcTrace.setValue( value );\r\n\r\n\t\t} );\r\n\t\tdat.controllerNameAndTitle( cTraceAll, lang.trace, lang.traceAllTitle );\r\n\t\tdislayEl( cTraceAll, Player.isCreated() );\r\n\r\n\t\t//Restore default settings of all 3d objects button.\r\n\t\tdat.controllerNameAndTitle( f3DObjects.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < cMeshs.__select.options.length; i++ ) {\r\n\r\n\t\t\t\t\tconst mesh = cMeshs.__select.options[i].mesh;\r\n\t\t\t\t\tif ( !mesh )\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tmesh.scale.copy( mesh.userData.default.scale );\r\n\t\t\t\t\tmesh.position.copy( mesh.userData.default.position );\r\n\t\t\t\t\tmesh.rotation.copy( mesh.userData.default.rotation );\r\n\t\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tsetScaleControllers();\r\n\t\t\t\tsetPositionControllers();\r\n\t\t\t\tsetRotationControllers();\r\n\t\t\t\texposePosition();\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' ), lang.defaultButton, lang.default3DObjectTitle );\r\n\t\taddPointControllers();\r\n\r\n\t\twhile ( arrayMeshs.length > 0 ) {\r\n\r\n\t\t\tthis.addMesh( arrayMeshs[arrayMeshs.length - 1] );\r\n\t\t\tarrayMeshs.pop();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\tthis.setColorAttribute = function( attributes, i, color ) {\r\n\r\n\t\tif ( typeof color === \"string\" )\r\n\t\t\tcolor = new THREE.Color( color );\r\n\t\tconst colorAttribute = attributes.color || attributes.ca;\r\n\t\tif ( colorAttribute === undefined )\r\n\t\t\treturn;\r\n\t\tcolorAttribute.setX( i, color.r );\r\n\t\tcolorAttribute.setY( i, color.g );\r\n\t\tcolorAttribute.setZ( i, color.b );\r\n\t\tcolorAttribute.needsUpdate = true;\r\n\r\n\t}\r\n\tthis.removePoints = function () {\r\n\r\n\t\t//thanks to https://stackoverflow.com/a/48780352/5175935\r\n\t\tcPoints.domElement.querySelectorAll( 'select option' ).forEach( option => option.remove() );\r\n\t\tconst opt = document.createElement( 'option' );\r\n\t\topt.innerHTML = lang.notSelected;\r\n\t\topt.setAttribute( 'value', -1 );//Эта строка нужна в случае когда пользователь отменил выбор точки. Иначе при движении камеры будут появляться пунктирные линии, указвающие на несуществующую точку\r\n\t\tcPoints.__select.appendChild( opt );\r\n\r\n\t}\r\n/*\r\n\tfunction movePoint( axisName, value ) {\r\n\r\n\t\tconst points = intersection.object,\r\n\t\t\taxesId = axisName === 'x' ? 0 : axisName === 'y' ? 1 : axisName === 'z' ? 2 : axisName === 'w' ? 3 : console.error( 'axisName:' + axisName );\r\n\t\tpoints.geometry.attributes.position.array\r\n\t\t[axesId + intersection.index * points.geometry.attributes.position.itemSize] = value;\r\n\t\tpoints.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\texposePosition( intersection.index );\r\n\r\n\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\toptions.arrayCloud.frustumPoints.updateCloudPointItem( points, intersection.index );\r\n\r\n\t}\r\n*/\r\n\tfunction addPointControllers() {\r\n\r\n\t\tfunction isReadOnlyController( controller ) {\r\n\r\n\t\t\tif ( controller.domElement.querySelector( 'input' ).readOnly ) {\r\n\r\n\t\t\t\tif ( controller.getValue() !== controller.initialValue ) {\r\n\r\n\t\t\t\t\tif ( controller.boSetValue === undefined ) {\r\n\r\n\t\t\t\t\t\tcontroller.boSetValue = true;\r\n\t\t\t\t\t\tsetValue( controller, controller.initialValue );\r\n\t\t\t\t\t\tcontroller.boSetValue = undefined;\r\n\t\t\t\t\t\tcontroller.initialValue = controller.getValue();//Эта строка нужна в случае когда новое зачения невозможно установиь точно таким же, как initialValue\r\n\t\t\t\t\t\t//Иначе перепонится стек\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\t//Point's attribute position axes controllers\r\n\r\n\t\tfunction axesGui( axisName/*axesId, onChange*/ ) {\r\n\r\n\t\t\tvar scale, controller;\r\n\t\t\tif ( axisName === 'w' ){\r\n\r\n\t\t\t\t//W axis\r\n/*\t\t\t\t\r\n\t\t\t\tif ( options.scales.w === undefined ) {\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n*/\t\t\t\t\r\n\t\t\t\tscale = options.scales.w;\r\n\t\t\t\tscale = scale || {};\r\n\t\t\t\tscale.name = scale.name || axisName;\r\n\t\t\t\tif ( options.palette instanceof ColorPicker.palette ) {\r\n\r\n\t\t\t\t\tscale.min = scale.min === undefined ? 0 : scale.min;\r\n\t\t\t\t\tscale.max = scale.max === undefined ? 100 : scale.max;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfunction onChange( value ) {\r\n\r\n//\t\t\t\t\t\toptions.palette = options.palette || new ColorPicker.palette();\r\n\t\t\t\t\tconst attributes = intersection.object.geometry.attributes,\r\n\t\t\t\t\t\ti = intersection.index;\r\n\t\t\t\t\tif ( attributes.position.itemSize < 4 ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'guiSelectPoint.addPointControllers().axesGui().controller.onChange(): attributes.position.itemSize = ' + attributes.position.itemSize )\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( options.palette ) {\r\n\r\n\t\t\t\t\t\tconst color = options.palette.toColor( value, controller.__min, controller.__max );\r\n\t\t\t\t\t\t_this.setColorAttribute( attributes, i, color );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tattributes.position.setW( i, value );\r\n\r\n\t\t\t\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\t\t\t\toptions.arrayCloud.frustumPoints.updateCloudPointItem( intersection.object, intersection.index );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( ( scale.min !== undefined ) &&  ( scale.max !== undefined ) ) {\r\n\r\n\t\t\t\t\tcontroller = fPoint.add( {\r\n\r\n\t\t\t\t\t\t\tvalue: scale.min,\r\n\r\n\t\t\t\t\t\t}, 'value',\r\n\t\t\t\t\t\t\tscale.min,\r\n\t\t\t\t\t\t\tscale.max,\r\n\t\t\t\t\t\t\t( scale.max - scale.min ) / 100\r\n\t\t\t\t\t).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\tonChange( value );\r\n/*\r\n//\t\t\t\t\t\toptions.palette = options.palette || new ColorPicker.palette();\r\n\t\t\t\t\t\tconst attributes = intersection.object.geometry.attributes,\r\n\t\t\t\t\t\t\ti = intersection.index;\r\n\t\t\t\t\t\tif ( options.palette ) {\r\n\r\n\t\t\t\t\t\t\tconst color = options.palette.toColor( value, controller.__min, controller.__max );\r\n\t\t\t\t\t\t\t_this.setColorAttribute( attributes, i, color );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tattributes.position.setW( i, value );\r\n\r\n\t\t\t\t\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\t\t\t\t\toptions.arrayCloud.frustumPoints.updateCloudPointItem( intersection.object, intersection.index );\r\n*/\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tif ( options.palette instanceof ColorPicker.palette ) {\r\n\r\n\t\t\t\t\t\tcontroller.domElement.querySelector( '.slider-fg' ).style.height = '40%';\r\n\t\t\t\t\t\tconst elSlider = controller.domElement.querySelector( '.slider' );\r\n\t\t\t\t\t\tColorPicker.create( elSlider, {\r\n\r\n\t\t\t\t\t\t\tpalette: options.palette,\r\n\t\t\t\t\t\t\tstyle: {\r\n\r\n\t\t\t\t\t\t\t\t//border: '2px solid #303030',\r\n\t\t\t\t\t\t\t\t//width: '65%',\r\n\t\t\t\t\t\t\t\t//height: elSlider.offsetHeight / 2,//'50%',\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t//onError: function ( message ) { alert( 'Colorpicker error: ' + message ); }\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t} else \r\n\t\t\t\t\tcontroller = fPoint.add( {\r\n\r\n\t\t\t\t\t\t\tvalue: 0,\r\n\r\n\t\t\t\t\t\t}, 'value'\r\n\t\t\t\t\t).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\tonChange( value );\r\n/*\r\n\t\t\t\t\t\tconst attributes = intersection.object.geometry.attributes,\r\n\t\t\t\t\t\t\ti = intersection.index;\r\n\t\t\t\t\t\tif ( attributes.position.itemSize < 4 ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'guiSelectPoint.addPointControllers().axesGui().controller.onChange(): attributes.position.itemSize = ' + attributes.position.itemSize )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tattributes.position.setW( i, value );\r\n\r\n\t\t\t\t\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\t\t\t\t\toptions.arrayCloud.frustumPoints.updateCloudPointItem( intersection.object, intersection.index );\r\n*/\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tscale = axesHelper === undefined ? options.scales[axisName] : //если я буду использовать эту строку то экстремумы шкал буду устанавливатся по умолчанию а не текущие\r\n\t\t\t\t\taxesHelper.options ? axesHelper.options.scales[axisName] : undefined;\r\n\t\t\t\tif ( scale )\r\n\t\t\t\t\tcontroller = fPoint.add( {\r\n\r\n\t\t\t\t\t\tvalue: scale.min,\r\n\r\n\t\t\t\t\t}, 'value',\r\n\t\t\t\t\t\tscale.min,\r\n\t\t\t\t\t\tscale.max,\r\n\t\t\t\t\t\t( scale.max - scale.min ) / 100 ).\r\n\t\t\t\t\t\tonChange( function ( value ) {\r\n\r\n\t\t\t\t\t\t\tif ( isReadOnlyController( controller ) )\r\n\t\t\t\t\t\t\t\treturn;\r\n//\t\t\t\t\t\t\tmovePoint( axisName, value );\r\n\t\t\t\t\t\t\tconst points = intersection.object,\r\n\t\t\t\t\t\t\t\taxesId = axisName === 'x' ? 0 : axisName === 'y' ? 1 : axisName === 'z' ? 2 : axisName === 'w' ? 3 : console.error( 'axisName:' + axisName );\r\n\t\t\t\t\t\t\tpoints.geometry.attributes.position.array\r\n\t\t\t\t\t\t\t[axesId + intersection.index * points.geometry.attributes.position.itemSize] = value;\r\n\t\t\t\t\t\t\tpoints.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t\t\t\t\texposePosition( intersection.index );\r\n\r\n\t\t\t\t\t\t\tif ( ( options.arrayCloud !== undefined ) && ( options.arrayCloud.frustumPoints !== undefined ) )\r\n\t\t\t\t\t\t\t\toptions.arrayCloud.frustumPoints.updateCloudPointItem( points, intersection.index );\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\tif ( scale )\r\n\t\t\t\tdat.controllerNameAndTitle( controller, scale.name );\r\n\t\t\treturn controller;\r\n\r\n\t\t}\r\n\t\tcX = axesGui( 'x' );\r\n\t\tcY = axesGui( 'y' );\r\n\t\tcZ = axesGui( 'z' );\r\n\t\tcW = axesGui( 'w' );\r\n\t\tcColor = fPoint.addColor( {\r\n\r\n\t\t\tcolor: '#FFFFFF',\r\n\r\n\t\t}, 'color' ).\r\n\t\t\tonChange( function ( value ) {\r\n\r\n\t\t\t\tif ( isReadOnlyController( cColor ) )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tif ( cColor.userData === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tvar intersection = cColor.userData.intersection;\r\n\t\t\t\t_this.setColorAttribute( intersection.object.geometry.attributes, intersection.index, value );\r\n\r\n\t\t\t} );\r\n\t\tdat.controllerNameAndTitle( cColor, options.scales.w ? options.scales.w.name : lang.color );\r\n//\t\tdat.controllerNameAndTitle( cColor, lang.color );\r\n\t\tcOpacity = fPoint.add( {\r\n\r\n\t\t\topasity: 1,\r\n\r\n\t\t}, 'opasity', 0, 1, 0.01 ).\r\n\t\t\tonChange( function ( opasity ) {\r\n\r\n\t\t\t\tif ( isReadOnlyController( cOpacity ) )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tif ( cColor.userData === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tconst intersection = cColor.userData.intersection;\r\n\t\t\t\tconst points = intersection.object;\r\n\t\t\t\tif ( points.geometry.attributes.ca === undefined )\r\n\t\t\t\t\treturn;//no opasity\r\n\t\t\t\tpoints.geometry.attributes.ca.array\r\n\t\t\t\t[3 + intersection.index * points.geometry.attributes.ca.itemSize] = opasity;\r\n\t\t\t\tpoints.geometry.attributes.ca.needsUpdate = true;\r\n\r\n\t\t\t} );\r\n\t\tdat.controllerNameAndTitle( cOpacity, lang.opacity, lang.opacityTitle );\r\n\t\t\r\n\t\tcTrace = fPoint.add( { trace: false }, 'trace' ).onChange( function ( value ) {\r\n\r\n\t\t\tvisibleTraceLine( intersection, value, getMesh );\r\n\r\n\t\t} );\r\n\t\tdat.controllerNameAndTitle( cTrace, lang.trace, lang.traceTitle );\r\n\t\tdislayEl( cTrace, Player.isCreated() );\r\n\r\n\t\tif ( guiParams.pointControls ) {\r\n\r\n//\t\t\tcTrace = guiParams.pointControls( fPoint, dislayEl, getMesh, intersection );\r\n\t\t\tguiParams.pointControls( fPoint, dislayEl, getMesh, intersection );\r\n\r\n\t\t}\r\n\t\t\r\n\t\t//Point's world position axes controllers\r\n\r\n\t\tfunction axesWorldGui( axisName ) {\r\n\r\n\t\t\tconst scale = axesHelper === undefined ? options.scales[axisName] :\r\n\t\t\t\t\taxesHelper.options ? axesHelper.options.scales[axisName] : undefined;\r\n\t\t\tif ( !scale )\r\n\t\t\t\treturn;\r\n\t\t\tconst controller = dat.controllerZeroStep( fPointWorld, { value: scale.min, }, 'value' );\r\n\t\t\tcontroller.domElement.querySelector( 'input' ).readOnly = true;\r\n\t\t\tdat.controllerNameAndTitle( controller, scale.name );\r\n\t\t\treturn controller;\r\n\r\n\t\t}\r\n\t\tcWorld.x = axesWorldGui( 'x' );\r\n\t\tcWorld.y = axesWorldGui( 'y' );\r\n\t\tcWorld.z = axesWorldGui( 'z' );\r\n\r\n\t\t//Restore default local position.\r\n\t\tcRestoreDefaultLocalPosition = fPoint.add( {\r\n\r\n\t\t\tdefaultF: function () {\r\n\r\n\t\t\t\tconst positionDefault = intersection.object.userData.player.arrayFuncs[intersection.index],\r\n\t\t\t\t\tt = Player.getTime();\r\n\t\t\t\tcX.setValue( typeof positionDefault.x === \"function\" ?\r\n\t\t\t\t\tpositionDefault.x( t, options.a, options.b ) : positionDefault.x );\r\n\t\t\t\tcY.setValue( typeof positionDefault.y === \"function\" ?\r\n\t\t\t\t\tpositionDefault.y( t, options.a, options.b ) : positionDefault.y );\r\n\t\t\t\tcZ.setValue( typeof positionDefault.z === \"function\" ?\r\n\t\t\t\t\tpositionDefault.z( t, options.a, options.b ) :\r\n\t\t\t\t\tpositionDefault.z === undefined ? 0 ://default Z axis of 2D point is 0\r\n\t\t\t\t\t\tpositionDefault.z );\r\n\r\n\t\t\t\tif ( positionDefault.w !== undefined ) {\r\n\r\n\t\t\t\t\tif ( positionDefault.w.r !== undefined )\r\n\t\t\t\t\t\tcColor.setValue( '#' +\r\n\t\t\t\t\t\t\tnew THREE.Color( positionDefault.w.r, positionDefault.w.g, positionDefault.w.b ).getHexString() );\r\n\t\t\t\t\telse if ( typeof positionDefault.w === \"function\" )\r\n\t\t\t\t\t\tsetValue( cW, positionDefault.w( t ) );\r\n\t\t\t\t\telse if ( positionDefault.w.func ) {\r\n\r\n\t\t\t\t\t\tsetValue( cW, positionDefault.w.func( t ) );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst float = parseFloat( positionDefault.w );\r\n\t\t\t\t\tif ( float === positionDefault.w )\r\n\t\t\t\t\t\tsetValue( cW, positionDefault.w );\r\n\t\t\t\t\telse console.error( 'Restore default local position: Invalid W axis.' );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tcColor.setValue( cColor.initialValue );\r\n\t\t\t\t\tcOpacity.setValue( cOpacity.initialValue );\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' );\r\n\t\tdat.controllerNameAndTitle( cRestoreDefaultLocalPosition, lang.defaultButton, lang.defaultLocalPositionTitle );\r\n\r\n\t\tfuncFolder = new functionsFolder( fPoint, options.scales, THREE, function ( func, axisName ) {\r\n\r\n\t\t\tconst mesh = getMesh(),\r\n\t\t\t\tindex = cPoints.__select.options.selectedIndex - 1,\r\n\t\t\t\tfuncs = mesh.userData.player.arrayFuncs[index];\r\n\t\t\tfuncs[axisName] = func;\r\n\r\n\t\t\tvar parent = mesh.parent, t = 0;\r\n\t\t\twhile ( parent ) {\r\n\r\n\t\t\t\tif ( parent.userData.t ) {\r\n\r\n\t\t\t\t\tt = parent.userData.t;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parent;\r\n\r\n\t\t\t}\r\n\t\t\tconst position = mesh.geometry.attributes.position,\r\n\t\t\t\titemSize = position.itemSize;\r\n\t\t\tvar controller;\r\n\t\t\tswitch ( axisName ) {\r\n\r\n\t\t\t\tcase 'x':\r\n\t\t\t\t\tcontroller = cX;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'y':\r\n\t\t\t\t\tcontroller = cY;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'z':\r\n\t\t\t\t\tcontroller = cZ;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'w':\r\n\t\t\t\t\tif ( func instanceof THREE.Color ) {\r\n\r\n\t\t\t\t\t\tcColor.setValue( '#' + func.getHexString() );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontroller = cW;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error( 'GuiSelectPoint new functionsFolder onFinishChange: axisName = ' + axisName );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tsetValue( controller, Player.execFunc( funcs, axisName, t ) );\r\n/*\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\r\n\t\t\t\tsetValue( controller, Player.execFunc( funcs, axisName, t ) );\r\n\t\t\t\r\n\t\t\t} catch ( e ) {\r\n\t\t\t\r\n\t\t\t\talert( e.message );\r\n\t\t\t\tfuncFolder.setFocus( axisName );\r\n\t\t\t\r\n\t\t\t}\r\n*/\r\n\r\n\t\t}, {\r\n\r\n\t\t\tgetLanguageCode: getLanguageCode,\r\n\t\t\tTHREE: THREE,\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\t/**\r\n\t * get frustum points\r\n\t * @function GuiSelectPoint.\r\n\t * getFrustumPoints\r\n\t */\r\n\tthis.getFrustumPoints = function () { return cFrustumPoints; }\r\n\tthis.windowRange = function ( options ) {\r\n\r\n\t\tpointLight1.windowRange( options.scales );\r\n\t\tpointLight2.windowRange( options.scales );\r\n\r\n\t\tcX.min( options.scales.x.min );\r\n\t\tcX.max( options.scales.x.max );\r\n\t\tcX.updateDisplay();\r\n\r\n\t\tcY.min( options.scales.y.min );\r\n\t\tcY.max( options.scales.y.max );\r\n\t\tcY.updateDisplay();\r\n\r\n\t\tcZ.min( options.scales.z.min );\r\n\t\tcZ.max( options.scales.z.max );\r\n\t\tcZ.updateDisplay();\r\n\r\n\t\tif ( cW !== undefined ) {\r\n\r\n\t\t\tcW.min( options.scales.w.min );\r\n\t\t\tcW.max( options.scales.w.max );\r\n\t\t\tcW.updateDisplay();\r\n\r\n\t\t}\r\n\r\n\t}\r\n//\tthis.setOrbitControls = function ( orbitControls ) { guiParams.cameraTarget.orbitControls = orbitControls; }\r\n\treturn this;\r\n\r\n}\r\n\r\n/**\r\n * gets the position from the geometry.attributes.position of the object.\r\n * @param {THREE.Mesh} object\r\n * @param {number} index index of position in the object.geometry.attributes.position\r\n * @returns position\r\n */\r\nfunction getObjectLocalPosition( object, index ) {\r\n\r\n\tif ( !THREE ) {\r\n\r\n\t\tconsole.error( 'getObjectLocalPosition: call GuiSelectPoint.setTHREE( THREE ); first' );\r\n\t\treturn;\r\n\t\t\r\n\t}\r\n\tconst attributesPosition = object.geometry.attributes.position,\r\n\t\tposition = attributesPosition.itemSize >= 4 ? new THREE.Vector4( 0, 0, 0, 0 ) : new THREE.Vector3();\r\n\tposition.fromArray( attributesPosition.array, index * attributesPosition.itemSize );\r\n\treturn position;\r\n\r\n}\r\n\r\n/**\r\n * gets position of the vector in world coordinates, taking into account the position, scale and rotation of the 3D object\r\n * @param {THREE.Object3D} object\r\n * @param {THREE.Vector3} pos local position\r\n * @returns world position \r\n */\r\nfunction getWorldPosition( object, pos ) {\r\n\r\n\tvar position = pos.clone();\r\n\r\n/*\r\n\t//https://stackoverflow.com/questions/11495089/how-to-get-the-absolute-position-of-a-vertex-in-three-js\r\n\t//Неудачная попытка вычислить абсолютную позицию точки\r\n\tobject.updateMatrixWorld();\r\n\tposition.applyMatrix4( object.matrixWorld );\r\n*/\t\r\n\tfunction getPosition( object, pos ) {\r\n\r\n\t\tvar position = new THREE.Vector3(),\r\n\t\t\tpositionAngle = new THREE.Vector3();\r\n\t\tposition = pos.clone();\r\n\t\tposition.multiply( object.scale );\r\n\r\n\t\t//rotation\r\n\t\tpositionAngle.copy( position );\r\n\t\tpositionAngle.applyEuler( object.rotation );\r\n\t\tposition.x = positionAngle.x;\r\n\t\tposition.y = positionAngle.y;\r\n\t\tposition.z = positionAngle.z;\r\n\r\n\t\tposition.add( object.position );\r\n\t\treturn position;\r\n\r\n\t}\r\n\tdo {\r\n\r\n\t\tposition = getPosition( object, position );\r\n\t\tobject = object.parent;\r\n\t\t\r\n\t} while ( object.parent );\r\n\treturn position;\r\n\r\n}\r\n\r\n/**\r\n * gets the position from the geometry.attributes.position of the object in world coordinates.\r\n * @param {THREE.Mesh} object\r\n * @param {number} index index of position in the object.geometry.attributes.position\r\n * @returns position\r\n */\r\nfunction getObjectPosition( object, index ) {\r\n\r\n\tif ( index === -1 )\r\n\t\treturn undefined;\r\n\tif ( index === undefined )\r\n\t\treturn object.position;\r\n\treturn getWorldPosition( object, getObjectLocalPosition( object, index ) )\r\n\r\n}\r\n\r\n/**\r\n * set THREE\r\n * @function GuiSelectPoint.\r\n * setTHREE\r\n * @param {THREE} _THREE {@link https://github.com/anhr/three.js|THREE}\r\n */\r\nGuiSelectPoint.setTHREE = function ( _THREE ) {\r\n\r\n\tif ( THREE ) {\r\n\r\n\t\tif ( !Object.is(THREE, _THREE) )\r\n\t\t\tconsole.error( 'GuiSelectPoint.setTHREE: duplicate THREE. Please use one instance of the THREE library.' )\r\n\t\treturn;\r\n\r\n\t}\r\n\tTHREE = _THREE;\r\n\r\n}\r\nexport { GuiSelectPoint, getWorldPosition, getObjectLocalPosition, getObjectPosition };\r\n","/**\r\n * dat-gui JavaScript Controller Library\r\n * http://code.google.com/p/dat-gui\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nfunction ___$insertStyle(css) {\r\n  if (!css) {\r\n    return;\r\n  }\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  var style = document.createElement('style');\r\n\r\n  style.setAttribute('type', 'text/css');\r\n  style.innerHTML = css;\r\n  document.head.appendChild(style);\r\n\r\n  return css;\r\n}\r\n\r\nfunction colorToString (color, forceCSSHex) {\r\n  var colorFormat = color.__state.conversionName.toString();\r\n  var r = Math.round(color.r);\r\n  var g = Math.round(color.g);\r\n  var b = Math.round(color.b);\r\n  var a = color.a;\r\n  var h = Math.round(color.h);\r\n  var s = color.s.toFixed(1);\r\n  var v = color.v.toFixed(1);\r\n  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\r\n    var str = color.hex.toString(16);\r\n    while (str.length < 6) {\r\n      str = '0' + str;\r\n    }\r\n    return '#' + str;\r\n  } else if (colorFormat === 'CSS_RGB') {\r\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n  } else if (colorFormat === 'CSS_RGBA') {\r\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\r\n  } else if (colorFormat === 'HEX') {\r\n    return '0x' + color.hex.toString(16);\r\n  } else if (colorFormat === 'RGB_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ']';\r\n  } else if (colorFormat === 'RGBA_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\r\n  } else if (colorFormat === 'RGB_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\r\n  } else if (colorFormat === 'RGBA_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\r\n  } else if (colorFormat === 'HSV_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\r\n  } else if (colorFormat === 'HSVA_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\r\n  }\r\n  return 'unknown format';\r\n}\r\n\r\nvar ARR_EACH = Array.prototype.forEach;\r\nvar ARR_SLICE = Array.prototype.slice;\r\nvar Common = {\r\n  BREAK: {},\r\n  extend: function extend(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (!this.isUndefined(obj[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  defaults: function defaults(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (this.isUndefined(target[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  compose: function compose() {\r\n    var toCall = ARR_SLICE.call(arguments);\r\n    return function () {\r\n      var args = ARR_SLICE.call(arguments);\r\n      for (var i = toCall.length - 1; i >= 0; i--) {\r\n        args = [toCall[i].apply(this, args)];\r\n      }\r\n      return args[0];\r\n    };\r\n  },\r\n  each: function each(obj, itr, scope) {\r\n    if (!obj) {\r\n      return;\r\n    }\r\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\r\n      obj.forEach(itr, scope);\r\n    } else if (obj.length === obj.length + 0) {\r\n      var key = void 0;\r\n      var l = void 0;\r\n      for (key = 0, l = obj.length; key < l; key++) {\r\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    } else {\r\n      for (var _key in obj) {\r\n        if (itr.call(scope, obj[_key], _key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  defer: function defer(fnc) {\r\n    setTimeout(fnc, 0);\r\n  },\r\n  debounce: function debounce(func, threshold, callImmediately) {\r\n    var timeout = void 0;\r\n    return function () {\r\n      var obj = this;\r\n      var args = arguments;\r\n      function delayed() {\r\n        timeout = null;\r\n        if (!callImmediately) func.apply(obj, args);\r\n      }\r\n      var callNow = callImmediately || !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(delayed, threshold);\r\n      if (callNow) {\r\n        func.apply(obj, args);\r\n      }\r\n    };\r\n  },\r\n  toArray: function toArray(obj) {\r\n    if (obj.toArray) return obj.toArray();\r\n    return ARR_SLICE.call(obj);\r\n  },\r\n  isUndefined: function isUndefined(obj) {\r\n    return obj === undefined;\r\n  },\r\n  isNull: function isNull(obj) {\r\n    return obj === null;\r\n  },\r\n  isNaN: function (_isNaN) {\r\n    function isNaN(_x) {\r\n      return _isNaN.apply(this, arguments);\r\n    }\r\n    isNaN.toString = function () {\r\n      return _isNaN.toString();\r\n    };\r\n    return isNaN;\r\n  }(function (obj) {\r\n    return isNaN(obj);\r\n  }),\r\n  isArray: Array.isArray || function (obj) {\r\n    return obj.constructor === Array;\r\n  },\r\n  isObject: function isObject(obj) {\r\n    return obj === Object(obj);\r\n  },\r\n  isNumber: function isNumber(obj) {\r\n    return obj === obj + 0;\r\n  },\r\n  isString: function isString(obj) {\r\n    return obj === obj + '';\r\n  },\r\n  isBoolean: function isBoolean(obj) {\r\n    return obj === false || obj === true;\r\n  },\r\n  isFunction: function isFunction(obj) {\r\n    return Object.prototype.toString.call(obj) === '[object Function]';\r\n  }\r\n};\r\n\r\nvar INTERPRETATIONS = [\r\n{\r\n  litmus: Common.isString,\r\n  conversions: {\r\n    THREE_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    SIX_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9]{6})$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGB: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3])\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGBA: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3]),\r\n          a: parseFloat(test[4])\r\n        };\r\n      },\r\n      write: colorToString\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isNumber,\r\n  conversions: {\r\n    HEX: {\r\n      read: function read(original) {\r\n        return {\r\n          space: 'HEX',\r\n          hex: original,\r\n          conversionName: 'HEX'\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return color.hex;\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isArray,\r\n  conversions: {\r\n    RGB_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 3) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b];\r\n      }\r\n    },\r\n    RGBA_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 4) return false;\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2],\r\n          a: original[3]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b, color.a];\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isObject,\r\n  conversions: {\r\n    RGBA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    RGB_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b\r\n        };\r\n      }\r\n    },\r\n    HSVA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    HSV_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v\r\n        };\r\n      }\r\n    }\r\n  }\r\n}];\r\nvar result = void 0;\r\nvar toReturn = void 0;\r\nvar interpret = function interpret() {\r\n  toReturn = false;\r\n  var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\r\n  Common.each(INTERPRETATIONS, function (family) {\r\n    if (family.litmus(original)) {\r\n      Common.each(family.conversions, function (conversion, conversionName) {\r\n        result = conversion.read(original);\r\n        if (toReturn === false && result !== false) {\r\n          toReturn = result;\r\n          result.conversionName = conversionName;\r\n          result.conversion = conversion;\r\n          return Common.BREAK;\r\n        }\r\n      });\r\n      return Common.BREAK;\r\n    }\r\n  });\r\n  return toReturn;\r\n};\r\n\r\nvar tmpComponent = void 0;\r\nvar ColorMath = {\r\n  hsv_to_rgb: function hsv_to_rgb(h, s, v) {\r\n    var hi = Math.floor(h / 60) % 6;\r\n    var f = h / 60 - Math.floor(h / 60);\r\n    var p = v * (1.0 - s);\r\n    var q = v * (1.0 - f * s);\r\n    var t = v * (1.0 - (1.0 - f) * s);\r\n    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\r\n    return {\r\n      r: c[0] * 255,\r\n      g: c[1] * 255,\r\n      b: c[2] * 255\r\n    };\r\n  },\r\n  rgb_to_hsv: function rgb_to_hsv(r, g, b) {\r\n    var min = Math.min(r, g, b);\r\n    var max = Math.max(r, g, b);\r\n    var delta = max - min;\r\n    var h = void 0;\r\n    var s = void 0;\r\n    if (max !== 0) {\r\n      s = delta / max;\r\n    } else {\r\n      return {\r\n        h: NaN,\r\n        s: 0,\r\n        v: 0\r\n      };\r\n    }\r\n    if (r === max) {\r\n      h = (g - b) / delta;\r\n    } else if (g === max) {\r\n      h = 2 + (b - r) / delta;\r\n    } else {\r\n      h = 4 + (r - g) / delta;\r\n    }\r\n    h /= 6;\r\n    if (h < 0) {\r\n      h += 1;\r\n    }\r\n    return {\r\n      h: h * 360,\r\n      s: s,\r\n      v: max / 255\r\n    };\r\n  },\r\n  rgb_to_hex: function rgb_to_hex(r, g, b) {\r\n    var hex = this.hex_with_component(0, 2, r);\r\n    hex = this.hex_with_component(hex, 1, g);\r\n    hex = this.hex_with_component(hex, 0, b);\r\n    return hex;\r\n  },\r\n  component_from_hex: function component_from_hex(hex, componentIndex) {\r\n    return hex >> componentIndex * 8 & 0xFF;\r\n  },\r\n  hex_with_component: function hex_with_component(hex, componentIndex, value) {\r\n    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\r\n  }\r\n};\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\r\n  return typeof obj;\r\n} : function (obj) {\r\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar get = function get(object, property, receiver) {\r\n  if (object === null) object = Function.prototype;\r\n  var desc = Object.getOwnPropertyDescriptor(object, property);\r\n\r\n  if (desc === undefined) {\r\n    var parent = Object.getPrototypeOf(object);\r\n\r\n    if (parent === null) {\r\n      return undefined;\r\n    } else {\r\n      return get(parent, property, receiver);\r\n    }\r\n  } else if (\"value\" in desc) {\r\n    return desc.value;\r\n  } else {\r\n    var getter = desc.get;\r\n\r\n    if (getter === undefined) {\r\n      return undefined;\r\n    }\r\n\r\n    return getter.call(receiver);\r\n  }\r\n};\r\n\r\nvar inherits = function (subClass, superClass) {\r\n  if (typeof superClass !== \"function\" && superClass !== null) {\r\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\r\n  }\r\n\r\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n    constructor: {\r\n      value: subClass,\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true\r\n    }\r\n  });\r\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar possibleConstructorReturn = function (self, call) {\r\n  if (!self) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n\r\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\r\n};\r\n\r\nvar Color = function () {\r\n  function Color() {\r\n    classCallCheck(this, Color);\r\n    this.__state = interpret.apply(this, arguments);\r\n    if (this.__state === false) {\r\n      throw new Error('Failed to interpret color arguments');\r\n    }\r\n    this.__state.a = this.__state.a || 1;\r\n  }\r\n  createClass(Color, [{\r\n    key: 'toString',\r\n    value: function toString() {\r\n      return colorToString(this);\r\n    }\r\n  }, {\r\n    key: 'toHexString',\r\n    value: function toHexString() {\r\n      return colorToString(this, true);\r\n    }\r\n  }, {\r\n    key: 'toOriginal',\r\n    value: function toOriginal() {\r\n      return this.__state.conversion.write(this);\r\n    }\r\n  }]);\r\n  return Color;\r\n}();\r\nfunction defineRGBComponent(target, component, componentHexIndex) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'RGB') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateRGB(this, component, componentHexIndex);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'RGB') {\r\n        Color.recalculateRGB(this, component, componentHexIndex);\r\n        this.__state.space = 'RGB';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nfunction defineHSVComponent(target, component) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'HSV') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateHSV(this);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'HSV') {\r\n        Color.recalculateHSV(this);\r\n        this.__state.space = 'HSV';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nColor.recalculateRGB = function (color, component, componentHexIndex) {\r\n  if (color.__state.space === 'HEX') {\r\n    color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\r\n  } else if (color.__state.space === 'HSV') {\r\n    Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\r\n  } else {\r\n    throw new Error('Corrupted color state');\r\n  }\r\n};\r\nColor.recalculateHSV = function (color) {\r\n  var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\r\n  Common.extend(color.__state, {\r\n    s: result.s,\r\n    v: result.v\r\n  });\r\n  if (!Common.isNaN(result.h)) {\r\n    color.__state.h = result.h;\r\n  } else if (Common.isUndefined(color.__state.h)) {\r\n    color.__state.h = 0;\r\n  }\r\n};\r\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\r\ndefineRGBComponent(Color.prototype, 'r', 2);\r\ndefineRGBComponent(Color.prototype, 'g', 1);\r\ndefineRGBComponent(Color.prototype, 'b', 0);\r\ndefineHSVComponent(Color.prototype, 'h');\r\ndefineHSVComponent(Color.prototype, 's');\r\ndefineHSVComponent(Color.prototype, 'v');\r\nObject.defineProperty(Color.prototype, 'a', {\r\n  get: function get$$1() {\r\n    return this.__state.a;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.a = v;\r\n  }\r\n});\r\nObject.defineProperty(Color.prototype, 'hex', {\r\n  get: function get$$1() {\r\n    if (!this.__state.space !== 'HEX') {\r\n      this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\r\n    }\r\n    return this.__state.hex;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.space = 'HEX';\r\n    this.__state.hex = v;\r\n  }\r\n});\r\n\r\nvar Controller = function () {\r\n  function Controller(object, property) {\r\n    classCallCheck(this, Controller);\r\n    this.initialValue = object[property];\r\n    this.domElement = document.createElement('div');\r\n    this.object = object;\r\n    this.property = property;\r\n    this.__onChange = undefined;\r\n    this.__onFinishChange = undefined;\r\n  }\r\n  createClass(Controller, [{\r\n    key: 'onChange',\r\n    value: function onChange(fnc) {\r\n      this.__onChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'onFinishChange',\r\n    value: function onFinishChange(fnc) {\r\n      this.__onFinishChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'setValue',\r\n    value: function setValue(newValue) {\r\n      this.object[this.property] = newValue;\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this, newValue);\r\n      }\r\n      this.updateDisplay();\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'getValue',\r\n    value: function getValue() {\r\n      return this.object[this.property];\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'isModified',\r\n    value: function isModified() {\r\n      return this.initialValue !== this.getValue();\r\n    }\r\n  }]);\r\n  return Controller;\r\n}();\r\n\r\nvar EVENT_MAP = {\r\n  HTMLEvents: ['change'],\r\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\r\n  KeyboardEvents: ['keydown']\r\n};\r\nvar EVENT_MAP_INV = {};\r\nCommon.each(EVENT_MAP, function (v, k) {\r\n  Common.each(v, function (e) {\r\n    EVENT_MAP_INV[e] = k;\r\n  });\r\n});\r\nvar CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\r\nfunction cssValueToPixels(val) {\r\n  if (val === '0' || Common.isUndefined(val)) {\r\n    return 0;\r\n  }\r\n  var match = val.match(CSS_VALUE_PIXELS);\r\n  if (!Common.isNull(match)) {\r\n    return parseFloat(match[1]);\r\n  }\r\n  return 0;\r\n}\r\nvar dom = {\r\n  makeSelectable: function makeSelectable(elem, selectable) {\r\n    if (elem === undefined || elem.style === undefined) return;\r\n    elem.onselectstart = selectable ? function () {\r\n      return false;\r\n    } : function () {};\r\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\r\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\r\n    elem.unselectable = selectable ? 'on' : 'off';\r\n  },\r\n  makeFullscreen: function makeFullscreen(elem, hor, vert) {\r\n    var vertical = vert;\r\n    var horizontal = hor;\r\n    if (Common.isUndefined(horizontal)) {\r\n      horizontal = true;\r\n    }\r\n    if (Common.isUndefined(vertical)) {\r\n      vertical = true;\r\n    }\r\n    elem.style.position = 'absolute';\r\n    if (horizontal) {\r\n      elem.style.left = 0;\r\n      elem.style.right = 0;\r\n    }\r\n    if (vertical) {\r\n      elem.style.top = 0;\r\n      elem.style.bottom = 0;\r\n    }\r\n  },\r\n  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\r\n    var params = pars || {};\r\n    var className = EVENT_MAP_INV[eventType];\r\n    if (!className) {\r\n      throw new Error('Event type ' + eventType + ' not supported.');\r\n    }\r\n    var evt = document.createEvent(className);\r\n    switch (className) {\r\n      case 'MouseEvents':\r\n        {\r\n          var clientX = params.x || params.clientX || 0;\r\n          var clientY = params.y || params.clientY || 0;\r\n          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0,\r\n          0,\r\n          clientX,\r\n          clientY,\r\n          false, false, false, false, 0, null);\r\n          break;\r\n        }\r\n      case 'KeyboardEvents':\r\n        {\r\n          var init = evt.initKeyboardEvent || evt.initKeyEvent;\r\n          Common.defaults(params, {\r\n            cancelable: true,\r\n            ctrlKey: false,\r\n            altKey: false,\r\n            shiftKey: false,\r\n            metaKey: false,\r\n            keyCode: undefined,\r\n            charCode: undefined\r\n          });\r\n          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\r\n          break;\r\n        }\r\n      default:\r\n        {\r\n          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\r\n          break;\r\n        }\r\n    }\r\n    Common.defaults(evt, aux);\r\n    elem.dispatchEvent(evt);\r\n  },\r\n  bind: function bind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.addEventListener) {\r\n      elem.addEventListener(event, func, bool);\r\n    } else if (elem.attachEvent) {\r\n      elem.attachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  unbind: function unbind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.removeEventListener) {\r\n      elem.removeEventListener(event, func, bool);\r\n    } else if (elem.detachEvent) {\r\n      elem.detachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  addClass: function addClass(elem, className) {\r\n    if (elem.className === undefined) {\r\n      elem.className = className;\r\n    } else if (elem.className !== className) {\r\n      var classes = elem.className.split(/ +/);\r\n      if (classes.indexOf(className) === -1) {\r\n        classes.push(className);\r\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n      }\r\n    }\r\n    return dom;\r\n  },\r\n  removeClass: function removeClass(elem, className) {\r\n    if (className) {\r\n      if (elem.className === className) {\r\n        elem.removeAttribute('class');\r\n      } else {\r\n        var classes = elem.className.split(/ +/);\r\n        var index = classes.indexOf(className);\r\n        if (index !== -1) {\r\n          classes.splice(index, 1);\r\n          elem.className = classes.join(' ');\r\n        }\r\n      }\r\n    } else {\r\n      elem.className = undefined;\r\n    }\r\n    return dom;\r\n  },\r\n  hasClass: function hasClass(elem, className) {\r\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\r\n  },\r\n  getWidth: function getWidth(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\r\n  },\r\n  getHeight: function getHeight(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\r\n  },\r\n  getOffset: function getOffset(el) {\r\n    var elem = el;\r\n    var offset = { left: 0, top: 0 };\r\n    if (elem.offsetParent) {\r\n      do {\r\n        offset.left += elem.offsetLeft;\r\n        offset.top += elem.offsetTop;\r\n        elem = elem.offsetParent;\r\n      } while (elem);\r\n    }\r\n    return offset;\r\n  },\r\n  isActive: function isActive(elem) {\r\n    return elem === document.activeElement && (elem.type || elem.href);\r\n  }\r\n};\r\n\r\nvar BooleanController = function (_Controller) {\r\n  inherits(BooleanController, _Controller);\r\n  function BooleanController(object, property) {\r\n    classCallCheck(this, BooleanController);\r\n    var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__prev = _this2.getValue();\r\n    _this2.__checkbox = document.createElement('input');\r\n    _this2.__checkbox.setAttribute('type', 'checkbox');\r\n    function onChange() {\r\n      _this.setValue(!_this.__prev);\r\n    }\r\n    dom.bind(_this2.__checkbox, 'change', onChange, false);\r\n    _this2.domElement.appendChild(_this2.__checkbox);\r\n    _this2.updateDisplay();\r\n    return _this2;\r\n  }\r\n  createClass(BooleanController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      this.__prev = this.getValue();\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (this.getValue() === true) {\r\n        this.__checkbox.setAttribute('checked', 'checked');\r\n        this.__checkbox.checked = true;\r\n        this.__prev = true;\r\n      } else {\r\n        this.__checkbox.checked = false;\r\n        this.__prev = false;\r\n      }\r\n      return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return BooleanController;\r\n}(Controller);\r\n\r\nvar OptionController = function (_Controller) {\r\n  inherits(OptionController, _Controller);\r\n  function OptionController(object, property, opts) {\r\n    classCallCheck(this, OptionController);\r\n    var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\r\n    var options = opts;\r\n    var _this = _this2;\r\n    _this2.__select = document.createElement('select');\r\n    if (Common.isArray(options)) {\r\n      var map = {};\r\n      Common.each(options, function (element) {\r\n        map[element] = element;\r\n      });\r\n      options = map;\r\n    }\r\n    Common.each(options, function (value, key) {\r\n      var opt = document.createElement('option');\r\n      opt.innerHTML = key;\r\n      opt.setAttribute('value', value);\r\n      _this.__select.appendChild(opt);\r\n    });\r\n    _this2.updateDisplay();\r\n    dom.bind(_this2.__select, 'change', function () {\r\n      var desiredValue = this.options[this.selectedIndex].value;\r\n      _this.setValue(desiredValue);\r\n    });\r\n    _this2.domElement.appendChild(_this2.__select);\r\n    return _this2;\r\n  }\r\n  createClass(OptionController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (dom.isActive(this.__select)) return this;\r\n      this.__select.value = this.getValue();\r\n      return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return OptionController;\r\n}(Controller);\r\n\r\nvar StringController = function (_Controller) {\r\n  inherits(StringController, _Controller);\r\n  function StringController(object, property) {\r\n    classCallCheck(this, StringController);\r\n    var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\r\n    var _this = _this2;\r\n    function onChange() {\r\n      _this.setValue(_this.__input.value);\r\n    }\r\n    function onBlur() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'keyup', onChange);\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        this.blur();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(StringController, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (!dom.isActive(this.__input)) {\r\n        this.__input.value = this.getValue();\r\n      }\r\n      return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return StringController;\r\n}(Controller);\r\n\r\nfunction numDecimals(x) {\r\n  var _x = x.toString();\r\n  if (_x.indexOf('.') > -1) {\r\n    return _x.length - _x.indexOf('.') - 1;\r\n  }\r\n  return 0;\r\n}\r\nvar NumberController = function (_Controller) {\r\n  inherits(NumberController, _Controller);\r\n  function NumberController(object, property, params) {\r\n    classCallCheck(this, NumberController);\r\n    var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\r\n    var _params = params || {};\r\n    _this.__min = _params.min;\r\n    _this.__max = _params.max;\r\n    _this.__step = _params.step;\r\n    if (Common.isUndefined(_this.__step)) {\r\n      if (_this.initialValue === 0) {\r\n        _this.__impliedStep = 1;\r\n      } else {\r\n        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\r\n      }\r\n    } else {\r\n      _this.__impliedStep = _this.__step;\r\n    }\r\n    _this.__precision = numDecimals(_this.__impliedStep);\r\n    return _this;\r\n  }\r\n  createClass(NumberController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var _v = v;\r\n      if (this.__min !== undefined && _v < this.__min) {\r\n        _v = this.__min;\r\n      } else if (this.__max !== undefined && _v > this.__max) {\r\n        _v = this.__max;\r\n      }\r\n      if (this.__step !== undefined && _v % this.__step !== 0) {\r\n        _v = Math.round(_v / this.__step) * this.__step;\r\n      }\r\n      return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\r\n    }\r\n  }, {\r\n    key: 'min',\r\n    value: function min(minValue) {\r\n      this.__min = minValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'max',\r\n    value: function max(maxValue) {\r\n      this.__max = maxValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'step',\r\n    value: function step(stepValue) {\r\n      this.__step = stepValue;\r\n      this.__impliedStep = stepValue;\r\n      this.__precision = numDecimals(stepValue);\r\n      return this;\r\n    }\r\n  }]);\r\n  return NumberController;\r\n}(Controller);\r\n\r\nfunction roundToDecimal(value, decimals) {\r\n  var tenTo = Math.pow(10, decimals);\r\n  return Math.round(value * tenTo) / tenTo;\r\n}\r\nvar NumberControllerBox = function (_NumberController) {\r\n  inherits(NumberControllerBox, _NumberController);\r\n  function NumberControllerBox(object, property, params) {\r\n    classCallCheck(this, NumberControllerBox);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\r\n    _this2.__truncationSuspended = false;\r\n    var _this = _this2;\r\n    var prevY = void 0;\r\n    function onChange() {\r\n      var attempted = parseFloat(_this.__input.value);\r\n      if (!Common.isNaN(attempted)) {\r\n        _this.setValue(attempted);\r\n      }\r\n    }\r\n    function onFinish() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onBlur() {\r\n      onFinish();\r\n    }\r\n    function onMouseDrag(e) {\r\n      var diff = prevY - e.clientY;\r\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\r\n      prevY = e.clientY;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      onFinish();\r\n    }\r\n    function onMouseDown(e) {\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      prevY = e.clientY;\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        _this.__truncationSuspended = true;\r\n        this.blur();\r\n        _this.__truncationSuspended = false;\r\n        onFinish();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerBox, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\r\n      return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerBox;\r\n}(NumberController);\r\n\r\nfunction map(v, i1, i2, o1, o2) {\r\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\r\n}\r\nvar NumberControllerSlider = function (_NumberController) {\r\n  inherits(NumberControllerSlider, _NumberController);\r\n  function NumberControllerSlider(object, property, min, max, step) {\r\n    classCallCheck(this, NumberControllerSlider);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, { min: min, max: max, step: step }));\r\n    var _this = _this2;\r\n    _this2.__background = document.createElement('div');\r\n    _this2.__foreground = document.createElement('div');\r\n    dom.bind(_this2.__background, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__background, 'touchstart', onTouchStart);\r\n    dom.addClass(_this2.__background, 'slider');\r\n    dom.addClass(_this2.__foreground, 'slider-fg');\r\n    function onMouseDown(e) {\r\n      document.activeElement.blur();\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      onMouseDrag(e);\r\n    }\r\n    function onMouseDrag(e) {\r\n      e.preventDefault();\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n      return false;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onTouchStart(e) {\r\n      if (e.touches.length !== 1) {\r\n        return;\r\n      }\r\n      dom.bind(window, 'touchmove', onTouchMove);\r\n      dom.bind(window, 'touchend', onTouchEnd);\r\n      onTouchMove(e);\r\n    }\r\n    function onTouchMove(e) {\r\n      var clientX = e.touches[0].clientX;\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n    }\r\n    function onTouchEnd() {\r\n      dom.unbind(window, 'touchmove', onTouchMove);\r\n      dom.unbind(window, 'touchend', onTouchEnd);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.updateDisplay();\r\n    _this2.__background.appendChild(_this2.__foreground);\r\n    _this2.domElement.appendChild(_this2.__background);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerSlider, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\r\n      this.__foreground.style.width = pct * 100 + '%';\r\n      return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerSlider;\r\n}(NumberController);\r\n\r\nvar FunctionController = function (_Controller) {\r\n  inherits(FunctionController, _Controller);\r\n  function FunctionController(object, property, text) {\r\n    classCallCheck(this, FunctionController);\r\n    var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__button = document.createElement('div');\r\n    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\r\n    dom.bind(_this2.__button, 'click', function (e) {\r\n      e.preventDefault();\r\n      _this.fire();\r\n      return false;\r\n    });\r\n    dom.addClass(_this2.__button, 'button');\r\n    _this2.domElement.appendChild(_this2.__button);\r\n    return _this2;\r\n  }\r\n  createClass(FunctionController, [{\r\n    key: 'fire',\r\n    value: function fire() {\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this);\r\n      }\r\n      this.getValue().call(this.object);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n    }\r\n  }]);\r\n  return FunctionController;\r\n}(Controller);\r\n\r\nvar ColorController = function (_Controller) {\r\n    inherits(ColorController, _Controller);\r\n    function ColorController(object, property) {\r\n        classCallCheck(this, ColorController);\r\n        var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\r\n        _this2.__color = new Color(_this2.getValue());\r\n        _this2.__temp = new Color(0);\r\n        var _this = _this2;\r\n        _this2.domElement = document.createElement('div');\r\n        dom.makeSelectable(_this2.domElement, false);\r\n        _this2.__selector = document.createElement('div');\r\n        _this2.__selector.className = 'selector';\r\n        _this2.__saturation_field = document.createElement('div');\r\n        _this2.__saturation_field.className = 'saturation-field';\r\n        _this2.__field_knob = document.createElement('div');\r\n        _this2.__field_knob.className = 'field-knob';\r\n        _this2.__field_knob_border = '2px solid ';\r\n        _this2.__hue_knob = document.createElement('div');\r\n        _this2.__hue_knob.className = 'hue-knob';\r\n        _this2.__hue_field = document.createElement('div');\r\n        _this2.__hue_field.className = 'hue-field';\r\n        _this2.__input = document.createElement('input');\r\n        _this2.__input.type = 'text';\r\n        _this2.__input_textShadow = '0 1px 1px ';\r\n        dom.bind(_this2.__input, 'keydown', function (e) {\r\n            if (e.keyCode === 13) {\r\n                onBlur.call(this);\r\n            }\r\n        });\r\n        dom.bind(_this2.__input, 'blur', onBlur);\r\n        dom.bind(_this2.__selector, 'mousedown', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'mouseup', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        dom.bind(_this2.__selector, 'touchstart', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'touchend', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        var valueField = document.createElement('div');\r\n        Common.extend(_this2.__selector.style, {\r\n            width: '122px',\r\n            height: '102px',\r\n            padding: '3px',\r\n            backgroundColor: '#222',\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\r\n        });\r\n        Common.extend(_this2.__field_knob.style, {\r\n            position: 'absolute',\r\n            width: '12px',\r\n            height: '12px',\r\n            border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\r\n            borderRadius: '12px',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__hue_knob.style, {\r\n            position: 'absolute',\r\n            width: '15px',\r\n            height: '2px',\r\n            borderRight: '4px solid #fff',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__saturation_field.style, {\r\n            width: '100px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            marginRight: '3px',\r\n            display: 'inline-block',\r\n            cursor: 'pointer'\r\n        });\r\n        Common.extend(valueField.style, {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: 'none'\r\n        });\r\n        linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\r\n        Common.extend(_this2.__hue_field.style, {\r\n            width: '15px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            cursor: 'ns-resize',\r\n            position: 'absolute',\r\n            top: '3px',\r\n            right: '3px'\r\n        });\r\n        hueGradient(_this2.__hue_field);\r\n        Common.extend(_this2.__input.style, {\r\n            outline: 'none',\r\n            textAlign: 'center',\r\n            color: '#fff',\r\n            border: 0,\r\n            fontWeight: 'bold',\r\n            textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\r\n        });\r\n        dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\r\n        dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\r\n        function fieldDown(e) {\r\n            setSV(e);\r\n            dom.bind(window, 'mousemove', setSV);\r\n            dom.bind(window, 'touchmove', setSV);\r\n            dom.bind(window, 'mouseup', fieldUpSV);\r\n            dom.bind(window, 'touchend', fieldUpSV);\r\n        }\r\n        function fieldDownH(e) {\r\n            setH(e);\r\n            dom.bind(window, 'mousemove', setH);\r\n            dom.bind(window, 'touchmove', setH);\r\n            dom.bind(window, 'mouseup', fieldUpH);\r\n            dom.bind(window, 'touchend', fieldUpH);\r\n        }\r\n        function fieldUpSV() {\r\n            dom.unbind(window, 'mousemove', setSV);\r\n            dom.unbind(window, 'touchmove', setSV);\r\n            dom.unbind(window, 'mouseup', fieldUpSV);\r\n            dom.unbind(window, 'touchend', fieldUpSV);\r\n            onFinish();\r\n        }\r\n        function fieldUpH() {\r\n            dom.unbind(window, 'mousemove', setH);\r\n            dom.unbind(window, 'touchmove', setH);\r\n            dom.unbind(window, 'mouseup', fieldUpH);\r\n            dom.unbind(window, 'touchend', fieldUpH);\r\n            onFinish();\r\n        }\r\n        function onBlur() {\r\n            var i = interpret(this.value);\r\n            if (i !== false) {\r\n                _this.__color.__state = i;\r\n                _this.setValue(_this.__color.toOriginal());\r\n            } else {\r\n                this.value = _this.__color.toString();\r\n            }\r\n        }\r\n        function onFinish() {\r\n            if (_this.__onFinishChange) {\r\n                _this.__onFinishChange.call(_this, _this.__color.toOriginal());\r\n            }\r\n        }\r\n        _this2.__saturation_field.appendChild(valueField);\r\n        _this2.__selector.appendChild(_this2.__field_knob);\r\n        _this2.__selector.appendChild(_this2.__saturation_field);\r\n        _this2.__selector.appendChild(_this2.__hue_field);\r\n        _this2.__hue_field.appendChild(_this2.__hue_knob);\r\n        _this2.domElement.appendChild(_this2.__input);\r\n        _this2.domElement.appendChild(_this2.__selector);\r\n        _this2.updateDisplay();\r\n        function setSV(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__saturation_field.getBoundingClientRect();\r\n            var _ref = e.touches && e.touches[0] || e,\r\n                clientX = _ref.clientX,\r\n                clientY = _ref.clientY;\r\n            var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\r\n            var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (v > 1) {\r\n                v = 1;\r\n            } else if (v < 0) {\r\n                v = 0;\r\n            }\r\n            if (s > 1) {\r\n                s = 1;\r\n            } else if (s < 0) {\r\n                s = 0;\r\n            }\r\n            _this.__color.v = v;\r\n            _this.__color.s = s;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        function setH(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__hue_field.getBoundingClientRect();\r\n            var _ref2 = e.touches && e.touches[0] || e,\r\n                clientY = _ref2.clientY;\r\n            var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (h > 1) {\r\n                h = 1;\r\n            } else if (h < 0) {\r\n                h = 0;\r\n            }\r\n            _this.__color.h = h * 360;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        return _this2;\r\n    }\r\n    createClass(ColorController, [{\r\n        key: 'updateDisplay',\r\n        value: function updateDisplay() {\r\n            var i = interpret(this.getValue());\r\n            if (i !== false) {\r\n                var mismatch = false;\r\n                Common.each(Color.COMPONENTS, function (component) {\r\n                    if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\r\n                        mismatch = true;\r\n                        return {};\r\n                    }\r\n                }, this);\r\n                if (mismatch) {\r\n                    Common.extend(this.__color.__state, i);\r\n                }\r\n            }\r\n            Common.extend(this.__temp.__state, this.__color.__state);\r\n            this.__temp.a = 1;\r\n            var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\r\n            var _flip = 255 - flip;\r\n            Common.extend(this.__field_knob.style, {\r\n                marginLeft: 100 * this.__color.s - 7 + 'px',\r\n                marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\r\n                backgroundColor: this.__temp.toHexString(),\r\n                border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\r\n            });\r\n            this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\r\n            this.__temp.s = 1;\r\n            this.__temp.v = 1;\r\n            linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\r\n            this.__input.value = this.__color.toString();\r\n            Common.extend(this.__input.style, {\r\n                backgroundColor: this.__color.toHexString(),\r\n                color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\r\n                textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\r\n            });\r\n        }\r\n    }]);\r\n    return ColorController;\r\n}(Controller);\r\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\r\nfunction linearGradient(elem, x, a, b) {\r\n    elem.style.background = '';\r\n    Common.each(vendors, function (vendor) {\r\n        elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\r\n    });\r\n}\r\nfunction hueGradient(elem) {\r\n    elem.style.background = '';\r\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\r\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n}\r\n\r\nvar ControllerFactory = function ControllerFactory(object, property) {\r\n  var initialValue = object[property];\r\n  if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\r\n    return new OptionController(object, property, arguments[2]);\r\n  }\r\n  if (Common.isNumber(initialValue)) {\r\n    if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\r\n      if (Common.isNumber(arguments[4])) {\r\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4]);\r\n      }\r\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\r\n    }\r\n    if (Common.isNumber(arguments[4])) {\r\n      return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });\r\n    }\r\n    return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\r\n  }\r\n  if (Common.isString(initialValue)) {\r\n    return new StringController(object, property);\r\n  }\r\n  if (Common.isFunction(initialValue)) {\r\n    return new FunctionController(object, property, '');\r\n  }\r\n  if (Common.isBoolean(initialValue)) {\r\n    return new BooleanController(object, property);\r\n  }\r\n  return null;\r\n};\r\n\r\nvar CustomController = function (_Controller) {\r\n  inherits(CustomController, _Controller);\r\n  function CustomController(object, property) {\r\n    classCallCheck(this, CustomController);\r\n    var _this = possibleConstructorReturn(this, (CustomController.__proto__ || Object.getPrototypeOf(CustomController)).call(this, object, property));\r\n    _this.arguments = {\r\n      object: object, property: property, opts: Array.prototype.slice.call(arguments, 2)\r\n    };\r\n    if (object.property) _this.property = object.property(_this);\r\n    return _this;\r\n  }\r\n  createClass(CustomController, [{\r\n    key: 'controller',\r\n    set: function set$$1(newController) {\r\n      this._controller = newController;\r\n    },\r\n    get: function get$$1() {\r\n      return this._controller;\r\n    }\r\n  }]);\r\n  return CustomController;\r\n}(Controller);\r\n\r\nvar css = {\r\n  load: function load(url, indoc) {\r\n    var doc = indoc || document;\r\n    var link = doc.createElement('link');\r\n    link.type = 'text/css';\r\n    link.rel = 'stylesheet';\r\n    link.href = url;\r\n    doc.getElementsByTagName('head')[0].appendChild(link);\r\n  },\r\n  inject: function inject(cssContent, indoc) {\r\n    var doc = indoc || document;\r\n    var injected = document.createElement('style');\r\n    injected.type = 'text/css';\r\n    injected.innerHTML = cssContent;\r\n    var head = doc.getElementsByTagName('head')[0];\r\n    try {\r\n      head.appendChild(injected);\r\n    } catch (e) {\r\n    }\r\n  }\r\n};\r\n\r\nvar saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\r\n\r\nfunction requestAnimationFrame(callback) {\r\n  setTimeout(callback, 1000 / 60);\r\n}\r\nvar requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\r\n\r\nvar CenteredDiv = function () {\r\n  function CenteredDiv() {\r\n    classCallCheck(this, CenteredDiv);\r\n    this.backgroundElement = document.createElement('div');\r\n    Common.extend(this.backgroundElement.style, {\r\n      backgroundColor: 'rgba(0,0,0,0.8)',\r\n      top: 0,\r\n      left: 0,\r\n      display: 'none',\r\n      zIndex: '1000',\r\n      opacity: 0,\r\n      WebkitTransition: 'opacity 0.2s linear',\r\n      transition: 'opacity 0.2s linear'\r\n    });\r\n    dom.makeFullscreen(this.backgroundElement);\r\n    this.backgroundElement.style.position = 'fixed';\r\n    this.domElement = document.createElement('div');\r\n    Common.extend(this.domElement.style, {\r\n      position: 'fixed',\r\n      display: 'none',\r\n      zIndex: '1001',\r\n      opacity: 0,\r\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\r\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\r\n    });\r\n    document.body.appendChild(this.backgroundElement);\r\n    document.body.appendChild(this.domElement);\r\n    var _this = this;\r\n    dom.bind(this.backgroundElement, 'click', function () {\r\n      _this.hide();\r\n    });\r\n  }\r\n  createClass(CenteredDiv, [{\r\n    key: 'show',\r\n    value: function show() {\r\n      var _this = this;\r\n      this.backgroundElement.style.display = 'block';\r\n      this.domElement.style.display = 'block';\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n      this.layout();\r\n      Common.defer(function () {\r\n        _this.backgroundElement.style.opacity = 1;\r\n        _this.domElement.style.opacity = 1;\r\n        _this.domElement.style.webkitTransform = 'scale(1)';\r\n      });\r\n    }\r\n  }, {\r\n    key: 'hide',\r\n    value: function hide() {\r\n      var _this = this;\r\n      var hide = function hide() {\r\n        _this.domElement.style.display = 'none';\r\n        _this.backgroundElement.style.display = 'none';\r\n        dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\r\n        dom.unbind(_this.domElement, 'transitionend', hide);\r\n        dom.unbind(_this.domElement, 'oTransitionEnd', hide);\r\n      };\r\n      dom.bind(this.domElement, 'webkitTransitionEnd', hide);\r\n      dom.bind(this.domElement, 'transitionend', hide);\r\n      dom.bind(this.domElement, 'oTransitionEnd', hide);\r\n      this.backgroundElement.style.opacity = 0;\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n    }\r\n  }, {\r\n    key: 'layout',\r\n    value: function layout() {\r\n      this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\r\n      this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\r\n    }\r\n  }]);\r\n  return CenteredDiv;\r\n}();\r\n\r\nvar styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\r\n\r\ncss.inject(styleSheet);\r\nvar CSS_NAMESPACE = 'dg';\r\nvar HIDE_KEY_CODE = 72;\r\nvar CLOSE_BUTTON_HEIGHT = 20;\r\nvar DEFAULT_DEFAULT_PRESET_NAME = 'Default';\r\nvar SUPPORTS_LOCAL_STORAGE = function () {\r\n  try {\r\n    return !!window.localStorage;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}();\r\nvar SAVE_DIALOGUE = void 0;\r\nvar autoPlaceVirgin = true;\r\nvar autoPlaceContainer = void 0;\r\nvar hide = false;\r\nvar hideableGuis = [];\r\nvar GUI = function GUI(pars) {\r\n  var _this = this;\r\n  var params = pars || {};\r\n  this.domElement = document.createElement('div');\r\n  this.__ul = document.createElement('ul');\r\n  this.domElement.appendChild(this.__ul);\r\n  dom.addClass(this.domElement, CSS_NAMESPACE);\r\n  this.__folders = {};\r\n  this.__controllers = [];\r\n  this.__rememberedObjects = [];\r\n  this.__rememberedObjectIndecesToControllers = [];\r\n  this.__listening = [];\r\n  params = Common.defaults(params, {\r\n    closeOnTop: false,\r\n    autoPlace: true,\r\n    width: GUI.DEFAULT_WIDTH\r\n  });\r\n  params = Common.defaults(params, {\r\n    resizable: params.autoPlace,\r\n    hideable: params.autoPlace\r\n  });\r\n  if (!Common.isUndefined(params.load)) {\r\n    if (params.preset) {\r\n      params.load.preset = params.preset;\r\n    }\r\n  } else {\r\n    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\r\n  }\r\n  if (Common.isUndefined(params.parent) && params.hideable) {\r\n    hideableGuis.push(this);\r\n  }\r\n  params.resizable = Common.isUndefined(params.parent) && params.resizable;\r\n  if (params.autoPlace && Common.isUndefined(params.scrollable)) {\r\n    params.scrollable = true;\r\n  }\r\n  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\r\n  var saveToLocalStorage = void 0;\r\n  var titleRow = void 0;\r\n  Object.defineProperties(this,\r\n  {\r\n    parent: {\r\n      get: function get$$1() {\r\n        return params.parent;\r\n      }\r\n    },\r\n    scrollable: {\r\n      get: function get$$1() {\r\n        return params.scrollable;\r\n      }\r\n    },\r\n    autoPlace: {\r\n      get: function get$$1() {\r\n        return params.autoPlace;\r\n      }\r\n    },\r\n    closeOnTop: {\r\n      get: function get$$1() {\r\n        return params.closeOnTop;\r\n      }\r\n    },\r\n    preset: {\r\n      get: function get$$1() {\r\n        if (_this.parent) {\r\n          return _this.getRoot().preset;\r\n        }\r\n        return params.load.preset;\r\n      },\r\n      set: function set$$1(v) {\r\n        if (_this.parent) {\r\n          _this.getRoot().preset = v;\r\n        } else {\r\n          params.load.preset = v;\r\n        }\r\n        setPresetSelectIndex(this);\r\n        _this.revert();\r\n      }\r\n    },\r\n    width: {\r\n      get: function get$$1() {\r\n        return params.width;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.width = v;\r\n        setWidth(_this, v);\r\n      }\r\n    },\r\n    name: {\r\n      get: function get$$1() {\r\n        return params.name;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.name = v;\r\n        if (titleRow) {\r\n          titleRow.innerHTML = params.name;\r\n        }\r\n      }\r\n    },\r\n    closed: {\r\n      get: function get$$1() {\r\n        return params.closed;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.closed = v;\r\n        if (params.closed) {\r\n          dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        } else {\r\n          dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        }\r\n        this.onResize();\r\n        if (_this.__closeButton) {\r\n          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\r\n        }\r\n      }\r\n    },\r\n    load: {\r\n      get: function get$$1() {\r\n        return params.load;\r\n      }\r\n    },\r\n    useLocalStorage: {\r\n      get: function get$$1() {\r\n        return useLocalStorage;\r\n      },\r\n      set: function set$$1(bool) {\r\n        if (SUPPORTS_LOCAL_STORAGE) {\r\n          useLocalStorage = bool;\r\n          if (bool) {\r\n            dom.bind(window, 'unload', saveToLocalStorage);\r\n          } else {\r\n            dom.unbind(window, 'unload', saveToLocalStorage);\r\n          }\r\n          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\r\n        }\r\n      }\r\n    }\r\n  });\r\n  if (Common.isUndefined(params.parent)) {\r\n    this.closed = params.closed || false;\r\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\r\n    dom.makeSelectable(this.domElement, false);\r\n    if (SUPPORTS_LOCAL_STORAGE) {\r\n      if (useLocalStorage) {\r\n        _this.useLocalStorage = true;\r\n        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\r\n        if (savedGui) {\r\n          params.load = JSON.parse(savedGui);\r\n        }\r\n      }\r\n    }\r\n    this.__closeButton = document.createElement('div');\r\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\r\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\r\n    if (params.closeOnTop) {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\r\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\r\n    } else {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\r\n      this.domElement.appendChild(this.__closeButton);\r\n    }\r\n    dom.bind(this.__closeButton, 'click', function () {\r\n      _this.closed = !_this.closed;\r\n    });\r\n  } else {\r\n    if (params.closed === undefined) {\r\n      params.closed = true;\r\n    }\r\n    var titleRowName = document.createTextNode(params.name);\r\n    dom.addClass(titleRowName, 'controller-name');\r\n    titleRow = addRow(_this, titleRowName);\r\n    var onClickTitle = function onClickTitle(e) {\r\n      e.preventDefault();\r\n      _this.closed = !_this.closed;\r\n      return false;\r\n    };\r\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\r\n    dom.addClass(titleRow, 'title');\r\n    dom.bind(titleRow, 'click', onClickTitle);\r\n    if (!params.closed) {\r\n      this.closed = false;\r\n    }\r\n  }\r\n  if (params.autoPlace) {\r\n    if (Common.isUndefined(params.parent)) {\r\n      if (autoPlaceVirgin) {\r\n        autoPlaceContainer = document.createElement('div');\r\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\r\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\r\n        document.body.appendChild(autoPlaceContainer);\r\n        autoPlaceVirgin = false;\r\n      }\r\n      autoPlaceContainer.appendChild(this.domElement);\r\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\r\n    }\r\n    if (!this.parent) {\r\n      setWidth(_this, params.width);\r\n    }\r\n  }\r\n  this.__resizeHandler = function () {\r\n    _this.onResizeDebounced();\r\n  };\r\n  dom.bind(window, 'resize', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\r\n  this.onResize();\r\n  if (params.resizable) {\r\n    addResizeHandle(this);\r\n  }\r\n  saveToLocalStorage = function saveToLocalStorage() {\r\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\r\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\r\n    }\r\n  };\r\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\r\n  function resetWidth() {\r\n    var root = _this.getRoot();\r\n    root.width += 1;\r\n    Common.defer(function () {\r\n      root.width -= 1;\r\n    });\r\n  }\r\n  if (!params.parent) {\r\n    resetWidth();\r\n  }\r\n};\r\nGUI.toggleHide = function () {\r\n  hide = !hide;\r\n  Common.each(hideableGuis, function (gui) {\r\n    gui.domElement.style.display = hide ? 'none' : '';\r\n  });\r\n};\r\nGUI.CLASS_AUTO_PLACE = 'a';\r\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\r\nGUI.CLASS_MAIN = 'main';\r\nGUI.CLASS_CONTROLLER_ROW = 'cr';\r\nGUI.CLASS_TOO_TALL = 'taller-than-window';\r\nGUI.CLASS_CLOSED = 'closed';\r\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\r\nGUI.CLASS_CLOSE_TOP = 'close-top';\r\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\r\nGUI.CLASS_DRAG = 'drag';\r\nGUI.DEFAULT_WIDTH = 245;\r\nGUI.TEXT_CLOSED = 'Close Controls';\r\nGUI.TEXT_OPEN = 'Open Controls';\r\nGUI._keydownHandler = function (e) {\r\n  if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\r\n    GUI.toggleHide();\r\n  }\r\n};\r\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\r\nCommon.extend(GUI.prototype,\r\n{\r\n  add: function add(object, property) {\r\n    return _add(this, object, property, {\r\n      factoryArgs: Array.prototype.slice.call(arguments, 2)\r\n    });\r\n  },\r\n  addColor: function addColor(object, property) {\r\n    return _add(this, object, property, {\r\n      color: true\r\n    });\r\n  },\r\n  remove: function remove(controller) {\r\n    this.__ul.removeChild(controller.__li);\r\n    this.__controllers.splice(this.__controllers.indexOf(controller), 1);\r\n    var _this = this;\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  destroy: function destroy() {\r\n    if (this.parent) {\r\n      throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\r\n    }\r\n    if (this.autoPlace) {\r\n      autoPlaceContainer.removeChild(this.domElement);\r\n    }\r\n    var _this = this;\r\n    Common.each(this.__folders, function (subfolder) {\r\n      _this.removeFolder(subfolder);\r\n    });\r\n    dom.unbind(window, 'keydown', GUI._keydownHandler, false);\r\n    removeListeners(this);\r\n  },\r\n  addFolder: function addFolder(name) {\r\n    if (this.__folders[name] !== undefined) {\r\n      throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\r\n    }\r\n    var newGuiParams = { name: name, parent: this };\r\n    newGuiParams.autoPlace = this.autoPlace;\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[name]) {\r\n      newGuiParams.closed = this.load.folders[name].closed;\r\n      newGuiParams.load = this.load.folders[name];\r\n    }\r\n    var gui = new GUI(newGuiParams);\r\n    this.__folders[name] = gui;\r\n    var li = addRow(this, gui.domElement);\r\n    dom.addClass(li, 'folder');\r\n    return gui;\r\n  },\r\n  removeFolder: function removeFolder(folder) {\r\n    this.__ul.removeChild(folder.domElement.parentElement);\r\n    delete this.__folders[folder.name];\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[folder.name]) {\r\n      delete this.load.folders[folder.name];\r\n    }\r\n    removeListeners(folder);\r\n    var _this = this;\r\n    Common.each(folder.__folders, function (subfolder) {\r\n      folder.removeFolder(subfolder);\r\n    });\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  open: function open() {\r\n    this.closed = false;\r\n  },\r\n  close: function close() {\r\n    this.closed = true;\r\n  },\r\n  hide: function hide() {\r\n    this.domElement.style.display = 'none';\r\n  },\r\n  show: function show() {\r\n    this.domElement.style.display = '';\r\n  },\r\n  onResize: function onResize() {\r\n    var root = this.getRoot();\r\n    if (root.scrollable) {\r\n      var top = dom.getOffset(root.__ul).top;\r\n      var h = 0;\r\n      Common.each(root.__ul.childNodes, function (node) {\r\n        if (!(root.autoPlace && node === root.__save_row)) {\r\n          h += dom.getHeight(node);\r\n        }\r\n      });\r\n      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\r\n        dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\r\n      } else {\r\n        dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = 'auto';\r\n      }\r\n    }\r\n    if (root.__resize_handle) {\r\n      Common.defer(function () {\r\n        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\r\n      });\r\n    }\r\n    if (root.__closeButton) {\r\n      root.__closeButton.style.width = root.width + 'px';\r\n    }\r\n  },\r\n  onResizeDebounced: Common.debounce(function () {\r\n    this.onResize();\r\n  }, 50),\r\n  remember: function remember() {\r\n    if (Common.isUndefined(SAVE_DIALOGUE)) {\r\n      SAVE_DIALOGUE = new CenteredDiv();\r\n      SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\r\n    }\r\n    if (this.parent) {\r\n      throw new Error('You can only call remember on a top level GUI.');\r\n    }\r\n    var _this = this;\r\n    Common.each(Array.prototype.slice.call(arguments), function (object) {\r\n      if (_this.__rememberedObjects.length === 0) {\r\n        addSaveMenu(_this);\r\n      }\r\n      if (_this.__rememberedObjects.indexOf(object) === -1) {\r\n        _this.__rememberedObjects.push(object);\r\n      }\r\n    });\r\n    if (this.autoPlace) {\r\n      setWidth(this, this.width);\r\n    }\r\n  },\r\n  getRoot: function getRoot() {\r\n    var gui = this;\r\n    while (gui.parent) {\r\n      gui = gui.parent;\r\n    }\r\n    return gui;\r\n  },\r\n  getSaveObject: function getSaveObject() {\r\n    var toReturn = this.load;\r\n    toReturn.closed = this.closed;\r\n    if (this.__rememberedObjects.length > 0) {\r\n      toReturn.preset = this.preset;\r\n      if (!toReturn.remembered) {\r\n        toReturn.remembered = {};\r\n      }\r\n      toReturn.remembered[this.preset] = getCurrentPreset(this);\r\n    }\r\n    toReturn.folders = {};\r\n    Common.each(this.__folders, function (element, key) {\r\n      toReturn.folders[key] = element.getSaveObject();\r\n    });\r\n    return toReturn;\r\n  },\r\n  save: function save() {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n    }\r\n    this.load.remembered[this.preset] = getCurrentPreset(this);\r\n    markPresetModified(this, false);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  saveAs: function saveAs(presetName) {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\r\n    }\r\n    this.load.remembered[presetName] = getCurrentPreset(this);\r\n    this.preset = presetName;\r\n    addPresetOption(this, presetName, true);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  revert: function revert(gui) {\r\n    Common.each(this.__controllers, function (controller) {\r\n      if (!this.getRoot().load.remembered) {\r\n        controller.setValue(controller.initialValue);\r\n      } else {\r\n        recallSavedValue(gui || this.getRoot(), controller);\r\n      }\r\n      if (controller.__onFinishChange) {\r\n        controller.__onFinishChange.call(controller, controller.getValue());\r\n      }\r\n    }, this);\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.revert(folder);\r\n    });\r\n    if (!gui) {\r\n      markPresetModified(this.getRoot(), false);\r\n    }\r\n  },\r\n  listen: function listen(controller) {\r\n    var init = this.__listening.length === 0;\r\n    this.__listening.push(controller);\r\n    if (init) {\r\n      updateDisplays(this.__listening);\r\n    }\r\n  },\r\n  updateDisplay: function updateDisplay() {\r\n    Common.each(this.__controllers, function (controller) {\r\n      controller.updateDisplay();\r\n    });\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.updateDisplay();\r\n    });\r\n  }\r\n});\r\nfunction addRow(gui, newDom, liBefore) {\r\n  var li = document.createElement('li');\r\n  if (newDom) {\r\n    li.appendChild(newDom);\r\n  }\r\n  if (liBefore) {\r\n    gui.__ul.insertBefore(li, liBefore);\r\n  } else {\r\n    gui.__ul.appendChild(li);\r\n  }\r\n  gui.onResize();\r\n  return li;\r\n}\r\nfunction removeListeners(gui) {\r\n  dom.unbind(window, 'resize', gui.__resizeHandler);\r\n  if (gui.saveToLocalStorageIfPossible) {\r\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\r\n  }\r\n}\r\nfunction markPresetModified(gui, modified) {\r\n  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\r\n  if (modified) {\r\n    opt.innerHTML = opt.value + '*';\r\n  } else {\r\n    opt.innerHTML = opt.value;\r\n  }\r\n}\r\nfunction augmentController(gui, li, controller) {\r\n  controller.__li = li;\r\n  controller.__gui = gui;\r\n  Common.extend(controller,                                   {\r\n    options: function options(_options) {\r\n      if (arguments.length > 1) {\r\n        var nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: nextSibling,\r\n          factoryArgs: [Common.toArray(arguments)]\r\n        });\r\n      }\r\n      if (Common.isArray(_options) || Common.isObject(_options)) {\r\n        var _nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: _nextSibling,\r\n          factoryArgs: [_options]\r\n        });\r\n      }\r\n    },\r\n    name: function name(_name) {\r\n      controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\r\n      return controller;\r\n    },\r\n    listen: function listen() {\r\n      controller.__gui.listen(controller);\r\n      return controller;\r\n    },\r\n    remove: function remove() {\r\n      controller.__gui.remove(controller);\r\n      return controller;\r\n    }\r\n  });\r\n  if (controller instanceof NumberControllerSlider) {\r\n    var box = new NumberControllerBox(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });\r\n    Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function (method) {\r\n      var pc = controller[method];\r\n      var pb = box[method];\r\n      controller[method] = box[method] = function () {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        pb.apply(box, args);\r\n        return pc.apply(controller, args);\r\n      };\r\n    });\r\n    dom.addClass(li, 'has-slider');\r\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\r\n  } else if (controller instanceof NumberControllerBox) {\r\n    var r = function r(returned) {\r\n      if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\r\n        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\r\n        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\r\n        controller.remove();\r\n        var newController = _add(gui, controller.object, controller.property, {\r\n          before: controller.__li.nextElementSibling,\r\n          factoryArgs: [controller.__min, controller.__max, controller.__step]\r\n        });\r\n        newController.name(oldName);\r\n        if (wasListening) newController.listen();\r\n        return newController;\r\n      }\r\n      return returned;\r\n    };\r\n    controller.min = Common.compose(r, controller.min);\r\n    controller.max = Common.compose(r, controller.max);\r\n  } else if (controller instanceof BooleanController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__checkbox, 'click');\r\n    });\r\n    dom.bind(controller.__checkbox, 'click', function (e) {\r\n      e.stopPropagation();\r\n    });\r\n  } else if (controller instanceof FunctionController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__button, 'click');\r\n    });\r\n    dom.bind(li, 'mouseover', function () {\r\n      dom.addClass(controller.__button, 'hover');\r\n    });\r\n    dom.bind(li, 'mouseout', function () {\r\n      dom.removeClass(controller.__button, 'hover');\r\n    });\r\n  } else if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n    controller.updateDisplay = Common.compose(function (val) {\r\n      li.style.borderLeftColor = controller.__color.toString();\r\n      return val;\r\n    }, controller.updateDisplay);\r\n    controller.updateDisplay();\r\n  }\r\n  controller.setValue = Common.compose(function (val) {\r\n    if (gui.getRoot().__preset_select && controller.isModified()) {\r\n      markPresetModified(gui.getRoot(), true);\r\n    }\r\n    return val;\r\n  }, controller.setValue);\r\n}\r\nfunction recallSavedValue(gui, controller) {\r\n  var root = gui.getRoot();\r\n  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\r\n  if (matchedIndex !== -1) {\r\n    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\r\n    if (controllerMap === undefined) {\r\n      controllerMap = {};\r\n      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\r\n    }\r\n    controllerMap[controller.property] = controller;\r\n    if (root.load && root.load.remembered) {\r\n      var presetMap = root.load.remembered;\r\n      var preset = void 0;\r\n      if (presetMap[gui.preset]) {\r\n        preset = presetMap[gui.preset];\r\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\r\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\r\n      } else {\r\n        return;\r\n      }\r\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\r\n        var value = preset[matchedIndex][controller.property];\r\n        controller.initialValue = value;\r\n        controller.setValue(value);\r\n      }\r\n    }\r\n  }\r\n}\r\nfunction _add(gui, object, property, params) {\r\n  var customObject;\r\n  if (object.arguments) {\r\n    customObject = object;\r\n    object = customObject.arguments.object;\r\n    property = customObject.arguments.property;\r\n    params = {\r\n      factoryArgs: customObject.arguments.opts\r\n    };\r\n  }\r\n  if (customObject === undefined && object[property] === undefined) {\r\n    throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\r\n  }\r\n  var controller = void 0;\r\n  if (params.color) {\r\n    controller = new ColorController(object, property);\r\n  } else if (customObject !== undefined && typeof customObject.property === \"string\") {\r\n    controller = customObject;\r\n  } else {\r\n    var factoryArgs = [object, property].concat(params.factoryArgs);\r\n    controller = ControllerFactory.apply(gui, factoryArgs);\r\n  }\r\n  if (controller === null) controller = customObject;else if (customObject !== undefined) customObject.controller = controller;\r\n  if (params.before instanceof Controller) {\r\n    params.before = params.before.__li;\r\n  }\r\n  recallSavedValue(gui, controller);\r\n  dom.addClass(controller.domElement, 'c');\r\n  var name = document.createElement('span');\r\n  dom.addClass(name, 'property-name');\r\n  if (customObject !== undefined && _typeof(customObject.property) === \"object\") {\r\n    for (var propertyName in customObject.property) {\r\n      name.appendChild(customObject.property[propertyName]);\r\n    }\r\n  } else name.innerHTML = controller.property;\r\n  var container = document.createElement('div');\r\n  container.appendChild(name);\r\n  container.appendChild(controller.domElement);\r\n  var li = addRow(gui, container, params.before);\r\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\r\n  if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n  } else {\r\n    dom.addClass(li, _typeof(controller.getValue()));\r\n  }\r\n  augmentController(gui, li, controller);\r\n  gui.__controllers.push(controller);\r\n  return controller;\r\n}\r\nfunction getLocalStorageHash(gui, key) {\r\n  return document.location.href + '.' + key;\r\n}\r\nfunction addPresetOption(gui, name, setSelected) {\r\n  var opt = document.createElement('option');\r\n  opt.innerHTML = name;\r\n  opt.value = name;\r\n  gui.__preset_select.appendChild(opt);\r\n  if (setSelected) {\r\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\r\n  }\r\n}\r\nfunction showHideExplain(gui, explain) {\r\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\r\n}\r\nfunction addSaveMenu(gui) {\r\n  var div = gui.__save_row = document.createElement('li');\r\n  dom.addClass(gui.domElement, 'has-save');\r\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\r\n  dom.addClass(div, 'save-row');\r\n  var gears = document.createElement('span');\r\n  gears.innerHTML = '&nbsp;';\r\n  dom.addClass(gears, 'button gears');\r\n  var button = document.createElement('span');\r\n  button.innerHTML = 'Save';\r\n  dom.addClass(button, 'button');\r\n  dom.addClass(button, 'save');\r\n  var button2 = document.createElement('span');\r\n  button2.innerHTML = 'New';\r\n  dom.addClass(button2, 'button');\r\n  dom.addClass(button2, 'save-as');\r\n  var button3 = document.createElement('span');\r\n  button3.innerHTML = 'Revert';\r\n  dom.addClass(button3, 'button');\r\n  dom.addClass(button3, 'revert');\r\n  var select = gui.__preset_select = document.createElement('select');\r\n  if (gui.load && gui.load.remembered) {\r\n    Common.each(gui.load.remembered, function (value, key) {\r\n      addPresetOption(gui, key, key === gui.preset);\r\n    });\r\n  } else {\r\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\r\n  }\r\n  dom.bind(select, 'change', function () {\r\n    for (var index = 0; index < gui.__preset_select.length; index++) {\r\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\r\n    }\r\n    gui.preset = this.value;\r\n  });\r\n  div.appendChild(select);\r\n  div.appendChild(gears);\r\n  div.appendChild(button);\r\n  div.appendChild(button2);\r\n  div.appendChild(button3);\r\n  if (SUPPORTS_LOCAL_STORAGE) {\r\n    var explain = document.getElementById('dg-local-explain');\r\n    var localStorageCheckBox = document.getElementById('dg-local-storage');\r\n    var saveLocally = document.getElementById('dg-save-locally');\r\n    saveLocally.style.display = 'block';\r\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\r\n      localStorageCheckBox.setAttribute('checked', 'checked');\r\n    }\r\n    showHideExplain(gui, explain);\r\n    dom.bind(localStorageCheckBox, 'change', function () {\r\n      gui.useLocalStorage = !gui.useLocalStorage;\r\n      showHideExplain(gui, explain);\r\n    });\r\n  }\r\n  var newConstructorTextArea = document.getElementById('dg-new-constructor');\r\n  dom.bind(newConstructorTextArea, 'keydown', function (e) {\r\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\r\n      SAVE_DIALOGUE.hide();\r\n    }\r\n  });\r\n  dom.bind(gears, 'click', function () {\r\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\r\n    SAVE_DIALOGUE.show();\r\n    newConstructorTextArea.focus();\r\n    newConstructorTextArea.select();\r\n  });\r\n  dom.bind(button, 'click', function () {\r\n    gui.save();\r\n  });\r\n  dom.bind(button2, 'click', function () {\r\n    var presetName = prompt('Enter a new preset name.');\r\n    if (presetName) {\r\n      gui.saveAs(presetName);\r\n    }\r\n  });\r\n  dom.bind(button3, 'click', function () {\r\n    gui.revert();\r\n  });\r\n}\r\nfunction addResizeHandle(gui) {\r\n  var pmouseX = void 0;\r\n  gui.__resize_handle = document.createElement('div');\r\n  Common.extend(gui.__resize_handle.style, {\r\n    width: '6px',\r\n    marginLeft: '-3px',\r\n    height: '200px',\r\n    cursor: 'ew-resize',\r\n    position: 'absolute'\r\n  });\r\n  function drag(e) {\r\n    e.preventDefault();\r\n    gui.width += pmouseX - e.clientX;\r\n    gui.onResize();\r\n    pmouseX = e.clientX;\r\n    return false;\r\n  }\r\n  function dragStop() {\r\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.unbind(window, 'mousemove', drag);\r\n    dom.unbind(window, 'mouseup', dragStop);\r\n  }\r\n  function dragStart(e) {\r\n    e.preventDefault();\r\n    pmouseX = e.clientX;\r\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.bind(window, 'mousemove', drag);\r\n    dom.bind(window, 'mouseup', dragStop);\r\n    return false;\r\n  }\r\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\r\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\r\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\r\n}\r\nfunction setWidth(gui, w) {\r\n  gui.domElement.style.width = w + 'px';\r\n  if (gui.__save_row && gui.autoPlace) {\r\n    gui.__save_row.style.width = w + 'px';\r\n  }\r\n  if (gui.__closeButton) {\r\n    gui.__closeButton.style.width = w + 'px';\r\n  }\r\n}\r\nfunction getCurrentPreset(gui, useInitialValues) {\r\n  var toReturn = {};\r\n  Common.each(gui.__rememberedObjects, function (val, index) {\r\n    var savedValues = {};\r\n    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\r\n    Common.each(controllerMap, function (controller, property) {\r\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\r\n    });\r\n    toReturn[index] = savedValues;\r\n  });\r\n  return toReturn;\r\n}\r\nfunction setPresetSelectIndex(gui) {\r\n  for (var index = 0; index < gui.__preset_select.length; index++) {\r\n    if (gui.__preset_select[index].value === gui.preset) {\r\n      gui.__preset_select.selectedIndex = index;\r\n    }\r\n  }\r\n}\r\nfunction updateDisplays(controllerArray) {\r\n  if (controllerArray.length !== 0) {\r\n    requestAnimationFrame$1.call(window, function () {\r\n      updateDisplays(controllerArray);\r\n    });\r\n  }\r\n  Common.each(controllerArray, function (c) {\r\n    c.updateDisplay();\r\n  });\r\n}\r\n\r\nvar color = {\r\n  Color: Color,\r\n  math: ColorMath,\r\n  interpret: interpret\r\n};\r\nvar controllers = {\r\n  Controller: Controller,\r\n  BooleanController: BooleanController,\r\n  OptionController: OptionController,\r\n  StringController: StringController,\r\n  NumberController: NumberController,\r\n  NumberControllerBox: NumberControllerBox,\r\n  NumberControllerSlider: NumberControllerSlider,\r\n  FunctionController: FunctionController,\r\n  ColorController: ColorController,\r\n  CustomController: CustomController\r\n};\r\nvar dom$1 = { dom: dom };\r\nvar gui = { GUI: GUI };\r\nvar GUI$1 = GUI;\r\nvar index = {\r\n  color: color,\r\n  controllers: controllers,\r\n  dom: dom$1,\r\n  gui: gui,\r\n  GUI: GUI$1\r\n};\r\n\r\nexport { color, controllers, dom$1 as dom, gui, GUI$1 as GUI };\r\nexport default index;\r\n//# sourceMappingURL=dat.gui.module.js.map\r\n","/**\r\n * @module Localization.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n/**\r\n * returns the \"primary language\" subtag of the version of the browser.\r\n * See the \"Syntax\" paragraph of RFC 4646 https://tools.ietf.org/html/rfc4646#section-2.1 for details.\r\n */\r\nexport function getLanguageCode() {\r\n\r\n\t//returns the language version of the browser.\r\n\tfunction _getLocale() {\r\n\r\n\t\tif ( !navigator ) {\r\n\r\n\t\t\tconsole.error( \"getLocale() failed! !navigator\" );\r\n\t\t\treturn \"\";\r\n\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\t( navigator.languages !== undefined )\r\n\t\t\t&& ( typeof navigator.languages !== 'unknown' )//for IE6\r\n\t\t\t&& ( navigator.languages.length > 0 )\r\n\t\t)\r\n\t\t\treturn navigator.languages[0];//Chrome\r\n\r\n\t\t//IE\r\n\t\tif ( navigator.language ) {\r\n\r\n\t\t\treturn navigator.language;\r\n\r\n\t\t} else if ( navigator.browserLanguage ) {\r\n\r\n\t\t\treturn navigator.browserLanguage;\r\n\r\n\t\t} else if ( navigator.systemLanguage ) {\r\n\r\n\t\t\treturn navigator.systemLanguage;\r\n\r\n\t\t} else if ( navigator.userLanguage ) {\r\n\r\n\t\t\treturn navigator.userLanguage;\r\n\r\n\t\t}\r\n\r\n\t\tconsole.error( \"getLocale() failed!\" );\r\n\t\treturn \"\";\r\n\r\n\t}\r\n\r\n\treturn _getLocale().toLowerCase().match( /([a-z]+)(?:-([a-z]+))?/ )[1];\r\n\r\n};\r\n\r\n","/**\r\n * @module PlayController\r\n * @description PlayController class for using in my version of dat.gui(https://github.com/anhr/dat.gui) for playing of 3D objects in my projects.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import { GUI, controllers } from 'D:/My documents/MyProjects/webgl/three.js/GitHub/dat.gui';\r\n//Please download https://github.com/anhr/dat.gui/tree/CustomController to '../../dat.gui' folder\r\n//import { GUI, controllers } from '../../dat.gui';\r\nimport { GUI, controllers } from '../dat.gui/CustomController/build/dat.gui.module.js';\r\n\r\n//import { getLanguageCode } from '../../commonNodeJS/master/build/common.module.js';\r\nimport { getLanguageCode } from '../lang.js';\r\n//import { getLanguageCode } from 'http://localhost/anhr/commonNodeJS/master/lang.js';\r\n\r\n//import Player from '../player/player.js';\r\n\r\n//Localization\r\n\r\nexport var lang = {\r\n\r\n\tprevSymbol: '←',\r\n\tprevSymbolTitle: 'Go to previous animation scene',\r\n\tnextSymbol: '→',\r\n\tnextSymbolTitle: 'Go to next animation scene',\r\n\tplaySymbol: '►',\r\n\tplayTitle: 'Play',\r\n\tpause: '❚❚',\r\n\tpauseTitle: 'Pause',\r\n\trepeat: '⥀',\r\n\trepeatOn: 'Turn repeat on',\r\n\trepeatOff: 'Turn repeat off',\r\n\tcontrollerTitle: 'Current time.',\r\n\tfullScreen: 'Full Screen',\r\n\tnonFullScreen: 'Non Full Screen',\r\n\tstereoEffects: 'Stereo effects',\r\n\tmono: 'Mono',\r\n\tsideBySide: 'Side by side',\r\n\ttopAndBottom: 'Top and bottom',\r\n\r\n};\r\n\r\n//try {\r\n\t//switch ( ( ( typeof THREE === 'undefined' ) || ( typeof THREE.getLanguageCode === 'undefined' ) ) ? 'en' : THREE.getLanguageCode() )\r\n\tswitch ( getLanguageCode() ) {\r\n\r\n\t\tcase 'ru'://Russian language\r\n\t\t\tlang.prevSymbolTitle = 'Кадр назад';//'Go to previous animation scene',\r\n\t\t\tlang.playTitle = 'Проиграть';//'Play'\r\n\t\t\tlang.nextSymbolTitle = 'Кадр вперед';//'Go to next animation scene';\r\n\t\t\tlang.pauseTitle = 'Пауза';//'Pause',\r\n\t\t\tlang.repeatOn = 'Повторять проигрывание';\r\n\t\t\tlang.repeatOff = 'Остановить повтор проигрывания';\r\n\t\t\tlang.controllerTitle = 'Текущее время.';\r\n\t\t\tlang.fullScreen = 'На весь экран';\r\n\t\t\tlang.nonFullScreen = 'Восстановить размеры экрана';\r\n\t\t\tlang.stereoEffects = 'Стерео эффекты';\r\n\t\t\tlang.mono = 'Моно';\r\n\t\t\tlang.sideBySide = 'Слева направо';\r\n\t\t\tlang.topAndBottom = 'Сверху вниз';\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n//} catch ( e ) {}\r\n\r\nfunction addButton( innerHTML, title, onclick ) {\r\n\r\n\tvar button = document.createElement( 'span' );\r\n\tbutton.innerHTML = innerHTML;\r\n\tbutton.title = title;\r\n\tbutton.style.cursor = 'pointer';\r\n\tbutton.style.margin = '0px 2px';\r\n\tbutton.onclick = onclick;\r\n\treturn button;\r\n\r\n}\r\n\r\n/**\r\n * PlayController class for using in my version of dat.gui(https://github.com/anhr/dat.gui) for playing of 3D objects in my projects.\r\n * \r\n * @class PlayController\r\n *\r\n * @extends dat.controllers.CustomController\r\n *\r\n */\r\nexport class PlayController extends controllers.CustomController {\r\n\r\n\t/**\r\n\t * PlayController class for using in my version of dat.gui(https://github.com/anhr/dat.gui) for animate of 3D objects in my projects.\r\n\t * @param {object} player 3D objects animation. See [Player]{@link https://github.com/anhr/commonNodeJS/tree/master/player}\r\n\t * @param {GUI} [gui] [new dat.GUI(...)]{@link https://github.com/anhr/dat.gui}. Folder for controller\r\n\t */\r\n\tconstructor( player, gui ) {\r\n\r\n\t\tvar _getGroup, _selectScene, _renamePlayButtons, _renameRepeatButtons, _repeat;//,_playNext, timerId, _prev, _play, _next;\r\n\t\tvar colorOff = 'rgb(255,255,255)', colorOn = 'rgb(128,128,128)';//'rgb(200,200,200)';\r\n\t\tsuper( {\r\n\r\n\t\t\tplayRate: 1,//Default play rate is 1 changes per second\r\n\t\t\tproperty: function ( customController ) {\r\n\r\n\t\t\t\tvar buttons = {};\r\n\t\t\t\tfunction RenamePlayButtons( innerHTML, title ) {\r\n\r\n\t\t\t\t\tbuttons.buttonPlay.innerHTML = innerHTML;\r\n\t\t\t\t\tbuttons.buttonPlay.title = title;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t_renamePlayButtons = RenamePlayButtons;\r\n\r\n\t\t\t\tbuttons.buttonPrev = addButton( lang.prevSymbol, lang.prevSymbolTitle, player.prev );\r\n\t\t\t\tbuttons.buttonPlay = addButton( lang.playSymbol, lang.playTitle, player.play3DObject );\r\n\r\n\t\t\t\tif ( player.getOptions().settings.max !== null ) {\r\n\r\n\t\t\t\t\t//Repeat button\r\n\r\n\t\t\t\t\tfunction RenameRepeatButtons( isRepeat ) {\r\n\r\n\t\t\t\t\t\tvar title, color;\r\n\t\t\t\t\t\tif ( isRepeat ) {\r\n\r\n\t\t\t\t\t\t\ttitle = lang.repeatOff;\r\n\t\t\t\t\t\t\tcolor = colorOff;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\ttitle = lang.repeatOn;\r\n\t\t\t\t\t\t\tcolor = colorOn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( buttons.buttonRepeat.title === title )\r\n\t\t\t\t\t\t\treturn;//stop of infinite recursive call\r\n\r\n\t\t\t\t\t\tbuttons.buttonRepeat.title = title;\r\n\t\t\t\t\t\tbuttons.buttonRepeat.style.color = color;\r\n\r\n\t\t\t\t\t\tplayer.onChangeRepeat( isRepeat );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_renameRepeatButtons = RenameRepeatButtons;\r\n\t\t\t\t\tfunction repeat( value ) {\r\n\r\n\t\t\t\t\t\tRenameRepeatButtons( buttons.buttonRepeat.title === lang.repeatOn );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_repeat = repeat;\r\n\t\t\t\t\tvar title, color;\r\n\t\t\t\t\tif ( player.getOptions().repeat ) {\r\n\r\n\t\t\t\t\t\ttitle = lang.repeatOff;\r\n\t\t\t\t\t\tcolor = colorOff;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttitle = lang.repeatOn;\r\n\t\t\t\t\t\tcolor = colorOn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbuttons.buttonRepeat = addButton( lang.repeat, title, repeat );\r\n\t\t\t\t\tbuttons.buttonRepeat.style.color = color;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tbuttons.buttonNext = addButton( lang.nextSymbol, lang.nextSymbolTitle, player.next );\r\n\t\t\t\tfunction getGroup() {\r\n\r\n\t\t\t\t\treturn group;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t_getGroup = getGroup;\r\n\r\n\t\t\t\treturn buttons;\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'playRate');//, 1, 25, 1 );\r\n\t\tplayer.PlayController = this;\r\n\t\tthis.onRenamePlayButtons = function ( playing ) {\r\n\r\n\t\t\tvar name, title;\r\n\t\t\tif ( playing ) {\r\n\r\n\t\t\t\tname = lang.pause;\r\n\t\t\t\ttitle = lang.pauseTitle;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tname = lang.playSymbol;\r\n\t\t\t\ttitle = lang.playTitle;\r\n\r\n\t\t\t}\r\n\t\t\t_renamePlayButtons( name, title, true );\r\n\r\n\t\t}\r\n\t\tthis.onChangeRepeat = function () {\r\n\r\n\t\t\t//_renameRepeatButtons( Player.getSettings().repeat );не работает если из разных мест делать import Player\r\n\t\t\t_renameRepeatButtons( player.getOptions().settings.repeat );\r\n\r\n\t\t}\r\n\t\tplayer.pushController( this );\r\n\t\tthis.onChange = function ( value ){\r\n\r\n//\t\t\tplayer.onChangeTimerId( value );\r\n\t\t\tplayer.setTime( value );\r\n\r\n\t\t}\r\n\t\tthis.getGroup = function () {\r\n\r\n\t\t\treturn _getGroup();\r\n\r\n\t\t}\r\n\t\tthis.selectScene = function ( index ) {\r\n\r\n\t\t\t_selectScene( parseInt( index ) );\r\n\r\n\t\t}\r\n\t\tthis.setValue = function ( value ) {\r\n\r\n/*\r\n\t\t\tif ( this._controller.getValue() === value )\r\n\t\t\t\treturn;//иначе переполнение стека\r\n\t\t\tthis._controller.setValue( value );\r\n*/\t\t\t\r\n\t\t\tthis._controller.domElement.childNodes[0].value = value;\r\n\r\n\t\t}\r\n\r\n\t\tconst controler = gui.add( this );\r\n\t\t//что бы можно было вводить цифры после запятой\r\n\t\tcontroler.__truncationSuspended = true;\r\n\r\n\t}\r\n\tset controller( newController ) {\r\n\r\n\t\tthis._controller = newController;\r\n\t\tvar _this = this;\r\n\t\tthis._controller.onChange( function ( value ) {\r\n\r\n\t\t\t_this.onChange( value );\r\n\r\n\t\t} );\r\n\t\tthis._controller.domElement.title = lang.controllerTitle;\r\n\r\n\t}\r\n\tget controller() {\r\n\r\n\t\treturn this._controller;\r\n\r\n\t}\r\n\r\n}\r\nexport function create( player, gui ) {\r\n\r\n\treturn new PlayController( player, gui );\r\n\r\n}\r\n","/**\r\n * @module CameraGui\r\n * @description [Camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera} graphical user interface.\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import PositionController from './PositionController.js';\r\nimport { dat } from './dat/dat.module.js';\r\n\r\nimport functionsFolder from './functionsFolder.js';\r\n\r\n//import Player from './player/player.js';\r\n//import Player from 'https://raw.githack.com/anhr/commonNodeJS/master/player/player.js';\r\n\r\n/**\r\n * Camera settings graphical user interface\r\n * @param {GUI} gui is [new dat.GUI(...)]{@link https://github.com/anhr/dat.gui}.\r\n * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n * @param {THREE} THREE {@link https://github.com/anhr/three.js|THREE}\r\n * @param {Player} Player [Player]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html}.\r\n * @param {object} [options] the following options are available:\r\n * @param {OrbitControls} [options.orbitControls] [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}.\r\n * @param {object} [options.scales={}] axes scales.\r\n * See [AxesHelper(...)]{@link https://raw.githack.com/anhr/commonNodeJS/master/AxesHelper/jsdoc/module-AxesHelper.html} options.scales for details.\r\n * @param {Function} [options.getLanguageCode=\"en\"] returns the \"primary language\" subtag of the version of the browser. Default returns \"en\" is English\r\n*/\r\nvar CameraGui = function ( gui, camera, THREE, Player, options ) {\r\n\r\n/*\r\n\tif ( camera === undefined )\r\n\t\treturn;\r\n*/\r\n\tPlayer.cameraGui = this;\r\n\r\n\toptions = options || {};\r\n\r\n\t//scales\r\n\r\n\toptions.scales = options.scales || {};\r\n\r\n\toptions.scales.x = options.scales.x || {};\r\n\toptions.scales.x.name = options.scales.x.name || 'X';\r\n\r\n\toptions.scales.y = options.scales.y || {};\r\n\toptions.scales.y.name = options.scales.y.name || 'Y';\r\n\r\n\toptions.scales.z = options.scales.z || {};\r\n\toptions.scales.z.name = options.scales.z.name || 'Z';\r\n\r\n\t//\r\n/*Не помню зачем засунул эту хрень. Если оставить то не могу двигать камеру если поставлена птичка в controllerLook\r\n\tif ( options.orbitControls )\r\n\t\toptions.orbitControls.addEventListener( 'change', function () {\r\n\r\n\t\t\tupdate();\r\n\r\n\t\t} );\r\n*/\r\n\t//Localization\r\n\r\n\tconst lang = {\r\n\r\n\t\tcamera: 'Camera',\r\n\r\n\t\tposition: 'Position',\r\n\t\tpositionTitle: 'Camera position',\r\n\r\n\t\tdistanceToCamera: 'Distance',\r\n\t\tdistanceToCameraTitle: 'Distance from the camera to the point at which the camera is looking',\r\n\r\n\t\tlook: 'Look',\r\n\t\tlookTitle: 'Camera is look at a selected point during playing.',\r\n\r\n\t\tdefaultButton: 'Default',\r\n\t\tdefaultTitle: 'Restore default camera settings.',\r\n\r\n\t};\r\n\r\n\tconst _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t: options.getLanguageCode();\r\n\tswitch ( _languageCode ) {\r\n\r\n\t\tcase 'ru'://Russian language\r\n\r\n\t\t\tlang.camera = 'Камера';\r\n\r\n\t\t\tlang.position = 'Позиция';\r\n\t\t\tlang.positionTitle = 'Позиция камеры';\r\n\r\n\t\t\tlang.distanceToCamera = 'Расстояние';\r\n\t\t\tlang.distanceToCameraTitle = 'Расстояние между камерой и точкой, на которую она смотрит.',\r\n\r\n\t\t\tlang.look = 'Следить';\r\n\t\t\tlang.lookTitle = 'Камера следит за выбранной точкой во время проигрывания.';\r\n\r\n\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\tlang.defaultTitle = 'Восстановить настройки камеры по умолчанию.';\r\n\r\n\t\t\tbreak;\r\n\t\tdefault://Custom language\r\n\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t} );\r\n\r\n\t}\r\n\r\n\tconst fCamera = gui.addFolder( lang.camera ),\r\n\t\tfPosition = fCamera.addFolder( lang.position ),\r\n\t\tcontrollersPosition = {\r\n\r\n\t\t\tx: dat.controllerZeroStep( fPosition, camera.position, 'x', function ( value ) {\r\n\r\n\t\t\t\tcamera.position.x = value;\r\n\r\n\t\t\t} ),\r\n\t\t\ty: dat.controllerZeroStep( fPosition, camera.position, 'y', function ( value ) {\r\n\r\n\t\t\t\tcamera.position.y = value;\r\n\r\n\t\t\t} ),\r\n\r\n\t\t\tz: dat.controllerZeroStep( fPosition, camera.position, 'z', function ( value ) {\r\n\r\n\t\t\t\tcamera.position.z = value;\r\n\r\n\t\t\t} ),\r\n\r\n\t\t};\r\n\tdat.folderNameAndTitle( fPosition, lang.position, lang.positionTitle );\r\n\tdat.controllerNameAndTitle( controllersPosition.x, options.scales.x.name );\r\n\tdat.controllerNameAndTitle( controllersPosition.y, options.scales.y.name );\r\n\tdat.controllerNameAndTitle( controllersPosition.z, options.scales.z.name );\r\n\r\n\tvar controllersDistance, defaultDistance;\r\n//\tif ( camera.userData.cameraTarget ) {\r\n\r\n//\t\tconst Player = camera.userData.cameraTarget.Player;\r\n//\tPlayer.setCameraTarget2( camera );\r\n\tPlayer.cameraTarget.init( { camera: camera } );\r\n//\tPlayer.cameraTarget.init( { cameraTarget: { camera: camera } } );\r\n//\tPlayer.setPlayerCameraTarget( { camera: camera } );\r\n\tconst cameraTarget = Player.cameraTarget.get(),\r\n//\t\tcontrollerLook = fCamera.add( cameraTarget, 'boLook' ).onChange( function ( value )\r\n\t\tcontrollerLook = fCamera.add( { boLook: cameraTarget.boLook }, 'boLook' ).onChange( function ( boLook ) {\r\n\r\n\t\t\tif ( Player.player ) Player.player.selectScene();\r\n\t\t\tif ( boLook ) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tif ( Player.orbitControls ) {\r\n\r\n\t\t\t\t//обязательно вызвать controls.saveState();\r\n\t\t\t\tPlayer.orbitControls.reset();\r\n\t/*\r\n\t\t\t\tPlayer.orbitControls.target.copy( camera.userData.cameraTarget.targetDefault );\r\n\t\t\t\tPlayer.orbitControls.update();\r\n\t*/\r\n\r\n\t\t\t}\r\n\t\t\r\n\t\t} ),\r\n\t\tfDistanceToCamera = fCamera.addFolder( lang.distanceToCamera ),\r\n\t\tdistance = {\r\n/*\t\t\t\r\n\t\t\tx: Player.execFunc( Player.cameraTarget2.distanceToCamera, 'x' ).toString(),\r\n\t\t\ty: Player.execFunc( Player.cameraTarget2.distanceToCamera, 'y' ).toString(),\r\n\t\t\tz: Player.execFunc( Player.cameraTarget2.distanceToCamera, 'z' ).toString(),\r\n*/\t\t\t\r\n\t\t\tx: Player.execFunc( cameraTarget.distanceToCamera, 'x' ).toString(),\r\n\t\t\ty: Player.execFunc( cameraTarget.distanceToCamera, 'y' ).toString(),\r\n\t\t\tz: Player.execFunc( cameraTarget.distanceToCamera, 'z' ).toString(),\r\n\r\n\t\t};\r\n\tdat.controllerNameAndTitle( controllerLook, lang.look, lang.lookTitle );\r\n\tfunction setDistance(){\r\n\r\n//\t\tcamera.userData.cameraTarget.setCameraPosition( camera.userData.cameraTarget.target );\r\n//\t\tPlayer.cameraTarget2.setCameraPosition();\r\n\t\tPlayer.cameraTarget.get().setCameraPosition();\r\n\t\tupdate();\r\n\r\n\t}\r\n\tcontrollersDistance = {\r\n\r\n\t\tx: dat.controllerZeroStep( fDistanceToCamera, distance, 'x', function ( value ) {\r\n\r\n\t\t\tcamera.userData.cameraTarget.distanceToCameraCur.x = value;\r\n\t\t\tsetDistance();\r\n\r\n\t\t} ),\r\n\t\ty: dat.controllerZeroStep( fDistanceToCamera, distance, 'y', function ( value ) {\r\n\r\n//\t\t\tcamera.userData.cameraTarget.distanceToCameraCur.y = value;\r\n\t\t\tPlayer.cameraTarget.get().distanceToCameraCur.y = value;\r\n\t\t\tsetDistance();\r\n\r\n\t\t} ),\r\n\r\n\t\tz: dat.controllerZeroStep( fDistanceToCamera, distance, 'z', function ( value ) {\r\n\r\n\t\t\tcamera.userData.cameraTarget.distanceToCameraCur.z = value;\r\n\t\t\tsetDistance();\r\n\r\n\t\t} ),\r\n\r\n\t};\r\n\tdefaultDistance = { x: distance.x, y: distance.y, z: distance.z };\r\n\tdat.folderNameAndTitle( fDistanceToCamera, lang.distanceToCamera, lang.distanceToCameraTitle );\r\n\tdat.controllerNameAndTitle( controllersDistance.x, options.scales.x.name );\r\n\tdat.controllerNameAndTitle( controllersDistance.y, options.scales.y.name );\r\n\tdat.controllerNameAndTitle( controllersDistance.z, options.scales.z.name );\r\n\r\n\tconst funcFolder = new functionsFolder( fDistanceToCamera, options.scales, THREE, function ( func, axisName ) {\r\n\r\n/*\r\n\t\tcamera.userData.cameraTarget.distanceToCamera[axisName] = func;\r\n\t\tconst value = Player.execFunc(camera.userData.cameraTarget.distanceToCamera,axisName,Player.getTime());\r\n*/\t\t\r\n\t\tconst cameraTarget = Player.cameraTarget.get();\r\n\t\tcameraTarget.distanceToCamera[axisName] = func;\r\n\t\tconst value = Player.execFunc( cameraTarget.distanceToCamera, axisName, Player.getTime() );\r\n\t\tcontrollersDistance[axisName].setValue( value );\r\n//\t\tPlayer.setCameraTarget( camera );\r\n\t\tPlayer.cameraTarget.init( { camera: camera } );\r\n//\t\tPlayer.setPlayerCameraTarget( camera );\r\n\r\n\t\tcameraTarget.distanceToCameraCur[axisName] = value;\r\n\t\tsetDistance();\r\n\r\n\t}, {\r\n\r\n\t\tgetLanguageCode: options.getLanguageCode,\r\n//\t\tvector: Player.cameraTarget2.distanceToCamera,\r\n\t\tvector: cameraTarget.distanceToCamera,\r\n\r\n\t} );\r\n\r\n//\t}\r\n\r\n\t//Default button\r\n\tconst defaultPosition = { x: camera.position.x, y: camera.position.y, z: camera.position.z },\r\n\t\tdefaultTarget = options.orbitControls ?\r\n\t\t{\r\n\r\n\t\t\tx: options.orbitControls.target.x,\r\n\t\t\ty: options.orbitControls.target.y,\r\n\t\t\tz: options.orbitControls.target.z,\r\n\r\n\t\t} :\r\n\t\t{ x: 0, y: 0, z: 0 };//default camera look at zero coordinate\r\n\tdat.controllerNameAndTitle( fCamera.add( {\r\n\r\n\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\tcontrollersPosition.x.setValue( defaultPosition.x );\r\n\t\t\tcontrollersPosition.y.setValue( defaultPosition.y );\r\n\t\t\tcontrollersPosition.z.setValue( defaultPosition.z );\r\n\r\n\t\t\tcamera.position.copy( defaultPosition );\r\n\t\t\tcamera.lookAt( defaultTarget );\r\n\t\t\tif ( options.orbitControls ) {\r\n\r\n\t\t\t\toptions.orbitControls.target.copy( defaultTarget );\r\n\t\t\t\toptions.orbitControls.update();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( controllersDistance ) {\r\n\r\n\t\t\t\tcontrollersDistance.x.setValue( defaultDistance.x );\r\n\t\t\t\tcontrollersDistance.y.setValue( defaultDistance.y );\r\n\t\t\t\tcontrollersDistance.z.setValue( defaultDistance.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\tfunction update(){\r\n\r\n\t\tconst cameraTarget = Player.cameraTarget.get();\r\n//\t\tif ( cameraTarget.boLook && !controllerLook.getValue() ) controllerLook.setValue( cameraTarget.boLook );\r\n//\t\tif ( !Player.cameraTarget2.boLook || !Player.cameraTarget2.target )\r\n\t\tif ( !cameraTarget.boLook || !cameraTarget.target )\r\n\t\t\treturn;\r\n\t\tcontrollersPosition.x.setValue( camera.position.x );\r\n\t\tcontrollersPosition.y.setValue( camera.position.y );\r\n\t\tcontrollersPosition.z.setValue( camera.position.z );\r\n\r\n\t\tif ( controllersDistance ) {\r\n\r\n/*\r\n\t\t\tcontrollersDistance.x.setValue( Player.cameraTarget2.distanceToCameraCur.x );\r\n\t\t\tcontrollersDistance.y.setValue( Player.cameraTarget2.distanceToCameraCur.y );\r\n\t\t\tcontrollersDistance.z.setValue( Player.cameraTarget2.distanceToCameraCur.z );\r\n*/\r\n\t\t\tcontrollersDistance.x.setValue( cameraTarget.distanceToCameraCur.x );\r\n\t\t\tcontrollersDistance.y.setValue( cameraTarget.distanceToCameraCur.y );\r\n\t\t\tcontrollersDistance.z.setValue( cameraTarget.distanceToCameraCur.z );\r\n\r\n\t\t}\r\n//\t\tfuncFolder.setFunction( Player.cameraTargetPoint.distanceToCamera || Player.cameraTarget2.distanceToCamera );\r\n\t\tfuncFolder.setFunction( cameraTarget.distanceToCamera );\r\n\r\n\t}\r\n\tif ( this ) {\r\n\r\n\t\t/**\r\n\t\t * Update camera controls.\r\n\t\t * @function CameraGui.\r\n\t\t * update\r\n\t\t */\r\n\t\tthis.update = function () { update(); }\r\n\t\t//if ( camera.userData.cameraTarget ) camera.userData.cameraTarget.cameraGui = this;Use Player.cameraGui\r\n\t\t/**\r\n\t\t * Is camera look at selected point?\r\n\t\t * @function CameraGui.\r\n\t\t * isLook\r\n\t\t */\r\n\t\tthis.isLook = function () { return controllerLook.getValue(); }\r\n\t\t/**\r\n\t\t * Look at selected point\r\n\t\t * @function CameraGui.\r\n\t\t * look\r\n\t\t * @param {boolean} [boLook=true] true - look at selected point\r\n\t\t */\r\n\t\tthis.look = function ( boLook = true ) { if ( controllerLook.getValue() !== boLook ) controllerLook.setValue( boLook ); }\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default CameraGui;","/**\r\n * @module Player\r\n * @description 3D objects animation.\r\n * @author [Andrej Hristoliubov]{@link https://anhr.github.io/AboutMe/}\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport cookie from '../cookieNodeJS/cookie.js';\r\n//import cookie from 'https://raw.githack.com/anhr/commonNodeJS/master/cookieNodeJS/cookie.js';\r\n\r\nimport ScaleController from '../ScaleController.js';\r\nimport PositionController from '../PositionController.js';\r\nimport { dat } from '../dat/dat.module.js';\r\n\r\nimport { GuiSelectPoint, getObjectPosition } from '../guiSelectPoint/guiSelectPoint.js';\r\n//import { GuiSelectPoint, getObjectPosition } from 'https://raw.githack.com/anhr/commonNodeJS/master/guiSelectPoint/guiSelectPoint.js';\r\n\r\nimport ColorPicker from '../colorpicker/colorpicker.js';\r\n//import ColorPicker from 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.js';\r\n//ColorPicker.palette.setTHREE( THREE );\r\n\r\nimport { lang } from '../controllerPlay/index.js';\r\n\r\n//import { SpriteText } from '../../../SpriteText/master/SpriteText.js';//https://github.com/anhr/SpriteText\r\n\r\nimport Cookie from '../cookieNodeJS/cookie.js';//https://github.com/anhr/commonNodeJS/tree/master/cookieNodeJS\r\n//import Cookie from 'https://raw.githack.com/anhr/cookieNodeJS/master/cookie.js';\r\n//import Cookie from 'https://raw.githack.com/anhr/commonNodeJS/master/cookieNodeJS/cookie.js';\r\n\r\nimport { getWorldPosition } from '../guiSelectPoint/guiSelectPoint.js';\r\n\r\nimport CameraGui from '../CameraGui.js';\r\n//import CameraGui from 'http://localhost/anhr/commonNodeJS/master/CameraGui.js';\r\n\r\nvar settings,\r\n\r\n\t//сделал общим для всех плееров потому что в getShaderMaterialPoints вызывается Player.selectMeshPlayScene\r\n\t//что бы установить начальные точки. Т.е. установить цвет и положение точек.\r\n\t//Начальные точки в getShaderMaterialPoints устанавливаются отдельно потому что в getShaderMaterialPoints точки создаются в отдельной нити\r\n\t//потому что сначала загружаются Shader файлы. Поэтому когда вызывается setTimeout( function () { onSelectScene(); }, 0 );\r\n\t//что бы цвет точек был верным еще до начала проигрывания, точки из getShaderMaterialPoints еще не добавлены в группу для проигрывания.\r\n\t//Кроме того цвет точек в getShaderMaterialPoints задается аттрибутом 'ca' а не 'color'.\r\n\tselectPlaySceneOptions,\r\n\tTHREE,\r\n\tboPlayer = false;//true - player is created\r\n//\tselectSceneIndex = 0;//for guiSelectPoint\r\n\r\n/**\r\n * @callback onSelectScene\r\n * @description This function is called at each new step of the playing. See [Player]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html#~Player} method.\r\n * @param {number} index current index of the scene of the animation\r\n * @param {number} t current time\r\n */\r\n\r\n/**\r\n * @callback onChangeScaleT\r\n * @description User has updated the time settings. See [Player]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html#~Player} method.\r\n * @param {object} scale the updated time settings\r\n */\r\n\r\n/**\r\n * 3D objects animation.\r\n * @param {THREE.Group|THREE.Scene} group THREE group or scene of the meshes  for playing.\r\n * @param {object} [options] the following options are available\r\n * @param {object} [options.selectPlaySceneOptions] See [Player.selectPlayScene]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html#~Player.selectPlayScene} options parameter.\r\n * @param {onSelectScene} [options.onSelectScene] This function is called at each new step of the playing. See [onSelectScene]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html#~onSelectScene}.\r\n * @param {onChangeScaleT} [options.onChangeScaleT] event. User has updated the time settings. See [onChangeScaleT]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html#~onChangeScaleT}.\r\n * @param {object} [options.settings] time settings.\r\n * @param {number} [options.settings.interval=1] Ticks per seconds.\r\n * @param {number} [options.settings.min=0] Animation start time.\r\n * @param {number} [options.settings.max=1] Animation end time. Set to Infinity if you want to play to infinity.\r\n * @param {number} [options.settings.dt=0.1] Step of the animation. Have effect only if <b>max</b> is infinity.\r\n * @param {number} [options.settings.marks=10] Ticks count of the playing. Number of scenes of 3D objects animation.\r\n * Have effect for <b>max</b> is not Infinity.\r\n * @param {boolean} [options.settings.repeat=false] true - Infinitely repeating 3D objects animation.\r\n * @param {number} [options.settings.zoomMultiplier=1.1] zoom multiplier of the time.\r\n * @param {number} [options.settings.offset=0.1] offset of the time.\r\n * @param {string} [options.settings.name=\"\"] name of the time.\r\n * @param {THREE.PerspectiveCamera} options.cameraTarget.camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n */\r\nfunction Player( group, options ) {\r\n\r\n\tif ( typeof THREE === 'undefined' ) {\r\n\r\n\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\tColorPicker.palette.setTHREE( THREE );\r\n\r\n\tif ( Player.isCreated() ) {\r\n\r\n\t\tconsole.error( 'Player: duplicate player.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tPlayer.player = this;\r\n\r\n\toptions = options || {};\r\n\r\n\tselectPlaySceneOptions = options.selectPlaySceneOptions;\r\n\tselectPlaySceneOptions = selectPlaySceneOptions || {};\r\n\tselectPlaySceneOptions.boPlayer = selectPlaySceneOptions.boPlayer || false;\r\n\r\n\tselectPlaySceneOptions.a = options.a || 1;\r\n\tselectPlaySceneOptions.b = options.b || 0;\r\n//\tselectPlaySceneOptions.scales = selectPlaySceneOptions.scales || {};не помню зачем эта строка\r\n\r\n\t//если тут создавать палитру то она не создастся если не создается плееер\r\n\t//palette = new palette();\r\n\r\n\tsettings = options.settings || {};\r\n\tassignSettings();\r\n\r\n\toptions.cameraTarget = options.cameraTarget || {};\r\n\r\n\t/**\r\n\t * Select a scene for playing\r\n\t * @function Player.\r\n\t * selectPlayScene\r\n\t * @param {THREE.Group} group [THREE.Group]{@link https://threejs.org/docs/index.html#api/en/objects/Group}\r\n\t * @param {number} t time\r\n\t * @param {number} index index of the time.\r\n\t * @param {object} [selectPlaySceneOptions] the following options are available\r\n\t * @param {boolean} [selectPlaySceneOptions.boPlayer] true - is not select play scene for mesh.userData.boFrustumPoints = true. Default is false.\r\n\t * @param {number} [selectPlaySceneOptions.a] multiplier. Second parameter of the arrayFuncs item function. Default is 1.\r\n\t * @param {number} [selectPlaySceneOptions.b] addendum. Third parameter of the arrayFuncs item function. Default is 0.\r\n\t * @param {object} [selectPlaySceneOptions.scales] axes scales. See {@link https://raw.githack.com/anhr/AxesHelper/master/jsdoc/module-AxesHelper.html|AxesHelper}. Default is {}\r\n\t * @param {object} [selectPlaySceneOptions.palette=new ColorPicker.palette();//palette: ColorPicker.paletteIndexes.BGRW] See [ColorPicker.palette]{@link https://raw.githack.com/anhr/colorPicker/master/jsdoc/module-ColorPicker.html#~Palette}.\r\n\t * <pre>\r\n\t * Example:\r\n\t * new ColorPicker.palette( { palette: ColorPicker.paletteIndexes.bidirectional } );\r\n\t * </pre>\r\n\t * @param {object} [selectPlaySceneOptions.guiSelectPoint] See [GuiSelectPoint]{@link https://raw.githack.com/anhr/commonNodeJS/master/guiSelectPoint/jsdoc/module-GuiSelectPoint.html#~GuiSelectPoint}.\r\n\t * <pre>\r\n\t * Example:\r\n\t * new GuiSelectPoint();\r\n\t * </pre>\r\n\t */\r\n\tfunction selectPlayScene( group, t, index, selectPlaySceneOptions ) {\r\n\r\n\t\t//Эта строка нужна в случае если в 3D объекте не утанвавливатся аттрибут color.\r\n\t\t//Другими словами если не вызывается Player.getColors\r\n\t\tColorPicker.palette.setTHREE( THREE );\r\n\r\n\t\tselectPlaySceneOptions = selectPlaySceneOptions || {};\r\n\r\n\t\tgroup.userData.t = t;\r\n\t\tPlayer.selectMeshPlayScene( /*THREE, */group, t, index );//, options );\r\n\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\tPlayer.selectMeshPlayScene( /*THREE, */mesh, t, index );//, options );\r\n\r\n\t\t} );\r\n/*\t\t\r\n//\t\tif ( options.cameraTarget )\r\n//\t\tif ( Player.cameraTarget2 )\r\n\t\tif ( Player.cameraTargetPoint ){\r\n\r\n//\t\t\tPlayer.setCameraTarget();\r\n\t\t\tPlayer.cameraTarget.setCameraTarget();\r\n//\t\t\tPlayer.setPlayerCameraTarget();\r\n//\t\t\tPlayer.cameraTarget2.setCameraPosition();\r\n\t\t\tPlayer.cameraTarget.get().setCameraPosition();\r\n\r\n\t\t}\r\n*/\t\t\r\n\t\tPlayer.cameraTarget.setCameraTarget();\r\n\r\n\t\tconst cameraTarget = Player.cameraTarget.get();\r\n\t\tif ( cameraTarget && cameraTarget.setCameraPosition ) cameraTarget.setCameraPosition();\r\n\r\n\t\tif ( Player.cameraGui ) Player.cameraGui.update();\r\n\r\n\t}\r\n\r\n\t//var boSelectFirstScene = true;\r\n\t/**\r\n\t * @description This function is called at each new step of the playing.\r\n\t * @param {number} [index=0] current index of the scene of the animation\r\n\t */\r\n\tfunction onSelectScene( index ) {\r\n\r\n\t\tindex = index || 0;\r\n\t\tconst t = _this.getTime();\r\n\t\tselectPlayScene( group, t, index, options.selectPlaySceneOptions );\r\n\t\t_this.setIndex( index, ( settings.name === '' ? '' : settings.name + ': ' ) + t );\r\n\t\tif ( options.onSelectScene ) options.onSelectScene( index, t );\r\n\r\n\t}\r\n\r\n\t//Теперь не нужно создавать color attribute на веб странице что бы цвет точек был верным еще до начала проигрывания\r\n\t//Кроме того трассировака начинается с нулевой точки\r\n\tsetTimeout( function () { onSelectScene(); }, 0 );\r\n\r\n\tvar selectSceneIndex = 0;\r\n\tconst _this = this;\r\n\r\n\t/**\r\n\t * get time\r\n\t * @function player.\r\n\t * getTime\r\n\t */\r\n\tthis.getTime = function() {\r\n\r\n\t\tconst t = settings.min + selectSceneIndex * settings.dt;\r\n\t\tif ( isNaN( t ) ) console.error( 'Player.getTime(): t = ' + t );\r\n\t\tif ( ( settings.max !== null ) && ( t > settings.max ) )\r\n\t\t\tconsole.error( 'Player.getTime(): t = ' + t + ' settings.max = ' + settings.max );\r\n\t\tif ( ( t < settings.min ) && ( settings.max !== null ) )\r\n\t\t\tconsole.error( 'Player.getTime(): t = ' + t + ' settings.min = ' + settings.min );\r\n\t\treturn t;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * set time\r\n\t * @function player.\r\n\t * setTime\r\n\t * @param {number} t time\r\n\t */\r\n\tthis.setTime = function( t ) {\r\n\r\n\t\tthis.selectScene( parseInt( ( t - settings.min ) / settings.dt ) );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * select scene for playing\r\n\t * @function player.\r\n\t * selectScene\r\n\t * @param {number} index Index of the scene. Range from 0 to settings.marks - 1\r\n\t */\r\n\tthis.selectScene = function( index ) {\r\n\r\n\t\tif ( index === undefined ) {\r\n\r\n\t\t\tonSelectScene( selectSceneIndex );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tindex = parseInt( index );\r\n\t\tif ( settings.max !== null ) {\r\n\r\n\t\t\tif ( index >= settings.marks )\r\n\t\t\t\tindex = 0;\r\n\t\t\telse if ( index < 0 )\r\n\t\t\t\tindex = settings.marks - 1;\r\n\t\t\tif( selectSceneIndex > settings.marks )\r\n\t\t\t\tselectSceneIndex = settings.marks;\r\n\r\n\t\t}\r\n\t\twhile ( selectSceneIndex !== index ) {\r\n\r\n\t\t\tif ( selectSceneIndex < index )\r\n\t\t\t\tselectSceneIndex++;\r\n\t\t\telse selectSceneIndex--;\r\n\t\t\tonSelectScene( selectSceneIndex );\r\n\t\t\t\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Go to next object 3D\r\n\t * @function Player.\r\n\t * next\r\n\t */\r\n\tthis.next = function() {\r\n\r\n\t\t_this.selectScene( selectSceneIndex + 1 );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Go to previous object 3D\r\n\t * @function Player.\r\n\t * prev\r\n\t */\r\n\tthis.prev = function () {\r\n\r\n\t\t_this.selectScene( selectSceneIndex - 1 );\r\n\r\n\t}\r\n\t/**\r\n\t * Add controller into controllers array\r\n\t * @function Player.\r\n\t * pushController\r\n\t * @param {controller} controller\r\n\t */\r\n\tthis.pushController = function ( controller ) {\r\n\r\n\t\tif ( ( controller.object !== undefined ) && ( controller.object.playRate !== undefined ) )\r\n\t\t\tcontroller.object.playRate = settings.min;\r\n\t\tcontrollers.push( controller );\r\n\r\n\t}\r\n\r\n\t//Play/Pause\r\n\r\n\tthis.controllers = [];\r\n\tvar playing = false, time, timeNext;\r\n\tconst controllers = this.controllers;\r\n\r\n\tfunction RenamePlayButtons() {\r\n\r\n\t\tcontrollers.forEach( function ( controller ) { if (controller.onRenamePlayButtons) controller.onRenamePlayButtons( playing ); } );\r\n\r\n\t}\r\n\r\n\tfunction play() {\r\n\r\n\t\tif ( ( selectSceneIndex === -1 ) || ( ( selectSceneIndex === settings.marks ) && ( settings.max !== null ) ) ) {\r\n\r\n\t\t\tselectSceneIndex = 0;\r\n\r\n\t\t}\r\n\t\tonSelectScene( selectSceneIndex );\r\n\r\n\t}\r\n\r\n\tfunction pause() {\r\n\r\n\t\tplaying = false;\r\n\t\tRenamePlayButtons();\r\n\r\n\t\ttime = undefined;\r\n\r\n\t}\r\n\tfunction isRepeat() {\r\n\r\n\t\treturn settings.repeat;\r\n\r\n\t}\r\n\r\n\tfunction playNext() {\r\n\r\n\t\tselectSceneIndex++;\r\n\t\tif ( ( settings.max !== null ) && selectSceneIndex >= settings.marks ) {\r\n\r\n\t\t\tif ( isRepeat() )\r\n\t\t\t\tselectSceneIndex = 0;\r\n\t\t\telse {\r\n\r\n\t\t\t\t//Для вычисления текущего времени в случае:\r\n\t\t\t\t//1. Запустить плеер и дождаться когда проигрывание остановится после достижения максимального времени\r\n\t\t\t\t//2. В guiSelectPoint выбрать точку, цвет которой зависит от времени\r\n\t\t\t\t//Тогда если убрать эту строку, то selectSceneIndex и время окажется за диапазоном допустимых значений\r\n\t\t\t\t//и цвет точки окажется неверным\r\n\t\t\t\tselectSceneIndex = settings.marks - 1;\r\n\r\n\t\t\t\tpause();\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tplay();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * User has clicked the Play ► / Pause ❚❚ button\r\n\t * @function player.\r\n\t * play3DObject\r\n\t */\r\n\tthis.play3DObject = function() {\r\n\r\n\t\tif ( playing ) {\r\n\r\n\t\t\tpause();\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tplaying = true;\r\n\t\tif ( ( settings.max !== null ) && ( selectSceneIndex >= ( settings.marks - 1 ) ) )\r\n\t\t\tselectSceneIndex = 0;//-1;\r\n\t\tplayNext();\r\n\t\tRenamePlayButtons();\r\n\r\n\t\tfunction step( timestamp ) {\r\n\r\n\t\t\tif ( playing )\r\n\t\t\t\twindow.requestAnimationFrame( step );\r\n\t\t\telse time = undefined;\r\n\r\n\t\t\tif ( time === undefined ) {\r\n\r\n\t\t\t\ttime = timestamp;\r\n\t\t\t\ttimeNext = time + 1000 / settings.interval;\r\n\r\n\t\t\t}\r\n\t\t\tif ( isNaN( timeNext ) || ( timeNext === Infinity ) ) {\r\n\r\n\t\t\t\tconsole.error( 'Player.animate: timeNext = ' + timeNext );\r\n\t\t\t\tplaying = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( timestamp < timeNext )\r\n\t\t\t\treturn;\r\n\t\t\twhile ( timestamp > timeNext ) timeNext += 1000 / settings.interval;\r\n\t\t\tplayNext();\r\n\r\n\t\t}\r\n\t\twindow.requestAnimationFrame( step );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * User has clicked the repeat ⥀ button\r\n\t * @function player.\r\n\t * repeat\r\n\t */\r\n\tthis.repeat = function () {\r\n\r\n\t\tsettings.repeat = !settings.repeat;\r\n\t\tthis.onChangeRepeat( settings.repeat );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @function player.\r\n\t * getOptions\r\n\t * @returns Player options.\r\n\t */\r\n\tthis.getOptions = function () { return options; }\r\n\t/**\r\n\t * @function player.\r\n\t * getSelectSceneIndex\r\n\t * @returns selected scene index.\r\n\t */\r\n\tthis.getSelectSceneIndex = function () { return selectSceneIndex; }\r\n\r\n\t/**\r\n\t * Event of the changing of the rate of changing of animation scenes per second.\r\n\t * @function player.\r\n\t * onChangeRepeat\r\n\t * @param {number} value new rate\r\n\t */\r\n\tthis.onChangeRepeat = function ( value ) {\r\n\r\n\t\tsettings.repeat = value;\r\n\t\tthis.controllers.forEach( function ( controller ) { if ( controller.onChangeRepeat ) controller.onChangeRepeat(); } );\r\n\r\n\t}\r\n\r\n\t//Localization\r\n\tfunction getLang( params ) {\r\n\r\n\t\tparams = params || {};\r\n\t\tconst lang = {\r\n\r\n\t\t\tplayer: 'Player',\r\n\t\t\tplayerTitle: '3D objects animation.',\r\n\r\n\t\t\tmin: 'Min',\r\n\t\t\tmax: 'Max',\r\n\t\t\tdt: 'Step',\r\n\t\t\tdtTitle: 'Time between frames',\r\n\r\n\t\t\tmarks: 'Frames',\r\n\t\t\tmarksTitle: 'Player frames count',\r\n\r\n\t\t\tinterval: 'Rate',\r\n\t\t\tintervalTitle: 'Rate of changing of animation scenes per second.',\r\n\r\n\t\t\ttime: 'Time',\r\n\r\n\t\t\tdefaultButton: 'Default',\r\n\t\t\tdefaultTitle: 'Restore default player settings.',\r\n\r\n\t\t};\r\n\r\n\t\tconst _languageCode = params.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t: params.getLanguageCode();\r\n\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\tlang.player = 'Проигрыватель';\r\n\t\t\t\tlang.playerTitle = 'Анимация 3D объектов.';\r\n\r\n\t\t\t\tlang.min = 'Минимум';\r\n\t\t\t\tlang.max = 'Максимум';\r\n\t\t\t\tlang.dt = 'Шаг';\r\n\t\t\t\tlang.dtTitle = 'Веремя между кадрами';\r\n\r\n\t\t\t\tlang.marks = 'Кадры';\r\n\t\t\t\tlang.marksTitle = 'Количество кадров проигрывателя';\r\n\r\n\t\t\t\tlang.interval = 'Темп',\r\n\t\t\t\tlang.intervalTitle = 'Скорость смены кадров в секунду.';\r\n\r\n\t\t\t\tlang.time = 'Время';\r\n\r\n\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\tlang.defaultTitle = 'Восстановить настройки проигрывателя по умолчанию.';\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tdefault://Custom language\r\n\t\t\t\tif ( ( params.lang === undefined ) || ( params.lang._languageCode != _languageCode ) )\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tObject.keys( params.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\tif ( _lang[key] === undefined )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t_lang[key] = params.lang[key];\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t}\r\n\t\treturn lang;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a Player's controllers into [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n\t * @function Player.\r\n\t * gui\r\n\t * @param {GUI} folder Player's folder\r\n\t * @param {object} [guiParams={}] Followed parameters is allowed. Default is no parameters\r\n\t * @param {Function} [guiParams.getLanguageCode=\"en\"] Your custom getLanguageCode() function.\r\n\t * <pre>\r\n\t * returns the \"primary language\" subtag of the language version of the browser.\r\n\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t * See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t * Default returns the 'en' is English language.\r\n\t * You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n\t * </pre>\r\n\t * @param {object} [guiParams.lang] Object with localized language values\r\n\t * <pre>\r\n\t * Example Using of guiParams.lang:\r\n\t * guiParams = {\r\n\t *\r\n\t * \tgetLanguageCode: function() { return 'az'; },\r\n\t * \tlang: { textHeight: 'mətn boyu', languageCode: 'az' },\r\n\t *\r\n\t * }\r\n\t * </pre>\r\n\t * @param {Cookie} [guiParams.cookie=new Cookie.defaultCookie()] Your custom cookie function for saving and loading of the SpriteText settings. Default cookie is not saving settings.\r\n\t * @param {string} [guiParams.cookieName=\"\"] Name of the cookie is \"Player\" + guiParams.cookieName.\r\n\t */\r\n\tthis.gui = function ( folder, guiParams = {} ) {\r\n\r\n\t\tguiParams.getLanguageCode = guiParams.getLanguageCode || function(){ return \"en\"; };\r\n\t\tguiParams.cookie = guiParams.cookie || new Cookie.defaultCookie();\r\n\t\tguiParams.cookieName = guiParams.cookieName || '';\r\n\t\t\r\n\t\tconst cookie = guiParams.cookie, cookieName = 'Player' + guiParams.cookieName;\r\n\t\tfunction setSettings() {\r\n\r\n\t\t\tsetDT();\r\n\t\t\tcookie.setObject( cookieName, settings );\r\n\t\t\tif ( options.onChangeScaleT ) options.onChangeScaleT( settings );\r\n\r\n\t\t}\r\n\t\tsetMax();\r\n\t\tconst axesDefault = JSON.parse( JSON.stringify( settings ) ),\r\n\t\t\tlang = getLang( {\r\n\r\n\t\t\tgetLanguageCode: guiParams.getLanguageCode,\r\n\t\t\t//lang: guiParams.lang\r\n\r\n\t\t} );\r\n\t\tObject.freeze( axesDefault );\r\n\t\tconst max = settings.max, marks = settings.marks;\r\n\t\tcookie.getObject( cookieName, settings, settings );\r\n\t\tif ( ( max === null ) || ( max === Infinity ) ||\r\n\t\t\t( settings.max === null )//раньше на веб странице плеер был настроен на бесконечное проигрыванияе а сейчас проигрывание ограничено по времени\r\n\t\t) {\r\n\r\n\t\t\tsettings.max = max;\r\n\t\t\tsettings.marks = marks;\r\n\r\n\t\t}\r\n\r\n\t\tconst fPlayer = folder.addFolder( lang.player );\r\n\t\tdat.folderNameAndTitle( fPlayer, lang.player, lang.playerTitle );\r\n\r\n\t\tfunction scale() {\r\n\r\n\t\t\tconst axes = settings,//options.settings,\r\n\t\t\t\tscaleControllers = {};\r\n\t\t\tfunction onclick( customController, action ) {\r\n\r\n\t\t\t\tvar zoom = customController.controller.getValue();\r\n\r\n\t\t\t\taxes.min = action( axes.min, zoom );\r\n\t\t\t\tscaleControllers.min.setValue( axes.min );\r\n\t\t\t\tif ( axes.max ) {\r\n\r\n\t\t\t\t\taxes.max = action( axes.max, zoom );\r\n\t\t\t\t\tsetDT();\r\n\t\t\t\t\tscaleControllers.max.setValue( axes.max );\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetSettings();\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\tscaleControllers.folder = fPlayer.addFolder( axes.name !== '' ? axes.name : lang.time );\r\n\r\n\t\t\tscaleControllers.scaleController = scaleControllers.folder.add( new ScaleController( onclick, \r\n\t\t\t\t{ settings: options.settings, getLanguageCode: guiParams.getLanguageCode, } ) ).onChange( function ( value ) {\r\n\r\n\t\t\t\taxes.zoomMultiplier = value;\r\n\t\t\t\tsetSettings();\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tconst positionController = new PositionController( function ( shift ) {\r\n\r\n\t\t\t\tonclick( positionController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\tvalue += shift;//zoom;\r\n\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}, { settings: options.settings, getLanguageCode: guiParams.getLanguageCode, } );\r\n\t\t\tscaleControllers.positionController = scaleControllers.folder.add( positionController ).onChange( function ( value ) {\r\n\r\n\t\t\t\taxes.offset = value;\r\n\t\t\t\tsetSettings();\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//min\r\n\t\t\tscaleControllers.min = dat.controllerZeroStep( scaleControllers.folder, axes, 'min', function ( value ) { setSettings(); } );\r\n\t\t\tdat.controllerNameAndTitle( scaleControllers.min, lang.min );\r\n\r\n\t\t\t//max\r\n\t\t\t//axes.max сейчас используется исключитьельно для удобства пользовательского интерфейса\r\n\t\t\t//Вместо axes.max используется axes.dt\r\n\t\t\tsetMax();\r\n\t\t\tif ( axes.max !== null ) {\r\n\r\n\t\t\t\tscaleControllers.max = dat.controllerZeroStep( scaleControllers.folder, axes, 'max', function ( value ) { setSettings(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.max, lang.max );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t//dt\r\n\t\t\t\tscaleControllers.dt = dat.controllerZeroStep( scaleControllers.folder, axes, 'dt', function ( value ) { setSettings(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.dt, lang.dt, lang.dtTitle );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//marks\r\n\t\t\tif ( axes.marks ) {\r\n\r\n\t\t\t\tscaleControllers.marks = scaleControllers.folder.add( axes, 'marks' ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\taxes.marks = parseInt( axes.marks );\r\n\t\t\t\t\tsetSettings();\r\n\t\t\t\t\tconst elSlider = getSliderElement();\r\n\t\t\t\t\tif ( elSlider ) elSlider.max = settings.marks - 1;\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.marks, axes.marksName === undefined ? lang.marks : axes.marksName,\r\n\t\t\t\t\taxes.marksTitle === undefined ? lang.marksTitle : axes.marksTitle );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Ticks per seconds.\r\n\t\t\tscaleControllers.interval = scaleControllers.folder.add( options.settings, 'interval', 1, 25, 1 ).onChange( function ( value ) {\r\n\r\n\t\t\t\tsetSettings();\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( scaleControllers.interval, lang.interval, lang.intervalTitle );\r\n\r\n\t\t\t//Default button\r\n\t\t\tdat.controllerNameAndTitle( scaleControllers.folder.add( {\r\n\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\taxes.zoomMultiplier = axesDefault.zoomMultiplier;\r\n\t\t\t\t\tscaleControllers.scaleController.setValue( axes.zoomMultiplier );\r\n\r\n\t\t\t\t\taxes.offset = axesDefault.offset;\r\n\t\t\t\t\tscaleControllers.positionController.setValue( axes.offset );\r\n\r\n\t\t\t\t\taxes.min = axesDefault.min;\r\n\t\t\t\t\tscaleControllers.min.setValue( axes.min );\r\n\r\n\t\t\t\t\tif ( scaleControllers.max ) {\r\n\r\n\t\t\t\t\t\taxes.max = axesDefault.max;\r\n\t\t\t\t\t\tsetDT();\r\n\t\t\t\t\t\tscaleControllers.max.setValue( axes.max );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( scaleControllers.dt ) {\r\n\r\n\t\t\t\t\t\taxes.dt = axesDefault.dt;\r\n\t\t\t\t\t\tscaleControllers.dt.setValue( axes.dt );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axesDefault.marks ) {\r\n\r\n\t\t\t\t\t\taxes.marks = axesDefault.marks;\r\n\r\n\t\t\t\t\t\t//scaleControllers.marks is undefined если программист сначала установил max: Infinity,\r\n\t\t\t\t\t\t//соханил Player in cookie, например изменил marks\r\n\t\t\t\t\t\t//удалил max: Infinity,\r\n\t\t\t\t\t\t//Нажал кнопку Default для проигрывателя\r\n\t\t\t\t\t\tif ( scaleControllers.marks )\r\n\t\t\t\t\t\t\tscaleControllers.marks.setValue( axes.marks );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\taxes.interval = axesDefault.interval;\r\n\t\t\t\t\tscaleControllers.interval.setValue( axes.interval );\r\n\r\n\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\t}\r\n\t\tscale();\r\n\r\n\t}\r\n\r\n\tvar _canvasMenu;\r\n\t/**\r\n\t * Adds a Player's menu item into [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t * @function Player.\r\n\t * createCanvasMenuItem\r\n\t * @param {CanvasMenu} canvasMenu [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t */\r\n\tthis.createCanvasMenuItem = function ( canvasMenu ) {\r\n\r\n\t\t_canvasMenu = canvasMenu;\r\n\t\tconst player = this, menu = canvasMenu.menu;\r\n\r\n\t\t//Previous button\r\n\t\tmenu.push( {\r\n\r\n\t\t\tname: lang.prevSymbol,\r\n\t\t\ttitle: lang.prevSymbolTitle,\r\n\t\t\tonclick: function ( event ) { player.prev(); }\r\n\r\n\t\t} );\r\n\r\n\t\t//Play button\r\n\t\tmenu.push( {\r\n\r\n\t\t\tname: lang.playSymbol,\r\n\t\t\ttitle: lang.playTitle,\r\n\t\t\tid: \"menuButtonPlay\",\r\n\t\t\tonclick: function ( event ) {\r\n\r\n//\t\t\t\tif ( selectSceneIndex >= ( settings.marks - 1 ) ) selectSceneIndex =  0;\r\n\t\t\t\tplayer.play3DObject();\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\tif ( settings.max !== null ) {\r\n\r\n\t\t\t//Repeat button\r\n\t\t\tmenu.push( {\r\n\r\n\t\t\t\tname: lang.repeat,\r\n\t\t\t\ttitle: this.getOptions().repeat ? lang.repeatOff : lang.repeatOn,\r\n\t\t\t\tid: \"menuButtonRepeat\",\r\n\t\t\t\tonclick: function ( event ) { player.repeat(); }\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\t//Next button\r\n\t\tmenu.push( {\r\n\r\n\t\t\tname: lang.nextSymbol,\r\n\t\t\ttitle: lang.nextSymbolTitle,\r\n\t\t\tonclick: function ( event ) { player.next(); }\r\n\r\n\t\t} );\r\n\r\n\t\tcontrollers.push( {\r\n\r\n\t\t\t/**\r\n\t\t\t * Renames the \"Play\" button of the player's menu.\r\n\t\t\t * @function Player.\r\n\t\t\t * onRenamePlayButtons\r\n\t\t\t * @param {boolean} playing <b>true</b> - pause.\r\n\t\t\t * <p><b>false</b> - play</p>\r\n\t\t\t */\r\n\t\t\tonRenamePlayButtons: function ( playing ) {\r\n\r\n\t\t\t\tvar name, title;\r\n\t\t\t\tif ( playing ) {\r\n\r\n\t\t\t\t\tname = lang.pause;\r\n\t\t\t\t\ttitle = lang.pauseTitle;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tname = lang.playSymbol;\r\n\t\t\t\t\ttitle = lang.playTitle;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst elMenuButtonPlay = canvasMenu.querySelector( '#menuButtonPlay' );\r\n\t\t\t\telMenuButtonPlay.innerHTML = name;\r\n\t\t\t\telMenuButtonPlay.title = title;\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * Changes \"Repeat\" button of the player's menu between <b>repeat Off</b> and <b>repeat On</b>.\r\n\t\t\t * @function Player.\r\n\t\t\t * onChangeRepeat\r\n\t\t\t */\r\n\t\t\tonChangeRepeat: function () {\r\n\r\n\t\t\t\tcanvasMenu.querySelector( '#menuButtonRepeat' ).title = settings.repeat ? lang.repeatOff : lang.repeatOn;\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adds slider menu item into [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t * @function Player.\r\n\t * addSlider\r\n\t */\r\n\tthis.addSlider = function () {\r\n\r\n\t\tif ( settings.max === null )\r\n\t\t\treturn;\r\n\t\t\t\r\n\t\t_canvasMenu.menu.push( {\r\n\r\n\t\t\tname: '<input type=\"range\" min=\"0\" max=\"' + ( Player.getSettings().marks - 1 ) + '\" value=\"0\" class=\"slider\" id=\"sliderPosition\">',\r\n\t\t\tstyle: 'float: right;',\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tfunction getSliderElement() { if ( _canvasMenu ) return _canvasMenu.querySelector( '#sliderPosition' ); }\r\n\r\n\t/**\r\n\t * Adds an events into slider menu item of the [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t * @function Player.\r\n\t * addSliderEvents\r\n\t * @returns slider element\r\n\t */\r\n\tthis.addSliderEvents = function () {\r\n\r\n\t\tconst elSlider = getSliderElement(), player = this;\r\n\t\tif ( elSlider ) {\r\n\r\n\t\t\telSlider.onchange = function ( event ) { player.selectScene( parseInt( elSlider.value ) ); };\r\n\t\t\telSlider.oninput = function ( event ) { player.selectScene( parseInt( elSlider.value ) ); };\r\n\r\n\t\t\tvar pointerdown;//, spriteText;\r\n\t\t\tconst player = this;\r\n\t\t\telSlider.addEventListener( 'pointerdown', e => { pointerdown = true; } );\r\n\t\t\telSlider.addEventListener( 'pointerup', e => { pointerdown = false; } );\r\n\t\t\telSlider.addEventListener( 'mousemove', e => {\r\n\r\n\t\t\t\tif ( !pointerdown )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tplayer.selectScene( ( settings.marks - 1 ) * e.offsetX / elSlider.clientWidth );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\treturn elSlider;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets <b>index</b> and <b>title</b> of the slider element of the player's menu.\r\n\t * @function Player.\r\n\t * setIndex\r\n\t * @param {string} index\r\n\t * @param {string} title\r\n\t */\r\n\tthis.setIndex = function ( index, title ) {\r\n\r\n\t\tif ( this.PlayController ) this.PlayController.setValue( this.getTime() );\r\n\t\tconst elSlider = getSliderElement();\r\n\t\tif ( elSlider ) {\r\n\r\n\t\t\telSlider.value = index;\r\n\t\t\telSlider.title = title;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Changes the \"max\" value of the slider of the player's menu. Moves [Player]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html} to the first scene.\r\n\t * @function Player.\r\n\t * onChangeScale\r\n\t * @param {Object} scale See <b>options.settings</b> of the [Player]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html}.\r\n\t */\r\n\tthis.onChangeScale = function ( scale ) {\r\n\r\n\t\tgetSliderElement().max = scale.marks - 1;\r\n\t\tthis.selectScene( 0 );\r\n\r\n\t}\r\n\r\n\tboPlayer = true;\r\n\r\n}\r\n/**\r\n * Is player created?\r\n * @function Player.\r\n * isCreated\r\n */\r\nPlayer.isCreated = function () { return boPlayer; }\r\n\r\nfunction playerCameraTarget() {\r\n\r\n\tconst cameraTargetDefault = { boLook: false, },//По умолчанию не слежу за точкой\r\n\t\t_cameraTarget = {\r\n\r\n\t\t\tboLook: cameraTargetDefault.boLook,\r\n//\t\t\tsetCameraPosition: function(){},если это оставить то не будет обновляться setCameraPosition, когда выбрана точка, на которую смотрит камера\r\n\r\n\t\t};\r\n//\tcameraTargetDefault.boLook = false;\r\n\tcameraTargetDefault.rotation = {};\r\n\t_cameraTarget.rotation = {};\r\n\tvar boTarget = false,//true - target point was detected. For displaying of the console warning if duplicate target point was detected\r\n\t\tboPlayer = false;//true - была попытка получить camera из Player.player. Добавил что бы не выполнялась лишняя работа\r\n\r\n\t//Если определен ( boCameraTargetLook !== undefined ) , то явно было задано следить или не следить за точкой.\r\n\t//Тогда если есть точка, за которой надо следить ( cameraTarget.bodefault === false )\r\n\t//и явно не было задано следить или не следить заточкой  ( boCameraTargetLook === undefined ),\r\n\t//то надо следить за точкой ( cameraTargetDefault.boLook = true )\r\n\tvar boCameraTargetLook;\r\n\t\r\n\t/**\r\n\t * get camera target\r\n\t * @function Player.cameraTarget.\r\n\t * get\r\n\t */\r\n\tthis.get = function () {\r\n\r\n\t\tif ( !_cameraTarget.camera && !boPlayer && Player.player ) {\r\n\r\n\t\t\tcameraTargetDefault.camera = Player.player.getOptions().cameraTarget.camera;\r\n\t\t\tif ( cameraTargetDefault.camera ) setCameraTarget();\r\n\t\t\tboPlayer = true;\r\n\r\n\t\t}\r\n\t\tif ( _cameraTarget.camera )\r\n\t\t\treturn _cameraTarget;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Create default camera target\r\n\t * @function Player.cameraTarget.\r\n\t * init\r\n\t * @param {object} cameraTarget the following cameraTarget are available:\r\n\t * @param {THREE.PerspectiveCamera} [cameraTarget.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n\t * @param {boolean} [cameraTarget.boLook] true - camera look at the target.\r\n\t * @param {THREE.Vector3} [cameraTarget.distanceToCamera] Distance from target point to camera.\r\n\t   * You can set the distance to the camera depending on the time.\r\n\t * <pre>\r\n\t *\tExample 1: new THREE.Vector3( 0, 0, new Function( 't', 'return 2+t' ) )\r\n\t *\tExample 2: new THREE.Vector3( 0, 0,\r\n\t *\t\t[ { t: 0, v: 5 }, { t: 1, v: 2 }, { t: 10, v: 2 }, { t: 11, v: 5 } ] )\r\n\t *\tDefault is camera.position.\r\n\t * </pre>\r\n\t * @param {object} [cameraTarget.rotation] rotation camera around point specified by an axis and an angle. Default is undefined - no rotation\r\n\t * @param {number|function|array} [cameraTarget.rotation.angle=0] Angle of rotation in radians.\r\n\t * <pre>\r\n\t *   number. Example: Math.PI / 2 rotate to 90 degrees.\r\n\t *   function. Example: new Function( 't', 'return 5*t' ).\r\n\t *   array.\r\n\t *     Example 1: [0, Math.PI]\r\n\t *       0 is angle for t = min is start time of the playing.\r\n\t *       Math.PI is rotate to 180 degrees\r\n\t *         for t = max is time of the stopping of the playing.\r\n\t *       If max time is infinity, then angle is for t = min.\r\n\t *     Example 2: [{ t: 0, v: 0 }, { t: 1, v: Math.PI / 2 }\r\n\t *       t is time,\r\n\t *       v is angle for current t.\r\n\t * </pre>\r\n\t * @param {THREE.Vector3} [cameraTarget.rotation.axis] Axis of rotattion.\r\n\t * <pre>\r\n\t *   Example: new THREE.Vector3( 1, 0, 0 ) - rotate around x axis.\r\n\t *   Default is rotate around y axis\r\n\t * </pre>\r\n\t */\r\n\tthis.init = function ( cameraTarget ) {\r\n\r\n\t\t//cameraTargetDefault.boLook = false по умолчанию камера не смотритт на выбранную точку если:\r\n\t\t// 1 ни разу не вызывается init. Тоесть нет настроек cameraTargetDefault и нет ни однойточки, на которую смотрит камера\r\n\t\t// 2 cameraTarget.bodefault !== false и cameraTarget.boLook = false - программист явно запретил смотреть на точку\r\n\r\n\t\t//Если есть хоть одна точка, на которую должна смотреть камера cameraTarget.bodefault === false,\r\n\t\t//то для этой точки не устанавливаем playerCameraTarget.cameraTargetDefault\r\n\t\t//Другими словами если есть точка, на которую должна смотреть камера,\r\n\t\t//то камера будет на нее смотреть если нет запрета смотеть на точку - playerCameraTarget.cameraTargetDefault = false\r\n\t\tif ( cameraTarget.bodefault !== false ) {\r\n\r\n\t\t\tif ( boTarget )\r\n\t\t\t\treturn;//Не надо устанавливать cameraTargetDefault после того,\r\n\t\t\t\t\t//как были устанвлены настройки cameraTargetDefault из точек\r\n\t\t\t\t\t//Иначе натройки точки не будут приоритетными\r\n\r\n\t\t\tif ( cameraTarget.boLook !== undefined ) {\r\n\r\n\t\t\t\tcameraTargetDefault.boLook = cameraTarget.boLook;\r\n\t\t\t\tboCameraTargetLook = cameraTarget.boLook;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( cameraTarget.boLook === true ){\r\n\r\n\t\t\t//Есть точка, за которой надо следить\r\n\r\n\t\t\tif ( boTarget ) console.warn( 'playerCameraTarget().init(...): duplicate target point' );\r\n\t\t\tboTarget = true;\r\n\t\t\t\r\n\t\t\tif ( boCameraTargetLook === undefined )\r\n\t\t\t\tcameraTargetDefault.boLook = true;//запрета на слежение камерой за точкой не было и есть точка, за которой надо следить\r\n\r\n\t\t} else return;\r\n\t\tcameraTargetDefault.camera = cameraTargetDefault.camera || cameraTarget.camera;\r\n\t\tif ( !cameraTargetDefault.camera ) {\r\n\r\n\t\t\tconsole.error( 'playerCameraTarget().init(...): cameraTargetDefault.camera = ' + cameraTargetDefault.camera );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tcameraTargetDefault.distanceToCamera = cameraTargetDefault.distanceToCamera || cameraTarget.distanceToCamera;\r\n\t\tcameraTarget.rotation = cameraTarget.rotation || {};\r\n\t\tcameraTargetDefault.rotation.angle = cameraTargetDefault.rotation.angle || cameraTarget.rotation.angle;\r\n\t\tcameraTargetDefault.rotation.axis = cameraTargetDefault.rotation.axis || cameraTarget.rotation.axis;\r\n\t\tsetCameraTarget( cameraTarget );\r\n\r\n\t}\r\n\tfunction setCameraTarget( cameraTarget ) {\r\n\r\n\t\tif ( !cameraTarget )\r\n\t\t\tcameraTarget = cameraTargetDefault;//У выбранной для слежения точки нет cameraTarget\r\n\t\tif ( cameraTarget.boLook !== undefined )\r\n\t\t\t_cameraTarget.boLook = cameraTarget.boLook;\r\n\t\telse _cameraTarget.boLook = cameraTargetDefault.boLook;\r\n\r\n\t\t_cameraTarget.camera = cameraTarget.camera || cameraTargetDefault.camera;\r\n\r\n//Если в программе не определены функции distanceToCamera (тоесть cameraTarget.distanceToCamera === undefined и cameraTargetDefault.distanceToCamera === undefined),\r\n//то при проигрывании каждый раз distanceToCamera будет равна camera.position\r\n//\t\t_cameraTarget.distanceToCamera = cameraTarget.distanceToCamera || cameraTargetDefault.distanceToCamera || new THREE.Vector3().copy( cameraTargetDefault.camera.position );\r\n\r\n\t\t//Если в программе не определены функции distanceToCamera (тоесть cameraTarget.distanceToCamera === undefined и cameraTargetDefault.distanceToCamera === undefined),\r\n\t\t//То сначала _cameraTarget.distanceToCamera будет равна camera.position, а потом при проигрывании не будет меняться\r\n\t\t_cameraTarget.distanceToCamera =\r\n\t\t\tcameraTarget.distanceToCamera ||\r\n\t\t\tcameraTargetDefault.distanceToCamera ||\r\n\t\t\t_cameraTarget.distanceToCamera ||\r\n\t\t\tnew THREE.Vector3().copy( cameraTargetDefault.camera.position );\r\n\r\n\t\tif ( !cameraTarget.rotation ) cameraTarget.rotation = {};\r\n\t\t_cameraTarget.rotation.angle = cameraTarget.rotation.angle || cameraTargetDefault.rotation.angle || 0;\r\n\t\t_cameraTarget.rotation.axis = cameraTarget.rotation.axis || cameraTargetDefault.rotation.axis || new THREE.Vector3( 0, 1, 0 );//Rotate around y axis\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Set a target point, what camera is look at.\r\n\t * @function Player.cameraTarget.\r\n\t * setTarget\r\n\t * @param {THREE.Mesh} mesh [mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} with selected point as target for camera.\r\n\t*/\r\n\tthis.setTarget = function ( mesh ) {\r\n\r\n\t\tif ( !mesh.geometry )\r\n\t\t\treturn;\r\n\r\n\t\tif ( typeof THREE === 'undefined' ) {\r\n\r\n\t\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst arrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\tif ( arrayFuncs === undefined )\r\n\t\t\treturn;\r\n\t\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\t\tvar funcs = arrayFuncs[i];\r\n\t\t\tPlayer.cameraTarget.changeTarget( mesh, i );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\t/**\r\n\t * Change target.\r\n\t * @function Player.cameraTarget.\r\n\t * changeTarget\r\n\t * @param {THREE.Mesh} mesh [mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} with selected point as target for camera.\r\n\t * @param {number} i index of the point.\r\n\t */\r\n\tthis.changeTarget = function ( mesh, i ) {\r\n\r\n\t\tif ( typeof THREE === 'undefined' ) {\r\n\r\n\t\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst cameraTarget = Player.cameraTarget.get();\r\n//\t\t\tcamera = cameraTarget.camera;\r\n\r\n\t\t//Update cameraTarget\r\n\t\tconst func = mesh.userData.player.arrayFuncs[i];\r\n\t\tif ( !func.cameraTarget )\r\n\t\t\tfunc.cameraTarget = { boLook: false };\r\n\t\tsetCameraTarget( func.cameraTarget );\r\n\r\n\t\tif ( cameraTarget && cameraTarget.boLook ) {\r\n\r\n\t\t\tconst target = getWorldPosition( mesh, new THREE.Vector3().fromArray( mesh.geometry.attributes.position.array, i * mesh.geometry.attributes.position.itemSize ) );\r\n\t\t\tcameraTarget.target = target;\r\n\r\n\t\t} else delete cameraTarget.target;\r\n\r\n\t}\r\n\t/**\r\n\t * Update camera settings.\r\n\t * @function Player.cameraTarget.\r\n\t * setCameraTarget\r\n\t * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n\t * @param {boolean} [update=false] true - camera look at the target.\r\n\t */\r\n\tthis.setCameraTarget = function ( camera, update = false ) {\r\n\r\n\t\tif ( typeof THREE === 'undefined' ) {\r\n\r\n\t\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar cameraTarget = Player.cameraTarget.get();\r\n\t\tif ( !cameraTarget ) cameraTarget = cameraTarget || {};\r\n\t\tcamera = camera || cameraTarget.camera;// || Player.player.getOptions().cameraTarget.camera;\r\n\r\n\t\tif ( !camera )\r\n\t\t\treturn;//В этом приложении невозможно следить за точкой, потому что ни разу не была вызывана Player.cameraTarget.init()\r\n\r\n\t\t//На случай когда не определена ни одна точка как cameraTarget и пользователь поставил птичку в controllerCameraTarget\r\n\t\tif ( !cameraTarget.distanceToCamera )\r\n\t\t\tcameraTarget.distanceToCamera = new THREE.Vector3().copy( camera.position );\r\n\r\n\t\tif ( !cameraTarget.distanceToCameraCur )\r\n\t\t\tcameraTarget.distanceToCameraCur = new THREE.Vector3();\r\n\r\n\t\tconst t = Player.getTime(),\r\n\t\t\tdistanceToCamera = cameraTarget.distanceToCamera;\r\n\t\tcameraTarget.distanceToCameraCur.set(\r\n\r\n\t\t\tPlayer.execFunc( distanceToCamera, 'x', t ),\r\n\t\t\tPlayer.execFunc( distanceToCamera, 'y', t ),\r\n\t\t\tPlayer.execFunc( distanceToCamera, 'z', t )\r\n\r\n\t\t);\r\n\r\n\t\tif ( !cameraTarget.setCameraPosition || update )\r\n\t\t\tcameraTarget.setCameraPosition = function () {\r\n\r\n\t\t\t\tconst target = cameraTarget.target;\r\n\t\t\t\tif ( ( Player.cameraGui && !Player.cameraGui.isLook() ) || !target )\r\n\t\t\t\t\treturn;//Камере не нужно следить за выбранной точкой или ни одна точка не определена как target\r\n\r\n\t\t\t\tconst t = Player.getTime();\r\n\t\t\t\tcamera.position.copy( cameraTarget.distanceToCameraCur );\r\n\t\t\t\tcamera.position.applyAxisAngle( cameraTarget.rotation.axis, Player.execFunc( cameraTarget.rotation, 'angle', t ) );\r\n\t\t\t\tcamera.position.add( target );\r\n\t\t\t\tcamera.lookAt( target );\r\n\t\t\t\tif ( Player.orbitControls ) {\r\n\r\n\t\t\t\t\tPlayer.orbitControls.target.copy( target );\r\n\t\t\t\t\tif ( Player.orbitControlsGui )\r\n\t\t\t\t\t\tPlayer.orbitControlsGui.setTarget( target );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t}\r\n\r\n}\r\n/**\r\n * Camera look at selected point\r\n * @function Player.\r\n * cameraTarget\r\n */\r\nPlayer.cameraTarget = new playerCameraTarget();\r\n/* *\r\n * set camera target\r\n * @function Player.\r\n * setPlayerCameraTarget\r\n * @param {object} options the following options are available:\r\n * @param {THREE.PerspectiveCamera} [options.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n * @param {object} [options.funcs] item of the arrayFuncs. See Player.getPoints(...) for details.\r\n */\r\n/*\r\nPlayer.setPlayerCameraTarget = function ( options ) {\r\n\r\n\tconst funcs = options.funcs;\r\n//\tconst boLook = Player.cameraTarget2 && ( Player.cameraTarget2.boLook !== undefined ) ? Player.cameraTarget2.boLook : true;//по умолчанию камера следит за точкой если для нее определен cameraTarget\r\n\tPlayer.cameraTarget2 = Player.cameraTarget2 || funcs.vector.cameraTarget;\r\n\tPlayer.cameraTarget2.boLook = Player.cameraTarget2.boLook !== undefined ? Player.cameraTarget2.boLook : true;//по умолчанию камера следит за точкой если для нее определен cameraTarget\r\n\tPlayer.cameraTarget2.camera = Player.cameraTarget2.camera || funcs.vector.cameraTarget.camera;\r\n\tif ( !Player.cameraTarget2.camera ) {\r\n\r\n\t\tconsole.error( 'Player.getPoints: Player.cameraTarget2.camera = ' + Player.cameraTarget2.camera );\r\n\t\treturn;\r\n\r\n\t}\r\n\t//\t\t\t\tPlayer.cameraTarget2.boLook = boLook;\r\n\tif ( Player.cameraTarget2.ready ) console.warn( 'Player.getPoints: duplicate cameraTarget' );\r\n\tPlayer.cameraTarget2.ready = true;\r\n\r\n\tPlayer.cameraTarget2.distanceToCamera = Player.cameraTarget2.distanceToCamera || ( funcs.vector.cameraTarget.distanceToCamera ?\r\n\t\tfuncs.vector.cameraTarget.distanceToCamera : new THREE.Vector3().copy( Player.cameraTarget2.camera.position ) );\r\n\t//\t\t\t\tPlayer.setPlayerCameraTarget( undefined, funcs );\r\n\t//\t\t\t\tPlayer.cameraTarget2.rotation = funcs.vector.cameraTarget.rotation || Player.cameraTarget2.rotation;\r\n\tPlayer.cameraTarget2.rotation = Player.cameraTarget2.rotation || funcs.vector.cameraTarget.rotation;\r\n\tif ( Player.cameraTarget2.rotation ) {\r\n\r\n\t\tif ( Player.cameraTarget2.rotation.angle === undefined )\r\n\t\t\tPlayer.cameraTarget2.rotation.angle = 0;\r\n\t\t//\t\t\t\t\t\tPlayer.cameraTarget2.rotation.angle = new Function( 't', 'return t' );\r\n\t\tPlayer.cameraTarget2.rotation.axis = Player.cameraTarget2.rotation.axis || new THREE.Vector3( 0, 1, 0 );//Rotate around y axis\r\n\r\n\t}\r\n\r\n}\r\n*/\r\n/**\r\n * execute function\r\n * @function Player.\r\n * execFunc\r\n * @param {THREE.Vector4} funcs\r\n * @param {string} axisName axis name\r\n * @param {number} t time\r\n * @param {number} [a=1] multiplier. Second parameter of the arrayFuncs item function.\r\n * @param {number} [b=0] addendum. Third parameter of the arrayFuncs item function.\r\n */\r\nPlayer.execFunc = function ( funcs, axisName, t, a = 1, b = 0 ) {\r\n\r\n\tvar func = funcs[axisName], typeofFuncs = typeof func;\r\n\tif ( typeof t === \"undefined\" ) t = settings.min;\r\n\tswitch ( typeofFuncs ) {\r\n\r\n\t\tcase \"undefined\":\r\n\t\t\treturn undefined;\r\n\t\tcase \"string\":\r\n\t\t\tfunc = new Function( 't', 'a', 'b', 'return ' + func );\r\n\t\tcase \"function\":\r\n\t\t\ttry {\r\n\r\n\t\t\t\tconst res = func( t, a, b );\r\n\t\t\t\tif ( res === undefined )\r\n\t\t\t\t\tthrow 'function returns ' + res;\r\n\t\t\t\treturn res;\r\n\r\n\t\t\t} catch( e ) {\r\n\r\n\t\t\t\tconsole.error( e );\r\n\t\t\t\tthrow e;\r\n//\t\t\t\talert( 'Player.execFunc(): axis: ' + axisName + '. ' + e );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\tcase \"number\":\r\n\t\t\treturn func;\r\n\t\tcase \"object\":\r\n\t\t\tif ( Array.isArray( func ) ) {\r\n\r\n\t\t\t\tif ( func.length === 0 ) {\r\n\r\n\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array is empty' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst a = func,\r\n\t\t\t\t\tl = func.length - 1,\r\n\t\t\t\t\tmax = settings.max === null ? Infinity : settings.max,\r\n\t\t\t\t\tmin = settings.min,\r\n\t\t\t\t\ttStep = ( max - min ) / l;\r\n\t\t\t\tvar tStart = min, tStop = max,\r\n\t\t\t\t\tiStart = 0, iStop = l;\r\n\t\t\t\tfor ( var i = 0; i < func.length; i++ ) {\r\n\r\n\t\t\t\t\tif ( tStep * i + min < t ) {\r\n\r\n\t\t\t\t\t\tiStart = i;\r\n\t\t\t\t\t\tiStop = i + 1;\r\n\t\t\t\t\t\ttStart = tStep * iStart + min;\r\n\t\t\t\t\t\ttStop = tStep * iStop + min;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfunction execW( i ) {\r\n\r\n\t\t\t\t\tif ( typeof a[i] === \"function\" )\r\n\t\t\t\t\t\treturn a[i]( t, a, b );\r\n\t\t\t\t\tif ( a[i] instanceof THREE.Color )\r\n\t\t\t\t\t\treturn a[i];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( typeof a[iStart] !== \"number\" ) {\r\n\r\n\t\t\t\t\tif ( axisName === 'w' ) {\r\n\r\n\t\t\t\t\t\treturn execW( iStart );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( typeof a[iStart] === \"object\" ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < func.length; i++ ){\r\n\r\n\t\t\t\t\t\t\tif ( i === ( func.length - 1 ) ) return a[i].v;\r\n\r\n\t\t\t\t\t\t\tiStart = i; iStop = i + 1;\r\n\t\t\t\t\t\t\ttStart = a[iStart].t; tStop = a[iStop].t;\r\n\t\t\t\t\t\t\tif ( ( tStart <= t ) && ( tStop > t ) ) {\r\n\r\n\t\t\t\t\t\t\t\tvar x = ( a[iStop].v - a[iStart].v ) / ( tStop - tStart ),\r\n\t\t\t\t\t\t\t\t\ty = a[iStart].v - x * tStart;\r\n\t\t\t\t\t\t\t\treturn x * t + y;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: value is not detected' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array item ' + iStart + ' typeof = ' + ( typeof a[iStart] ) + ' is not number' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( iStop >= func.length ) iStop = iStart;\r\n\t\t\t\tif ( typeof a[iStop] !== \"number\" ) {\r\n\r\n\t\t\t\t\tif ( axisName === 'w' )\r\n\t\t\t\t\t\treturn execW( iStop );\r\n\t\t\t\t\tif ( typeof a[iStop] !== \"object\" ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array item ' + iStop + ' typeof = ' + ( typeof a[iStop] ) + ' is not number' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tvar x = ( a[iStop] - a[iStart] ) / ( tStop - tStart ),\r\n\t\t\t\t\ty = a[iStart] - x * tStart;\r\n\t\t\t\tif ( isNaN( x ) || isNaN( y ) ) console.error( 'Player.execFunc: invalid x = ' + x + ' or y = ' + y );\r\n\t\t\t\treturn x * t + y;\r\n\r\n\t\t\t}\r\n\t\t\tif ( func.func )\r\n\t\t\t\treturn func.func instanceof Function ? func.func( t, a, b ) : func.func;\r\n\t\t\tif ( axisName !== 'w' )\r\n\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] object is not array' );\r\n\t\t\treturn func;\r\n\t\tdefault:\r\n\t\t\tconsole.error( 'Player.execFunc: Invalud typeof funcs[\"' + axisName + '\"]: ' + typeofFuncs );\r\n\t}\r\n\treturn;\r\n\r\n}\r\n\r\nfunction palette() {\r\n\r\n\tvar paletteDefault;\r\n\tthis.get = function() {\r\n\r\n\t\tif ( selectPlaySceneOptions && selectPlaySceneOptions.palette )\r\n\t\t\treturn selectPlaySceneOptions.palette;\r\n\t\t\t\r\n\t\tif ( !paletteDefault )\r\n\t\t\tpaletteDefault = new ColorPicker.palette();\r\n\t\treturn paletteDefault;\r\n\r\n\t}\r\n\r\n}\r\npalette = new palette();\r\n/**\r\n * Select a scene for playing of the mesh\r\n * @function Player.\r\n * selectMeshPlayScene\r\n * @param {THREE.Mesh} mesh [mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} for playing.\r\n * @param {number} [t=0] time\r\n * @param {number} [index=0] index of the time.\r\n * @param {object} [options] the following options are available:\r\n * @param {boolean} [options.boPlayer] true - is not select play scene for mesh.userData.boFrustumPoints = true. Default is false.\r\n * @param {number} [options.a] multiplier. Second parameter of the arrayFuncs item function. Default is 1.\r\n * @param {number} [options.b] addendum. Third parameter of the arrayFuncs item function. Default is 0.\r\n * @param {object} [options.scales] axes scales. See {@link https://raw.githack.com/anhr/AxesHelper/master/jsdoc/module-AxesHelper.html|AxesHelper}. Default is {}\r\n * @param {object} [options.palette=new ColorPicker.palette();//palette: ColorPicker.paletteIndexes.BGRW] See [ColorPicker.palette]{@link https://raw.githack.com/anhr/colorPicker/master/jsdoc/module-ColorPicker.html#~Palette}.\r\n * @param {object} [options.point={}] point settings. Applies to points with ShaderMaterial.\r\n * <pre>\r\n * See [ShaderMaterial]{@link https://threejs.org/docs/index.html#api/en/materials/ShaderMaterial} for details.\r\n * The size of the point seems constant and does not depend on the distance to the camera.\r\n * </pre>\r\n * @param {number} [options.point.size=0.02] The apparent angular size of a point in radians.\r\n*/\r\nPlayer.selectMeshPlayScene = function ( /*THREE, */mesh, t, index, options ) {\r\n\r\n\tif ( typeof THREE === 'undefined' ) {\r\n\r\n\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\tif ( t === undefined ) t = Player.getSettings().min;\r\n\tindex = index || 0;\r\n\toptions = options || selectPlaySceneOptions || {};\r\n\toptions.scales = options.scales || {};\r\n\tif (\r\n\r\n\t\t!mesh.userData.player ||\r\n\t\t( options && options.boPlayer && mesh.userData.boFrustumPoints )\r\n\r\n\t)\r\n\t\treturn;\r\n\r\n\t//Эти строки нужны что бы появлялся текст возле точки, если на нее наведена мышка\r\n\t//при условии, что до этого точка была передвинута с помошью проигрывателя.\r\n\tif ( mesh.geometry ) {//scene do not have geometry\r\n\r\n\t\tdelete mesh.geometry.boundingSphere;\r\n\t\tmesh.geometry.boundingSphere = null;\r\n\r\n\t}\r\n\r\n\tif ( mesh.userData.player.selectPlayScene ) {\r\n\r\n\t\tmesh.userData.player.selectPlayScene( t );\r\n\r\n\t\t//если не приводить угол поворота в диапазон 0 - 360 градусов,\r\n\t\t//то угол поворота будет равен нулю или Math.PI * 2\r\n\t\t//когда пользователь выберет mesh в guiSelectPoint.js\r\n\t\t//потому что в органе управления угла поворота угол поворота ограничен 0 - 360 градусов,\r\n\t\t//смотри строку\r\n\t\t//cRotations[name] = fRotation.add( new THREE.Vector3(), name, 0, Math.PI * 2, 1 / 360 ).\r\n\t\t//в guiSelectPoint\r\n\t\tfunction setRotation( axisName ) {\r\n\r\n\t\t\twhile ( mesh.rotation[axisName] < 0 ) mesh.rotation[axisName] += Math.PI * 2;\r\n\t\t\twhile ( mesh.rotation[axisName] > Math.PI * 2 ) mesh.rotation[axisName] -= Math.PI * 2;\r\n\r\n\t\t}\r\n\t\tsetRotation( 'x' );\r\n\t\tsetRotation( 'y' );\r\n\t\tsetRotation( 'z' );\r\n\t\t\r\n\t}\r\n\r\n\tfunction setAttributes( a, b ) {\r\n\r\n\t\tif ( !mesh.geometry )\r\n\t\t\treturn;\r\n\t\t\t\r\n\t\tconst attributes = mesh.geometry.attributes,\r\n\t\t\tarrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\tif ( arrayFuncs === undefined )\r\n\t\t\treturn;\r\n\t\tif ( t === undefined )\r\n\t\t\tconsole.error( 'setPosition: t = ' + t );\r\n\r\n\t\tvar min, max;\r\n\t\tif ( options && ( options.scales.w !== undefined ) ) {\r\n\r\n\t\t\tmin = options.scales.w.min; max = options.scales.w.max;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmax = value;\r\n\t\t\tmin = max - 1;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\t\tvar funcs = arrayFuncs[i], needsUpdate = false;\r\n\t\t\tfunction setPosition( axisName, fnName ) {\r\n\r\n\t\t\t\tvar value = Player.execFunc( funcs, axisName, t, a, b );\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\tattributes.position[fnName]( i, value );\r\n\t\t\t\t\tneedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tsetPosition( 'x', 'setX' );\r\n\t\t\tsetPosition( 'y', 'setY' );\r\n\t\t\tsetPosition( 'z', 'setZ' );\r\n\r\n\t\t\t//если тут поставить var то цвет точки, которая определена как THREE.Vector3 будет равет цвету предыдущей точки\r\n\t\t\t//потому что перемнные типа var видны снаружи блока {}\r\n\t\t\tlet color;\r\n\r\n\t\t\tfunction getColor() {\r\n\r\n\t\t\t\tif ( mesh.userData.player.palette )\r\n\t\t\t\t\tcolor = mesh.userData.player.palette.toColor( value, min, max );\r\n\t\t\t\telse if ( options.palette )\r\n\t\t\t\t\tcolor = options.palette.toColor( value, min, max );\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tconst c = { r: 255, g: 255, b: 255 };\r\n\t\t\t\t\tcolor = new THREE.Color( \"rgb(\" + c.r + \", \" + c.g + \", \" + c.b + \")\" );\r\n\t\t\t\t\treturn color;\r\n/*\t\t\t\t\r\n\t\t\t\t\tColorPicker.palette.setTHREE( THREE );\r\n\t\t\t\t\tcolor = palette.get().toColor( value, min, max );\r\n*/\t\t\t\t\t\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( typeof funcs.w === \"function\" ) {\r\n\r\n\t\t\t\tvar value = funcs.w( t, a, b );\r\n\t\t\t\tif ( options.scales.w ) {\r\n\r\n\t\t\t\t\tmin = options.scales.w.min;\r\n\t\t\t\t\tmax = options.scales.w.max;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmin = 0;\r\n\t\t\t\t\tmax = 100;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( attributes.position.itemSize >= 4 )\r\n\t\t\t\t\tattributes.position.setW( i, value );\r\n\t\t\t\tneedsUpdate = true;\r\n\r\n\t\t\t\tgetColor();\r\n\r\n\t\t\t} else if ( typeof funcs.w === \"object\" ) {\r\n\r\n\t\t\t\tif ( funcs.w instanceof THREE.Color )\r\n\t\t\t\t\tcolor = funcs.w;\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tvar value = funcs.w.func( t, a, b );\r\n\t\t\t\t\tif ( funcs.w.min !== 'undefined' ) min = funcs.w.min;\r\n\t\t\t\t\tif ( funcs.w.max !== 'undefined' ) max = funcs.w.max;\r\n\t\t\t\t\tgetColor();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( ( typeof funcs.w === \"number\" ) && options.palette )\r\n\t\t\t\tcolor = options.palette.toColor( funcs.w, min, max );\r\n\t\t\tif ( color ) {\r\n\r\n\t\t\t\tif ( !mesh.material instanceof THREE.ShaderMaterial && mesh.material.vertexColors !== THREE.VertexColors )\r\n\t\t\t\t\tconsole.error( 'Player.selectPlayScene: Please set the vertexColors parameter of the THREE.PointsMaterial of your points to THREE.VertexColors. Example: vertexColors: THREE.VertexColors' );\r\n\t\t\t\tif ( !Player.setColorAttribute( attributes, i, color ) && funcs instanceof THREE.Vector4 ) {\r\n\r\n\t\t\t\t\tmesh.geometry.setAttribute( 'color',\r\n\t\t\t\t\t\tnew THREE.Float32BufferAttribute( Player.getColors( /*THREE, */arrayFuncs,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tpositions: mesh.geometry.attributes.position,\r\n\t\t\t\t\t\t\t\tscale: { min: min, max: max },\r\n\t\t\t\t\t\t\t\tpalette: options.palette,\r\n\r\n\t\t\t\t\t\t\t} ), 4 ) );\r\n//\t\t\t\t\t\t\t} ), 3 ) );//кажется тут ошибочно поставил itemSize = 3\r\n\t\t\t\t\tif ( !Player.setColorAttribute( attributes, i, color ) )\r\n\t\t\t\t\t\tconsole.error( 'Player.selectPlayScene: the color attribute is not exists. Please use THREE.Vector3 instead THREE.Vector4 in the arrayFuncs or add \"color\" attribute' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tif ( needsUpdate )\r\n\t\t\t\tattributes.position.needsUpdate = true;\r\n\r\n\t\t\tif ( funcs.line !== undefined )\r\n\t\t\t\tfuncs.line.addPoint( mesh, i/*getObjectPosition( mesh, i ), index*/, color );\r\n//\t\t\tcameraTarget( /*THREE, */mesh, funcs, t, i );\r\n//\t\t\tPlayer.cameraTarget.changeTarget( mesh, funcs, t, i );\r\n\t\t\tif ( funcs.cameraTarget && ( funcs.cameraTarget.boLook === true ) )\r\n\t\t\t\tPlayer.cameraTarget.changeTarget( mesh, i );\r\n\r\n\t\t};\r\n\r\n\t}\r\n\tsetAttributes( options ? options.a : 1, options ? options.b : 0 );\r\n\tconst message = 'Player.selectPlayScene: invalid mesh.scale.';\r\n\tif ( mesh.scale.x <= 0 ) console.error( message + 'x = ' + mesh.scale.x );\r\n\tif ( mesh.scale.y <= 0 ) console.error( message + 'y = ' + mesh.scale.y );\r\n\tif ( mesh.scale.z <= 0 ) console.error( message + 'z = ' + mesh.scale.z );\r\n\r\n\tif ( !options || !options.guiSelectPoint )\r\n\t\treturn;\r\n\r\n\toptions.guiSelectPoint.setMesh();\r\n\r\n\tvar selectedPointIndex = options.guiSelectPoint.getSelectedPointIndex();\r\n\tif ( ( selectedPointIndex !== -1 ) && options.guiSelectPoint.isSelectedMesh( mesh ) ) {\r\n\r\n\t\toptions.guiSelectPoint.setPosition( getObjectPosition( mesh, selectedPointIndex ), {\r\n\r\n\t\t\tobject: mesh,\r\n\t\t\tindex: selectedPointIndex,\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * set color attribute \r\n * @function Player.\r\n * setColorAttribute\r\n * @param {Object} attributes geometry.attributes of the mesh\r\n * @param {number} i index of the arrayFuncs.\r\n * @param {THREE.Color} color color.\r\n * @returns true - success\r\n * <p>false - colorAttribute was not detected.</p>\r\n */\r\nPlayer.setColorAttribute = function ( attributes, i, color ) {\r\n\r\n\tif ( typeof color === \"string\" )\r\n\t\tcolor = new THREE.Color( color );\r\n\tconst colorAttribute = attributes.color || attributes.ca;\r\n\tif ( colorAttribute === undefined )\r\n\t\treturn false;\r\n\tcolorAttribute.setX( i, color.r );\r\n\tcolorAttribute.setY( i, color.g );\r\n\tcolorAttribute.setZ( i, color.b );\r\n\tcolorAttribute.needsUpdate = true;\r\n\treturn true;\r\n\r\n}\r\n\r\n/**\r\n * Get array of THREE.Vector4 points.\r\n * @function Player.\r\n * getPoints\r\n * @param {THREE.Vector4|THREE.Vector3|THREE.Vector2|object|array} arrayFuncs points.geometry.attributes.position array\r\n * <pre>\r\n * THREE.Vector4: 4D point.\r\n * THREE.Vector3: 3D point. w = 1. Default is white color\r\n * THREE.Vector2: 2D point. w = 1, z = 0. Default is white color\r\n * Vector's x, y, z, w is position of the point.\r\n * Can be as:\r\n * <ul>\r\n * <li>float - position of the point.</li>\r\n * Example: 0.5\r\n * <li>[float] - array of positions of the point.</li>\r\n * Example 1: [0.6, 0, -0.5]\r\n * 0.6 is positon for t = min is start time of the playing.\r\n * 0 is position for t = ( max - min ) / 2\r\n * -0.5 is positon for t = max is stop time of the playing.\r\n * If stop time of the playing is infinity, then position is equal to the first item of the array or 0.6 in the example 1.\r\n * \r\n * Example 2: [{ t: 0, v: 0.6 }, { t: 1, v: -0.6 }]\r\n * Every item of array is object with:\r\n * t is time\r\n * v is position for current t.\r\n * <li>[Function]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} - position of the point is function of the t.\r\n * Example: new Function( 't', 'a', 'b', 'return Math.sin(t*a*2*Math.PI)*0.5+b' )</li>\r\n * <li>string - text of the function.\r\n * Example: 'Math.sin(t*a*2*Math.PI)*0.5+b' )</li>\r\n * </ul>\r\n * Vector.w is index of the [palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * Default range of the Vector.w is from 0 to 100. You can change range by use an object:\r\n * {\r\n *   func: Vector.w\r\n *   max: new max value of tne Vector.w\r\n *   min: new min value of tne Vector.w\r\n * }\r\n * Example:\r\n * {\r\n *\r\n *   func: new Function( 't', 'return 1-2*t' ),\r\n *   min: -1,\r\n *   max: 1,\r\n *\r\n * }\r\n * Vector.w can be as THREE.Color. Example: new THREE.Color( \"rgb(255, 127, 0)\" )\r\n *\r\n * object: {\r\n *   vector: THREE.Vector4|THREE.Vector3|THREE.Vector2 - point position\r\n *   [name]: point name. Default is undefined.\r\n *   [trace]: true - displays the trace of the point movement. Default is undefined.\r\n *   \r\n *   //You can set the camera to look at a point. Use <b>cameraTarget</b> key for it.\r\n *   //ATTENTION!!! Only one point can have <b>cameraTarget</b> key!\r\n *   //   You will receive the \r\n *   \r\n *   //      Player.getPoints: duplicate cameraTarget\r\n *   \r\n *   //   console warning if two or more points have <b>cameraTarget</b> key.\r\n *   //   Then only last point with <b>cameraTarget</b> key will be have an effect.\r\n *   [cameraTarget]: {\r\n *\r\n *      camera: [camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera},\r\n *      \r\n *      //rotation camera around point specified by an axis and an angle. Default is undefined - no rotation\r\n *      [rotation]: {\r\n *      \r\n *         [angle]: number|function|array. Angle of rotation in radians.\r\n *            number. Example: Math.PI / 2 rotate to 90 degrees.\r\n *            function. Example: new Function( 't', 'return 5*t' ).\r\n *            array. Example 1: [0, Math.PI]\r\n *                  0 is angle for t = min is start time of the playing.\r\n *                  Math.PI is rotate to 180 degrees for t = max is time of the stopping of the playing.\r\n *                  If max time is infinity, then angle is for t = min.\r\n *               Example 2: [{ t: 0, v: 0 }, { t: 1, v: Math.PI / 2 }\r\n *                  t is time,\r\n *                  v is angle for current t.\r\n *            \r\n *            Default is 0\r\n *\r\n *         [axis]: THREE.Vector3. Axis of rotattion. Example: new THREE.Vector3( 1, 0, 0 ) - rotate around x axis.\r\n *            Default is new THREE.Vector3( 0, 1, 0 );//Rotate around y axis\r\n *            \r\n *      },\r\n *      \r\n *      [distanceToCamera]: THREE.Vector3. Distance from point to camera.\r\n *         You can set the distance to the camera depending on the time.\r\n *         Example 1: new THREE.Vector3( 0, 0, new Function( 't', 'return 2+t' ) )\r\n *         Example 2: new THREE.Vector3( 0, 0, [{ t: 0, v: 5 }, { t: 1, v: 2 }, { t: 10, v: 2 }, { t: 11, v: 5 }] )\r\n *         Default is camera.position.\r\n *      [orbitControls]: [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}. Change the OrbitControl setting during playing.\r\n *      [orbitControlsGui]: [OrbitControlsGui]{@link https://raw.githack.com/anhr/commonNodeJS/master/jsdoc/OrbitControlsGui/index.html} instance;\r\n *\r\n *   },\r\n *\r\n * }\r\n * or\r\n * object: {\r\n *   x: x axis. Defauilt is 0.\r\n *   y: y axis. Defauilt is 0.\r\n *   z: z axis. Defauilt is 0.\r\n *   w: w axis. Defauilt is 0.\r\n * }\r\n *\r\n * array: [\r\n *   0: x axis. Defauilt is 0.\r\n *   1: y axis. Defauilt is 0.\r\n *   2: z axis. Defauilt is 0.\r\n *   3: w axis. Defauilt is 0.\r\n * ]\r\n * </pre>\r\n * @param {object} [optionsPoints] followed optionsPoints is available\r\n * @param {THREE.Group} [optionsPoints.group] {@link https://threejs.org/docs/index.html#api/en/objects/Group|Group}\r\n * or {@link https://threejs.org/docs/index.html#api/en/scenes/Scene|Scene}.\r\n * Use only if you want trace lines during playing. See trace of the arrayFuncs param above.\r\n * Default is undefined.\r\n * @param {number} [optionsPoints.t] first parameter of the arrayFuncs item function. Start time of animation. Default is 0.\r\n * @param {object} [optionsPoints.options] the following options are available\r\n * @param {number} [optionsPoints.options.a] multiplier. Second parameter of the arrayFuncs item function. Default is 1.\r\n * @param {number} [optionsPoints.options.b] addendum. Third parameter of the arrayFuncs item function. Default is 0.\r\n * @param {object} [optionsPoints.options.player] See Player method above.\r\n * @returns array of THREE.Vector4 points.\r\n */\r\nPlayer.getPoints = function ( /*THREE, */arrayFuncs, optionsPoints ) {\r\n\r\n\tif ( typeof THREE === 'undefined' ) {\r\n\r\n\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\tGuiSelectPoint.setTHREE( THREE );\r\n\t\r\n\toptionsPoints = optionsPoints || {};\r\n\tif ( optionsPoints.t === undefined ) optionsPoints.t = optionsPoints.options ? optionsPoints.options.player.player.getOptions().settings.min : 0;\r\n\tconst options = optionsPoints.options || {},\r\n\t\ta = options.a || 1,\r\n\t\tb = options.b || 0;\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar item = arrayFuncs[i];\r\n\t\tif ( Array.isArray( item ) )\r\n\t\t\tarrayFuncs[i] = new THREE.Vector4(\r\n\r\n\t\t\t\titem[0] === undefined ? 0 : item[0],\r\n\t\t\t\titem[1] === undefined ? 0 : item[1],\r\n\t\t\t\titem[2] === undefined ? 0 : item[2],\r\n\t\t\t\titem[3] === undefined ? 0 : item[3]\r\n\r\n\t\t\t);\r\n\t\telse if (\r\n\r\n\t\t\t( typeof item === \"object\" )\r\n\t\t\t&& ( item instanceof THREE.Vector2 === false )\r\n\t\t\t&& ( item instanceof THREE.Vector3 === false )\r\n\t\t\t&& ( item instanceof THREE.Vector4 === false )\r\n\r\n\t\t) {\r\n\r\n\t\t\tif ( ( item.vector === undefined ) )\r\n\t\t\t\tarrayFuncs[i] = new THREE.Vector4(\r\n\r\n\t\t\t\t\titem.x === undefined ? 0 : item.x,\r\n\t\t\t\t\titem.y === undefined ? 0 : item.y,\r\n\t\t\t\t\titem.z === undefined ? 0 : item.z,\r\n\t\t\t\t\titem.w === undefined ? 0 : item.w\r\n\r\n\t\t\t\t);\r\n\t\t\telse if (\r\n\r\n\t\t\t\t( item.vector instanceof THREE.Vector2 === true )\r\n\t\t\t\t|| ( item.vector instanceof THREE.Vector3 === true )\r\n\t\t\t\t|| ( item.vector instanceof THREE.Vector4 === true )\r\n\r\n\t\t\t) {\r\n\r\n\t\t\t\tif ( item.vector instanceof THREE.Vector2 === true )\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector3(\r\n\r\n\t\t\t\t\t\titem.vector.x === undefined ? 0 : item.vector.x,\r\n\t\t\t\t\t\titem.vector.y === undefined ? 0 : item.vector.y,\r\n\t\t\t\t\t\titem.vector.z === undefined ? 0 : item.vector.z,\r\n\r\n\t\t\t\t\t);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( item.vector.length === 4 )\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector4(\r\n\r\n\t\t\t\t\t\titem.vector[0] === undefined ? 0 : item.vector[0],\r\n\t\t\t\t\t\titem.vector[1] === undefined ? 0 : item.vector[1],\r\n\t\t\t\t\t\titem.vector[2] === undefined ? 0 : item.vector[2],\r\n\t\t\t\t\t\titem.vector[3] === undefined ? 0 : item.vector[3]\r\n\r\n\t\t\t\t\t);\r\n\t\t\t\telse if ( item.vector.length === 3 )\r\n\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector3(\r\n\r\n\t\t\t\t\t\titem.vector[0] === undefined ? 0 : item.vector[0],\r\n\t\t\t\t\t\titem.vector[1] === undefined ? 0 : item.vector[1],\r\n\t\t\t\t\t\titem.vector[2] === undefined ? 0 : item.vector[2],\r\n\r\n\t\t\t\t\t);\r\n\t\t\t\telse console.error( 'options.getPoints(...) falied! item.vector.length = ' + item.vector.length );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\tconst points = [];\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar funcs = arrayFuncs[i];\r\n\t\tfunction getAxis( axisName ) {\r\n\r\n\t\t\tif ( typeof funcs === \"number\" )\r\n\t\t\t\tfuncs = new THREE.Vector4( funcs, 0, 0, 0 );\r\n\t\t\tif ( ( funcs instanceof THREE.Vector2 ) || ( funcs instanceof THREE.Vector3 ) || ( funcs instanceof THREE.Vector4 ) ) {\r\n\r\n\t\t\t\tconst value = Player.execFunc( funcs, axisName, optionsPoints.t, a, b );\r\n/*\t\t\t\t\r\n\t\t\t\tif ( value === undefined ) {\r\n\r\n\t\t\t\t\tif ( axisName === 'w' )\r\n\t\t\t\t\t\treturn 1;//white color\r\n\t\t\t\t\telse console.error( 'Player.getPoints.getAxis(' + axisName + '): value = ' + value );\r\n\r\n\t\t\t\t}\r\n*/\t\t\t\t\r\n\t\t\t\treturn value;\r\n\r\n\t\t\t}\r\n\t\t\tif ( funcs.vector === undefined ) {\r\n\r\n\t\t\t\tconsole.error( 'options.getPoints: funcs.vector = ' + funcs.vector );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tif ( funcs.name !== undefined )\r\n\t\t\t\tfuncs.vector.name = funcs.name;\r\n\t\t\tif ( funcs.trace ) funcs.vector.line = new Player.traceLine( /*THREE, optionsPoints.group, */options );\r\n\t\t\tif ( funcs.cameraTarget ) {\r\n\r\n\t\t\t\tfuncs.vector.cameraTarget = funcs.cameraTarget;\r\n//\t\t\t\tfuncs.cameraTarget = undefined;\r\n\t\t\t\tdelete funcs.cameraTarget;\r\n//\t\t\t\tPlayer.cameraTargetPoint = funcs.vector.cameraTarget;\r\n//\t\t\t\tPlayer.cameraTarget.init( { funcs: funcs, } );\r\n\r\n\t\t\t\tfuncs.vector.cameraTarget.bodefault = false;\r\n\t\t\t\tif ( funcs.vector.cameraTarget.boLook === undefined ) funcs.vector.cameraTarget.boLook = true;\r\n\r\n\t\t\t\tPlayer.cameraTarget.init( funcs.vector.cameraTarget );\r\n//\t\t\t\tPlayer.cameraTarget.init( { funcs : funcs } );\r\n//\t\t\t\tPlayer.setPlayerCameraTarget( { funcs: funcs, } );\r\n/*\t\t\t\t\r\n//\t\t\t\tconst boLook = Player.cameraTarget2 && ( Player.cameraTarget2.boLook !== undefined ) ? Player.cameraTarget2.boLook : true;//по умолчанию камера следит за точкой если для нее определен cameraTarget\r\n\t\t\t\tPlayer.cameraTarget2 = Player.cameraTarget2 || funcs.vector.cameraTarget;\r\n\t\t\t\tPlayer.cameraTarget2.boLook = Player.cameraTarget2.boLook !== undefined ? Player.cameraTarget2.boLook : true;//по умолчанию камера следит за точкой если для нее определен cameraTarget\r\n\t\t\t\tPlayer.cameraTarget2.camera = Player.cameraTarget2.camera || funcs.vector.cameraTarget.camera;\r\n\t\t\t\tif ( !Player.cameraTarget2.camera ) {\r\n\r\n\t\t\t\t\tconsole.error( 'Player.getPoints: Player.cameraTarget2.camera = ' + Player.cameraTarget2.camera );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n//\t\t\t\tPlayer.cameraTarget2.boLook = boLook;\r\n\t\t\t\tif ( Player.cameraTarget2.ready ) console.warn( 'Player.getPoints: duplicate cameraTarget' );\r\n\t\t\t\tPlayer.cameraTarget2.ready = true;\r\n\r\n\t\t\t\tPlayer.cameraTarget2.distanceToCamera = Player.cameraTarget2.distanceToCamera || ( funcs.vector.cameraTarget.distanceToCamera ?\r\n\t\t\t\t\tfuncs.vector.cameraTarget.distanceToCamera : new THREE.Vector3().copy( Player.cameraTarget2.camera.position ) );\r\n//\t\t\t\tPlayer.setPlayerCameraTarget( undefined, funcs );\r\n//\t\t\t\tPlayer.cameraTarget2.rotation = funcs.vector.cameraTarget.rotation || Player.cameraTarget2.rotation;\r\n\t\t\t\tPlayer.cameraTarget2.rotation = Player.cameraTarget2.rotation || funcs.vector.cameraTarget.rotation;\r\n\t\t\t\tif ( Player.cameraTarget2.rotation ) {\r\n\r\n\t\t\t\t\tif ( Player.cameraTarget2.rotation.angle === undefined )\r\n\t\t\t\t\t\tPlayer.cameraTarget2.rotation.angle = 0;\r\n//\t\t\t\t\t\tPlayer.cameraTarget2.rotation.angle = new Function( 't', 'return t' );\r\n\t\t\t\t\tPlayer.cameraTarget2.rotation.axis = Player.cameraTarget2.rotation.axis || new THREE.Vector3( 0, 1, 0 );//Rotate around y axis\r\n\r\n\t\t\t\t}\r\n*/\t\t\t\t\r\n\r\n\t\t\t}\r\n\t\t\tarrayFuncs[i] = funcs.vector;\r\n\t\t\tfuncs = funcs.vector;\r\n\t\t\treturn Player.execFunc( funcs, axisName, optionsPoints.t, a, b );\r\n\r\n\r\n\t\t}\r\n\t\tconst point = funcs.vector instanceof THREE.Vector3 === true ?\r\n\t\t\tnew THREE.Vector3( getAxis( 'x' ), getAxis( 'y' ), getAxis( 'z' ) ) :\r\n\t\t\tnew THREE.Vector4( getAxis( 'x' ), getAxis( 'y' ), getAxis( 'z' ), getAxis( 'w' ) );\r\n\r\n\t\tif ( funcs.w === undefined ) {\r\n\r\n/*\r\n\t\t\tpoint.w = {};//Если тут поставить NaN то в points.geometry.attributes.position.array он преобразуется в 0.\r\n\t\t\t//Тогда в gui появится ненужный орган управления controllerW\r\n\t\t\t//от балды поставил пустой объект что бы при создании points.geometry.attributes.position.array\r\n\t\t\t//это зачение преобразвалось в NaN.\r\n*/\r\n//Цвет этой точки не определен и по умолчанию должен быть белым.\r\n//если я определю w то цвет точки будет зависеть от выбранной палитры\r\n//\t\t\tfuncs.w = 1;//white color\r\n\r\n\t\t}\r\n\r\n\t\tpoints.push( point );\r\n\r\n\t}\r\n\treturn points;\r\n\r\n}\r\n\r\n/**\r\n * Get array of mesh colors.\r\n * @function Player.\r\n * getColors\r\n * @param {THREE.Vector4|THREE.Vector3|THREE.Vector2|object|array} arrayFuncs points.geometry.attributes.position array\r\n * <pre>\r\n * THREE.Vector4: 4D point.\r\n * THREE.Vector3: 3D point. w = 1. Default is white color\r\n * THREE.Vector2: 2D point. w = 1, z = 0. Default is white color\r\n * Vector's x, y, z, w is position of the point.\r\n * Can be as:\r\n * float - position of the point.\r\n * [float] - array of positions of the point.\r\n * [Function]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} - position of the point is function of the t.\r\n * Example: new Function( 't', 'a', 'b', 'return Math.sin(t*a*2*Math.PI)*0.5+b' )\r\n *\r\n * Vector.w is index of the [palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * Default range of the Vector.w is from 0 to 100. You can change range by use an object:\r\n * {\r\n *   func: Vector.w\r\n *   max: new max value of tne Vector.w\r\n *   min: new min value of tne Vector.w\r\n * }\r\n * Example:\r\n * {\r\n *\r\n *   func: new Function( 't', 'return 1-2*t' ),\r\n *   min: -1,\r\n *   max: 1,\r\n *\r\n * }\r\n * Vector.w can be as THREE.Color. Example: new THREE.Color( \"rgb(255, 127, 0)\" )\r\n *\r\n * object: {\r\n *   vector: THREE.Vector4|THREE.Vector3|THREE.Vector2 - point position\r\n *   [name]: point name. Default is undefined.\r\n *   [trace]: true - displays the trace of the point movement. Default is undefined.\r\n * }\r\n * or\r\n * object: {\r\n *   x: x axis. Defauilt is 0.\r\n *   y: y axis. Defauilt is 0.\r\n *   z: z axis. Defauilt is 0.\r\n *   w: w axis. Defauilt is 0.\r\n * }\r\n *\r\n * array: [\r\n *   0: x axis. Defauilt is 0.\r\n *   1: y axis. Defauilt is 0.\r\n *   2: z axis. Defauilt is 0.\r\n *   3: w axis. Defauilt is 0.\r\n * ]\r\n * </pre>\r\n * @param {object} [optionsColor] the following options are available:\r\n * @param {object} [optionsColor.palette] [color palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * @param {object} [optionsColor.scale]\r\n * @param {object} [optionsColor.scale.min] Minimal range of the [color palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * <p>Default is undefined. Minimal palette range is 0.</p>\r\n * @param {object} [optionsColor.scale.max] Maximal range of the [color palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * <p>Default is undefined. Maximal palette range is 100</p>\r\n * @param {THREE.BufferAttribute} [optionsColor.positions] geometry.attributes.position of the new mesh. Default is undefined.\r\n * @param {array} [optionsColor.colors] array for mesh colors. Default is undefined.\r\n * @param {boolean} [optionsColor.opacity] if true then opacity of the point is depend from distance to all  meshes points from the group with defined mesh.userData.cloud. Default is undefined.\r\n * @returns array of mesh colors.\r\n */\r\nPlayer.getColors = function ( /*THREE, */arrayFuncs, optionsColor ) {\r\n\r\n\tif ( typeof THREE === 'undefined' ) {\r\n\r\n\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\tColorPicker.palette.setTHREE(THREE);\r\n\toptionsColor = optionsColor || {};\r\n/*\t\r\n\tif ( !optionsColor.palette ) {\r\n\r\n\t\tconsole.error( 'Player.getColors: Define palette first.' );\r\n\t\treturn;\r\n\r\n\t}\r\n*/\t\r\n//\toptionsColor.palette = optionsColor.palette || palette.get();\r\n\t\r\n\tif (\r\n\t\t( optionsColor.positions !== undefined ) &&\r\n\t\tArray.isArray( arrayFuncs ) &&\r\n\t\t( arrayFuncs.length !== optionsColor.positions.count )\r\n\t) {\r\n\r\n\t\tconsole.error( 'getColors failed! arrayFuncs.length: ' + arrayFuncs.length + ' != positions.count: ' + optionsColor.positions.count );\r\n\t\treturn optionsColor.colors;\r\n\r\n\t}\r\n\r\n\t//не надо убирать const length. Иначе переполнится память\r\n\tconst length = Array.isArray( arrayFuncs ) ? arrayFuncs.length : optionsColor.positions.count;\r\n\r\n\toptionsColor.colors = optionsColor.colors || [];\r\n\tif ( !optionsColor.palette ) {\r\n\r\n\t\t//Все точки белые и непрозрачные\r\n\t\tfor ( var i = 0; i < length; i++ ) optionsColor.colors.push( 1, 1, 1, 1 );\r\n\t\treturn optionsColor.colors;\r\n\r\n\t}\r\n\r\n\tfor ( var i = 0; i < length; i++ ) {\r\n\r\n\t\tconst funcs = Array.isArray( arrayFuncs ) ? arrayFuncs[i] : undefined;\r\n\t\tvar vector;\r\n\t\tif (\r\n\t\t\t( funcs instanceof THREE.Vector4 ) ||//w of the funcs is color of the point\r\n\t\t\t( optionsColor.positions && ( optionsColor.positions.itemSize === 4 ) )//w position of the positions is color of the point\r\n\t\t\t) {\r\n\r\n\t\t\tlet min, max;\r\n\t\t\tvar w = funcs.w;\r\n\t\t\tif ( funcs.w instanceof Object && funcs.w.func ) {\r\n\r\n\t\t\t\tif ( funcs.w.max ) max = funcs.w.max;\r\n\t\t\t\tif ( funcs.w.min ) min = funcs.w.min;\r\n\t\t\t\tw = funcs.w.func;\r\n\r\n\t\t\t} else if ( optionsColor.scale !== undefined ) {\r\n\r\n\t\t\t\tmin = optionsColor.scale.min; max = optionsColor.scale.max;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( funcs instanceof THREE.Vector4 ) {\r\n\r\n\t\t\t\t\tif ( typeof funcs.w === 'function' ) {\r\n\r\n\t\t\t\t\t\tmax = 100;\r\n\t\t\t\t\t\tmin = 0;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else { }\r\n\r\n\t\t\t}\r\n\t\t\tif ( w instanceof Function && ! settings ) {\r\n\r\n\t\t\t\tconsole.error( 'Player.getColors: remove all functions from all THREE.Vector4.w items of the arrayFuncs.' );\r\n\t\t\t\tconsole.error( ' \tOr create Player.' );\r\n\t\t\t\tconsole.error( '\tIf you use MyPoints for create of the points, please add Player: Player into settings parameter of the MyPoints function after creating of the Player.' );\r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tvar color = optionsColor.palette.toColor(\r\n\t\t\t\tfuncs === undefined ?\r\n\t\t\t\t\tnew THREE.Vector4().fromBufferAttribute( optionsColor.positions, i ).w :\r\n\t\t\t\t\tw instanceof Function ?\r\n\t\t\t\t\t\tw( settings.min ) :\r\n\t\t\t\t\t\tw,\r\n\t\t\t\tmin, max );\r\n\t\t\toptionsColor.colors.push( color.r, color.g, color.b );\r\n\r\n\t\t} else if ( optionsColor.colors instanceof THREE.Float32BufferAttribute )\r\n\t\t\tvector = new THREE.Vector3( 1, 1, 1 );\r\n\t\telse optionsColor.colors.push( 1, 1, 1 );//white\r\n\r\n\t\t//opacity\r\n\t\tif ( optionsColor.opacity !== undefined ) {\r\n\r\n\t\t\tvar opacity = 0,\r\n\t\t\t\tstandardNormalDistributionZero = getStandardNormalDistribution( 0 );\r\n\t\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\t\tif ( !mesh.userData.cloud )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tfor ( var iMesh = 0; iMesh < mesh.geometry.attributes.position.count; iMesh++ ) {\r\n\r\n\t\t\t\t\tvar position = getObjectPosition( mesh, iMesh );\r\n\t\t\t\t\topacity += getStandardNormalDistribution(\r\n\t\t\t\t\t\tgetWorldPosition(//myThreejs.getWorldPosition(\r\n\t\t\t\t\t\t\tcamera, new THREE.Vector3().fromBufferAttribute( optionsColor.positions, i )\r\n\t\t\t\t\t\t).distanceTo( position ) * 5\r\n\t\t\t\t\t) / standardNormalDistributionZero;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tif ( debug.opacity !== undefined )\r\n\t\t\t\topacity = debug.opacity;\r\n\r\n\t\t\tif ( optionsColor.colors instanceof THREE.Float32BufferAttribute ) {\r\n\r\n\t\t\t\toptionsColor.colors.setXYZW( i, vector.x, vector.y, vector.z, opacity );\r\n\r\n\t\t\t}\r\n\t\t\telse optionsColor.colors.push( opacity );\r\n\r\n\t\t} else optionsColor.colors.push( 1 );\r\n\r\n\t}\r\n\treturn optionsColor.colors;\r\n\r\n}\r\n\r\n/**\r\n * trace line of moving of the point during playing\r\n * @function Player.\r\n * traceLine\r\n * @param {object} options the following options are available\r\n * @param {object} options.player See Player function above.\r\n */\r\nPlayer.traceLine = function ( /*THREE, group, */options ) {\r\n\r\n\tif ( typeof THREE === 'undefined' ) {\r\n\r\n\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\treturn;\r\n\r\n\t}\r\n/*\r\n\tif ( !group ) {\r\n\r\n\t\tconsole.error( 'Player.traceLine: Define optionsPoints.group of the Player.getPoints first.' );\r\n\t\treturn;\r\n\t\t\r\n\t}\r\n*/\r\n\tif ( !settings ) {\r\n\r\n\t\tconsole.error( 'Player.traceLine: Remove all trace: true from arrayFunc parameter of the MyPoints or getShaderMaterialPoints method.' );\r\n\t\tconsole.error( '\tOr call Player(...).' );\r\n\t\tconsole.error( '\tIf you use getShaderMaterialPoints or MyPoints for create of the points, please add Player: Player into settings parameter of the getShaderMaterialPoints or MyPoints method after creating of the Player.' );\r\n\t\treturn;\r\n\t\t\r\n\t}\r\n\tvar line;\r\n\tconst arrayLines = [];\r\n\tthis.addPoint = function ( mesh/*point*/, index, color ) {\r\n\r\n\t\tconst attributesPosition = mesh.geometry.attributes.position;\r\n\t\tvar point = attributesPosition.itemSize >= 4 ? new THREE.Vector4( 0, 0, 0, 0 ) : new THREE.Vector3();\r\n\t\tpoint.fromArray( attributesPosition.array, index * attributesPosition.itemSize );\r\n//\t\tvar point = getObjectPosition( mesh, index ),\r\n\t\tvar sceneIndex = Player.getSelectSceneIndex();\r\n\t\tif ( settings.max === null ) {\r\n\r\n\t\t\tsceneIndex = Math.abs( sceneIndex );\r\n\t\t\tif ( sceneIndex < ( arrayLines.length - 1 ) ){\r\n\r\n\t\t\t\twhile ( sceneIndex < ( arrayLines.length - 1 ) ) {\r\n\r\n//\t\t\t\t\tgroup.remove( arrayLines[arrayLines.length - 1] );\r\n\t\t\t\t\tmesh.remove( arrayLines[arrayLines.length - 1] );\r\n\t\t\t\t\tarrayLines.pop();\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\t// geometry\r\n\t\t\tconst geometry = new THREE.BufferGeometry(), MAX_POINTS = 2;\r\n\r\n\t\t\t// attributes\r\n\t\t\tconst positions = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\tgeometry.setAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\t\t\tconst colors = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\tgeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\t\tconst line = new THREE.Line( geometry, new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } ) );\r\n//\t\t\tgroup.add( line );\r\n\t\t\tmesh.add( line );\r\n\r\n\t\t\t//на случай когда пользователь изменил флажок трассировки\r\n\t\t\t//первая линия arrayLines[0] всегда имеет visible = true потому что сюда попадат только если установлена трассировка по умолчанию\r\n\t\t\t//или пользователь установил флаг трассировки\r\n\t\t\tif ( arrayLines[0] ) line.visible = arrayLines[0].visible;\r\n\r\n\t\t\t//point position\r\n\t\t\tpoint = new THREE.Vector3().copy( point );\r\n\t\t\tconst itemSize = line.geometry.attributes.position.itemSize;\r\n\t\t\tpoint.toArray( line.geometry.attributes.position.array, 1 * itemSize );\r\n\t\t\tconst point0 = arrayLines.length === 0 ? point :\r\n\t\t\t\tnew THREE.Vector3().fromArray(arrayLines[arrayLines.length-1].geometry.attributes.position.array, 1 * itemSize);\r\n\t\t\tpoint0.toArray( line.geometry.attributes.position.array, 0 * itemSize );\r\n\t\t\tline.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t//point color\r\n\t\t\tif ( color === undefined )\r\n\t\t\t\tcolor = new THREE.Color( 1, 1, 1 );//White\r\n\t\t\tPlayer.setColorAttribute( line.geometry.attributes, 0, arrayLines.length === 0 ? color :\r\n\t\t\t\t new THREE.Color().fromArray(arrayLines[arrayLines.length-1].geometry.attributes.color.array, 1 * itemSize));\r\n\t\t\tPlayer.setColorAttribute( line.geometry.attributes, 1, color );\r\n\r\n\t\t\tarrayLines.push( line );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tif ( line === undefined ) {\r\n\r\n\t\t\t// geometry\r\n\t\t\tconst geometry = new THREE.BufferGeometry();\r\n\r\n\t\t\t//Thanks to https://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically/31411794#31411794\r\n\t\t\tvar MAX_POINTS;\r\n\t\t\tif ( settings.max !== null ) {\r\n\r\n\t\t\t\tif ( settings && settings.marks )\r\n\t\t\t\t\tMAX_POINTS = settings.marks;\r\n\t\t\t\telse if ( options.player && options.player.marks )\r\n\t\t\t\t\tMAX_POINTS = options.player.marks;\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tconsole.error( 'Player.traceLine: MAX_POINTS = ' + MAX_POINTS + '. Create Player first or remove all trace = true from all items of the arrayFuncs' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else MAX_POINTS = sceneIndex + 1;\r\n\r\n\t\t\t// attributes\r\n\t\t\tconst positions = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\tgeometry.setAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\t\t\tconst colors = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\tgeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\t\t// draw range\r\n\t\t\tgeometry.setDrawRange( sceneIndex, sceneIndex );\r\n\r\n\t\t\tline = new THREE.Line( geometry, new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } ) );\r\n\t\t\tline.visible = true;\r\n//\t\t\tgroup.add( line );\r\n\t\t\tmesh.add( line );\r\n\r\n\t\t}\r\n/*\r\n\t\tif ( line.geometry ) {//scene do not have geometry\r\n\r\n\t\t\tdelete line.geometry.boundingSphere;\r\n\t\t\tline.geometry.boundingSphere = null;\r\n\r\n\t\t}\r\n*/\r\n\t\t//Если не удалять boundingSphere\r\n\t\t//и если двигается камера от проигрывания или ее перемещает пользователь\r\n\t\t//то в некоторых случаях линию не будет видно даже если она не выходит из поля видимости\r\n\t\t//потому что она выходит за рамки frustupoints\r\n\t\tif ( line.geometry ) {//scene do not have geometry\r\n\r\n\t\t\tdelete line.geometry.boundingSphere;\r\n\t\t\tline.geometry.boundingSphere = null;\r\n\r\n\t\t}\r\n\r\n\t\t//point position\r\n\t\tpoint = new THREE.Vector3().copy( point );\r\n\t\tpoint.toArray( line.geometry.attributes.position.array, sceneIndex * line.geometry.attributes.position.itemSize );\r\n\t\tline.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t//point color\r\n\t\tif ( color === undefined )\r\n\t\t\tcolor = new THREE.Color( 1, 1, 1 );//White\r\n\t\tPlayer.setColorAttribute( line.geometry.attributes, sceneIndex, color );\r\n\r\n\t\t//set draw range\r\n\t\tvar start = line.geometry.drawRange.start, count = sceneIndex + 1 - start;\r\n\t\tif ( start > sceneIndex ) {\r\n\r\n\t\t\tvar stop = start + line.geometry.drawRange.count;\r\n\t\t\tstart = sceneIndex;\r\n\t\t\tcount = stop - start;\r\n\r\n\t\t}\r\n\t\tline.geometry.setDrawRange( start, count );\r\n\r\n\t}\r\n\t/**\r\n\t * Show or hide trace line.\r\n\t * @function Player.traceLine.\r\n\t * visible\r\n\t * @param {boolean} visible true - show trace line.\r\n\t * <p>false - hide trace line.</p>\r\n\t */\r\n\tthis.visible = function ( visible ) {\r\n\r\n\t\tif ( line ) {\r\n\r\n\t\t\tline.visible = visible;\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\t//сюда попадает когда t max is Infinity (settings.max === null) и когда пользователь в выбранной в guiSelectPoint  точке изменил галочку трассировки\r\n\t\tarrayLines.forEach( function ( line ) {\r\n\r\n\t\t\tline.visible = visible;\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\t/**\r\n\t * Is trace line visible?\r\n\t * @function Player.traceLine.\r\n\t * isVisible\r\n\t * @returns true - trace line is visible.\r\n\t * <p>false - trace line is not visible.</p>\r\n\t */\r\n\tthis.isVisible = function () {\r\n\r\n\t\tif ( line ) return line.visible;\r\n\t\t//сюда попадает когда t max is Infinity ( settings.max === null ) и когда пользователь выбрал точку в guiSelectPoint у которой установлена трассировка\r\n\t\treturn arrayLines[0].visible;\r\n\r\n\t}\r\n\t/**\r\n\t * Remove trace line.\r\n\t * @function Player.traceLine.\r\n\t * remove\r\n\t */\r\n\tthis.remove = function () {\r\n\r\n\t\tif ( line === undefined )\r\n\t\t\treturn;\r\n\t\tline.geometry.dispose();\r\n\t\tline.material.dispose();\r\n\t\tgroup.remove( line );\r\n\r\n\t}\r\n\r\n}\r\nfunction setDT() {\r\n\r\n\tif ( settings.max === null ) settings.dt = settings.dt || 0.1;\r\n\telse settings.dt = ( settings.max - settings.min ) / ( settings.marks - 1 );\r\n\r\n}\r\nfunction setMax() { if ( settings.max !== null ) settings.max = settings.min + settings.dt * ( settings.marks - 1 ); }\r\nfunction assignSettings() {\r\n\r\n\tsettings = settings || {};\r\n\tsettings.min = settings.min || 0;\r\n\tif ( settings.max === Infinity ) settings.max = null;//Заменяю Infinity на null потому что из cockie Infinity читается как null\r\n\tif ( settings.max !== null ) {\r\n\r\n\t\tif ( settings.max === undefined ) settings.max =  1;\r\n\t\tsettings.marks = settings.marks || 10;//2;\r\n\r\n\t} else settings.marks = null;\r\n\tsetDT();\r\n\tsettings.repeat = settings.repeat || false;\r\n\tsettings.interval = settings.interval || 1;//25;\r\n\tsettings.zoomMultiplier = settings.zoomMultiplier || 1.1;\r\n\tsettings.offset = settings.offset || 0.1;\r\n\tsettings.name = settings.name || '';\r\n\r\n}\r\n\r\n/**\r\n * @function Player.\r\n * getSettings\r\n * @returns Player ettings.\r\n */\r\nPlayer.getSettings = function () {\r\n\r\n\tif ( !settings ) {\r\n\r\n\t\tassignSettings();\r\n\r\n\t}\r\n\treturn settings;\r\n\r\n}\r\n/**\r\n * @function Player.\r\n * getSelectSceneIndex\r\n * @returns selected scene index.\r\n */\r\nPlayer.getSelectSceneIndex = function () {\r\n\r\n\tif ( Player.player )\r\n\t\treturn Player.player.getSelectSceneIndex();\r\n\treturn 0;\r\n\r\n}\r\n/**\r\n * get time\r\n * @function Player.\r\n * getTime\r\n */\r\nPlayer.getTime = function () {\r\n\r\n\tif ( Player.player )\r\n\t\treturn Player.player.getTime();\r\n\treturn 0;\r\n\r\n}\r\n\r\n/**\r\n * get item size of the attribute of the mesh geometry\r\n * @function Player.\r\n * getItemSize\r\n * @param {array} arrayFuncs points.geometry.attributes.position array.\r\n * See arrayFuncs parametr of the [Player.getPoints(...)]{@link https://raw.githack.com/anhr/commonNodeJS/master/player/jsdoc/module-Player.html#~Player.getPoints} for details.\r\n */\r\nPlayer.getItemSize = function ( arrayFuncs ) {\r\n\r\n\tif ( typeof THREE === 'undefined' ){\r\n\r\n\t\tconsole.error( 'Call Player.setTHREE(THREE) first.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar func = arrayFuncs[i];\r\n\t\tif ( func instanceof THREE.Vector4 )\r\n\t\t\treturn 4;\r\n\r\n\t}\r\n\treturn 3;\r\n\r\n}\r\n/**\r\n * set THREE\r\n * @function Player.\r\n * setTHREE\r\n * @param {THREE} THREE {@link https://github.com/anhr/three.js|THREE}\r\n */\r\nPlayer.setTHREE = function ( _THREE ) {\r\n\r\n\tif ( THREE ) {\r\n\r\n\t\tif ( !Object.is( THREE, _THREE ) )\r\n\t\t\tconsole.error( 'Player.setTHREE: duplicate THREE. Please use one instance of the THREE library.' )\r\n\t\treturn;\r\n\r\n\t}\r\n\tif ( !THREE ) {\r\n\r\n\t\tTHREE = _THREE;\r\n\t\tObject.assign( THREE.BufferGeometry.prototype, {\r\n\r\n\t\t\tsetFromPoints: function ( points, itemSize ) {\r\n\r\n\t\t\t\titemSize = itemSize || 3;\r\n\t\t\t\tvar position = [];\r\n\r\n\t\t\t\tfor ( var i = 0, l = points.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\tvar point = points[i];\r\n\t\t\t\t\tposition.push( point.x, point.y, point.z || 0 );\r\n\t\t\t\t\tif ( itemSize >= 4 )\r\n\t\t\t\t\t\tposition.push( point.w || 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.setAttribute( 'position', new THREE.Float32BufferAttribute( position, itemSize ) );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t},\r\n\r\n\t\t} );\r\n\r\n\t\t//three.js\\dev\\src\\math\\Vector4.js\r\n\t\tObject.assign( THREE.Vector4.prototype, {\r\n\r\n\t\t\tmultiply: function ( v ) {\r\n\r\n\t\t\t\tthis.x *= v.x;\r\n\t\t\t\tthis.y *= v.y;\r\n\t\t\t\tthis.z *= v.z;\r\n\t\t\t\t//\t\tthis.w *= v.w || 1;\r\n\t\t\t\tif ( v.w !== undefined )\r\n\t\t\t\t\tthis.w *= v.w;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t},\r\n\r\n\t\t} );\r\n\t\t//three.js\\dev\\src\\math\\Vector4.js\r\n\t\tObject.assign( THREE.Vector4.prototype, {\r\n\r\n\t\t\tadd: function ( v, w ) {\r\n\r\n\t\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.x += v.x;\r\n\t\t\t\tthis.y += v.y;\r\n\t\t\t\tthis.z += v.z;\r\n\t\t\t\tif ( v.w !== undefined )\r\n\t\t\t\t\tthis.w += v.w;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t},\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\t//three.js\\dev\\src\\objects\\Points.js\r\n\tObject.assign( THREE.Points.prototype, {\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tconst _inverseMatrix = new THREE.Matrix4();\r\n\t\t\tconst _ray = new THREE.Ray();\r\n\t\t\tconst _sphere = new THREE.Sphere();\r\n\t\t\tconst _position = new THREE.Vector3();\r\n\t\t\tfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\r\n\r\n\t\t\t\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\r\n\r\n\t\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\r\n\t\t\t\t\tconst intersectPoint = new THREE.Vector3();\r\n\r\n\t\t\t\t\t_ray.closestPointToPoint( point, intersectPoint );\r\n\t\t\t\t\tintersectPoint.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\t\t\tpoint: intersectPoint,\r\n\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tobject: object\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst geometry = this.geometry;\r\n\t\t\tconst matrixWorld = this.matrixWorld;\r\n\t\t\tconst threshold = raycaster.params.Points.threshold;\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\t_sphere.copy( geometry.boundingSphere );\r\n\t\t\t_sphere.applyMatrix4( matrixWorld );\r\n\t\t\t_sphere.radius += threshold;\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\r\n\r\n\t\t\t//\r\n\r\n//three.module.js:47508 THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.\r\n//\t\t\t_inverseMatrix.getInverse( matrixWorld );\r\n\t\t\t_inverseMatrix.copy( matrixWorld ).invert();\r\n\t\t\t\r\n\t\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\r\n\r\n\t\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\t\tconst localThresholdSq = localThreshold * localThreshold;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tconst index = geometry.index;\r\n\t\t\t\tconst attributes = geometry.attributes;\r\n\t\t\t\tconst positions = attributes.position.array;\r\n\t\t\t\tconst itemSize = attributes.position.itemSize;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tconst indices = index.array;\r\n\r\n\t\t\t\t\tfor ( let i = 0, il = indices.length; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\tconst a = indices[i];\r\n\r\n\t\t\t\t\t\t_position.fromArray( positions, a * itemSize );\r\n\r\n\t\t\t\t\t\ttestPoint( _position, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = positions.length / itemSize; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\t_position.fromArray( positions, i * itemSize );\r\n\r\n\t\t\t\t\t\ttestPoint( _position, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst vertices = geometry.vertices;\r\n\r\n\t\t\t\tfor ( let i = 0, l = vertices.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\ttestPoint( vertices[i], i, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\r\n}\r\n\r\nexport default Player;\r\n"],"names":["isEnabled","navigator","cookieEnabled","set","name","value","cookie_date","toString","undefined","Date","setTime","getTime","cookie","settings","toGMTString","document","console","error","setObject","object","JSON","stringify","get","defaultValue","results","match","unescape","getObject","options","optionsDefault","defaultCookie","copyObject","objectDefault","parse","consoleCookieEnabled","keys","forEach","key","option","isTrue","setCookie","getCookie","___$insertStyle","css","window","style","createElement","setAttribute","innerHTML","head","appendChild","colorToString","color","forceCSSHex","colorFormat","__state","conversionName","r","Math","round","g","b","a","h","s","toFixed","v","str","hex","length","ARR_EACH","Array","prototype","ARR_SLICE","slice","Common","extend","target","each","call","arguments","obj","isObject","Object","isUndefined","bind","defaults","compose","toCall","args","i","apply","itr","scope","l","BREAK","_key","defer","fnc","debounce","func","threshold","callImmediately","timeout","delayed","callNow","setTimeout","toArray","isNull","_isNaN","isNaN","_x","isArray","constructor","isNumber","isString","isBoolean","isFunction","INTERPRETATIONS","read","original","test","parseInt","parseFloat","write","result","toReturn","interpret","family","litmus","conversions","conversion","tmpComponent","ColorMath","hsv_to_rgb","hi","floor","f","p","q","t","c","rgb_to_hsv","min","max","delta","NaN","rgb_to_hex","hex_with_component","component_from_hex","componentIndex","_typeof","Symbol","babelHelpers.typeof","iterator","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","getter","inherits","subClass","superClass","create","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","Color","Error","toHexString","toOriginal","defineRGBComponent","component","componentHexIndex","get$$1","space","recalculateRGB","set$$1","defineHSVComponent","recalculateHSV","COMPONENTS","Controller","initialValue","domElement","__onChange","__onFinishChange","onChange","onFinishChange","setValue","newValue","updateDisplay","getValue","isModified","EVENT_MAP","EVENT_MAP_INV","k","e","CSS_VALUE_PIXELS","cssValueToPixels","val","dom","makeSelectable","elem","selectable","onselectstart","MozUserSelect","KhtmlUserSelect","unselectable","makeFullscreen","hor","vert","vertical","horizontal","position","left","right","top","bottom","fakeEvent","eventType","pars","aux","params","className","evt","createEvent","clientX","x","clientY","y","initMouseEvent","bubbles","cancelable","clickCount","init","initKeyboardEvent","initKeyEvent","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode","initEvent","dispatchEvent","event","newBool","bool","addEventListener","attachEvent","unbind","removeEventListener","detachEvent","addClass","classes","split","indexOf","push","join","replace","removeClass","removeAttribute","index","splice","hasClass","RegExp","getWidth","getComputedStyle","width","getHeight","height","getOffset","el","offset","offsetParent","offsetLeft","offsetTop","isActive","activeElement","type","href","BooleanController","_Controller","_this2","_this","__prev","__checkbox","checked","OptionController","opts","__select","map","element","opt","desiredValue","selectedIndex","StringController","__input","onBlur","blur","numDecimals","NumberController","_params","__min","__max","__step","step","__impliedStep","pow","log","abs","LN10","__precision","_v","minValue","maxValue","stepValue","roundToDecimal","decimals","tenTo","NumberControllerBox","_NumberController","__truncationSuspended","prevY","attempted","onFinish","onMouseDrag","diff","onMouseUp","onMouseDown","i1","i2","o1","o2","NumberControllerSlider","__background","__foreground","onTouchStart","preventDefault","bgRect","getBoundingClientRect","touches","onTouchMove","onTouchEnd","pct","FunctionController","text","__button","fire","ColorController","__color","__temp","__selector","__saturation_field","__field_knob","__field_knob_border","__hue_knob","__hue_field","__input_textShadow","valueField","fieldDown","fieldDownH","setSV","fieldUpSV","setH","fieldUpH","fieldRect","_ref","_ref2","mismatch","flip","_flip","marginTop","vendors","linearGradient","background","vendor","cssText","hueGradient","ControllerFactory","CustomController","newController","_controller","load","url","indoc","doc","link","rel","getElementsByTagName","inject","cssContent","injected","saveDialogContents","requestAnimationFrame","callback","requestAnimationFrame$1","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","CenteredDiv","backgroundElement","body","hide","show","display","opacity","webkitTransform","layout","innerWidth","innerHeight","styleSheet","CSS_NAMESPACE","HIDE_KEY_CODE","CLOSE_BUTTON_HEIGHT","DEFAULT_DEFAULT_PRESET_NAME","SUPPORTS_LOCAL_STORAGE","localStorage","SAVE_DIALOGUE","autoPlaceVirgin","autoPlaceContainer","hideableGuis","GUI","__ul","__folders","__controllers","__rememberedObjects","__rememberedObjectIndecesToControllers","__listening","DEFAULT_WIDTH","autoPlace","preset","hideable","resizable","scrollable","useLocalStorage","getItem","getLocalStorageHash","saveToLocalStorage","titleRow","closeOnTop","getRoot","revert","closed","CLASS_CLOSED","onResize","__closeButton","TEXT_OPEN","TEXT_CLOSED","setItem","CLASS_MAIN","savedGui","CLASS_CLOSE_BUTTON","CLASS_CLOSE_TOP","insertBefore","childNodes","CLASS_CLOSE_BOTTOM","titleRowName","createTextNode","addRow","onClickTitle","CLASS_AUTO_PLACE_CONTAINER","CLASS_AUTO_PLACE","__resizeHandler","onResizeDebounced","getSaveObject","saveToLocalStorageIfPossible","resetWidth","root","toggleHide","gui","CLASS_CONTROLLER_ROW","CLASS_TOO_TALL","CLASS_DRAG","_keydownHandler","which","add","_add","addColor","remove","controller","removeChild","__li","destroy","subfolder","removeFolder","addFolder","newGuiParams","folders","li","folder","parentElement","open","close","node","__save_row","__resize_handle","offsetHeight","remember","remembered","getCurrentPreset","save","saveAs","presetName","listen","newDom","liBefore","removeListeners","markPresetModified","modified","__preset_select","augmentController","__gui","_options","nextSibling","nextElementSibling","_nextSibling","_name","firstElementChild","box","method","pc","pb","returned","oldName","wasListening","stopPropagation","borderLeftColor","recallSavedValue","matchedIndex","controllerMap","presetMap","customObject","factoryArgs","concat","before","propertyName","container","location","addPresetOption","setSelected","showHideExplain","explain","addSaveMenu","div","firstChild","gears","button","button2","button3","select","getElementById","localStorageCheckBox","saveLocally","newConstructorTextArea","focus","prompt","addResizeHandle","pmouseX","drag","dragStop","dragStart","setWidth","w","useInitialValues","savedValues","setPresetSelectIndex","updateDisplays","controllerArray","controllers","GUI$1","dat","elNameAndTitle","title","warn","controllerNameAndTitle","querySelector","folderNameAndTitle","controllerZeroStep","onchange","input","controllerSetValue","UpDownController","onclick","cursor","onwheel","onWheel","deltaY","detail","wheelDelta","margin","ScaleController","zoomMultiplier","customController","lang","_languageCode","getLanguageCode","zoom","in","out","wheelZoom","languageCode","buttons","addButton","zoomLabel","PositionController","onclickController","subtract","wheelPosition","Label","shift","myRequest","loadXMLDoc","req","XMLHttpRequest","ActiveXObject","NewActiveXObject","XMLHttpRequestStart","onreadystatechange","async","XMLHttpRequestStop","onerror","XMLHttpRequestReStart","getUrl","ontimeout","timeout_id_SendReq","send","message","abort","ProcessReqChange","processStatus200","readyState","status","processStatus200Error","GetElementText","tagName","noDisplayErrorMessage","xmlhttp","responseXML","ErrorMessage","responseText","textContent","data","appName","appVersion","sync","onload","response","request","src","appendTo","isScriptExists","optionsItem","tag","item","script","loadFileSync","loadScriptBase","isrc","srcAsync","next","_onload","attribute","elParent","scripts","querySelectorAll","child","id","loadScript","optionsStyle","getCurrentScript","currentScript","stack","getCurrentScriptPath","path","substring","lastIndexOf","currentScriptPath","SVGAngle","implementation","hasFeature","svgNS","uniqID","paletteIndexes","elSliderWrapper","orientation","isHorizontal","direction","onError","HTMLElement","classList","palette","Palette","slide","getSlideHeight","getSlideWidth","clientWidth","slideIndicator","hsv2rgb","percent","sliderIndicator","pointerEvents","positionIndicators","offsetWidth","CreateSVGElement","getPalette","fill","mouseMove","mouse","size","slideListener","mouseout","mousePosition","contentOverflow","offsetX","offsetY","wrapper","parentNode","layerX","layerY","listener","enableDragging","ctx","rect","srcElement","mouseup","mousemove","attrs","children","createElementNS","len","paletteitem","BGRW","arrayPalette","monochrome","bidirectional","rainbow","unshift","Number","toUpperCase","stringPercent","lastPalette","lastItem","itemPrev","percentPrev","prev","percentItem","percentD","toColor","THREE","setTHREE","_THREE","is","ColorPicker","functionsFolder","fParent","scales","boError","functions","defaultButton","defaultTitle","fFunctions","vector","getFuncText","z","cFunctions","createControl","axisName","vectorCur","getAxisName","buttonDefault","getStyle","typeofFunc","typeofValue","float","array","setFocus","setFunction","_vector","vectorDefault","setVectorAxis","dislay","defaultF","dislayEl","displayController","displayFolder","GuiSelectPoint","guiParams","axesHelper","guiSelectPoint","setScale","cFrustumPoints","meshs","notSelected","rotation","points","cameraTarget","cameraTargetTitle","point","pointTitle","trace","traceTitle","traceAllTitle","pointWorld","pointWorldTitle","mesh","scale","opacityTitle","defaultScaleTitle","defaultPositionTitle","default3DObjectTitle","defaultRotationTitle","defaultLocalPositionTitle","f3DObjects","fPoint","cRestoreDefaultLocalPosition","fPointWorld","fPoints","cMeshs","fMesh","cScaleX","cScaleY","cScaleZ","cPosition","Vector3","cRotations","cPoints","selectedPointIndex","cX","cY","cZ","cW","cTrace","cTraceAll","cColor","cOpacity","cCameraTarget","funcFolder","boSetMesh","displayPointControllers","arrayCloud","cFrustumPointsF","exposePosition","getSelectedPointIndex","getObjectPosition","cWorld","readOnly","wLimitsDefault","setPosition","intersectionSelected","player","userData","arrayFuncs","changeTarget","positionLocal","getObjectLocalPosition","displayControllerW","displayControllerColor","displayControllerOpacity","none","block","intersection","opasity","isWObject","Player","execFunc","geometry","attributes","ca","vColor","Vector4","fromArray","itemSize","strColor","getHexString","boReadOnly","boFrustumPoints","setMesh","selected","update","getMeshIndex","setIndexMesh","selectPoint","removeMesh","removePoints","arrayMeshs","addMesh","uuid","default","copy","Euler","selectPoint2","selectedMesh","pointIndexes","setIntersection","getMesh","line","isVisible","isSelectedMesh","meshCur","isDisplay","frustumPoints","getSelectedIndex","selectedOptions","isNotSetControllers","setScaleControllers","setPositionControllers","setRotationControllers","visibleTraceLine","visible","traceLine","addPoint","buttonScaleDefault","buttonPositionDefault","buttonRotationDefault","Meshs","displayDefaultButtons","displayPoints","displayfPoints","displayFrustumPoints","iPosition","count","isCreated","traceAll","fScale","action","needsUpdate","updateCloudPoint","axesName","fPosition","addAxisControllers","fRotation","addRotationControllers","PI","Points","myThreejs","orbitControlsOptions","playerCameraTarget","boLook","j","selectScene","cameraGui","look","cameraTarget2","orbitControls","camera","cameraTargetPoint","reset","getCameraTarget","lookAt","pointsControls","pop","setColorAttribute","colorAttribute","setX","setY","setZ","addPointControllers","isReadOnlyController","boSetValue","axesGui","setW","updateCloudPointItem","elSlider","axesId","pointControls","axesWorldGui","positionDefault","funcs","getFrustumPoints","windowRange","attributesPosition","getWorldPosition","pos","clone","getPosition","positionAngle","multiply","applyEuler","_getLocale","languages","language","browserLanguage","systemLanguage","userLanguage","toLowerCase","prevSymbolTitle","playTitle","nextSymbolTitle","pauseTitle","repeatOn","repeatOff","controllerTitle","fullScreen","nonFullScreen","stereoEffects","mono","sideBySide","topAndBottom","PlayController","_getGroup","_selectScene","_renamePlayButtons","_renameRepeatButtons","colorOff","colorOn","RenamePlayButtons","buttonPlay","buttonPrev","prevSymbol","playSymbol","play3DObject","getOptions","RenameRepeatButtons","isRepeat","buttonRepeat","onChangeRepeat","repeat","buttonNext","nextSymbol","getGroup","group","onRenamePlayButtons","playing","pause","pushController","controler","selectPlaySceneOptions","boPlayer","selectPlayScene","selectMeshPlayScene","setCameraTarget","setCameraPosition","onSelectScene","setIndex","selectSceneIndex","dt","marks","playRate","time","timeNext","play","playNext","timestamp","interval","Infinity","getSelectSceneIndex","getLang","playerTitle","dtTitle","marksTitle","intervalTitle","_lang","Cookie","cookieName","setSettings","onChangeScaleT","axesDefault","freeze","fPlayer","axes","scaleController","scaleControllers","positionController","getSliderElement","marksName","_canvasMenu","createCanvasMenuItem","canvasMenu","menu","elMenuButtonPlay","addSlider","getSettings","addSliderEvents","oninput","pointerdown","onChangeScale","cameraTargetDefault","boTarget","boCameraTargetLook","_cameraTarget","bodefault","distanceToCamera","angle","axis","setTarget","distanceToCameraCur","isLook","applyAxisAngle","orbitControlsGui","typeofFuncs","res","execW","tStep","tStart","tStop","iStart","iStop","paletteDefault","boundingSphere","setRotation","setAttributes","fnName","getColor","material","ShaderMaterial","vertexColors","VertexColors","Float32BufferAttribute","getColors","getPoints","optionsPoints","Vector2","getAxis","optionsColor","positions","colors","fromBufferAttribute","standardNormalDistributionZero","getStandardNormalDistribution","cloud","iMesh","distanceTo","debug","setXYZW","arrayLines","sceneIndex","BufferGeometry","MAX_POINTS","Float32Array","BufferAttribute","Line","LineBasicMaterial","point0","setDrawRange","start","drawRange","stop","dispose","setDT","setMax","assignSettings","getItemSize","assign","addVectors","raycaster","intersects","_inverseMatrix","Matrix4","_ray","Ray","_sphere","Sphere","_position","testPoint","localThresholdSq","matrixWorld","rayPointDistanceSq","distanceSqToPoint","intersectPoint","closestPointToPoint","applyMatrix4","distance","ray","origin","near","far","sqrt","computeBoundingSphere","radius","intersectsSphere","invert","localThreshold","isBufferGeometry","indices","il","vertices"],"mappings":"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"}